/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 10:00:55 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.audit;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.oa.audit.po.AuditLog;
import com.js.system.service.rolemanager.RoleBD;
import com.js.system.util.*;
import java.util.List;
import com.js.system.service.mailmanager.MailBD;
import com.js.system.vo.mailmanager.MailVO;
import com.js.oa.audit.util.AuditSetupReader;
import java.util.Map;
import java.util.HashMap;
import com.js.oa.audit.bean.AuditMsRemindEJBBean;

public final class audittemmanager_005fsysSetup_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("com.js.system.util");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.oa.audit.po.AuditLog");
    _jspx_imports_classes.add("com.js.system.service.rolemanager.RoleBD");
    _jspx_imports_classes.add("java.util.List");
    _jspx_imports_classes.add("com.js.system.vo.mailmanager.MailVO");
    _jspx_imports_classes.add("com.js.oa.audit.bean.AuditMsRemindEJBBean");
    _jspx_imports_classes.add("com.js.system.service.mailmanager.MailBD");
    _jspx_imports_classes.add("java.util.Map");
    _jspx_imports_classes.add("java.util.HashMap");
    _jspx_imports_classes.add("com.js.oa.audit.util.AuditSetupReader");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

response.setHeader("Cache-Control","no-store");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", 0);
String action=request.getParameter("action");
String options=null;
String domainId=session.getAttribute("domainId").toString();
long limitSize=0;
String initPanel=request.getParameter("initPanel");
if(initPanel==null||initPanel.equals("")||initPanel.equals("null")){
	initPanel="0";
}

MailBD mb=new MailBD();
List mailList=mb.getMailList();
if(action!=null&&"update".equals(action)){
	String clickPanel=request.getParameter("clickPanel");
	StringBuffer optionBuffer=new StringBuffer();
	optionBuffer.append(request.getParameter("attach"))
		.append(request.getParameter("sign"))
		.append(request.getParameter("messageReceive"))
		.append(request.getParameter("potoflow"))
		.append(request.getParameter("rtx"))
		.append(request.getParameter("word"))
		.append(request.getParameter("website"))
		.append(request.getParameter("signature"))
		.append(request.getParameter("messageSend"));
		
		//记录日志情况
		java.sql.Connection conn=null;
	  java.sql.Statement stmt=null;
	  String moduleName,moduleSerial,moduleLog;
	  try{
	     conn=new com.js.util.util.DataSourceBase().getDataSource().getConnection();
	     stmt=conn.createStatement();
	     java.sql.ResultSet rs=stmt.executeQuery("select module_serial from sec_log_module where module_level=0 order by module_id");
	     while(rs.next()){
	        moduleSerial=rs.getString(1);		        
	        optionBuffer.append(",").append(request.getParameter(moduleSerial)).append(moduleSerial);
	     }
	     rs.close();
	     stmt.close();
	     conn.close();
	  }catch(Exception ex){
	  		if(conn!=null){
	  		  conn.close();
	  		}
	  		ex.printStackTrace();
	  }    
	options=optionBuffer.toString();	
	String limitSizeStr=request.getParameter("attachLimitSize");
	String limitSizeFilter=request.getParameter("filterLimitSize");
	if(limitSizeStr!=null && !"null".equals(limitSizeStr) && !"".equals(limitSizeStr)){
	    limitSize=Integer.parseInt(limitSizeStr)*1024*1024l;
	    
	}
	String isUserEmail=request.getParameter("email");
	String emailCount=request.getParameter("emailCount");
	String markPWD=request.getParameter("markPWD");
	String pwdImage=request.getParameter("pwdImage");
	String useRss=request.getParameter("useRss");
	String pwdStart=request.getParameter("pwdStart");
	String pwdEnd=request.getParameter("pwdEnd");
	String pwdStrongType=request.getParameter("pwdStrongType");
	String pwdStrong=request.getParameter("pwdStrong");
	String pwd_strong="0";
	
	

	
	if(pwdStrong.equals("1"))//启用密码强度开关
	{
		StringBuffer sb=new StringBuffer();
		if((pwdStart!=null||pwdStart.length()>0)&&(pwdEnd!=null||pwdEnd.length()>0))
		{
			sb.append("$");
			sb.append(pwdStart);
			sb.append("$");
			sb.append("$");
			sb.append(pwdEnd);
			sb.append("$");
			if(pwdStrongType!=null)
			{
				sb.append("$");
				sb.append("1");
				sb.append("$");
			}
			else
			{
				sb.append("$");
				sb.append("0");
				sb.append("$");
			}
			pwd_strong=sb.toString();
		}
	}
	String pwdErrorNum=request.getParameter("pwdErrorNumInput");
	String pwdErrorMin=request.getParameter("pwdErrorMinInput");
	String pwdSecurity=request.getParameter("pwdError");//登录失败次数开关
	String pwdError="0";
	if(pwdSecurity.equals("1"))//启用登录失败次数
	{
		StringBuffer sb=new StringBuffer();
		if((pwdErrorNum!=null||pwdErrorNum.length()>0)&&(pwdErrorNum!=null||pwdErrorNum.length()>0))
		{
			sb.append("$");
			sb.append(pwdErrorNum);
			sb.append("$");
			sb.append("$");
			sb.append(pwdErrorMin);
			sb.append("$");
			pwdError=sb.toString();
		}
	}
	String pwdDate=request.getParameter("pwdDate");
	String pwd_date="0";//密码过期天数默认为0未开启
	if(pwdDate.equals("1"))//如果启用密码过期天数
		pwd_date=request.getParameter("pwdDateInput");
	String pwdInit=request.getParameter("pwdChange");
	String pwd_init="0";//初始密码更改开关默认为0未开启
	if(pwdInit.equals("1"))//如果启用初始密码更改
		pwd_init=pwdInit;
	String pwdKey=request.getParameter("pwdKey");	
	String logId = AuditSetupReader.getInstance("0").insertLog(session.getAttribute("userId").toString(),
	           session.getAttribute("userName").toString(),session.getAttribute("orgId").toString(),"0");
	AuditSetupReader.getInstance(logId).updateSystemOption(domainId,options,request.getParameter("worklog"),
	           request.getParameter("mailBoxSize"),request.getParameter("netDiskSize"),request.getParameter("attachLimit"),
	           String.valueOf(limitSize),isUserEmail,emailCount,markPWD,useRss,request.getParameter("exportInner"),
	           request.getParameter("kq"),pwd_strong,pwd_init,pwd_date,pwdError,pwdImage,request.getParameter("linkmanScope"),
	           pwdKey,limitSizeFilter,request.getParameter("filterLimit"));
    //发送提醒开始
    AuditMsRemindEJBBean  msRemindBeann=new AuditMsRemindEJBBean();
    msRemindBeann.auditMsRemind(Long.valueOf((String)session.getAttribute("userId")), session.getAttribute("orgId").toString(), session.getAttribute("userName").toString(),
              1, 1, new java.util.Date(), "审计提醒:"+session.getAttribute("userName").toString()+"修改系统开关", "audit", Long.valueOf(logId), "/jsoa/audit/audittemmanager_sysSetup.jsp?logId="+logId+"&disabled=disabled&comeflag=tixing"); 
    //发送提醒结束 
	com.js.oa.security.log.service.LogBD logBD = new com.js.oa.security.log.service.LogBD();
	java.util.Date date = new java.util.Date();
	logBD.log(session.getAttribute("userId").toString(), session.getAttribute("userName").toString(), session.getAttribute("orgName").toString(), "system_sys", "系统管理",date, date, "2", "系统设置",session.getAttribute("userIP").toString(), domainId);

	
      out.write("\r\n\t<script language=\"javascript\">\r\n\t\t");
if(com.js.util.config.SystemCommon.getAudit()==0){ 
      out.write("\r\n            alert(\"保存成功！\");\r\n        ");
}
      out.write("\r\n        window.location.href = \"/jsoa/audit/audittemmanager_sysSetup.jsp?logId=");
      out.print(logId );
      out.write("&initPanel=");
      out.print(clickPanel);
      out.write("\";\r\n\t</script>\r\n\t");

}else if(action!=null&&"audit".equals(action)){
    String checked = request.getParameter("checked");
    String logId = request.getParameter("logId")==null?"0":request.getParameter("logId");
    RoleBD roleBD = new RoleBD();
    AuditLog auditLog = roleBD.auditLog(logId);
    String typeString="";
    if(!"0".equals(logId)){
	    AuditSetupReader sysRed = AuditSetupReader.getInstance(logId);
	    if("1".equals(checked)){
	        sysRed.auditOption(checked,session.getAttribute("userId").toString(),session.getAttribute("userName").toString());
	    }else{
	        sysRed.setLog(checked,session.getAttribute("userId").toString(),session.getAttribute("userName").toString());
	    }
    }
       if("1".equals(checked)){
	        typeString="审核已通过";
	    }else{
	         typeString="审核未通过";
	    }
     AuditMsRemindEJBBean  msRemindBeann=new AuditMsRemindEJBBean();
    msRemindBeann.auditRemind(Long.valueOf(session.getAttribute("userId").toString()), session.getAttribute("orgId").toString(), session.getAttribute("userName").toString(),
    		              3, 1, new java.util.Date(), "您修改系统开关"+typeString+"！", "audit", Long.valueOf(logId), "",auditLog.getSubmitEmpid()+"");
    
      

      out.write("\r\n    <script language=\"javascript\">\r\n        ");
String comeFlag = request.getParameter("comeFlag");
        if("frame".equals(comeFlag)){ 
      out.write("\r\n\t\t      alert(\"审计完成！\");\r\n\t\t      opener.window.location.href=\"/jsoa/AuditLogAction.do?action=daiShenHeList\";\r\n\t\t      window.close();\r\n\t\t");
 }else{ 
      out.write("\r\n\t\t      alert(\"审计完成！\");\r\n\t\t      //opener.location.reload();\r\n\t\t      window.close();\r\n\t\t");
 }
      out.write("\r\n    </script>\r\n");
}
String log_id = request.getParameter("logId")==null?"0":request.getParameter("logId");
String disabled=request.getParameter("disabled")==null?"":"disabled='disabled'";
AuditSetupReader sysRed = AuditSetupReader.getInstance(log_id);
options=sysRed.getSystemOption(domainId);
String kqflag=sysRed.getKq(domainId);
String workLog = sysRed.getWorkLog(domainId);
String mailBoxSize=sysRed.getMailBoxSize(domainId);
String netDiskSize=sysRed.getNetDiskSize(domainId);
String attachLimitSize=sysRed.getAttachLimit(domainId);
String filterLimitSize=sysRed.getFilterLimit(domainId);
String exportInnerflag=sysRed.getExportInner(domainId);
String email=sysRed.getEmail(domainId);
String mailState=email.split(";")[0];
String mailID=email.split(";")[1];

String pwd_date=sysRed.getPwdDate(domainId);
String pwd_init=sysRed.getPwdInit(domainId);
String pwdStrongConfig=sysRed.getPwdStrongConfig(domainId);//密码强度
String minLength="";//最小长度
String maxLength="";//最大长度
String filterLimit="";
boolean isContainNumAndLetter=false;
if(!pwdStrongConfig.equals("0"))//0为未开启,开启后的格式为"$minLength$$maxLength$$isContainNumAndLettert(0,1)$"
{
	String[] parameters=pwdStrongConfig.split(";");
	minLength=parameters[0];
	maxLength=parameters[1];
	isContainNumAndLetter=parameters[2].equals("1")?true:false;
}
if(attachLimitSize!=null && !"null".equals(attachLimitSize) && !"".equals(attachLimitSize)){
    limitSize=Long.parseLong(attachLimitSize.substring(1))/(1024*1024);
}
if(filterLimitSize!=null && !"null".equals(filterLimitSize) && !"".equals(filterLimitSize))
{
    filterLimit=filterLimitSize.substring(1);
}
else
{
	filterLimit="";
}	
workLog = workLog==null?"0":workLog;


/*//判断是否使用了RTX
AuditSetupReader ssReader=AuditSetupReader.getInstance("0");
boolean rtxIsUsed=ssReader.rtxIsUsed();*/

//判断是否使用即时通讯工具
//com.js.message.RealTimeUtil util=new com.js.message.RealTimeUtil();
boolean used=false;

      out.write("\r\n<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\">\r\n<link href=\"/jsoa/skin/");
      out.print(session.getAttribute("skin"));
      out.write("/style-");
      out.print(session.getAttribute("browserVersion"));
      out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<SCRIPT language=javascript src=\"/jsoa/js/openEndow.js\"></SCRIPT>\r\n<style type=\"text/css\">\r\n<!--\r\n.input{height:16px;line-height:9px;vertical-align:middle;padding-top:2px;}\r\n-->\r\n</style>\r\n<script language=\"javascript\">\r\nfunction changePanle(flag){\r\n document.getElementById(\"clickPanel\").value=flag;\r\n\tif(flag=='0'){\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel0\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"none\";\r\n\t}if(flag=='1'){\r\n\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanel\";\r\n");
      out.write("\t\tdocument.getElementById(\"Panel0\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"none\";\r\n\t}if(flag=='2'){\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel0\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"none\";\r\n\t}if(flag=='3'){\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel0\").style.display=\"none\";\r\n");
      out.write("\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"none\";\r\n\t}\r\n}\r\n\r\nfunction init(){\r\n\tchangePanle('");
      out.print(initPanel);
      out.write("');\r\n}\r\n</script>\r\n<title>系统开关审核</title>\r\n\r\n</head>\r\n<body  class=\"MainFrameBox\" onLoad=\"init()\">\r\n<table width=\"100%\" border=0 cellpadding=\"0\" cellspacing=\"0\">\r\n<tr>\r\n<td>\r\n<table width=\"100%\" height=\"25\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"inlineBottomLine\">\r\n  <tr>\r\n    <td>\r\n\t    <div id=\"PanleDIV0\" class=\"tabPanelSelected\" onClick=\"changePanle('0');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">系统开关</div>\r\n        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n\t  \r\n\t    <div class=\"btnBQspace AlignLeft\"></div>\r\n\t    \r\n\t    <div id=\"PanleDIV1\" class=\"tabPanel\" onClick=\"changePanle('1');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">系统日志</div>\r\n        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n      \r\n      <div class=\"btnBQspace AlignLeft\"></div>\r\n\t    \r\n\t    <div id=\"PanleDIV2\" class=\"tabPanel\" onClick=\"changePanle('2');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">密码策略</div>\r\n");
      out.write("        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n      \r\n      <div class=\"btnBQspace AlignLeft\"></div>\r\n\t    \r\n\t    <div id=\"PanleDIV3\" class=\"tabPanel\" onClick=\"changePanle('3');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">容量设置</div>\r\n        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n     </td>\r\n  </tr>\r\n</table>\r\n\r\n<table width=\"100%\" border=\"0\" cellpadding=\"10\" cellspacing=\"0\" class=\"docBox\">\r\n <tr>\r\n    <td valign=\"top\">\r\n    <form name=\"frm\" id=\"frm\" method=\"post\" action=\"/jsoa/audit/audittemmanager_sysSetup.jsp?action=update\">\r\n    \t<input type=\"hidden\" name=\"clickPanel\" id=\"clickPanel\">\r\n\t   <table id=\"Panel0\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15px;\">\t\r\n\t\t  <tr style=\"display:none;\">\r\n\t\t\t<td width=\"110\">附件存储</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t\t<input type=\"radio\" value=\"1\" name=\"attach\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(0)=='1'){
      out.write("checked");
}
      out.write(">本地&nbsp;&nbsp;&nbsp;<input type=\"radio\" value=\"0\" name=\"attach\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(0)=='0'){
      out.write("checked");
}
      out.write(">文件服务器\r\n\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td width=\"110\">附件大小</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t\t<input type=\"radio\" value=\"0\" name=\"attachLimit\" ");
      out.print(disabled );
      out.write(" checked onClick=\"showAttachSize();\">无限制 <input type=\"radio\" value=\"1\" name=\"attachLimit\" ");
      out.print(disabled );
      out.write(" onclick=\"showAttachSize();\" ");
if(attachLimitSize.startsWith("1")){
      out.write("checked");
}
      out.write(">限制\r\n\t\t\t\t<span id=\"attachSizeSpan\" ");
if(attachLimitSize.startsWith("1")){}else{
      out.write("style=\"display:none\"");
}
      out.write("><input type=\"text\" name=\"attachLimitSize\" class=\"inputText\" style=\"width:40px; height:16px;\" ");
      out.print(disabled );
      out.write(" value=\"");
      out.print(limitSize);
      out.write("\" maxlength=\"6\">&nbsp;M</span></td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>手写意见</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"sign\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(1)=='1'){
      out.write("checked");
}
      out.write(" name=\"sign\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>电子签章</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"signature\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(7)=='1'){
      out.write("checked");
}
      out.write(" name=\"signature\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr >\r\n\t\t\t<td>短信提醒</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"messageReceive\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(2)=='1'){
      out.write("checked");
}
      out.write(" name=\"messageReceive\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr >\r\n\t\t\t<td>发送短信权限控制</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"messageSend\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(8)=='1'){
      out.write("checked");
}
      out.write(" name=\"messageSend\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:none\">\r\n\t\t\t<td>图形工作流</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"potoflow\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(3)=='1'){
      out.write("checked");
}
      out.write(" name=\"potoflow\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr ");
if(!used){
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t<td>在线感知</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"rtx\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(4)=='1'){
      out.write("checked");
}
      out.write(" name=\"rtx\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:none\">\r\n\t\t\t<td>WORD编辑</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"word\" ");
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.charAt(5)=='1'){
      out.write("checked");
}
      out.write(" name=\"word\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:none;\">\r\n\t\t\t<td>与网站结合</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"website\" ");
      out.print(disabled );
      out.write(" checked>否&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(options.length() > 6 && options.charAt(6)=='1'){
      out.write("checked");
}
      out.write(" name=\"ezsite\">是</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>日报修改删除</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"worklog_rad\" ");
      out.print(disabled );
      out.write(' ');
      out.print(workLog.equals("0")?"checked='checked'":"");
      out.write(" onClick=\"wkCk(0);\">不允许&nbsp;<input type=\"radio\" value=\"1\" name=\"worklog_rad\" ");
      out.print(disabled );
      out.write(" onClick=\"wkCk(1);\" ");
      out.print(workLog.equals("0")?"":"checked='checked'");
      out.write(">允许\r\n                            <span id=\"worklog_sp1\" style=\"");
      out.print(workLog.equals("0")?"display:none":"");
      out.write("\"><input type=\"text\" name=\"worklog\" class=\"input\" ");
      out.print(disabled );
      out.write(" style=\"width:30px;\" value=\"");
      out.print(workLog);
      out.write("\" maxlength=\"3\"> 天之内删除</span></td>\r\n\t\t  </tr>\r\n\t\t   ");
 
		  AuditSetupReader ssReader=AuditSetupReader.getInstance(log_id);
		  String flag=ssReader.getMarkPWD(domainId).split(";")[0];
		  String rssFlag=ssReader.getUseRss(domainId);
		  String pwdImage=ssReader.getPwdPolicyByImage();
		  String pwdError=ssReader.getPwdPolicyByError();
		  String pwdKey=ssReader.getPwdPolicyByKey();
		  String pwdStrong=ssReader.getPwdPolicyByStrong();
		  boolean linkmanScope=ssReader.getLinkmanScope(domainId);
		  String errorNum="";
		  String errorMin="";
		  if(!pwdError.equals("0"))
		  {
		  	String errorConfig=pwdError.substring(1,pwdError.length()-1).replaceAll("\\$\\$", ";");
		  	String[] parameters=errorConfig.split(";");
		  	errorNum=parameters[0];
		  	errorMin=parameters[1];
		  }
		  
      out.write("\r\n\t\t <tr>\r\n\t\t\t<td>邮件提醒</td>\r\n\t\t\t<td>\r\n\t\t\t\t<input type=\"radio\" value=\"0\" name=\"email\" ");
      out.print(disabled );
      out.write(" checked onClick=\"showEmail();\">不使用\r\n\t\t\t\t<input type=\"radio\" value=\"1\" name=\"email\" ");
      out.print(disabled );
      out.write(" onclick=\"showEmail();\" \r\n\t\t\t\t");
if(mailState.equals("1")&&mailList.size()>0){
      out.write("checked");
}
      out.write(">使用\r\n\t\t\t\t<span id=\"emailSpan\" ");
if(mailState.equals("1")&&mailList.size()>0){}else{
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t\t  <select name=\"emailCount\" id=\"emailCount\" ");
      out.print(disabled );
      out.write(">\r\n\t\t\t\t    <option value=\"-1\">--请选择--</option>\r\n\t\t\t\t    ");

					 if(mailList!=null){
					    for(int i=0;i<mailList.size();i++){
					     MailVO mv=(MailVO)mailList.get(i);
					     //if(mailID!=null&&!mailID.equals("")){
					        int mailCount=Integer.parseInt(mailID);
					
      out.write("\r\n\t\t\t\t\t\r\n\t\t\t\t     <option ");
if(mailCount==mv.getMailId()){
      out.write("selected");
}
      out.write(" value=\"");
      out.print(mv.getMailId());
      out.write('"');
      out.write('>');
      out.print(mv.getFromUser());
      out.write("</option>\r\n\t\t\t\t\t");
}}//}
      out.write("\r\n\t\t\t\t  </select>\r\n\t\t\t\t</span>\t\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t   <tr>\r\n\t\t    <td>启用RSS</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"useRss\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(rssFlag.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"useRss\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(rssFlag.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t    <td>记住登陆密码</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"markPWD\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(flag.equals("0")) {
      out.write("checked");
}
      out.write("/>不使用\r\n\t\t\t <input type=\"radio\" name=\"markPWD\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(flag.equals("1")) {
      out.write("checked");
}
      out.write("/>使用\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t    <td>导出通讯录</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"exportInner\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(exportInnerflag.equals("0")) {
      out.write("checked");
}
      out.write("/>不允许\r\n\t\t\t <input type=\"radio\" name=\"exportInner\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(exportInnerflag.equals("1")) {
      out.write("checked");
}
      out.write("/>允许\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t  \t <td>查看联系人范围</td>\r\n\t\t  \t <td>\r\n\t\t  \t \t<input type=\"radio\" name=\"linkmanScope\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(linkmanScope){
      out.write("checked");
} 
      out.write("/>全部&nbsp;&nbsp;\r\n\t\t  \t \t<input type=\"radio\" name=\"linkmanScope\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(!linkmanScope){
      out.write("checked");
} 
      out.write("/>权限范围内\r\n\t\t  \t </td>\r\n\t\t  </tr>\r\n\t\t   \r\n\t\t  \r\n\t\t  <tr style=\"display:none\">\r\n\t\t    <td>考勤模块</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"kq\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(kqflag.equals("0")) {
      out.write("checked");
}
      out.write("/>不使用\r\n\t\t\t <input type=\"radio\" name=\"kq\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(kqflag.equals("1")) {
      out.write("checked");
}
      out.write("/>使用\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  \r\n                  <script language=\"javascript\">\r\n                  function wkCk(flag){\r\n                      var worklog = ");
      out.print(workLog);
      out.write(";\r\n                      if(flag == 0){\r\n                          document.all.worklog_sp1.style.display = \"none\";\r\n                          document.all.worklog.value = 0;\r\n                      }else{\r\n                          document.all.worklog_sp1.style.display = \"\";\r\n                          if(worklog == 0){\r\n                              document.all.worklog.value = 3;\r\n                          }else{\r\n                              document.all.worklog.value = worklog;\r\n                          }\r\n\r\n                      }\r\n                  }\r\n                  </script>\r\n\t   </table>\r\n\t   <table id=\"Panel1\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15px;\">\r\n\t   \t\t");

		  java.sql.Connection conn=null;
		  java.sql.Statement stmt=null;
		  java.sql.ResultSet rs = null;
		  String moduleName,moduleSerial,moduleLog,logOption;
		  java.util.Map<String,String> logMap = new HashMap<String,String>();
		  String[] logStrings = null;
		  try{
		     conn=new com.js.util.util.DataSourceBase().getDataSource().getConnection();
		     stmt=conn.createStatement();
		     rs = stmt.executeQuery("select module_serial,module_name from sec_log_module where module_level=0 order by module_id");
		     while(rs.next()){
		          logMap.put(rs.getString(1),rs.getString(2));
		     }
		     rs.close();
		     rs=stmt.executeQuery("select options from audit_switchlog where audit_log_id="+log_id);
		     if(rs.next()){
		         if(rs.getString(1)!=null){
		              logStrings = rs.getString(1).split(",");
		         }
		     }
            for(int i=1;i<logStrings.length;i++){
                moduleSerial=logStrings[i].substring(1);
		        moduleName=logMap.get(moduleSerial);
		        moduleLog=logStrings[i].substring(0,1);
		        
      out.write("\r\n\t\t        <tr>\r\n\t\t\t\t<td width=\"110\">");
      out.print(moduleName);
      out.write("</td>\r\n\t\t\t\t<td><input type=\"radio\" value=\"0\" name=\"");
      out.print(moduleSerial);
      out.write('"');
      out.write(' ');
      out.print(disabled );
      out.write(" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if("1".equals(moduleLog)){
      out.write("checked");
}
      out.write(" name=\"");
      out.print(moduleSerial);
      out.write("\">使用</td>\r\n\t\t\t\t</tr>\r\n\t\t        ");

		     }
		     rs.close();
		     stmt.close();
		     conn.close();
		  }catch(Exception ex){
		  		if(conn!=null){
		  		  conn.close();
		  		}
		  }    
		  
      out.write("\r\n\t   </table>\r\n\t   \r\n\t   <table id=\"Panel2\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15\">\r\n\t   \t\t<tr>\r\n\t\t\t<td width=\"110\">初始密码更改</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdChange\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(pwd_init.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdChange\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(pwd_init.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>图形验证码</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdImage\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(pwdImage.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdImage\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(pwdImage.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>USBKey</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdKey\" value=\"0\" ");
      out.print(disabled );
      out.write(' ');
if(pwdKey.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdKey\" value=\"1\" ");
      out.print(disabled );
      out.write(' ');
if(pwdKey.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  \r\n\t\t  <tr>\r\n\t\t\t<td>密码过期</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdDate\" value=\"0\" ");
      out.print(disabled );
      out.write("  onclick=\"showPwdDate()\" ");
if(pwd_date.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdDate\" value=\"1\" ");
      out.print(disabled );
      out.write("  onclick=\"showPwdDate()\" ");
if(!pwd_date.equals("0")) {
      out.write("checked");
}
      out.write("//>启用&nbsp;&nbsp;\r\n\t\t\t <span ");
if(!pwd_date.equals("0")){}else{
      out.write("style=\"display:none\"");
}
      out.write(" id=\"pwdDateInputSpan\">密码有效期&nbsp;<input id=\"pwd_date_input\" type=\"text\" name=\"pwdDateInput\"  class=\"input\" ");
      out.print(disabled );
      out.write(" size=\"2\" value=\"");
      out.print(pwd_date);
      out.write("\">&nbsp;天</span>\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>登录失败次数</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdError\" value=\"0\" ");
      out.print(disabled );
      out.write(" onclick=\"showPwdError()\" ");
if(pwdError.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdError\" value=\"1\" ");
      out.print(disabled );
      out.write(" onClick=\"showPwdError()\" ");
if(!pwdError.equals("0")) {
      out.write("checked");
}
      out.write("/>启用&nbsp;&nbsp;\r\n\t\t\t <span ");
if(!pwdError.equals("0")){}else{
      out.write("style=\"display:none\"");
}
      out.write(" id=\"pwdErrorInputSpan\">\r\n\t\t\t   连续登录失败&nbsp;<input type=\"text\" name=\"pwdErrorNumInput\" value=\"");
      out.print(errorNum );
      out.write('"');
      out.write(' ');
      out.print(disabled );
      out.write(" class=\"input\"size=\"2\">&nbsp;次后\r\n\t\t\t   &nbsp;<input type=\"text\" name=\"pwdErrorMinInput\" value=\"");
      out.print(errorMin );
      out.write('"');
      out.write(' ');
      out.print(disabled );
      out.write(" class=\"input\"size=\"2\">&nbsp;分钟内禁止再次登录</span></td>\r\n\t\t  </tr>\r\n\t\t  \r\n\t\t  <tr>\r\n\t\t\t<td>密码强度</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdStrong\" value=\"0\" ");
      out.print(disabled );
      out.write(" onclick=\"showPwdStrong()\" ");
if(pwdStrongConfig.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdStrong\" value=\"1\" ");
      out.print(disabled );
      out.write(" onClick=\"showPwdStrong()\" ");
if(pwdStrongConfig.length()>1) {
      out.write("checked");
}
      out.write("/>启用&nbsp;&nbsp;\r\n\t\t\t <span id=\"pwdStrongInputSpan\" ");
if(pwdStrongConfig.length()>1){}else{
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t   密码长度&nbsp;<input type=\"text\" name=\"pwdStart\" ");
      out.print(disabled );
      out.write(" class=\"input\" size=\"2\" value=\"");
      out.print(minLength );
      out.write("\">&nbsp;-\r\n\t\t\t   &nbsp;<input type=\"text\" name=\"pwdEnd\" size=\"2\" ");
      out.print(disabled );
      out.write(" class=\"input\" value=\"");
      out.print(maxLength );
      out.write("\">&nbsp;位\r\n\t\t\t   <input type=\"checkbox\" name=\"pwdStrongType\" ");
      out.print(disabled );
      out.write(' ');
if(isContainNumAndLetter){
      out.write("checked");
}
      out.write(">密码必须同时包含字母和数字</span></td>\r\n\t\t  </tr>\r\n\t   </table>\r\n\t   \r\n\t   <table id=\"Panel3\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15px;\">\r\n\t   \t\t<tr style=\"display:none\">\r\n\t   \t\t<td>邮箱容量</td>\r\n\t\t\t<td colspan=\"2\"><input type=\"text\" name=\"mailBoxSize\" class=\"input\" ");
      out.print(disabled );
      out.write("  size=5 maxlength=\"6\" value=\"");
      out.print(mailBoxSize);
      out.write("\"> M&nbsp;&nbsp;</td>\t\t\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t  \t<td width=\"110\">个人文档默认值</td>\r\n\t\t\t<td colspan=\"2\"><input type=\"text\" name=\"netDiskSize\" class=\"input\" ");
      out.print(disabled );
      out.write(" size=5 maxlength=\"6\" value=\"");
      out.print(netDiskSize);
      out.write("\"> MB</td>\r\n\t\t\t\r\n\t\t  </tr>\r\n\t   </table>\r\n\t</form>\r\n\t<br>\r\n\t<table style=\"margin-left:13px;\">\r\n\t\t<tr>\r\n\t\t\t");
if("".equals(disabled)){ 
      out.write("\r\n            <td><input type=\"button\" style=\"cursor:pointer;\" class=\"btnButton2font\" onClick=\"javascript:save();\" value=\"保存配置\"/>   </td>\r\n            <td colspan=\"2\"></td>");
}else{
            String logId = request.getParameter("logId");
             if(request.getParameter("flag")==null&&"0".equals(StaticParam.getLogCheck(logId))){
      out.write("\r\n            <td><input type=\"button\" style=\"cursor:pointer;\" class=\"btnButton2font\" onClick=\"aduitSwitch('1');\" value=\"通过\"/> </td>\r\n            <td><input type=\"button\" style=\"cursor:pointer;\" class=\"btnButton2font\" onClick=\"aduitSwitch('0');\" value=\"不通过\"/> </td>\r\n            <td><input type=\"button\" style=\"cursor:pointer;\" class=\"btnButton2font\" onClick=\"window.close();\" value=\"退出\"/> </td>\r\n            <td></td>\r\n            ");
}else{
      out.write("\r\n            <td><input type=\"button\" style=\"cursor:pointer;\" class=\"btnButton2font\" onClick=\"window.close();\" value=\"退出\"/> </td>\r\n            ");
} 
            } 
      out.write("\r\n\t\t</tr>\r\n\t</table>\r\n</tr>\r\n\r\n</table>\r\n\r\n</td>\r\n</tr>\r\n</table>\r\n</body>\r\n</html>\r\n<script src=\"/jsoa/js/util.js\"></script>\r\n<script language=\"javascript\">\r\nfunction goClose(){\r\nlocation.href=((window.location.href).substring(0,(window.location.href).indexOf(\"/jsoa\")))+\"/jsoa/AuditLogAction.do?action=yiShenHeList&fromSystem=1\";\r\n}\r\nfunction aduitSwitch(audit){\r\n\tdocument.frm.action=((window.location.href).substring(0,(window.location.href).indexOf(\"/jsoa\")))+\"/jsoa/audit/audittemmanager_sysSetup.jsp?action=audit&checked=\"+audit+\"&logId=");
      out.print(log_id );
      out.write("\";\r\n\tdocument.frm.submit();\r\n}\r\nfunction save() {\r\n    if(document.all.worklog_rad[1].checked && isNaN(document.all.worklog.value)){\r\n        alert(\"删除天数请输入数字！\");\r\n        document.all.worklog.focus();\r\n        return ;\r\n    }\r\n    if(document.all.worklog_rad[1].checked && parseInt(document.all.worklog.value) < 0){\r\n        alert(\"删除天数不能是负数！\");\r\n        document.all.worklog.focus();\r\n        return ;\r\n    }\r\n\tif(isNaN(document.all.mailBoxSize.value) || parseInt(document.all.mailBoxSize.value)<0){\r\n\t\talert(\"容量必须为正整数！\");\r\n\t\treturn;\r\n\t}\r\n\tif(isNaN(document.all.netDiskSize.value) || parseInt(document.all.netDiskSize.value)<0){\r\n\t\talert(\"容量必须为正整数！\");\r\n\t\treturn;\r\n\t}\r\n\tif(document.all.attachLimit[1].checked){\r\n\t\tif(isNaN(document.all.attachLimitSize.value)){\r\n\t\t\talert(\"限制大小必须为数字\");\r\n\t\t\tdocument.all.attachLimitSize.select();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar re= /^[1-9]+[0-9]*]*$/;\r\n\t\tif (!re.test(document.all.attachLimitSize.value)){\r\n\t\t\talert(\"限制大小必须为正整数\");\r\n\t\t\tdocument.all.attachLimitSize.select();\r\n\t\t\treturn;\r\n\t\t}\r\n\t}else{\r\n");
      out.write("\t\tdocument.all.attachLimitSize.value=\"0\";\r\n\t}\r\n//使用拦截器应用填写拦截的文档格式的书写格式必须以分号隔开\r\n\t\r\n\t\r\n\tif(document.all.email[1].checked){\r\n\t   if(document.getElementById(\"emailCount\").value==-1){\r\n\t      alert(\"请选择邮箱!\");\r\n\t\t  return;\r\n\t   }\r\n\t}\r\n\t//密码过期开关验证\r\n\tif(document.all.pwdDate[1].checked)\r\n\t{\r\n\t\tvar regExp=/^[1-9]\\d*$/;\r\n\t\tif(!regExp.test(document.all.pwdDateInput.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的天数!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t//登录失败次数开关验证\r\n\tif(document.all.pwdError[1].checked)\r\n\t{\r\n\t\tvar regExp=/^[1-9]\\d*$/;\r\n\t\tif(!regExp.test(document.all.pwdErrorNumInput.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的登录失败次数!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse if(!regExp.test(document.all.pwdErrorMinInput.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的禁用分钟数!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t//密码强度开关验证\r\n\tif(document.all.pwdStrong[1].checked)\r\n\t{\r\n\t\tvar regExp=/^[1-9]\\d*$/;\r\n\t\tif(!regExp.test(document.all.pwdStart.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的密码最小长度!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse if(!regExp.test(document.all.pwdEnd.value)||parseInt(document.all.pwdEnd.value)>32)\r\n\t\t{\r\n\t\t\talert(\"请输入正确的密码最大长度,最大长度不能大于32位!\");\r\n");
      out.write("\t\t\treturn;\r\n\t\t}\r\n\t\telse if(parseInt(document.all.pwdEnd.value)<=parseInt(document.all.pwdStart.value))\r\n\t\t{\r\n\t\t\talert(\"密码最小长度应小于最大长度!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t\r\n\t");
if(com.js.util.config.SystemCommon.getAudit()!=0){ 
      out.write("\r\n       alert(\"数据已提交审计管理员审核！\");\r\n    ");
}
      out.write("\r\n    document.frm.submit();\r\n}\r\nfunction showAttachSize(){\r\n\tif(document.all.attachLimit[1].checked){\r\n\t\tdocument.all.attachSizeSpan.style.display='';\r\n\t}else{\r\n\t\tdocument.all.attachSizeSpan.style.display='none';\r\n\t}\r\n}\r\n//拦截器的限制\r\nfunction showFilterSize()\r\n{\r\n\tif(document.all.filterLimit[1].checked)\r\n\t{\r\n\t\tdocument.all.filterSizeSpan.style.display='';\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdocument.all.filterSizeSpan.style.display='none';\r\n\t}\r\n}\r\nfunction showEmail(){\r\n\tif(document.all.email[1].checked){\r\n\t   if(");
      out.print(mailList.size());
      out.write("<=0){\r\n\t      alert(\"请选添加web邮箱账户!\");\r\n\t      document.all.email[0].checked=true;\r\n\t\t  return;\r\n\t   }else{\r\n\t     document.all.emailSpan.style.display='';\r\n\t   }\r\n\t}else{\r\n\t\tdocument.all.emailSpan.style.display='none';\r\n\t}\r\n}\r\n\r\nfunction showPwdDate(){\r\n\tif(document.all.pwdDate[1].checked){\r\n\t\tdocument.all.pwdDateInputSpan.style.display='';\r\n\t\tdocument.getElementById(\"pwd_date_input\").value=\"\";\r\n\t}else{\r\n\t\tdocument.all.pwdDateInputSpan.style.display='none';\r\n\t}\r\n}\r\n\r\nfunction showPwdError(){\r\n\tif(document.all.pwdError[1].checked){\r\n\t\tdocument.all.pwdErrorInputSpan.style.display='';\r\n\t}else{\r\n\t\tdocument.all.pwdErrorInputSpan.style.display='none';\r\n\t}\r\n}\r\nfunction showPwdStrong(){\r\n\tif(document.all.pwdStrong[1].checked){\r\n\t\tdocument.all.pwdStrongInputSpan.style.display='';\r\n\t}else{\r\n\t\tdocument.all.pwdStrongInputSpan.style.display='none';\r\n\t}\r\n}\r\n\r\nfunction pwdCheck(){\r\n    if(document.all.pwdDate[1].checked && isNaN(document.all.pwdDateInput.value)){\r\n        alert(\"密码过期天数必须是数字！\");\r\n        document.all.pwdDateInput.focus();\r\n");
      out.write("        return ;\r\n    }\r\n    if(document.all.pwdDate[1].checked && parseInt(document.all.pwdDateInput.value) < 0){\r\n        alert(\"密码过期天数不能是负数！\");\r\n        document.all.pwdDateInput.focus();\r\n        return ;\r\n    }\r\n\tif(isNaN(document.all.pwdDateInput.value) || parseInt(document.all.pwdDateInput.value)<0){\r\n\t\talert(\"容量必须为正整数！\");\r\n\t\tdocument.all.pwdDateInput.focus();\r\n\t\treturn ;\r\n\t}\r\n  \r\n}\r\n</script>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
