/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 10:09:16 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.cooperate;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.util.config.SystemCommon;
import com.js.util.util.BrowserJudge;
import com.js.cooperate.po.*;
import java.util.*;
import com.js.system.manager.service.*;
import com.js.util.util.CharacterTool;

public final class body_005fdealwith_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(6);
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-nested.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-tiles.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-logic.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-html.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-template.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-bean.tld", Long.valueOf(1499751390000L));
  }

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("com.js.cooperate.po");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("com.js.system.manager.service");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.util.util.CharacterTool");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("com.js.util.util.BrowserJudge");
  }

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fhtml_005fhtml;

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fhtml_005fhtml = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fhtml_005fhtml.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

response.setHeader("Cache-Control","no-store");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", 0);
String userAgent=request.getHeader("user-agent");
boolean ipadFlag=false;
//ipad打开表单页面时，能够查看附件(登录PC端)
if(userAgent.indexOf("iPad") !=-1 || userAgent.indexOf("ipad") !=-1){
	ipadFlag=true;
}
String curUserId=session.getAttribute("userId").toString();
String nodeId=request.getParameter("nodeId");
String curMemberId=request.getParameter("memberId");
if(nodeId == null || nodeId.trim().isEmpty()){
	java.sql.Connection conn=null;
	java.sql.Statement stmt = null;
	java.sql.ResultSet rs = null;
	try {
        conn = new com.js.util.util.DataSourceBase().getDataSource().getConnection();
        stmt = conn.createStatement();
        rs = stmt.executeQuery("select node_id from co_nodemember where id=" + curMemberId);
        if(rs.next()){
            nodeId = rs.getString(1);
        }
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
    	if(rs != null) try{ rs.close(); } catch(Exception e){}
    	if(stmt != null) try{ stmt.close(); } catch(Exception e){}
    	if(conn != null) try{ conn.close(); } catch(Exception e){}
    }
}
// System.out.println("=============================nodeId = " + nodeId);
String fromStatus=request.getParameter("fromStatus");
java.util.Calendar cal = java.util.Calendar.getInstance();
String year = cal.get(java.util.Calendar.YEAR)+"";//年
String yearSub=year.substring(0, 4);
BodyPO bpo=(BodyPO)request.getAttribute("bodyInfo");
String uploadHtml=bpo.getContent();

List bodyEx=(List)request.getAttribute("bodyEx");
List opinion=(List)request.getAttribute("opinion");
List subOpinion=(List)request.getAttribute("subOpinion");

List bodyAttach=(List)request.getAttribute("bodyAttach");
List bodyExAttach=(List)request.getAttribute("bodyExAttach");
List opinionAttach=(List)request.getAttribute("opinionAttach");
Map map =new HashMap();
String nodeRight=request.getAttribute("nodeRight")==null?"":request.getAttribute("nodeRight").toString();

int mainStatus=bpo.getStatus().intValue();
String posterId=bpo.getPosterId();
Object[] obj;
int i;
String postTime;
/**
  *判断现在附件时是下载的那个模块下的附件，以判断相应的路径
  *10：代表待办事项  201：代表已办事项  1：代表代发事项  202：已发事项
**/
String moduleCode="";
if(request.getAttribute("statusDownLoad")!=null)
{
	if("10".equals(request.getAttribute("statusDownLoad")))//待办事项
	{
		moduleCode="co_attach_waitdo";
	}
	else if("201".equals(request.getAttribute("statusDownLoad")))//已办事项
	{
		moduleCode="co_attach_comdo";
	}
	else if("1".equals(request.getAttribute("statusDownLoad")))//待发事项
	{
		moduleCode="co_attach_waitsend";
	}
	else if("202".equals(request.getAttribute("statuDownLoad")))//已发事项
	{
		moduleCode="co_attach_send";
	}
	else
	{
		moduleCode="co_attach_waitdo";
	}
}
//当前用户的办理状态 10为待办 20为已办

String dealwithStatus="20";
if(request.getAttribute("dealwithStatus")!=null){
	dealwithStatus=request.getAttribute("dealwithStatus").toString();
}
String tempProcessId="";
if(request.getParameter("processId")!=null){
	tempProcessId=request.getParameter("processId");
}

String button;
if("10".equals(dealwithStatus)){
	button="Dealwith,";
	if(nodeRight.indexOf("modifyBody_")>=0){
		button+="ModifyBody,";
	}
	if(nodeRight.indexOf("appendBody_")>=0){
		button+="AppendBody,";
	}
	button+="DrawFlow,RecordList,";
	if(nodeRight.indexOf("printDoc_")>=0){
		button+="PrintDoc,";
	}	
	if(nodeRight.indexOf("overBody_")>=0){
		button+="overBody,";
	}
	button+="Close";
}else{
	button="DrawFlow,RecordList,";
	if(nodeRight.indexOf("printDoc_")>=0){
		button+="PrintDoc,";
	}
	if(("1002".equals(request.getParameter("status")))&&nodeRight.indexOf("printDoc_")<0){
			button+="PrintDoc,";
	}
	if(posterId.equals(curUserId) && mainStatus<100){
		//发起人是自己，没有办理按钮,可以补充正文修改正文
		button="ModifyBody,AppendBody,DrawFlow,RecordList,PrintDoc,overBody,press,";
	}
	if(posterId.equals(curUserId) && ((mainStatus==10 && "202".equals(request.getParameter("status")))||(mainStatus==100 && "1002".equals(request.getParameter("status"))))||"11".equals(tempProcessId)){
		button+="TurnToDo,";
	}
	button+="Close";
}
if(("1002".equals(request.getParameter("status")))&&request.getParameter("finish")==null){
	button += ",CoToArchives";
}

String range = session.getAttribute("browseRange")+"";

if("".equals(range)){
range="*0*";
}
boolean bflag=false;if(BrowserJudge.isMSIE(request))bflag=true;

      out.write("\r\n\r\n");
      //  html:html
      org.apache.struts.taglib.html.HtmlTag _jspx_th_html_005fhtml_005f0 = (org.apache.struts.taglib.html.HtmlTag) _005fjspx_005ftagPool_005fhtml_005fhtml.get(org.apache.struts.taglib.html.HtmlTag.class);
      boolean _jspx_th_html_005fhtml_005f0_reused = false;
      try {
        _jspx_th_html_005fhtml_005f0.setPageContext(_jspx_page_context);
        _jspx_th_html_005fhtml_005f0.setParent(null);
        int _jspx_eval_html_005fhtml_005f0 = _jspx_th_html_005fhtml_005f0.doStartTag();
        if (_jspx_eval_html_005fhtml_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
          do {
            out.write("\r\n\r\n<head><script language=\"JavaScript\" src=\"/jsoa/js/resource/");
            out.print(session.getAttribute("org.apache.struts.action.LOCALE"));
            out.write("/CommonResource.js\" type=\"text/javascript\"></script>\r\n<title>");
            out.print(bpo.getTitle() );
            out.write("</title>\r\n<link href=\"skin/");
            out.print(session.getAttribute("skin"));
            out.write("/style-");
            out.print(session.getAttribute("browserVersion"));
            out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n\r\n");
            out.write("<script src=\"/jsoa/js/js.js\" language=\"javascript\"></script>\r\n<!-- <link rel=\"stylesheet\" type=\"text/css\" href=\"public/date_picker/DateObject2.css\">\r\n<SCRIPT language=\"javascript\" src=\"public/date_picker/DateObject.js\"></SCRIPT>\r\n<SCRIPT language=\"javascript\" src=\"public/date_picker/DatePicker.js\"></SCRIPT>\r\n<SCRIPT language=\"javascript\" src=\"public/date_picker/editlib.js\"></SCRIPT>\r\n<SCRIPT language=\"javascript\" src=\"public/date_picker/tree.js\"></SCRIPT>\r\n<script language=\"javascript\" src=\"/jsoa/eform/datetime/datetime_check.js\"></script>\r\n<script language=\"javascript\" src=\"/jsoa/eform/datetime/datetime_select.js\"></script> -->\r\n<script language=\"javascript\" src=\"js/openEndow.js\"></script>\r\n<script language=\"javascript\" src=\"js/checkForm.js\"></script>\r\n\r\n<script src=\"/jsoa/js/jquery-1.4.2.min.js\" language=\"javascript\"></script>\r\n<script src=\"/jsoa/js/toolbar/standardAdd.js\" language=\"javascript\"></script>\r\n<script src=\"/jsoa/js/clsPullXMenu.js\" language=\"javascript\"></script>\r\n<script src=\"/jsoa/js/cooperate/cooperatebtn.jsp?button=");
            out.print(button );
            out.write("\"></script>\r\n\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\r\n\r\n\r\n</head>\r\n\r\n<body onLoad=\"loadToolbar('commandBar');initPage();\" onResize=\"loadToolbar('commandBar')\" class=\"MainFrameBox PupwinForFlow\" style=\"overflow-y:hidden;overflow-x:auto;\">\r\n<table width=\"100%\" height=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n  <tr id=\"tr_1\" style=\"display:;\" height=\"27\">\r\n\t<td height=\"27\" id=\"popToolbar\"><div id=\"commandBar\"></div>\r\n\t</td>\r\n  </tr>\r\n   <input type=\"hidden\" name=\"selPeoples\" id=\"selPeoples\"> \r\n  <tr id=\"tr_2\"  style=\"display:;\">\r\n    <td height=\"50\">\r\n      <table valign=\"top\"  border=\"0\" cellpadding=\"5\" cellspacing=\"0\" class=\"docBox\" width=\"100%\">\r\n\t\t\t<tr>\r\n\t\t\t\t<td height=\"10\" width=\"5%\" nowrap>标&nbsp;&nbsp;&nbsp;&nbsp;题：</td>\r\n\t\t\t\t<td width=\"65%\">\r\n\t\t\t\t  ");
            out.print(CharacterTool.escapeHTMLTags(bpo.getTitle()) );
            out.write("\r\n\t\t\t\t</td>\r\n\t\t\t\t<td width=\"5%\" nowrap> 重要程度：</td>\r\n\t\t\t\t<td width=\"25%\">\r\n\t\t\t\t   ");

				   int level=bpo.getLevel().intValue();
				   if(level==10){
					   out.print("一般");
				   }else if(level==20){
					   out.print("重要");
				   }else if(level==30){
					   out.print("紧急");
				   }
				   
            out.write("\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t");

			postTime=bpo.getPostTime().toLocaleString();
			if(postTime.lastIndexOf(":")>0){
				postTime=postTime.substring(0,postTime.lastIndexOf(":"));
			}
			
            out.write("\r\n\t\t\t<tr>\r\n\t\t\t\t<td  height=\"10\" nowrap>发起人：\r\n\t\t\t\t</td>\r\n\t\t\t\t<td >\r\n\t\t\t\t   ");
            out.print(bpo.getPosterName() );
            out.write("&nbsp;(");
            out.print(postTime );
            out.write(")\r\n\t\t\t\t</td>\r\n\t\t\t\t<td> 办理期限：</td>\r\n\t\t\t\t<td>\r\n\t\t\t\t");

				if(bpo.getHasTerm().intValue()==1){
				Date term=bpo.getTerm();
				
            out.write("\r\n\t\t\t\t");
            out.print(term.getYear()+1900 );
            out.write('-');
            out.print(term.getMonth()+1 );
            out.write('-');
            out.print(term.getDate() );
            out.write("\r\n\t\t\t\t");
}else{
					 out.print("无");
				  }
				
            out.write("\r\n\t            </td>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t");
if(SystemCommon.getArchiveToInfo()==1 && request.getAttribute("infoChannel")!=null){ 
            out.write("\r\n\t\t\t<tr><td nowrap>知识归档：</td><td>");
            out.print(request.getAttribute("infoChannel").toString() );
            out.write("</td></tr>\r\n\t\t\t");
} 
            out.write("\r\n\t\t\t\t\t\r\n\t\t</table>\r\n    </td>\r\n  </tr>\r\n  <!-- 协同正文属性 end -->\r\n  <!-- 协同正文内容 -->\r\n  <tr>\r\n     <td style=\"padidng:1px;padding-top:0px;\">\r\n         <table width=\"100%\" height=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n            <tr>\r\n                <td class=\"pannelWin\" valign=\"top\" align=\"center\" style=\"background:#a0a0a0;\">\r\n                ");
            out.write("\r\n                ");
 if( BrowserJudge.isChrome(request) || BrowserJudge.isSafari(request)) { 
                	// 这里的执行部分和else块里的内容是一样的，之所以分出来，是为了突出显示 
            out.write("\r\n                \t<div style=\"height:100%;width:100%;padding:20px 0px;overflow-x:hidden;background:#a0a0a0;\"  class=\"scrollBox\" id=\"coopDiv\">\r\n                \t<script type=\"text/javascript\">\r\n                \tfunction resetCoopDivHeight(){\r\n\t\t                \tdocument.getElementById(\"coopDiv\").style.height = document.body.offsetHeight - 120;\r\n\t                \t};\r\n\t                \tresetCoopDivHeight();\r\n\t                \tdocument.getElementsByTagName(\"body\")[0].onresize = function(){\r\n\t                \t\tloadToolbar('commandBar');\r\n\t                \t\tresetCoopDivHeight();\r\n\t                \t};\r\n\t\t\t\t\t</script>\r\n                ");
 } else if ( BrowserJudge.isMSIE11(request) || BrowserJudge.isFirefox(request) ){ 
            out.write("\r\n                \t<div style=\"height:100%;width:100%;padding:20px 0px;overflow-x:hidden;background:#a0a0a0;\"  class=\"scrollBox\" id=\"coopDiv\">\r\n\t                <script type=\"text/javascript\">\r\n\t                \tfunction resetCoopDivHeight(){\r\n\t\t                \tdocument.getElementById(\"coopDiv\").style.height = document.body.offsetHeight - 120;\r\n\t                \t};\r\n\t                \tresetCoopDivHeight();\r\n\t                \tdocument.getElementsByTagName(\"body\")[0].onresize = function(){\r\n\t                \t\tloadToolbar('commandBar');\r\n\t                \t\tresetCoopDivHeight();\r\n\t                \t};\r\n\t\t\t\t\t</script>\r\n                ");
 } else { 
            out.write("\r\n                \t<div style=\"height:100%;width:100%;padding:20px 0px;overflow-x:hidden;background:#a0a0a0;\"  class=\"scrollBox\" >\r\n                ");
 } 
            out.write("\r\n                      <table width=\"95%\" height=\"90%\" border=\"0\" cellpadding=\"10\" cellspacing=\"0\" class=\"docBoxNoPanelForFlow\">\r\n                           <tr>\r\n                              <td valign=\"top\">\r\n                                  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n       \r\n                                     <tr>\r\n                                         <td valign=\"top\">\r\n                                         <div id=\"coBodyContentHTML\"> \r\n                                         ");
            out.print(uploadHtml);
            out.write("                                   \r\n                                         </div>\r\n                                         \r\n                                         <p></p>\r\n                                         ");

                                         if(bodyAttach!=null && bodyAttach.size()>0){
                                         
            out.write("\r\n                                         <div>附件：</div>\r\n                                         <div id=\"coBodyAttach\" style=\"padding-left:20px;\">\r\n                                         ");

                                         String tempFileName="";
                 						 String tempName="";
                                         for(i=0;i<bodyAttach.size();i++){
                                        	 obj=(Object[])bodyAttach.get(i);  
                                        	 tempFileName+=(String)obj[2]+",";
                 							 tempName+=(String)obj[1]+",";
                                         
            out.write("\r\n                                         \t<a class=\"a1\" href=\"javascript:JSMainWinOpen('/jsoa/download.jsp?");
            out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+obj[2]+"&name="+obj[1].toString()+"&path=cooperate&moduleCode="+moduleCode+"&edit=1"));
            out.write('\'');
            out.write(',');
            out.write('\'');
            out.print((SystemCommon.getFileShowUse()==1 || ipadFlag)?"showPage":"myIframe" );
            out.write("');\">");
            out.print(obj[1] );
            out.write("</a>&nbsp;&nbsp;\r\n                                         ");
 }
                                         if(SystemCommon.getFujianBatchDownload().equals("1")&&bodyAttach.size()>1){
                                        	 tempFileName=tempFileName.length()>0?tempFileName.substring(0,tempFileName.length()-1):tempFileName;
                 							 tempName=tempName.length()>0?tempName.substring(0,tempName.length()-1):tempName;
                 							 
            out.write("\r\n                 \t\t\t\t\t\t\t <a class=\"a1\" href=\"javascript:JSMainWinOpen('/jsoa/downloadBatch.jsp?");
            out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+tempFileName+"&name="+tempName+"&path=cooperate&moduleCode="+moduleCode+"&edit=1"));
            out.write('\'');
            out.write(',');
            out.write('\'');
            out.print((SystemCommon.getFileShowUse()==1 || ipadFlag)?"showPage":"myIframe" );
            out.write("');\">全部下载</a>&nbsp;&nbsp;\r\n                 \t\t\t\t\t\t\t ");
 
                                         }
                                         
                                         
            out.write("\r\n                                         </div>\r\n                                         ");
} 
                                         //相关项目
                                         if(bpo.getRelProjectId().longValue()!=-1){
                                         
            out.write("\r\n                                         <p></p>\r\n                                         <div>相关项目:</div>\r\n                                         <div  style=\"padding-left:20px;\">");
if(request.getAttribute("relProjectName")==null){
            out.write("<font color=red>关联项目不存在或已被删除</font>");
}else{ 
            out.write("<a href=\"javascript:void(0);\" onclick=\"toProjectDetail('");
            out.print(bpo.getRelProjectId() );
            out.write("')\">");
            out.print(request.getAttribute("relProjectName") );
            out.write("</a>");
} 
            out.write("</div>                                         \r\n                                         ");
} 
            out.write("\r\n                                         </td>\r\n                                     </tr>\r\n                                  </table>\r\n                               </td>\r\n                           </tr>\r\n                      </table>\r\n                    ");

                    if(bodyEx!=null && bodyEx.size()>0){
                    
            out.write("\r\n                      <p height=\"5\"></p>\r\n                      <table width=\"95%\" height=\"50\" border=\"0\" cellpadding=\"10\" cellspacing=\"0\" class=\"docBoxNoPanelForFlow\" id=\"table_2\" style=\"padding-top:2px;display:;\" >\r\n                           <tr>\r\n                              <td>\r\n                                  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n                                     <tr>\r\n                                        <td>正文补充</td>\r\n                                     </tr>\r\n                                     ");

                                     for(i=0;i<bodyEx.size();i++){
                                    	 obj=(Object[])bodyEx.get(i);
                                    	 postTime=obj[1].toString();
                                    	 if(postTime.lastIndexOf(":")>0){
                                    		 postTime=postTime.substring(0,postTime.lastIndexOf(":"));
                                    	 }
                                     
            out.write("\r\n                                     <tr>\r\n                                       <td style=\"WORD-BREAK: break-all; WORD-WRAP: break-word\">");
            out.print(CharacterTool.escapeHTMLTagsSimple(obj[0].toString()) );
            out.write("</td>\r\n                                     </tr>\r\n                                     <tr>\r\n                                       <td align=\"right\">");
            out.print(postTime );
            out.write("&nbsp;&nbsp;&nbsp;");
            out.print(obj[2] );
            out.write("</td>\r\n                                     </tr>\r\n                                     ");
}
                                     
                                     if(bodyExAttach!=null && bodyExAttach.size()>0){
                                     
            out.write("\r\n                                     <tr><td>\r\n                                     <div>附件：</div>\r\n                                     <div id=\"coBodyAttach\" style=\"padding-left:20px;\">\r\n                                     ");

                                  	String tempFileName="";
             						String tempName="";
                                     for(i=0;i<bodyExAttach.size();i++){
                                    	 obj=(Object[])bodyExAttach.get(i);  
                                    	 tempFileName+=(String)obj[2]+",";
             							 tempName+=(String)obj[1]+",";
                                     
            out.write("\r\n                                     \t<a href=\"javascript:JSMainWinOpen('/jsoa/download.jsp?");
            out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+obj[2]+"&name="+obj[1].toString()+"&moduleCode="+moduleCode+"&path=cooperate&edit=1"));
            out.write('\'');
            out.write(',');
            out.write('\'');
            out.print((SystemCommon.getFileShowUse()==1 || ipadFlag)?"showPage":"myIframe" );
            out.write("');\">");
            out.print(obj[1] );
            out.write("</a>&nbsp;&nbsp;\r\n                                     ");

                                     } 
                                     if(SystemCommon.getFujianBatchDownload().equals("1")&&bodyExAttach.size()>1){
                                    	 tempFileName=tempFileName.length()>0?tempFileName.substring(0,tempFileName.length()-1):tempFileName;
             							tempName=tempName.length()>0?tempName.substring(0,tempName.length()-1):tempName;
             							
            out.write("\r\n             \t\t\t\t\t\t\t<a href=\"javascript:JSMainWinOpen('/jsoa/downloadBatch.jsp?");
            out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+tempFileName+"&name="+tempName+"&moduleCode="+moduleCode+"&path=cooperate&edit=1"));
            out.write('\'');
            out.write(',');
            out.write('\'');
            out.print((SystemCommon.getFileShowUse()==1 || ipadFlag)?"showPage":"myIframe" );
            out.write("');\">全部下载</a>&nbsp;&nbsp;\r\n             \t\t\t\t\t\t\t");

                                     }
                                     
            out.write("\r\n                                     </div>\r\n                                     </td></tr>\r\n                                     ");
}
            out.write("\r\n                                     \r\n                                            \r\n                                     \r\n                                  </table>\r\n                               </td>\r\n                           </tr>\r\n                      </table>\r\n                    ");

                    }
                    if(opinion!=null && opinion.size()>0){                    	
                    
            out.write(" \r\n                      <p height=\"5\"></p>                      \r\n                      <table width=\"95%\" height=\"50\" valign=\"top\" border=\"0\" cellpadding=\"1\" cellspacing=\"0\" class=\"docBoxNoPanelForFlow\" id=\"table_1\" style=\"display:;\" >\r\n                           <tr>\r\n                              <td height=\"50\">\r\n                                  <table height=\"50\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n                                     <tr>\r\n                                        <td nowrap height=\"26\">&nbsp;&nbsp;办理意见</td>\r\n                                     </tr>\r\n                                     \r\n                                     ");

                                     String opinionId,memberId,memberName,opinionContent,isHidden,empId;
                                  
                                     for(i=0;i<opinion.size();i++){
                                     	obj=(Object[])opinion.get(i);
                                     	opinionId=obj[0].toString();
                                     	isHidden=obj[1].toString();
                                     	postTime=obj[3].toString();
                                     	opinionContent=(String)obj[4];
                                     	if(opinionContent==null){
                                     		opinionContent="";
                                     	}
                                     	empId=obj[5].toString();
                                     	map.put(obj[0].toString(), empId);
                                     	if(opinionContent==null || "".equals(opinionContent) || "null".equals(opinionContent)){
                                     	   opinionContent="已阅";
                                     	}
                                     	//隐藏意见只能有发起者和本人看到
                                     	if("1".equals(isHidden)){
                                     		if(posterId.equals(curUserId) || empId.equals(curUserId) ){
                                     			opinionContent="[<font color='#FF0000' class=\"font\">隐藏</font>]"+opinionContent;
                                     		}else{
                                     			opinionContent="[<font color='#FF0000' class=\"font\">隐藏</font>]";
                                     		}
                                     	}
                                     	if(postTime.indexOf(".")>0){
                                     		postTime=postTime.substring(0,postTime.indexOf("."));
                                     	}
                                     	
                                     
            out.write("\r\n                                     \r\n                                     <!-- 处理意见人员时间等信息 -->\r\n                                     <tr bgcolor=#d4d0c8 >\r\n                                        <td width=\"60\" nowrap align=\"left\"><font color=\"#000066\"  class=\"op_font\">&nbsp;&nbsp;");
            out.print(obj[2] );
            out.write("</font></td>\r\n                                        <td><font color=\"#FF0000\" class=\"font\">");
            out.print(postTime );
            out.write("</font></td>\r\n                                        <td align=right>［<a href=\"javascript:void(0);\" onclick=\"reOpinion('");
            out.print(opinionId );
            out.write("');\">回复意见</a>］&nbsp;</td>\r\n                                     </tr>\r\n                                     \r\n                                     <!-- 处理意见 -->\r\n                                     <tr>\r\n                                        <td>&nbsp;</td>\r\n                                        <td colspan=\"2\" class=\"op_opinion\" style=\"line-height:20px;\">\r\n                                             ");
            out.print(opinionContent );
            out.write("\r\n                                        </td>                                     \r\n                                     </tr>\r\n                                     \r\n                                     <!-- 震荡回复 -->\r\n                                     <tr id=\"SubOPTR");
            out.print(opinionId );
            out.write("\" style=\"display:none\">\r\n                                        <td>&nbsp;</td>\r\n                                        <td colspan=\"2\">\r\n                                           <table width=\"100%\"> \r\n                                              <tr>\r\n                                                <td class=\"paddingl\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t    <table width=\"98%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"op_ltable\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t      <tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t        <td height=\"25\" class=\"op_border\">回复意见</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t        <td class=\"border\"> </td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t      </tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t      <tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t        <td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t           \r\n\t\t\t\t\t\t\t\t\t\t\t\t            <div style=\"height:100%;width=100%;padding-left:1px;boder:1px solid #994564;overflow-y:scroll;overflow:auto;\">\r\n\t\t\t                                                     <table id=\"SubOPTable");
            out.print(opinionId );
            out.write("\"></table>\r\n\t\t\t                                                 </div>\r\n                                                   \r\n\t\t\t\t\t\t\t\t\t\t\t\t        </td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t      </tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t    </table>\r\n\t\t\t\t\t\t\t\t\t\t\t\t </td>\r\n                                              </tr>                                              \r\n                                              \r\n                                           </table>                                         \r\n                                        </td>\r\n                                     </tr>\r\n                                     <!-- 震荡回复 结束 -->\r\n                                     \r\n                                     <!-- 回复意见附件 -->\r\n                                     <tr>\r\n                                        <td>&nbsp;</td>\r\n                                        <td colspan=\"2\">\r\n                                                 <div id=\"SubOPAttachDIV");
            out.print(opinionId );
            out.write("\" style=\"display:none;padding-top:5px;\"><div style=\"float:left;\">附件：</div><div id=\"SubOPAttachTR");
            out.print(opinionId );
            out.write("\"></div></div>\r\n                                        </td>                                     \r\n                                     </tr>\r\n                                     \r\n                                     ");

                                     }//end of for(i<opinion.size())
                                     
            out.write("\r\n                                     <tr>\r\n                                       <td height=\"12\">&nbsp;</td>\r\n                                     </tr>       \r\n                                     \r\n                                  </table>\r\n                               </td>\r\n                           </tr>\r\n                      </table>\r\n                    ");

                    }//end of if(opinion!=null)
                    
            out.write("                     \r\n                   </div>\r\n                </td>\r\n            </tr>\r\n         </table>\r\n     </td>\r\n  </tr>\r\n\r\n  <tr style=\"display:none\">\r\n     <td>\r\n        <input type=\"hidden\" name=\"bodyId\" id=\"bodyId\" value=\"");
            out.print(bpo.getId());
            out.write("\"> \r\n        <input type=\"hidden\" name=\"nodeId\" value=\"");
            out.print(nodeId );
            out.write("\">\r\n        <input type=\"hidden\" name=\"memberId\" value=\"");
            out.print(curMemberId );
            out.write("\">\r\n        <input type=\"hidden\" name=\"posterId\" value=\"");
            out.print(bpo.getPosterId());
            out.write("\">\r\n        <input type=\"hidden\" name=\"posterName\" value=\"");
            out.print(bpo.getPosterName());
            out.write("\">\r\n        <input type=\"hidden\" name=\"selPersonIds\" value=\"\">\r\n        <input type=\"hidden\" name=\"selPersonNames\" value=\"\">\r\n        <input type=\"hidden\" name=\"appSelectedId\" value=\"\">\r\n        <input type=\"hidden\" name=\"appSelectedName\" value=\"\">\r\n        <input type=\"hidden\" name=\"fromdesktop\" value=\"");
            out.print(request.getParameter("fromdesktop"));
            out.write("\">\r\n        ");

        //循环回复意见
        StringBuffer buffer=new StringBuffer("0");
        if(subOpinion!=null && subOpinion.size()>0){        	
        	String empId,opinionId,memberId,memberName,opinionContent,isHidden;
        	String lastParentId="0",parentId;
        	for(i=0;i<subOpinion.size();i++){
        		obj=(Object[])subOpinion.get(i);
        		parentId=obj[5].toString();
        		isHidden=obj[1].toString();
             	postTime=obj[3].toString();
             	opinionContent=obj[4].toString();
             	empId=obj[6].toString();
             	
             	
             	if("1".equals(isHidden)){
             		if(posterId.equals(curUserId) || empId.equals(curUserId)|| map.get(parentId).equals(curUserId)  ){
             			opinionContent="[<font color='#FF0000' class=\"font\">隐藏</font>]"+opinionContent;
             		}else{
             			opinionContent="[<font color='#FF0000' class=\"font\">隐藏</font>]";
             		}
             	}
             	if(postTime.indexOf(".")>0){
             		postTime=postTime.substring(0,postTime.indexOf("."));
             	}
             	             	
             	if(!lastParentId.equals(parentId)){
             		//preId 改变了
             		lastParentId=parentId;
             		buffer.append(",").append(parentId);
             		if(i>0){
             			out.print("</table>");
             		}
             		
            out.write("             \t\t\r\n             \t\t<table id=\"SubOPTableTmp");
            out.print(parentId );
            out.write("\">\r\n             \t\t");

             	}
                
            out.write("\r\n\t           <tr>\r\n\t              \r\n\t              <td valign=\"top\" align=\"right\" nowrap>&nbsp;&nbsp;");
            out.print(obj[2] );
            out.write(":&nbsp;</td>\r\n\t              <td valign=\"top\">");
            out.print(opinionContent );
            out.write("</td>\r\n\t              <td valign=\"top\" nowrap>");
            out.print(postTime );
            out.write("</td>\r\n\t           </tr>\r\n        \r\n         ");

           } //end for
        	if(i>0){
     			out.print("</table>");
     		}
         } //end if
         
            out.write("\r\n         <input type=\"hidden\" name=\"subOpinionPreIds\" value=\"");
            out.print(buffer.toString() );
            out.write("\">\r\n         \r\n         ");

         //循环意见附件
         buffer=new StringBuffer("0");

         if(opinionAttach!=null && opinionAttach.size()>0){        	
         	String fileName,fileSaveName;
         	String lastParentId="0",parentId;
         	for(i=0;i<opinionAttach.size();i++){
         		obj=(Object[])opinionAttach.get(i);
         		parentId=obj[0].toString();
         		fileName=obj[1].toString();
         		fileSaveName=obj[2].toString();
             	
             	if(!lastParentId.equals(parentId)){
             		//preId 改变了
             		lastParentId=parentId;
             		buffer.append(",").append(parentId);
             		if(i>0){
             			out.print("</div>");
             		}
             		
            out.write("             \t\t\r\n             \t\t\r\n             \t\t<div id=\"SubOPAttachTableTmp");
            out.print(parentId );
            out.write("\">\r\n             \t\t");

             	}
                
            out.write("\r\n                <a href=\"javascript:JSMainWinOpen('/jsoa/download.jsp?");
            out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+fileSaveName+"&name="+fileName+"&moduleCode="+moduleCode+"&path=cooperate&edit=1"));
            out.write('\'');
            out.write(',');
            out.write('\'');
            out.print((SystemCommon.getFileShowUse()==1 || ipadFlag) ?"showPage":"myIframe" );
            out.write("');\">");
            out.print(fileName );
            out.write("</a>&nbsp;\r\n         ");

         	}// end for
         	if(i>0){
     			out.print("</div>");
     		}
         }
         
            out.write("\r\n         <input type=\"hidden\" name=\"subOpinionAttachPreIds\" value=\"");
            out.print(buffer.toString() );
            out.write("\">\r\n     </td>\r\n  </tr>\r\n\r\n </table>\r\n\t<iframe name=\"myIframe\" style=\"display:none;\"></iframe>\r\n <form target=\"myIframe\" name=\"form4\" action=\"/jsoa/BodyAction.do?bodyId=");
            out.print(bpo.getId() );
            out.write("&flag=gd\" method=\"POST\">\r\n    <input type=\"hidden\" name=\"pageContent\">\r\n    <input type=\"hidden\" name=\"coTitle\" value=\"");
            out.print(CharacterTool.escapeHTMLTags(bpo.getTitle()) );
            out.write("\">\r\n</form>\r\n</body>\r\n");
            int evalDoAfterBody = _jspx_th_html_005fhtml_005f0.doAfterBody();
            if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
              break;
          } while (true);
        }
        if (_jspx_th_html_005fhtml_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
          return;
        }
        _005fjspx_005ftagPool_005fhtml_005fhtml.reuse(_jspx_th_html_005fhtml_005f0);
        _jspx_th_html_005fhtml_005f0_reused = true;
      } finally {
        org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhtml_005f0, _jsp_getInstanceManager(), _jspx_th_html_005fhtml_005f0_reused);
      }
      out.write("\r\n<script>\r\n<!--\r\n//关闭\r\nfunction jsEnd(){\t\r\n\t$.get(\"/jsoa/BodyAction.do\", { 'bodyId':$(\"#bodyId\").val(),'flag':'end'},\r\n  \t\tfunction(data){  \t\r\n    \tif(data.indexOf(\"ok\")>-1){\r\n    \t\topener.location.reload(); \r\n    \t\twindow.close();    \t\t\r\n    \t}else{\r\n    \t\talert(data);\r\n    \t}\r\n   });\r\n}\r\n\r\n\r\nfunction jsDealwith(){\r\n   JSMainWinOpen2('/jsoa/cooperate/co_dealwith.jsp?right=");
      out.print(nodeRight);
      out.write("','','',500,400);\r\n}\r\n\r\nfunction reOpinion(opId){\r\n   JSMainWinOpen2('/jsoa/cooperate/co_reopinion.jsp?opId='+opId,'','',500,400);\r\n}\r\n\r\nfunction jsDrawFlow(){\r\n  var bodyId=document.all.bodyId.value;\r\n  var posterId=document.all.posterId.value;\r\n  var posterName=document.all.posterName.value;\r\n  var nodeId=document.all.nodeId.value;\r\n  //JSMainWinOpenForOpener('/jsoa/cooperate/co_flow.jsp?bodyId='+bodyId+'&initUserId='+posterId+'&initUserName='+posterName,'','');\r\n  JSMainWinOpen( '/jsoa/cooperate/co_flow.jsp?bodyId='+bodyId+'&initUserId='+posterId+'&initUserName='+posterName+'&nodeId='+nodeId,'',''); \r\n}\r\n\r\nfunction jsAppendBody(){\r\n   JSMainWinOpen2('/jsoa/cooperate/body_append.jsp','','',600,400);\r\n}\r\n\r\nfunction jsModifyBody(){\r\n\tvar bodyId=document.all.bodyId.value;\r\n\tJSMainWinOpen('/jsoa/BodyAction.do?flag=loadContent&bodyId='+bodyId,'','');\r\n}\r\n\r\nfunction jsAddPerson(){\r\n    var selPersonIdsValue=document.all.selPersonIds.value;\r\n    var selPersonNamesValue=document.all.selPersonNames.value;  \r\n    \r\n    selectExeFunc('','selPersonIds','selPersonNames',selPersonIdsValue,selPersonNamesValue,'orgPerson','no','','");
      out.print(range );
      out.write("','yes','userorggroup','addPersonEnd');\r\n}\r\n//转办\r\nfunction jsTurnToDo(){\r\n\tJSMainWinOpen2('/jsoa/cooperate/co_dealwith_turntodo.jsp?bodyId='+document.all.bodyId.value,'','',500,400);\r\n}\r\n//督办\r\nfunction jsPressToDo(){\r\n\tJSMainWinOpen2('/jsoa/cooperate/co_dealwith_presstodo.jsp?bodyId='+document.all.bodyId.value,'','',500,400);\r\n}\r\nfunction addPersonEnd(){\r\n   alert(\"选择的用户将在提交完成后增加！\");\r\n}\r\n\r\nfunction jsClose(){\r\n   window.close();\r\n}\r\n//打印\r\nfunction jsPrintDoc(){\r\n    var bodyId=document.all.bodyId.value;\r\n    var nodeId=document.all.nodeId.value;\r\n    var memberId=document.all.memberId.value;\r\n\tvar url=\"/jsoa/BodyAction.do?flag=toDealwith&printFlag=1&bodyId=\"+bodyId+\"&nodeId=\"+nodeId+\"&memberId=\"+memberId+\"&status=");
      out.print(request.getAttribute("statusDownLoad"));
      out.write("\";\r\n\tMM_openBrWindow(url,\"\",\"TOP=0,LEFT=0,scrollbars=yes,resizable=yes,width=800,height=600\");\r\n}\r\nfunction MM_openBrWindow(theURL,winName,features) { //v2.0\r\n\t  JSMainWinOpen(theURL,winName,features);\r\n}\r\n/* function jsPrintDoc(){\r\n\tdocument.getElementById(\"tr_1\").style.display=\"none\";\r\n\tdocument.getElementById(\"tr_2\").style.display=\"none\";\r\n\tif(document.getElementById(\"table_1\")){\r\n\t\tdocument.getElementById(\"table_1\").style.display=\"none\";\r\n\t}\r\n\tif(document.getElementById(\"table_2\")){\r\n\t\tdocument.getElementById(\"table_2\").style.display=\"none\";\r\n\t}\r\n\twindow.print();\r\n\tdocument.getElementById(\"tr_1\").style.display=\"\";\r\n\tdocument.getElementById(\"tr_2\").style.display=\"\";\r\n\tif(document.getElementById(\"table_1\")){\r\n\t\tdocument.getElementById(\"table_1\").style.display=\"\";\r\n\t}\r\n\tif(document.getElementById(\"table_2\")){\r\n\t\tdocument.getElementById(\"table_2\").style.display=\"\";\r\n\t}\r\n} */\r\n\r\nfunction jsRecordList(){\r\n\tJSMainWinOpen(\"/jsoa/BodyAction.do?bodyId=\"+document.all.bodyId.value+\"&flag=recordList\",\"\",\"\");\r\n}\r\n\r\nfunction initPage(){\r\n");
      out.write("   var preIds=document.all.subOpinionPreIds.value;\r\n   var preIdArr=preIds.split(\",\");\r\n   for(var i=1;i<preIdArr.length;i++){\r\n      eval(\"document.all.SubOPTR\"+preIdArr[i]+\".style.display=''\");\r\n      var obj=eval(\"document.all.SubOPTable\"+preIdArr[i]);\r\n      var objtmp=eval(\"document.all.SubOPTableTmp\"+preIdArr[i]);  \r\n     obj.outerHTML=objtmp.outerHTML;      \r\n   }\r\n   try{\r\n   preIds=document.all.subOpinionAttachPreIds.value;\r\n   preIdArr=preIds.split(\",\");\r\n   for(var i=1;i<preIdArr.length;i++){\r\n      eval(\"document.all.SubOPAttachDIV\"+preIdArr[i]+\".style.display=''\");\r\n      var obj=eval(\"document.all.SubOPAttachTR\"+preIdArr[i]);\r\n      var objtmp=eval(\"document.all.SubOPAttachTableTmp\"+preIdArr[i]);  \r\n     obj.innerHTML=objtmp.innerHTML;      \r\n   }\r\n   }catch(e){\r\n   alert(e);\r\n   }\r\n}\r\nfunction toProjectDetail(_id){\r\n   var obj;\r\n   obj=opener.parent.document.all.MainDesktop;\r\n   if(obj){\r\n   }else{\r\n     obj=opener.document.all.MainDesktop;\r\n   }\r\n   obj.src=\"/jsoa/RelProjectAction.do?flag=detail&id=\"+_id;\r\n");
      out.write("   window.close();\r\n}\r\n/****************************************************张健添加*************************************************/\r\n//采用ajax的方法传递参数并返回值给页面\r\nvar xmlHttpRequest;  \r\nfunction createXMLHttpRequest(){  \r\n\ttry{  \r\n\t\t// Firefox, Opera 8.0+, Safari  \r\n\t\txmlHttpRequest=new XMLHttpRequest();  \r\n\t}  \r\n\tcatch (e){  \r\n\t\t// Internet Explorer  \r\n\t\ttry{  \r\n\t\t\txmlHttpRequest=new ActiveXObject(\"Msxml2.XMLHTTP\");  \r\n\t\t}  \r\n\t\tcatch (e){  \r\n\t\t\ttry{  \r\n\t\t\t\txmlHttpRequest=new ActiveXObject(\"Microsoft.XMLHTTP\");  \r\n\t\t\t}  \r\n\t\t\tcatch (e){  \r\n\t\t\t\talert(\"您的浏览器不支持AJAX！\");  \r\n\t\t\t\treturn false;  \r\n\t\t\t}  \r\n\t\t}  \r\n\t}  \r\n   \r\n}\r\n \r\n//发送请求函数  \r\nfunction sendRequestPost(url,param){  \r\n\tcreateXMLHttpRequest();  \r\n\txmlHttpRequest.open(\"POST\",url,true);  \r\n\txmlHttpRequest.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");  \r\n\txmlHttpRequest.onreadystatechange = processResponse;  \r\n\txmlHttpRequest.send(param);  \r\n}\t\r\n//处理返回信息函数  \r\nfunction processResponse(){  \r\n\tif(xmlHttpRequest.readyState == 4){  \r\n\t\tif(xmlHttpRequest.status == 200){  \r\n");
      out.write("\t\t\tvar res = xmlHttpRequest.responseText;\r\n\t\t\tres = res.replace(/\\s/g,\"\");//去除空格\r\n\t\t\tif (res.length > 3){\r\n\t\t\t\t//window.alert(res); \r\n\t\t\t\tif(res.indexOf(\"SUCCESS\")!=-1){\r\n\t\t\t\t    var obj;\r\n                    obj=opener.parent.document.all.MainDesktop;\r\n                    if(obj){\r\n                    }else{\r\n                    obj=opener.document.all.MainDesktop;\r\n                    }\r\n                    obj.src=\"/jsoa/RelProjectAction.do?flag=detail&id=\"+");
      out.print(bpo.getRelProjectId());
      out.write(";\r\n                    window.close();\t\r\n\t\t\t\t}else{   \r\n\t\t\t\t    alert(\"对不起，您无权查看此项目！\");\t\t \r\n\t\t\t\t}\r\n\r\n\t\t\t} \r\n\t\t\t\r\n\t\t}\r\n\t\telse{  \r\n\t\t\twindow.alert(\"请求页面异常\");  \r\n\t\t}  \r\n\t}  \r\n}\r\nfunction toProjectDetail(_id){\r\n          \r\n          var url = \"MyAjax.jsp\";\r\n          var param = \"id=\"+_id;\r\n          \r\n\t      sendRequestPost(url,param);\r\n\t      \r\n       \r\n}\r\nfunction guidang(){\r\n\t//alert(document.body.innerHTML);\r\n\talert(\"归档完成！\");\r\n\tform4.pageContent.value = document.body.innerHTML;\r\n    form4.submit();\r\n}\r\n");
if("1".equals(request.getParameter("guidang"))){
      out.write("\r\n\tguidang();////\r\n");
}
      out.write("\r\n//-->\r\n</script>\r\n<script src=\"/jsoa/js/util.js\"></script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
