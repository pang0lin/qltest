/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 09:59:32 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.weixin.workflow;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.util.util.BrowserJudge;

public final class workflow_005finclude_005fcommentForWeiXin_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.util.util.BrowserJudge");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=utf-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write(" \r\n\r\n\r\n<style type=\"text/css\">\r\n<!--\r\n#noteDiv {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n\tbackground-color:#ffffff;\r\n}\r\n\r\n#noteDiv1 {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n}\r\n.divOver{\r\n    background-color:#003399;\r\n\tcolor:#FFFFFF;\r\n\tborder-bottom:1px dashed #cccccc;\r\n    width:100%;\r\n\theight:20px;\r\n\tline-height:20px;\r\n\tcursor:default;\r\n\tpadding-left:5px;\r\n}\r\n.divOut{\r\n    background-color:#ffffff;\r\n\tcolor:#000000;\r\n\tborder-bottom:1px dashed #cccccc;\r\n    width:100%;\r\n\theight:20px;\r\n\tline-height:20px;\r\n\tcursor:default;\r\n\tpadding-left:5px;\r\n\ttext-align:left;\r\n}\r\n.table_border { border:1px solid #dce0e1;}\r\n.border_bottom_background{ border-bottom:1px solid #dce0e1; background:#f5f5f5;}\r\n.border_bottom{border-bottom:1px dashed #dce0e1;}\r\n.td_top{padding-top:8px;}\r\n-->\r\n</style>\r\n\r\n<script>\r\n\r\n//获取事件对象\r\n\r\nfunction getEvent()\r\n {\r\n         if(document.all)return window.event;        \r\n");
      out.write("         func=getEvent.caller;            \r\n         while(func!=null){    \r\n             var arg0=func.arguments[0];\r\n              if(arg0){\r\n                  if((arg0.constructor==Event || arg0.constructor ==MouseEvent)\r\n                      || (typeof(arg0)==\"object\" && arg0.preventDefault && arg0.stopPropagation)){   \r\n                      arg0.x = arg0.pageX;\r\n                      arg0.y = arg0.pageY ;\r\n                      arg0.srcElement = arg0.target;\r\n                     return arg0;\r\n                  }\r\n              }\r\n              func=func.caller;\r\n          }\r\n          return null;\r\n\r\n } \r\n \r\nvar noteTimer=null;\r\nfunction getNote(");
if(BrowserJudge.isFirefox(request)){
      out.write("event");
}
      out.write("){\r\n\r\n\tvar event = event || window.event;\r\n\tvar x = event.clientX+document.body.scrollLeft||event.pageX;\r\n\tvar y = event.clientY+document.body.scrollTop||event.pageY;\r\n\tvar d=document.getElementById(\"noteDiv\");\r\n\tvar s_top=0;\r\n\t\t\r\n\tif(document.getElementById(\"showHtmlDiv\")) {\r\n\t   s_top=document.getElementById(\"showHtmlDiv\").scrollTop;\r\n\t}else if(document.getElementById(\"mainFrame\")) {\r\n\t   s_top=document.getElementById(\"mainFrame\").scrollTop;\r\n\t}\r\n\t");
if(BrowserJudge.isMSIE(request)){
      out.write("\r\n\t  d.style.left=x-220;\r\n\t  d.style.top=s_top+y-20;\r\n\t");
}else{
      out.write("\r\n\t d.style.left=x-220;\r\n\t d.style.top=y+15;\r\n\t");
}
      out.write("\r\n\t\r\n\td.style.display=\"inline\";\r\n}\r\nfunction hiddenNote(){\r\n  noteTimer=window.setTimeout(\"closeNote()\",200);\r\n}\r\nfunction closeNote(){\r\n  var d=document.getElementById(\"noteDiv\");\r\n  d.style.display=\"none\";\r\n}\r\nfunction lockedNote(){\r\n  window.clearTimeout(noteTimer);\r\n}\r\nfunction setNote(obj){\r\n\tdocument.getElementById(\"flowNote\").innerText+=obj.innerText;\r\n}\r\n</script>\r\n<input type=\"hidden\" name=\"addDivContent\" value=\"\"> <!-- 在  常用语中用到-->\r\n\r\n");

int handSignInUse = 0;//是否使用了手写签名
int signatureInUse = 0;//是否使用了电子签章
java.util.Map include_sysMap = com.js.system.util.SysSetupReader.getInstance().getSysSetupMap(session.getAttribute("domainId").toString());
if(include_sysMap != null && include_sysMap.get("使用手写意见") != null && "1".equals(include_sysMap.get("使用手写意见").toString())){
    handSignInUse = 1;//手写签名
}
if(include_sysMap != null && include_sysMap.get("电子签章") != null && "1".equals(include_sysMap.get("电子签章").toString())){
	signatureInUse = 1;//电子签章
}

int maxHandSignIndex=-1;
String publicSignHeight=com.js.util.config.SystemCommon.getPublicSignHeight();
String userSignHeight=com.js.util.config.SystemCommon.getUserSignHeight();
String realSignHeight;


//当前审批人和日期
String writeUser = session.getAttribute("userName").toString();
String writeUserId = session.getAttribute("userId").toString();
com.js.system.service.usermanager.UserBD ub = new com.js.system.service.usermanager.UserBD();
String writeUserSignature = ub.getSignature(writeUserId);
String src="0000";
if(writeUserSignature!=null && writeUserSignature.length()>6 && writeUserSignature.substring(4,5).equals("_")){
	src=writeUserSignature.substring(0,4);
}else{
	src="0000";
}


if(!"".equals(writeUserSignature)){
	writeUserSignature = "<IMG SRC='/jsoa/upload/"+src+"/peopleinfo/"+writeUserSignature+"'>";
}else{
	writeUserSignature = writeUser;
}
//System.out.println("手写签名："+writeUserSignature);
java.text.DateFormat df = new java.text.SimpleDateFormat("yyyy-MM-dd HH:mm");
String nowTime = df.format(new java.util.Date());


//保护字段
com.js.oa.jsflow.service.WorkFlowCommonBD workFlowCommonBD2 = new com.js.oa.jsflow.service.WorkFlowCommonBD();
String protectField = "";
/*
String moduleId2 = workFlowCommonBD2.getModuleId(request.getParameter("table"));//模块ID
java.util.List protectList = new com.js.oa.jsflow.service.WorkFlowBD().getProtectList(request.getParameter("activity"),request.getParameter("table"),request.getParameter("record"),moduleId2);

for(int i=0;i<protectList.size();i++){
	Object[] objP = (Object[])protectList.get(i);
	protectField += objP[1].toString()+"="+objP[2].toString()+";";
}*/
if("".equals(protectField)){
	protectField = "none";
}
//电子签章div的位置
String inc_divId = java.util.Calendar.getInstance().getTimeInMillis() + "";

java.util.List officelist = new com.js.oa.jsflow.service.WorkFlowBD().getOffiDict(session.getAttribute("userId").toString(), session.getAttribute("domainId").toString());

int curIndex = 0;//批示意见对应字段的序号
//java.util.List commentList = new com.js.oa.jsflow.service.WorkFlowBD().getDealWithCommentNotBack(request.getParameter("table"),request.getParameter("record"),request.getParameter("workType"));
java.util.List commentList;
if(com.js.util.config.SystemCommon.getShowBackComment()==1){
	commentList= new com.js.oa.jsflow.service.WorkFlowBD().getDealWithComment(request.getParameter("table"),request.getParameter("record"),request.getParameter("workType"));
}else{
	commentList = new com.js.oa.jsflow.service.WorkFlowBD().getDealWithCommentNotBack(request.getParameter("table"),request.getParameter("record"),request.getParameter("workType"));
}

com.js.oa.jsflow.service.WorkFlowCommonBD include_comment_wfcBD = new com.js.oa.jsflow.service.WorkFlowCommonBD();
if("0".equals(request.getParameter("workType"))){
    //随机流程 
}else{
	int commentSize=0;
	
    //业务流程
    java.util.List tmpList = new java.util.ArrayList();
    String disActivityId = "";
    String disCurStepCount = "";
    String hasDisplayCommentId="";
    /**
    str2[0]:节点ID
    str2[1]:节点名称
    str2[2]:办理人姓名
    str2[3]:办理人处理意见
    str2[4]:处理意见时间
    str2[5]:当前意见是流程第几步骤
    str2[6]:
    str2[7]:意见查看范围
    str2[8]:意见对应字段
    str2[9]:  批示意见类型
    str2[10]: 阅件意见类型
    str2[11]: commtype
    str2[12]: emp_id
    str2[13]: wf_dealwithcomment_id
    str2[14]: signcomment
    	
    str3[0]:节点ID
    str3[1]:节点名称
    str3[2]:当前意见是流程第几步骤
    str3[3]:意见查看范围
    str3[4]:意见对应字段
    str3[5]:11
    str3[6]:批示意见类型
    str3[7]:阅件意见类型
    str3[8]:13
    
    **/
    
    for(int j = 0; j < commentList.size(); j ++){
        String[] str2 = (String[]) commentList.get(j);
        if(!disActivityId.equals(str2[0]) && !disCurStepCount.equals(str2[5]) && (!"-1".equals(str2[9]) || (!"-1".equals(str2[10]) && "2".equals( str2[11])))){
            //disActivityId = str2[0];
            //disCurStepCount = str2[5];           
            String[] str3 = {str2[0],str2[1],str2[5],str2[7],str2[8],str2[11],str2[9],str2[10],str2[13]};
            tmpList.add(str3);
            
        }
    }    
    if(tmpList.size()>0){
    
      out.write("   \r\n    \r\n    <table id=\"commentListTableTemp\" width=\"100%\" align=\"center\" cellspacing=\"0\" cellpadding=\"0\" class=\"table_border\">\r\n    ");

    //开始循环显示意见........
    String[] str2 = null, str3 = null;
    boolean showComment;
    for(int j = 0; j < tmpList.size(); j ++){
        str2 = (String[]) tmpList.get(j);
		//判断是否显示意见，如果是无批示意见字段，则不显示
		String actiCommFieldType = str2[6];
		String passRoundCommFieldType = str2[7];
		showComment=false;
		
		if((str2[4]==null || "-1".equals(str2[4]) || str2[4].trim().length()<1 || str2[4].trim().toUpperCase().equals("NULL"))){
		     showComment=true;
		     commentSize++;
		}

    
      out.write("\r\n   <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("\">\r\n      <td height=\"24\" class=\"border_bottom_background\"><b>");
      out.print(str2[1]);
      out.write("</b></td>\r\n   </tr>\r\n   <!--显示意见Title结束,开始循环显示意见-->\r\n   ");

    if(request.getParameter("gd") != null || include_comment_wfcBD.inCommentRange(session.getAttribute("userId").toString(), session.getAttribute("orgIdString").toString(), str2[3]).booleanValue()){
    for(int k = 0; k < commentList.size(); k ++){
         str3 = (String[]) commentList.get(k);
         //判断是否显示意见，如果是无批示意见字段，则不显示
		 String commtype = str3[11];
		 if(("2".equals(commtype) && "-1".equals(passRoundCommFieldType)) || (!"2".equals(commtype) && "-1".equals(actiCommFieldType)) || !str2[8].equals(str3[13]) || hasDisplayCommentId.indexOf(","+str3[13]+",")>=0){
			continue;
		 }
		 hasDisplayCommentId+=","+str3[13]+",";		
					
		 if(str2[0].equals(str3[0]) && (str2[2]==null?"0":str2[2]).equals((str3[5]==null?"0":str3[5]))){
			//显示意见
			
			//设置时间格式
			if(str3[4].indexOf(".")>0){
				str3[4]=str3[4].substring(0,str3[4].indexOf("."));
			}
			if(str3[4].indexOf(":")>0){
				str3[4]=str3[4].substring(0,str3[4].lastIndexOf(":"));
			}
			 
		    boolean sx = false;
	        try{
	        	String contextLong = (str3[3]!=null&&str3[3].indexOf(":::")>0)?str3[3].split(":::")[0]:str3[3];
	        	if((contextLong.startsWith("1")||contextLong.startsWith("2"))&&contextLong.length()>=13
	        			&&contextLong.length()<=16){
					long longT = Long.parseLong(contextLong);
					sx = true;
	        	}
	        	//Long.parseLong((str3[3]!=null&&str3[3].indexOf(":::")>0)?str3[3].split(":::")[0]:str3[3]);
	        	//sx = true;
	        }catch(Exception e){
	        }
	        
	       if(sx){
           //手写批注
    	   if("0".equals(str3[15])){
       		   realSignHeight=userSignHeight;
       	   }else{
       		   realSignHeight=publicSignHeight;
       	   }
           if(str3[8]==null || "-1".equals(str3[8]) || str3[8].trim().length()<1 || str3[8].trim().toUpperCase().equals("NULL")){
        	   maxHandSignIndex=k;  
        	   
             //手写控件
        
      out.write("  \r\n        <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("\">    \r\n        <td height=\"");
      out.print(realSignHeight);
      out.write("\">\r\n            <OBJECT name=\"incSig");
      out.print(k);
      out.write("\" classid=\"clsid:2294689C-9EDF-40BC-86AE-0438112CA439\" codebase=\"/jsoa/iWebRevision.jsp/iWebRevision.cab#version=6,0,0,0\" width=\"100%\" height=\"");
      out.print(realSignHeight);
      out.write("\">\r\n                <param name=\"weburl\" value=\"http://");
      out.print(request.getServerName());
      out.write(':');
      out.print(request.getServerPort());
      out.write("/jsoa/iWebRevision.jsp/iWebServer.jsp\">\r\n                <param name=\"recordid\" value=\"");
      out.print(str3[3]);
      out.write("\">\r\n                <param name=\"fieldname\" value=\"incSig");
      out.print(k);
      out.write("\">\r\n                <param name=\"username\" value=\"\">\r\n                <param name=\"Enabled\" value=\"0\">\r\n                <param name=\"PenColor\" value=\"00000000\">\r\n                <param name=\"BorderStyle\" value=\"0\">\r\n                <param name=\"SignatureType\" value=\"0\">\r\n                <param name=\"wmode\" value=\"opaque\">\r\n                <param name=\"ShowUserListMenu\" value=\"false\">\r\n            </OBJECT>\r\n            <script language=\"javascript\">document.all.incSig");
      out.print(k);
      out.write(".LoadSignature();</script>\r\n        </td> \r\n        </tr>\r\n        ");

	       //if(str3[14]!=null && str3[14].length()>4){
	       if(false){
        	 //使用了电子签章	         
        
      out.write("\r\n\t    <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("\">\r\n          <td height=\"1\"><div id=\"signPosi_");
      out.print(str3[14]);
      out.write("\" style='position:absolute;width:100%;");
if(!BrowserJudge.isMSIE11(request)){
      out.write("height:100%;");
}
      out.write("'></div></td>\r\n        </tr>\r\n\t    ");

	         }
	    
      out.write("\r\n        <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("\">\r\n            <td>\r\n        ");

		   //判断是否转办人
		   if(str3[11] != null && !str3[11].toString().equals("") && str3[11].toString().equals("3")){
		       out.print("转办人：");				
		   }
		   String srcLove="0000";
			if(ub.getSignature(str3[12])!=null && ub.getSignature(str3[12]).length()>6 && ub.getSignature(str3[12]).substring(4,5).equals("_")){
				srcLove=ub.getSignature(str3[12]).substring(0,4);
			}else{
				srcLove="0000";
			}
		
      out.write("\r\n\t\t");
      out.print(ub.getSignature(str3[12]).equals("")?str3[2]:("<IMG SRC='/jsoa/upload/"+srcLove+"/peopleinfo/"+ub.getSignature(str3[12])+"'>"));
      out.write("&nbsp;&nbsp;(");
      out.print(str3[4]);
      out.write(")\r\n        ");
if(str3[6] != null && !str3[6].toString().equals("")){ 
      out.write("\r\n        <font color=\"blue\">(");
      out.print(str3[6]);
      out.write("代办)</font>\r\n        ");
 }
      out.write("\r\n\t     \t</td>\r\n\t\t</tr>\r\n\t\t");
 }else{//使用自定义批示意见字段处理手写批示意见 
      out.write("\r\n\t             <script language=\"javascript\">\r\n\t        \t\tvar divArr1 = document.getElementsByTagName(\"div\");\t        \t\t\t\r\n\t        \t\tif(divArr1.length>0){\r\n\t\t\t\t        var commentStr = \"");
      out.print((str3[3]==null?"":str3[3].replaceAll("\"","'")));
      out.write("\";\r\n\t\t\t\t        var commentIndex = 0;\r\n\t\t\t\t        var divID = \"\";\r\n\t\t\t\t\t\tfor(var i=0;i<divArr1.length;i++){\r\n\t\t\t\t\t\t\tif(divArr1[i].id.indexOf(\"-\")>=1 && divArr1[i].id.indexOf(\"-\")!=(divArr1[i].id.length-1) && (\"");
      out.print(str3[8]);
      out.write("\".indexOf(\"$\"+divArr1[i].id.split(\"-\")[1]+\"$\")>=0 || \"");
      out.print(str3[8]);
      out.write("\" == divArr1[i].id.split(\"-\")[1] )){\r\n\t\t\t\t\t\t\t\tif(divArr1[i].innerHTML.indexOf(\"<\")==0 ){\r\n\t\t\t\t\t\t\t\t\tdivArr1[i].innerHTML=\"\";\r\n\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t");
      out.write("\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t");

								   //判断是否转办人
								   /*if(str3[11] != null && !str3[11].toString().equals("") && str3[11].toString().equals("3")){
								       out.print("转办人：");				
								   }
								   String srcLove="0000";
									if(ub.getSignature(str3[12])!=null && ub.getSignature(str3[12]).length()>6 && ub.getSignature(str3[12]).substring(4,5).equals("_")){
										srcLove=ub.getSignature(str3[12]).substring(0,4);
									}else{
										srcLove="0000";
									}*/
								
      out.write("\r\n\t\t\t\t\t\t\t\t//divArr1[i].innerHTML +=\"<div align=right>");
//=ub.getSignature(str3[12]).equals("")?str3[2]:("<IMG SRC='/jsoa/upload/"+srcLove+"/peopleinfo/"+ub.getSignature(str3[12])+"'>")
      out.write("&nbsp;&nbsp;(");
      out.print(str3[4]);
      out.write(")\";\r\n\t\t\t\t\t\t\t\t");
//if(str3[6] != null && !str3[6].toString().equals("")){ 
      out.write("\r\n\t\t\t\t\t\t        //divArr1[i].innerHTML +=\"<font color=blue>(");
//=str3[6]
      out.write("代办)</font></div>\";\r\n\t\t\t\t\t\t        ");
// }
      out.write("\r\n\t\t\t\t\t\t        divArr1[i].innerHTML+=\"<div align=right style='font-size:");
      out.print(com.js.util.config.SystemCommon.getCommentFontSize());
      out.write(';');
      out.write('\'');
      out.write('>');
      out.print(str3[4]);
      out.write("</div>\";\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//alert(((commentStr!=\"null\" && commentStr!=\"\" && commentStr.indexOf(\":::\")>0)?commentStr.split(\":::\")[commentIndex-1]:commentStr));\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t");

								//if(str3[14]!=null && str3[14].length()>4){
								if(false){
									//使用了电子签章	
								
      out.write("\r\n\t\t\t\t\t\t\t\t");
      out.write("\r\n\t\t\t\t\t\t\t\t");

								}
								
      out.write("      \r\n\t\t\t\t\t\t\t\t");
      out.write("\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t        \t\t}\r\n\t        \t</script>\r\n\t        \t\t\r\n\t ");
       }
	      }else{ //end of if(sx) 未使用手写签批的情况 
      out.write("\r\n\t         <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("; text-align: left;\"><td class=\"td_top\">&nbsp;\r\n\t         ");

	         if(str3[8]==null || "-1".equals(str3[8]) || str3[8].trim().length()<1 || str3[8].trim().toUpperCase().equals("NULL")){
	         	   if(str3[3] != null){
                       out.print(str3[3]);
                   }
	         
      out.write("\r\n\t         </td>\r\n\t         </tr>\r\n\t         ");

	         //if(str3[14]!=null && str3[14].length()>4){
	         if(false){
	        	 //使用了电子签章	         
	         
      out.write("\r\n\t\t    <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("\">\r\n\t          <td height=\"1\"><div id=\"signPosi_");
      out.print(str3[14]);
      out.write("\" style='position:absolute;width:100%;");
if(!BrowserJudge.isMSIE11(request)){
      out.write("height:100%;");
}
      out.write("'></div></td>\r\n\t        </tr>\r\n\t         ");
 } 
      out.write("\r\n\t         <tr style=\"display:");
      out.print(showComment?"":"none");
      out.write("\"><td height=\"20\" align=\"right\">\r\n\t         ");

                   if(str3[11] != null && !str3[11].toString().equals("") && str3[11].toString().equals("3")){
                       out.print("转办人：");
                   }
                   String src_Love="0000";
					if(ub.getSignature(str3[12])!=null && ub.getSignature(str3[12]).length()>6 && ub.getSignature(str3[12]).substring(4,5).equals("_")){
						src_Love=ub.getSignature(str3[12]).substring(0,4);
					}else{
						src_Love="0000";
					}
   
      out.write("<!-- 显示名字和日期 -->\r\n                   ");
      out.print(ub.getSignature(str3[12]).equals("")?str3[2]:("<IMG SRC='/jsoa/upload/"+src_Love+"/peopleinfo/"+ub.getSignature(str3[12])+"'>"));
      out.write("&nbsp;&nbsp;(");
      out.print(str3[4]);
      out.write(")\r\n   ");

                   if(str3[6] != null && !str3[6].toString().equals("")){
   
      out.write("\r\n                      <font color=\"blue\">(");
      out.print(str3[6]);
      out.write("代办)</font>\r\n   ");

                   }
              
      out.write("\r\n              </td>\r\n              </tr>\r\n              \r\n   ");
      }else{//enf of if(str3[8]==null || "-1".equals(str3[8]) || str3[8].tri.......
		   	  //批示意见对应字段情况
   
      out.write("\r\n                   <script language=\"javascript\">\r\n\t\t\t        \tvar divArr1 = document.getElementsByTagName(\"div\");\r\n\t\t        \t\tif(divArr1.length){\r\n\t\t\t\t\t\t\t\tvar commentStr = \"");
      out.print((str3[3]==null?"":str3[3].replaceAll("\"","'")));
      out.write("\";\r\n\t\t\t\t\t\t\t\tvar commentIndex = 0;\r\n\t\t\t\t\t\t\t\tfor(var i=0;i<divArr1.length;i++){\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t                   if(divArr1[i].id.indexOf(\"-\")>=1 && divArr1[i].id.indexOf(\"-\")!=(divArr1[i].id.length-1) && (\"");
      out.print(str3[8]);
      out.write("\".indexOf(\"$\"+divArr1[i].id.split(\"-\")[1]+\"$\")>=0 || \"");
      out.print(str3[8]);
      out.write("\" == divArr1[i].id.split(\"-\")[1] )){\r\n\t\t\t\t\t\t\t\t\t\t/*if(divArr1[i].innerHTML.indexOf(\"<\")==0 ){\r\n\t\t\t\t\t\t\t\t\t\t\tdivArr1[i].innerHTML=\"\";\r\n\t\t\t\t\t\t\t\t\t\t}*/\r\n\t\t\t\t\t\t\t\t\t\t");

										String src_myLove="0000";
										if(ub.getSignature(str3[12])!=null && ub.getSignature(str3[12]).length()>6 && ub.getSignature(str3[12]).substring(4,5).equals("_")){
											src_myLove=ub.getSignature(str3[12]).substring(0,4);
										}else{
											src_myLove="0000";
										}
										
										 
      out.write("\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tdivArr1[i].innerHTML += \"<div><div style='font-size:");
      out.print(com.js.util.config.SystemCommon.getCommentFontSize());
      out.write(";'>\"+((commentStr!=\"null\" && commentStr!=\"\" && commentStr.indexOf(\":::\")>0)?commentStr.split(\":::\")[commentIndex++]:commentStr)+\r\n\t\t\t\t\t\t\t\t\t\t\"</div><div style='TEXT-ALIGN: right;padding-right:20px;font-size:");
      out.print(com.js.util.config.SystemCommon.getCommentFontSize());
      out.write(";'>\"\r\n\t\t\t\t\t\t\t\t\t\t\t+\"");
      out.print((str3[11] != null && !str3[11].toString().equals("") && str3[11].toString().equals("3"))?"转办人：":"");
      out.write("\"\r\n\t\t\t\t\t\t\t\t\t\t\t+\"");
      out.print(ub.getSignature(str3[12]).equals("")?str3[2]:("<IMG SRC='/jsoa/upload/"+src_myLove+"/peopleinfo/"+ub.getSignature(str3[12])+"'>"));
      out.write("\"+\"&nbsp;(");
      out.print(str3[4]);
      out.write(")\"\r\n\t\t\t\t\t\t\t\t\t\t\t+\"");
      out.print((str3[6] != null && !str3[6].toString().equals(""))?("("+str3[6]+"代办)"):"");
      out.write("</div></div>\";\r\n\t\t\t\t\t\t\t\t\t\t");

										//if(str3[14]!=null && str3[14].length()>4){
										if(false){
											//使用了电子签章
											String divIdSet = str3[14].endsWith("id=")?str3[14].substring(0,str3[14].indexOf(" id=")):str3[14];
										
      out.write("\r\n\t\t\t\t\t\t\t\t\t\tdivArr1[i].innerHTML+=\"<div id=\\\"signPosi_");
      out.print(divIdSet);
      out.write("\\\" style='position:absolute;width:100%;");
if(!BrowserJudge.isMSIE11(request)){
      out.write("height:100%;");
}
      out.write("'></div>\";\r\n\t\t\t\t\t\t\t\t\t\t");
}
      out.write("\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}//end of for()\r\n\t\t        \t\t}//end of if\r\n\t\t\t\t     </script>\r\n\t\t\t\t     \r\n\t ");
       } // end of enf of if(str3[8]==null 批示意见对应字段
           }// end of end of if(sx)
        }//end of if(str2[0].equals(str3[0]) && (str2[2]
     }//end of for(int k=0 
     
     }// end of if(request.getParameter("gd") != null || inc
   
     }// end for(int j = 0; j < tmpList.size(); j ++){
     
      out.write("\r\n     </table>\r\n     ");

   }// end if(tmpList.size()>0){
   if(commentSize>0){
	   
      out.write("\r\n\t   <script>\r\n\t   document.all.commentListTableTemp.style.display='';\r\n\t   </script>\r\n\t   ");

   }else{
	   
      out.write("\r\n\t   <script>\t   \r\n\t   if(document.all.commentListTableTemp)document.all.commentListTableTemp.style.display='none';\r\n\t   </script>\r\n\t   ");

   }
}// end of 业务流程

      out.write("\r\n\r\n\r\n\r\n\r\n<!-- 退回意见 -->\r\n");

	String backCommentStr = new com.js.oa.jsflow.service.WorkFlowButtonBD().getBackComment(request.getParameter("processId"),request.getParameter("table"),request.getParameter("record"));

      out.write("<BR>\r\n    <table width=\"80%\" border=\"0\" cellpadding=\"0\" align=\"center\" cellspacing=\"0\">\r\n    \r\n        <tr style=\"display:");
      out.print("".equals(backCommentStr)?"none":"none");
      out.write("\">\r\n\t\t<td>\r\n\t\t<table border=\"0\" width=\"100%\" style=\"border:1px solid #366AB3;background-color:#F6F6F6;\"><tr>\r\n            <td width=\"120\" nowrap align=\"center\" valign=\"middle\" style=\"border:1px solid #366AB3;background-color:#F6F6F6;border-bottom:1px;border-top:0px;border-left:0px;\">退回意见：</td>\r\n            <td style=\"word-break:break-all;\">\r\n                    <table width=\"100%\" border=\"0\">\r\n\t\t\t\t\t");
      out.print(backCommentStr);
      out.write("                 \r\n                    </table>\r\n                \r\n                &nbsp;\r\n            </td>\r\n\t\t\t</tr></table></td>\r\n        </tr>\r\n    \r\n    </table>\r\n<BR>\r\n");

int _inWorkStatus = new com.js.oa.jsflow.service.WorkFlowBD().getWorkStatusByWorkId(request.getParameter("work"));
if((_inWorkStatus==0 || _inWorkStatus==2) && !"1".equals(request.getParameter("printFlag"))){
    //待批或待阅文件
	//没有设置批示意见对应字段，使用默认批示意见 
	if((request.getAttribute("curCommField")==null || "-1".equals(request.getAttribute("curCommField")) || request.getAttribute("curCommField").toString().trim().length()<1 || request.getAttribute("curCommField").toString().toUpperCase().equals("NULL"))
	&& !"1".equals(request.getParameter("savefirst"))
	&& !"-1".equals(request.getAttribute("commFieldType")+"")
	){
	  String SignatureId = new java.util.Date().getTime() + "";
    
      out.write("\r\n    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"table_border\">\r\n    <tr>\r\n\t    <td class=\"border_bottom_background\"><b>办理意见</b></td>\r\n\t    <td height=\"24\" align=\"left\" class=\"border_bottom_background\">\r\n\t       <div align=\"right\"><a href=\"javascript:void(0);\" onClick=\"getNote(");
if(BrowserJudge.isFirefox(request)){
      out.write("event");
}
      out.write(");\" onmouseout=\"hiddenNote();\" onmouseover=\"lockedNote();\" >常用语</a></div>\r\n\t\t\t <div id=\"noteDiv\" style=\"right:15px;\" onmouseout=\"hiddenNote();\" onmouseover=\"lockedNote();\" value=\"comment\">\r\n\t\t\t\t");

				  if(officelist!=null&&officelist.size()>0){
				   for(int i=0;i<officelist.size();i++){
					 String offContent=""+officelist.get(i);
      out.write("\r\n\t\t\t\t\t  <div class=\"divOut\" onmouseover=\"lockedNote();this.className='divOver'\" onmouseout=\"this.className='divOut'\" onclick=\"include_set_comment(this,'comment')\">");
      out.print(offContent);
      out.write("</div>\t\t\t\t   \r\n\t\t\t\t   ");
}
				}
				
      out.write("\r\n\t\t\t  ");
      out.write("</div> \r\n\t\t\t  </td>\r\n\t  </tr>\r\n\t  <!-- 填写意见框 -->\r\n\t\t<!-- 普通 -->\r\n\t  <tr  id=\"signTb1\">\r\n\t    <td colspan=\"2\" align=\"right\" class=\"td_top\">\r\n\t     <textarea name=\"comment\" id=\"comment\" cols=\"50\" Class=\"inputTextarea\" style=\"width:100%\" rows=\"5\" onblur=\"include_checkTextArea(this,'办理意见',2000);\"></textarea>\r\n\t\t</td>\r\n\t  </tr>\r\n\t  ");
if(handSignInUse==1){
		  String curHandSignType=new com.js.oa.jsflow.service.ActivityBD().getActivityHandSignType(request.getParameter("activity"));
		  realSignHeight=("0".equals(curHandSignType))?userSignHeight:publicSignHeight;
	  
      out.write("\r\n\t\t\t\t<tr id=\"signTb2\"  style=\"display:none\">\r\n\t\t\t\t\t    <td width=\"90%\" height=\"150\">\r\n\t\t\t\t\t\t<OBJECT name=\"incSig");
      out.print(maxHandSignIndex+1);
      out.write("\" classid=\"clsid:2294689C-9EDF-40BC-86AE-0438112CA439\" codebase=\"/jsoa/iWebRevision.jsp/iWebRevision.cab#version=6,0,0,0\" width=\"100%\" height=\"");
      out.print(realSignHeight);
      out.write("\">\r\n\t\t\t\t\t\t\t<param name=\"weburl\" value=\"http://");
      out.print(request.getServerName());
      out.write(':');
      out.print(request.getServerPort());
      out.write("/jsoa/iWebRevision.jsp/iWebServer.jsp\">\r\n\t\t\t\t\t\t\t<param name=\"recordid\" value=\"");
      out.print(SignatureId);
      out.write("\">\r\n\t\t\t\t\t\t\t<param name=\"fieldname\" value=\"incSig");
      out.print(maxHandSignIndex+1);
      out.write("\">\r\n\t\t\t\t\t\t\t<param name=\"username\" value=\"");
      out.print(session.getAttribute("userName"));
      out.write("\">\r\n\t\t\t\t\t\t\t<param name=\"Enabled\" value=\"1\">\r\n\t\t\t\t\t\t\t<param name=\"PenWidth\" value=\"1\">\r\n\t\t\t\t\t\t\t<param name=\"PenColor\" value=\"00000000\">\r\n\t\t\t\t\t\t\t<param name=\"BorderStyle\" value=\"0\">\r\n\t\t\t\t\t\t\t<param name=\"EditType\" value=\"0\">\r\n\t\t\t\t\t\t    <param name=\"ShowUserListMenu\" value=\"false\">\r\n\t\t\t\t\t\t</OBJECT>\r\n\t\t\t\t\t\t<input type=\"hidden\" name=\"comment\" value=\"");
      out.print(SignatureId);
      out.write("\"><br>\r\n\t\t\t\t\t\t<input type=\"hidden\" name=\"SignSendOutObject\" value=\"incSig");
      out.print(maxHandSignIndex+1);
      out.write("\"><br>\r\n\t\t\t\t\t\t<!-- <a href=\"javascript:\" onclick=\"if (!SendOut.OpenSignature()){alert(SendOut.Status);}\">打开签章</a> -->\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t<td valign=\"top\" style=\"padding-top:10px;\">\r\n\t\t\t\t\t\t    <input type=\"button\" class=\"btnButton2font\" onclick=\"if (!document.all.incSig");
      out.print(maxHandSignIndex+1);
      out.write(".OpenSignature()){alert(document.all.incSig");
      out.print(maxHandSignIndex+1);
      out.write(".Status);}\"  value=\"签章\">\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t");
}
      out.write("\r\n\t\t\t");
//if(signatureInUse==1){
			if(false){
			
      out.write("\r\n\t\t\t\t<!-- 电子签章 -->\r\n\t\t\t\t<tr id=\"signTb3\" style=\"display:none\">\r\n\t\t\t\t\t    <td width=\"90%\" height=\"10\">\r\n\t\t\t\t\t\t    <div id=\"signPosi_");
      out.print(inc_divId+"0000");
      out.write("\" style='position:absolute;width:100%;");
if(!BrowserJudge.isMSIE11(request)){
      out.write("height:100%;");
}
      out.write("'></div>\r\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"include_signcomment\" value=\"");
      out.print(inc_divId+"0000");
      out.write("\">\r\n\t\t\t\t\t\t</td>\t\t\t\t\t\t\r\n\t\t\t\t</tr>\r\n\t\t\t");
}
      out.write("\r\n\t\t\t\r\n\t\t\t<tr>\r\n\t\t   <td height=\"26\" colspan=\"2\" align=\"right\">\r\n\t\t\t<input type=\"hidden\" name=\"commentSignType\" value=\"0\"><!-- 用户选择的批示类型 -->\r\n\t\t\t");
      out.write("\r\n\t\t\t<div align=\"right\" style=\"clear:both;\" >");
      out.print(writeUserSignature+"("+nowTime+")");
      out.write("</div>\r\n\t\t </td>\r\n\t\t</tr>\t  \r\n    </table>\r\n\r\n    ");

	}
}

      out.write("\r\n\r\n\r\n\r\n");
if(signatureInUse==1){
      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');
}
      out.write("\r\n\r\n<script language=\"javascript\">\r\n//增加批示字段对应意见到指定位置 \r\n");
if(request.getAttribute("curCommField")!=null && !"-1".equals(request.getAttribute("curCommField")) && request.getAttribute("curCommField").toString().trim().length()>0 && !request.getAttribute("curCommField").toString().toUpperCase().equals("NULL") && (_inWorkStatus==0 || _inWorkStatus==2)){
      out.write("\r\nvar divArr = document.getElementsByTagName(\"div\");\r\nvar useDivArr = 0;\r\nif(divArr.length){\r\n    for(var i=0;i<divArr.length;i++){\r\n        //1000980-js$f1631\r\n\r\n        if(divArr[i].id.indexOf(\"-\")>=1 && divArr[i].id.indexOf(\"-\")!=(divArr[i].id.length-1) && (\"");
      out.print(request.getAttribute("curCommField").toString());
      out.write("\".indexOf(\"$\"+divArr[i].id.split(\"-\")[1]+\"$\")>=0 || \"");
      out.print(request.getAttribute("curCommField").toString());
      out.write("\" == divArr[i].id.split(\"-\")[1]) ){\r\n            \r\n            /*if(divArr[i].innerHTML.indexOf(\"<\")==0 ){\r\n                divArr[i].innerHTML=\"\";\r\n            }*/\r\n\t\t\t");

				String SignatureId1 = new java.util.Date().getTime() + "";
            
      out.write("\r\n\t\t\t\t//复合三种审批方式\r\n\t\t\t\t//普通\r\n\t\t\t\tdivArr[i].innerHTML+=\r\n\t\t\t\t\t\"<div id='signTb1' style='display:'>\"+\r\n\t\t\t\t\t\"<div align='right' style=\\\"width:98%;\\\">&nbsp;&nbsp;&nbsp;<a href=\\\"javascript:;\\\" onClick=\\\"getNote(");
if(BrowserJudge.isFirefox(request)){
      out.write("event");
}
      out.write(");\\\" onmouseout=\\\"hiddenNote();\\\" onmouseover=\\\"lockedNote();\\\">常用语</a></div>\"+ \r\n\t\t\t\t\t\"<div id=\\\"noteDiv\\\" style=\\\"right:15px;\\\" value=\"+divArr[i].id.split(\"-\")[1]+\" onmouseout=\\\"hiddenNote();\\\" onmouseover=\\\"lockedNote();\\\">\"+\r\n\t\t\t\t\t");

					  if(officelist!=null&&officelist.size()>0){
					   for(int i=0;i<officelist.size();i++){
						 String offContent=""+officelist.get(i);
      out.write("\r\n\t\t\t\t\t\t  \"<div class=\\\"divOut\\\" onmouseover=\\\"lockedNote();this.className='divOver'\\\" onmouseout=\\\"this.className='divOut'\\\" onclick=\\\"include_set_comment(this,'\"+divArr[i].id.split(\"-\")[1]+\"')\\\">");
      out.print(offContent);
      out.write("</div>\"+\r\n\t\t\t\t\t   \r\n\t\t\t\t\t   ");
}
					}
					
      out.write("\t\t\t\r\n\t\t\t\t\t");
      out.write("\"</div>\"+\r\n\t\t\t\t\t\"<div><textarea name=\\\"\"+divArr[i].id.split(\"-\")[1]+\"\\\"  id=\\\"\"+divArr[i].id.split(\"-\")[1]+\"\\\"  Class=\\\"inputTextarea\\\" rows='6' style=\\\"width:98%;\\\" onblur=\\\"include_checkTextArea(this,'办理意见',2000);\\\"></textarea>&nbsp;</div></div>\";\r\n\r\n\t\t\t\t//手写\r\n\t\t\t  ");

			  if(false){
				  String curHandSignType=new com.js.oa.jsflow.service.ActivityBD().getActivityHandSignType(request.getParameter("activity"));
				  realSignHeight=("0".equals(curHandSignType))?userSignHeight:publicSignHeight;
			  
      out.write("\r\n\t\t\t\tdivArr[i].innerHTML += \r\n\t\t\t\t\t\"<div id='signTb2' style='display:none'>\"+\r\n\t\t\t\t\t\"<div style='text-align:right;'><input type='button' class=btnButton2font onclick=\\\"if (!\"+divArr[i].id.split(\"-\")[1]+\"_SendOut.OpenSignature()){alert(\"+divArr[i].id.split(\"-\")[1]+\"_SendOut.Status);}\\\" value='签章' />&nbsp;</div>\"+\r\n\t\t\t\t\t\"<div>\"+\r\n\t\t\t\t\t\"<OBJECT name=\\\"\"+divArr[i].id.split(\"-\")[1]+\"_SendOut\\\" classid=\\\"clsid:2294689C-9EDF-40BC-86AE-0438112CA439\\\" codebase=\\\"/jsoa/iWebRevision.jsp/iWebRevision.cab#version=6,0,0,0\\\" width=\\\"100%\\\" height=\\\"");
      out.print(realSignHeight);
      out.write("\\\">\"\r\n                \t\t\t+\"<param name=\\\"weburl\\\" value=\\\"http://");
      out.print(request.getServerName());
      out.write(':');
      out.print(request.getServerPort());
      out.write("/jsoa/iWebRevision.jsp/iWebServer.jsp\\\">\"\r\n            \t\t\t\t+\"<param name=\\\"recordid\\\" value=\\\"");
      out.print(SignatureId1);
      out.write("\"+i+\"\\\">\"\r\n                \t\t\t+\"<param name=\\\"fieldname\\\" value=\\\"SendOut\\\">\"\r\n                \t\t\t+\"<param name=\\\"username\\\" value=\\\"");
      out.print(session.getAttribute("userName"));
      out.write("\\\">\"\r\n                \t\t\t+\"<param name=\\\"Enabled\\\" value=\\\"1\\\">\"\r\n               \t \t\t\t+\"<param name=\\\"PenColor\\\" value=\\\"00000000\\\">\"\r\n                \t\t\t+\"<param name=\\\"BorderStyle\\\" value=\\\"0\\\">\"\r\n                \t\t\t+\"<param name=\\\"EditType\\\" value=\\\"0\\\"><param name=\\\"PenWidth\\\" value=\\\"1\\\">\"\r\n                            +\"<Param Name=\\\"ShowScale\\\" value=\\\"50\\\">\"\r\n                            +\"<param name=\\\"ShowUserListMenu\\\" value=\\\"false\\\">\"\r\n            \t\t\t\t+\"</OBJECT>\"\r\n            \t\t\t\t+\"<input type=\\\"hidden\\\" name=\\\"\"+divArr[i].id.split(\"-\")[1]+\"\\\" value=\\\"");
      out.print(SignatureId1);
      out.write("\"+i+\"\\\"></div>\"+\r\n\t\t\t\t\t\"</div></div>\";\r\n\t\t\t ");
}
      out.write("\r\n\t\t\t ");
if(false){
      out.write("\r\n\t\t\t\t//电子签章\r\n\t\t\t\tdivArr[i].innerHTML += \r\n\t\t\t\t\t\"<div id='signTb3' style='position:relative;width:100%;height:1px;' style='display:none'>\"+\r\n\t\t\t\t\t\t//\"<div valign=bottom align=\\\"right\\\"></div>&nbsp;\"+\r\n\t\t\t\t\t\t\"<div id=\\\"signPosi_");
      out.print(inc_divId+"0000");
      out.write("\\\" style=\\\"position:absolute;width:100%;");
if(!BrowserJudge.isMSIE11(request)){
      out.write("height:100%;");
}
      out.write("\\\"><div valign=bottom align=\\\"right\\\"><input type=\\\"hidden\\\" name=\\\"include_signcomment\\\" id=\\\"include_signcomment\\\" value=\\\"");
      out.print(inc_divId+"0000");
      out.write("\\\"></div>\"+\r\n\t\t\t\t\t\"</div>\";\r\n\t\t\t ");
}
      out.write("\r\n\t\t\t\tdivArr[i].innerHTML += \r\n\t\t\t\t\t\"<div align=\\\"right\\\"><input type=\\\"hidden\\\" name=\\\"commentSignType\\\" id=\\\"commentSignType\\\" value=\\\"0\\\">\"+\r\n\t\t\t\t\t\"");
if(false){
      out.write("<a href=\\\"javascript:;\\\" onClick=\\\"changeSignTypeArr('0',\"+useDivArr+\");\\\">普通</a>&nbsp;");
}
if(false){
      out.write("<a href=\\\"javascript:;\\\"\"+ \"onClick=\\\"changeSignTypeArr('1',\"+useDivArr+\");\\\">手写签批</a>&nbsp;");
}if(false){
      out.write("<a href=\\\"javascript:;\\\" onClick=\\\"changeSignTypeArr('2',\"+useDivArr+\");include_signature();\\\">盖章</a>&nbsp;<a href=\\\"javascript:;\\\" onClick=\\\"changeSignTypeArr('2',\"+useDivArr+\");include_signature2();\\\">签字</a>&nbsp;");
}
      out.write("</div>\";\r\n\t\t\t\tdivArr[i].innerHTML += \"<div align=\\\"right\\\">");
      out.print(writeUserSignature+"("+nowTime+")");
      out.write("</div>\";\r\n\t\t\t\tuseDivArr ++;\t\t\t\t\r\n        }\r\n    }\r\n}\r\n");
}
      out.write("\r\n\r\n\r\nfunction changeSignTypeArr(type, i){\r\n\tif(document.all.commentSignType.length){\r\n\t\tif(type=='0'){\r\n\t\t\tif(document.all.signTb1 && document.all.signTb1[i]){\r\n\t\t\t\tdocument.all.signTb1[i].style.display=\"\";\r\n\t\t\t}\r\n\t\t\tif(document.all.signTb2 && document.all.signTb2[i]){\r\n\t\t\t\tdocument.all.signTb2[i].style.display=\"none\";\r\n\t\t\t}\r\n\t\t\tif(document.all.signTb3 && document.all.signTb3[i]){\r\n\t\t\t\tdocument.all.signTb3[i].style.display=\"none\";\r\n\t\t\t}\r\n\t\t} else if(type=='1'){\r\n\t\t\tif(winZoomSize>1){\r\n\t\t\t\talert(\"您的浏览器目前处于缩放状态比例为\"+winZoomSize+\"的放大状态，\\n这将导致页面显示不正常！\\n请按键盘“CTRL+数字0”组合键恢复初始状态！\");\r\n\t\t\t}else if(winZoomSize<1){\r\n\t\t\t\talert(\"您的浏览器目前处于缩放状态比例为\"+winZoomSize+\"的缩小状态，\\n这将导致页面显示不正常！\\n请按键盘“CTRL+数字0”组合键恢复初始状态！\");\t\r\n\t\t\t}else{\t\t\r\n\t\t\t\tif(document.all.signTb2 && document.all.signTb2[i]){\r\n\t\t\t\t\tdocument.all.signTb2[i].style.display=\"\";\r\n\t\t\t\t}\r\n\t\t\t\tif(document.all.signTb1 && document.all.signTb1[i]){\r\n\t\t\t\t\tdocument.all.signTb1[i].style.display=\"none\";\r\n\t\t\t\t}\r\n\t\t\t\tif(document.all.signTb3 && document.all.signTb3[i]){\r\n\t\t\t\t\tdocument.all.signTb3[i].style.display=\"none\";\r\n");
      out.write("\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if(type=='2'){\r\n\t\t\tif(document.all.signTb3 && document.all.signTb3[i]){\r\n\t\t\t\tdocument.all.signTb3[i].style.display=\"\";\r\n\t\t\t}\r\n\t\t\tif(document.all.signTb1 && document.all.signTb1[i]){\r\n\t\t\t\tdocument.all.signTb1[i].style.display=\"none\";\r\n\t\t\t}\r\n\t\t\tif(document.all.signTb2 && document.all.signTb2[i]){\r\n\t\t\t\tdocument.all.signTb2[i].style.display=\"none\";\r\n\t\t\t}\r\n\t\t}\r\n\t\t/*document.all.commentSignType[i].value = type;\r\n\t\t//判断电子签章选项\r\n\t\tif(!document.all.signTb2 && type=='2'){\r\n\t\t\tdocument.all.commentSignType[i].value = 1;\r\n\t\t}*/\r\n\t\t\r\n\t\tif(type!='2'){\r\n\t\t\tdocument.all.commentSignType[i].value = type;\r\n\t\t}\r\n\t} else{\r\n\t\tchangeSignType(type);\r\n\t}\r\n}\r\n\r\nfunction changeSignType(type){\r\n\tif(type=='0'){\r\n\t\tif(document.all.signTb1){\r\n\t\t\tdocument.all.signTb1.style.display=\"\";\r\n\t\t}\r\n\t\tif(document.all.signTb2){\r\n\t\t\tdocument.all.signTb2.style.display=\"none\";\r\n\t\t}\r\n\t\t/*if(document.all.signTb3){\r\n\t\t\tdocument.all.signTb3.style.display=\"none\";\r\n\t\t}*/\r\n\t} else if(type=='1'){\r\n\t\t\r\n\t\tvar winZoomSize=1;\r\n\t\ttry{\r\n\t\t\twinZoomSize=ZoomHint.ZoomValue;\r\n");
      out.write("\t\t}catch(e){\r\n\t\t\twinZoomSize=1;\r\n\t\t}\t\t\r\n\t\t\r\n\t\tif(winZoomSize>1){\r\n\t\t\talert(\"您的浏览器目前处于缩放状态比例为\"+winZoomSize+\"的放大状态，\\n这将导致页面显示不正常！\\n请按键盘“CTRL+数字0”组合键恢复初始状态！\");\r\n\t\t}else if(winZoomSize<1){\r\n\t\t\talert(\"您的浏览器目前处于缩放状态比例为\"+winZoomSize+\"的缩小状态，\\n这将导致页面显示不正常！\\n请按键盘“CTRL+数字0”组合键恢复初始状态！\");\t\r\n\t\t}else{\r\n\t\t\tif(document.all.signTb2){\r\n\t\t\t\tdocument.all.signTb2.style.display=\"\";\r\n\t\t\t}\r\n\t\t\tif(document.all.signTb1){\r\n\t\t\t\tdocument.all.signTb1.style.display=\"none\";\r\n\t\t\t}\r\n\t\t\t/*if(document.all.signTb3){\r\n\t\t\t\tdocument.all.signTb3.style.display=\"none\";\r\n\t\t\t}*/\r\n\t\t}\r\n\t} else if(type=='2'){\r\n\t\tif(document.all.signTb3){\r\n\t\t\tdocument.all.signTb3.style.display=\"\";\r\n\t\t}\r\n\t\t/*if(document.all.signTb1){\r\n\t\t\tdocument.all.signTb1.style.display=\"none\";\r\n\t\t}\r\n\t\tif(document.all.signTb2){\r\n\t\t\tdocument.all.signTb2.style.display=\"none\";\r\n\t\t}*/\r\n\t}\r\n\t/*document.all.commentSignType.value = type;\r\n\t//判断电子签章选项\r\n\tif(!document.all.signTb2 && type=='2'){\r\n\t\tdocument.all.commentSignType.value = 1;\r\n\t}*/\r\n\t\r\n\tif(type!='2'){\r\n\t\tdocument.all.commentSignType.value = type;\r\n");
      out.write("\t}\r\n\t\r\n}\r\n\r\n\r\nfunction changeSignature(name,type){\r\n\tif(eval(\"document.all.\"+name+\".EditType\") == 0){\r\n        \t//手写变键盘\r\n        \teval(\"document.all.\"+name).EditType = 1;\r\n            eval(\"document.all.signatureHref\"+name).innerHTML = \"切换手写\";\r\n        }else{\r\n        \t//键盘变手写\r\n               eval(\"document.all.\"+name).EditType = 0;\r\n                eval(\"document.all.signatureHref\"+name).innerHTML = \"切换键盘\";\r\n        }\r\n}\r\n\r\nfunction include_checkTextArea(obj, tmp, len){\r\n    if(obj.value.length > len){\r\n        alert(tmp + \"不能超过\" + len + \"字！\");\r\n        obj.focus();\r\n    }\r\n}\r\n\r\nfunction include_offiDict(userId, field){\r\n    JSMainWinOpen('/jsoa/jsflow/workflow_offiDict.jsp?userId=' + userId + '&textAreaName=' + field,'','menubar=0,scrollbars=yes,locations=0,width=400,height=200,resizable=yes');\r\n}\r\n\r\nfunction include_set_comment(obj,commentName){\r\n\tvar val=obj.value==null?obj.innerHTML:obj.value;\r\n\tvar cobj=eval(\"document.all.\"+commentName);\r\n\t//cobj.value=cobj.value+val;\r\n\tif(cobj.length){\r\n\t\tcobj[0].value=val;\r\n");
      out.write("\t} else{\r\n\t\tcobj.value=val;\r\n\t}\r\n}\r\n\r\nfunction addDivContent(){\r\n\tvar adddivcontent=document.all.addDivContent.value;\r\n\tvar comment=document.getElementById(\"noteDiv\").getAttribute(\"value\");\r\n\tdocument.getElementById(\"noteDiv\").innerHTML= \"\"+\"<div class='divOut' onmouseover='lockedNote();this.className=\\\"divOver\\\"' onmouseout='this.className=\\\"divOut\\\"' onclick=\\\"include_set_comment(this,\\'\"+comment+\"\\');\\\">\"+adddivcontent+\"<\\/div>\"+document.getElementById(\"noteDiv\").innerHTML;\r\n}\r\n\r\n//电子签章\r\nvar wnd;\r\n//作用：进行甲方签章\r\nfunction include_signature() {\r\n\t\r\n}\r\n\r\n//作用：进行手写签名\r\nfunction include_signature2() {\r\n\t\r\n}\r\n\r\n");
if(false){
      out.write("\r\ntry{\r\n\tdocument.all.SignatureControl.ShowSignature('");
      out.print(request.getParameter("record"));
      out.write("');\r\n}catch(e){\r\n}\r\n");
}
      out.write("\r\n</script>\r\n");

//if(!"1".equals(request.getParameter("printFlag")+"")){
if(false){	// 微信中不引用判断浏览器缩放的js
	
      out.write("\r\n\t<script src=\"/jsoa/skin/zoom/ZoomDetect.js\"></script>\r\n\t");

}

    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
