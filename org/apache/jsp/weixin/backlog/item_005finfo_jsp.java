/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 09:58:23 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.weixin.backlog;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.doc.doc.service.ReceiveFileBD;
import com.js.doc.doc.po.GovReceiveFilePO;
import com.wiscom.ldapvalidate.jsende;
import com.js.doc.doc.po.GovDocumentSendFilePO;
import com.js.doc.doc.service.SendFileBD;
import com.js.oa.info.infomanager.service.InformationBD;
import java.net.URLEncoder;
import java.util.*;
import java.text.SimpleDateFormat;
import com.js.oa.scheme.worklog.po.WorkLogPO;
import com.js.util.util.DateHelper;
import com.js.wap.util.WapUtil;
import com.js.wap.bean.WorkDealWithBean;
import com.js.oa.jsflow.po.WFWorkPO;
import com.js.lang.Resource;
import com.js.util.config.SystemCommon;

public final class item_005finfo_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.wiscom.ldapvalidate.jsende");
    _jspx_imports_classes.add("com.js.oa.info.infomanager.service.InformationBD");
    _jspx_imports_classes.add("com.js.oa.scheme.worklog.po.WorkLogPO");
    _jspx_imports_classes.add("com.js.wap.util.WapUtil");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("com.js.doc.doc.po.GovReceiveFilePO");
    _jspx_imports_classes.add("java.text.SimpleDateFormat");
    _jspx_imports_classes.add("com.js.doc.doc.service.SendFileBD");
    _jspx_imports_classes.add("com.js.doc.doc.service.ReceiveFileBD");
    _jspx_imports_classes.add("com.js.doc.doc.po.GovDocumentSendFilePO");
    _jspx_imports_classes.add("java.net.URLEncoder");
    _jspx_imports_classes.add("com.js.lang.Resource");
    _jspx_imports_classes.add("com.js.util.util.DateHelper");
    _jspx_imports_classes.add("com.js.wap.bean.WorkDealWithBean");
    _jspx_imports_classes.add("com.js.oa.jsflow.po.WFWorkPO");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- \r\n\r\n【已发退回】流程信息显示目前添加在WorkDealWithBean.java【mainFileURL.indexOf(\"WorkFlowReSubmitAction.do\")>0】\r\n微信端添加流程发送功能时，重新确定已取消流程的重新发送功能。\r\n\r\n -->\r\n");

request.setCharacterEncoding("UTF-8");

String type = request.getParameter("type");
String path = request.getContextPath();

String localhi = session.getAttribute("org.apache.struts.action.LOCALE").toString();
String pageKey=String.valueOf(new java.util.Date().getTime());
String workId = "";
String beginIndex = "0";
String status = "";
String isMessage = null!=request.getParameter("message") ? request.getParameter("message") : "";
if(request.getParameter("workId") != null){
	workId = request.getParameter("workId");
	session.setAttribute("workId",workId);
}else{
	workId = session.getAttribute("workId").toString();
}
if(request.getParameter("beginIndex") != null){
	beginIndex = request.getParameter("beginIndex");
	session.setAttribute("beginIndex", beginIndex);
}else{
	beginIndex = null!=session.getAttribute("beginIndex") ? session.getAttribute("beginIndex").toString() : "0";
}
if(request.getParameter("status") != null){
	status = request.getParameter("status");
	session.setAttribute("status", status);
}else{
	status = null!=session.getAttribute("status") ? session.getAttribute("status").toString() : "";
}
String workStatus = null!=request.getParameter("workStatus") ?  request.getParameter("workStatus") : "";
//我的待办
String op="dbsx";
if("2".equals(status)){
	//我的待阅
	op="dysx";
}else if("101".equals(status)){
	//已办事项
	op="ybsx";
}else if("102".equals(status)){
	//已阅事项
	op="yysx";
} 
String wechatShowDoc="";
String wechatShowDoc1="";
if(request.getParameter("wechatShowDoc")!=null){
	if("receive".equals(request.getParameter("wechatShowDoc"))){
		op="dbsx102";
	}else{
		op="dbsx101";
	}
	wechatShowDoc="&wechatShowDoc="+request.getParameter("wechatShowDoc");
	wechatShowDoc1="?wechatShowDoc="+request.getParameter("wechatShowDoc");
}
if("1".equals(workStatus)){
	//已发在办
	op="yfzb";
}else if("100".equals(workStatus)){
	//已发办结
	op="yfbj";
}else if("-1".equals(workStatus)){
	//已发退回
	op="yfth";
}else if("-2".equals(workStatus)){
	//已发取消
	op="yfqx";
}
String from = null!=request.getParameter("from") ? request.getParameter("from") : "";
String url="/jsoa/weixin/backlog/item_info.jsp?workId="+workId+"&beginIndex="+beginIndex+"&from="+from+"&status="+status+wechatShowDoc;
WorkDealWithBean bean = new WorkDealWithBean();
Map itemInfo = bean.getWorkDealWithSimpleInfo(workId);

Map subTable = null;
if(itemInfo != null){
	subTable = (Map) itemInfo.get("subTableInfo");
}

String operId = "",operName = "";
String mainUserType = "100";
String mainNextActivityId = "", mainNextActivityName = "";

WFWorkPO po = (WFWorkPO) itemInfo.get("workPO");

String informationIssueOrg="";
InformationBD informationBD=new InformationBD();
List list=informationBD.getInformationIssueOrg(po.getWorkRecordId().toString());

if(!list.isEmpty()){
	informationIssueOrg=(String)list.get(0);
	
}

String DocumentSendFile_WriteOrg="";
SendFileBD  sendFileBD=new  SendFileBD();
GovDocumentSendFilePO sendFilePO=sendFileBD.get(po.getWorkRecordId().toString());
if(sendFilePO!=null){
	DocumentSendFile_WriteOrg=sendFilePO.getDocumentSendFileWriteOrg();
	if("0".equals(DocumentSendFile_WriteOrg)){
	DocumentSendFile_WriteOrg="";
	}
}
	
String  ReceiveFile_SendFileUnit="";	
ReceiveFileBD receiveFileBD=new ReceiveFileBD();
GovReceiveFilePO receiveFilePO=receiveFileBD.get(po.getWorkRecordId().toString());
if(receiveFilePO!=null){
	ReceiveFile_SendFileUnit=receiveFilePO.getReceiveFileSendFileUnit();	
	
}
com.js.oa.jsflow.service.WorkFlowBD workFlowBD = new com.js.oa.jsflow.service.WorkFlowBD();
String activityClass = itemInfo.get("activityClass")==null ? "" : itemInfo.get("activityClass").toString();
String curCommField = itemInfo.get("curCommField")==null ? "" : itemInfo.get("curCommField").toString();
String opinionMust = itemInfo.get("opinionMust")==null ? "0" : itemInfo.get("opinionMust").toString();
String actiCommFieldType = itemInfo.get("actiCommFieldType")==null ? "0" : itemInfo.get("actiCommFieldType").toString();
//2016-12-17 增加阅件批示意见字段的判断
String curPassRoundCommField = itemInfo.get("curPassRoundCommField")==null ? "" : itemInfo.get("curPassRoundCommField").toString();

//记录接收待办时间
com.js.oa.jsflow.vo.WorkLogVO workLogVO = new com.js.oa.jsflow.vo.WorkLogVO();
workLogVO.setSendUserId(session.getAttribute("userId").toString());
workLogVO.setSendUserName(session.getAttribute("userName").toString());
workLogVO.setSendAction(com.js.oa.weixin.common.util.WorkflowForWeiXinUtil.decordStr(po.getWorkCurStep()+"签收"));
workLogVO.setReceiveUserName(" ");
workLogVO.setProcessId(po.getWorkProcessId().toString());
workLogVO.setTableId(po.getWorkTableId().toString());
workLogVO.setRecordId(po.getWorkRecordId().toString());
workLogVO.setDomainId(session.getAttribute("domainId").toString());
new com.js.oa.jsflow.service.WorkFlowButtonBD().setWorkViewedDate(workId, workLogVO);

String loginType = null!=session.getAttribute("loginType") ? session.getAttribute("loginType").toString() : "";
String showDoc = request.getParameter("showDoc")!=null && "doc".equals(request.getParameter("showDoc")) ? "&showDoc=doc" : "";
List<String[]> buts = new ArrayList<String[]>();

String formName = "frm";
String saveCheckFn = "initPara()";//保存时校验表单的javascript函数名称
String beforeSubmit = "";

      out.write("\r\n<!DOCTYPE HTML>\r\n<HTML>\r\n\t<HEAD>\r\n\t\t<TITLE>工作处理</TITLE>\r\n\t\t<META content=\"text/html; charset=UTF-8\" http-equiv=Content-Type>\r\n\t\t<META name=viewport content=\"width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=1;\"> \r\n\t\t\r\n\t\t<META name=\"apple-touch-fullscreen\" content=\"YES\">\r\n\t\t<META name=\"apple-mobile-web-app-capable\" content=\"no\">\r\n\t\t<META name=GENERATOR content=\"MSHTML 8.00.6001.19154\">\r\n\t\t\r\n\t\t<script type='text/javascript' src='/jsoa/workflow/dwr/interface/workflowSync.js'></script>\r\n\t\t<script type='text/javascript' src='/jsoa/workflow/dwr/engine.js'></script>\r\n\t\t<script type=\"text/javascript\" src=\"/jsoa/js/checkText.js\"></script>\r\n\t\t\r\n\t\t<script type=\"text/javascript\" src=\"/jsoa/js/weixin/mobiscroll/js/jquery-1.9.1.min.js\" ></script>\r\n\t\t<script type=\"text/javascript\" src=\"/jsoa/js/weixin/standardModiForWeiXin.js\" ></script>\r\n\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/wap2/commonImport.jsp", out, false);
      out.write("\r\n\t\t<SCRIPT language=\"JavaScript\">\r\n\t\tfunction init(){\r\n\t\t    var backUrl = \"");
      out.print(path);
      out.write("/login.jsp?action=logout\";\r\n\t\t    setTimeout(scrollTo, 100, 0, 1);\r\n\t\t}\r\n\t\t\r\n\t\tfunction gotoPage(url, flag){\r\n\t\t    if(flag){\r\n\t\t        location.href = encodeURI(url);\r\n\t\t    }\r\n\t\t}\r\n\t\t\r\n\t\tfunction findParent(node, localName){\r\n\t\t\twhile (node && (node.nodeType != 1 || node.localName.toLowerCase() != localName))\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\treturn node;\r\n\t\t}\r\n\t\t\r\n\t\tfunction checkOnlineUser(){\r\n\t\t\tvar url = encodeURI(\"");
      out.print(path);
      out.write("/common/checkOnlineUser.jsp\");\r\n\t\t\tvar resulthtml = XmlHttpHelper.transmit(false, \"get\", \"text\", url, null, null);\r\n\t\t\tvar result = resulthtml.replace(/\\r|\\n/gm,'');\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\t\r\n\t\tfunction displaySearch(flag){\r\n\t\t    if(flag == 1){\r\n\t\t        document.all.dd.style.display = \"none\";\r\n\t\t        document.all.search.style.display = \"\";\r\n\t\t    }else{\r\n\t\t        document.all.dd.style.display = \"\";\r\n\t\t        document.all.search.style.display = \"none\";\r\n\t\t    }\r\n\t\t}\r\n\t\t\r\n\t\t//选择下一步\r\n\t\tfunction submitForm(){\r\n\t\t\tdocument.frm.action = \"");
      out.print(path);
      out.write("/weixin/backlog/item_select_act.jsp");
      out.print(wechatShowDoc1);
      out.write("\";\t\r\n\t\t\tdocument.frm.submit();\r\n\t\t}\r\n\t\t//退回\r\n\t\tfunction backForm(){\t\r\n\t\t\tdocument.frm.action = \"");
      out.print(path);
      out.write("/weixin/backlog/item_select_act_back.jsp");
      out.print(wechatShowDoc1);
      out.write("\";\r\n\t\t\tdocument.frm.submit();\r\n\t\t}\r\n\t\t//转办\r\n\t\tfunction transAction(){\r\n\t\t\tdocument.frm.action = \"");
      out.print(path);
      out.write("/weixin/backlog/item_trans_selectemp.jsp");
      out.print(wechatShowDoc1);
      out.write("\";\r\n\t\t\tdocument.frm.submit();\r\n\t\t}\r\n\t\t//办理完毕\r\n\t\tfunction endCurrStep(){\r\n\t\t\tdocument.frm.action = \"");
      out.print(path);
      out.write("/weixin/backlog/item_endcurrentstep.jsp");
      out.print(wechatShowDoc1);
      out.write("\";\r\n\t\t\tdocument.frm.submit();\r\n\t\t}\r\n\t\t//办理完毕自动返回\r\n\t\tfunction endAutoReturn(){\r\n\t\t\tdocument.frm.action = \"");
      out.print(path);
      out.write("/weixin/backlog/item_select_act_back.jsp");
      out.print(wechatShowDoc1);
      out.write("\";\r\n\t\t\tdocument.frm.submit();\r\n\t\t}\r\n\t\t//作废\r\n\t\tfunction deleteItem(){\r\n\t\t\tdocument.frm.action = \"");
      out.print(path);
      out.write("/weixin/backlog/item_submit_delete.jsp");
      out.print(wechatShowDoc1);
      out.write("\";\r\n\t\t\tdocument.frm.submit();\r\n\t\t}\r\n\t\tfunction quitToList(){\r\n\t\t\tlocation.href = \"");
      out.print(path );
      out.write("/weiXinBacklogAction.do?action=list&status=");
      out.print(status );
      out.write("&beginIndex=");
      out.print(beginIndex+showDoc+wechatShowDoc );
      out.write("\";\r\n\t\t}\r\n\t\t");
if(SystemCommon.getCustomerName().equals("zcl")){
      out.write("\r\n\t\t\tfunction closeWindow(){\r\n\t\t\t\twindow.history.back();\r\n\t\t\t}\r\n\t\t\tfunction loadURL(){\r\n\t\t\t\tvar jumpflag=document.getElementById(\"jumpflag\").value;\r\n\t\t\t\tif(jumpflag!=null && jumpflag!=\"\"){\r\n\t\t\t\t   window.location.href = '");
      out.print(url);
      out.write("';\r\n\t\t\t\t}else{\r\n\t\t\t\t\twindow.history.back();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t   ");
}
      out.write("\r\n\t\tfunction viewContent(fileName){\r\n\t\t\t  document.getElementById(\"jumpflag\").value=\"1\";\r\n\t\t      var path=\"govdocumentmanager\";\r\n\t\t      if(fileName == \"\"){\r\n\t\t\t      weixinMessageReminder('alert', '提示：', '公文不存在或被删除');\r\n\t\t\t      return ;\r\n\t\t\t   }\r\n\t\t\t   showHtmlObject(fileName, \"0\",path);\r\n\t\t  }\r\n\t\t</SCRIPT>\r\n\t\t<style type=\"text/css\">\r\n\t\t* { padding: 0; margin: 0;}\r\n\t\t.nextStep{\r\n      \t \tdisplay: none;\r\n       \t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t\tposition: fixed;\r\n\t\t\ttop: 0;\r\n\t\t\tleft: 0;\r\n\t\t\tz-index: 10000;\r\n\t\t\toverflow-y: auto;\r\n\t\t}\r\n\t\t</style>\r\n\t</HEAD>\r\n\t");

	String backEvent = "javascript:closeWindow();";
	if("wap".equals(loginType)){
		backEvent = "javascript:loadURL('"+op+"');";
	}
	System.out.println(backEvent);
	
      out.write("\r\n\t<body onload=\"init();setHeader('");
      out.print(backEvent );
      out.write("','工作处理');\" class=\"paddingTop\">\r\n\t\t");

		if("wap".equals(loginType)){
			
      out.write("\r\n\t\t\t<div id=\"mainpage_navdiv\" class=\"top\" >\r\n\t\t    \t<a id=\"mainpage_backurl\" href=\"");
      out.print(backEvent );
      out.write("\">\r\n\t\t    \t\t<img width=\"20\" height=\"15\" src=\"/jsoa/wap2/images/topfh.png\" style=\"margin-top: 14px;\">\r\n\t\t    \t</a>\r\n\t\t    \t<p id=\"mainpage_title\">工作处理</p>\r\n\t    \t</div>\r\n\t\t\t");

		}
		
      out.write("\r\n\t\t<div id=\"formBody\" class=\"form\" style=\"padding-bottom: 80px; padding-top: 40px;\">\r\n\t\t\t<form name=\"frm\" action=\"\" method=\"post\">\r\n\t\t\t\t<input type=\"hidden\" name=\"formName\" id=\"formName\" value=\"");
      out.print(formName );
      out.write("\">\r\n\t\t\t\t<input type=\"hidden\" id=\"saveCheckFn\" name=\"saveCheckFn\" value=\"");
      out.print(saveCheckFn);
      out.write("\">\r\n\t\t\t\t<input type=\"hidden\" id=\"backto\" name=\"backto\" value=\"\">\r\n\t\t\t\t<input type=\"hidden\" id=\"field10\" name=\"field10\" value=\"0\">\r\n\t\t\t\t<input type=\"hidden\" id=\"sendFileDepartWord\" name=\"sendFileDepartWord\"><!-- 机关代字 -->\r\n\t\t\t\t<input type=\"hidden\" id=\"documentSendFileByteNumber\" name=\"documentSendFileByteNumber\"><!-- 文号 -->\r\n\t\t\t\t<input type=\"hidden\" id=\"documentSendFileTitle\" name=\"documentSendFileTitle\"><!-- 标题 -->\r\n\t\t\t\t<input type=\"hidden\" id=\"sendFilePoNumId\" name=\"sendFilePoNumId\">\r\n\t\t\t\t<input type=\"hidden\" id=\"field2\" name=\"field2\">\r\n\t\t\t\t\r\n\t\t\t\t<input type=\"hidden\" name=\"informationIssueOrg\" id=\"informationIssueOrg\" value=\"");
      out.print(informationIssueOrg);
      out.write("\"><!-- 新闻公告知识 -->\r\n\t\t\t\t<input type=\"hidden\" name=\"DocumentSendFile_WriteOrg\" id=\"DocumentSendFile_WriteOrg\" value=\"");
      out.print(DocumentSendFile_WriteOrg);
      out.write("\"><!--  发文拟文发文表-->\r\n\t\t\t\t<input type=\"hidden\" name=\"documentSendFileWriteOrg\" id=\"documentSendFileWriteOrg\" value=\"");
      out.print( DocumentSendFile_WriteOrg);
      out.write("\"/><!-- 发文 拟稿自建表-->\r\n\t\t\t\t<input type=\"hidden\" name=\"ReceiveFile_SendFileUnit\" id=\"ReceiveFile_SendFileUnit\" value=\"");
      out.print( ReceiveFile_SendFileUnit);
      out.write("\"/><!--  收文里的来文单位-->\r\n\t\t\t\t<input type=\"hidden\" name=\"receiveFileSendFileUnit\" id=\"receiveFileSendFileUnit\" value=\"");
      out.print( ReceiveFile_SendFileUnit);
      out.write("\"/><!--  收文里的来文单位-->\r\n\t\t\t\t\r\n\t\t\t\t<!-- 页面跳转url -->\r\n\t\t\t\t<input type=\"hidden\" id=\"url\" name=\"url\" value=\"");
      out.print(url);
      out.write("\">\r\n\t\t\t\t<input type=\"hidden\" id=\"jumpflag\" name=\"jumpflag\" value=\"\">\r\n\t\t\t\t\r\n\t\t\t\t");

				if(null != itemInfo){ 
					SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm");	
					
      out.write("\r\n\t\t\t\t\t<input type=\"hidden\" name=\"message\" value=\"");
      out.print(isMessage );
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"actiCommFieldType\" value=\"");
      out.print(actiCommFieldType);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"opinionMust\" value=\"");
      out.print(opinionMust);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"workId\" name=\"workId\" value=\"");
      out.print(workId);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"tableId\" value=\"");
      out.print(po.getWorkTableId());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"recordId\" value=\"");
      out.print(po.getWorkRecordId());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"workType\" value=\"");
      out.print(po.getWorkType());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"processId\" name=\"processId\" value=\"");
      out.print(po.getWorkProcessId());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"processName\" value=\"");
      out.print(po.getWorkFileType());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"curActivityId\" value=\"");
      out.print(po.getWorkActivity());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"curActivityName\" value=\"");
      out.print(po.getWorkCurStep());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"submitPerson\" value=\"");
      out.print(po.getWorkSubmitPerson());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"submitPersonId\" value=\"");
      out.print(po.getWfSubmitEmployeeId());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"stepCount\" value=\"");
      out.print(po.getWorkStepCount());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"remindField\" value=\"\"/>\t\r\n\t\t\t\t\t<input type=\"hidden\" name=\"isStandForWork\" value=\"");
      out.print(po.getIsStandForWork());
      out.write("\"/>\t\r\n\t\t\t\t\t<input type=\"hidden\" name=\"standForUserId\" value=\"");
      out.print(po.getStandForUserId());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"standForUserName\" value=\"");
      out.print(po.getStandForUserName());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainLinkFile\" value=\"");
      out.print(po.getWorkMainLinkFile());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"titleFieldName\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"msgFrom\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"inWorkType\" value=\"");
      out.print(po.getWorkType() );
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"submitTime\" value=\"");
      out.print(new SimpleDateFormat("yyyy-MM-dd hh:mm:ss").format(po.getWorkSubmitTime()));
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"submitPersonTime\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"initActivity\" value=\"");
      out.print(po.getInitActivity());
      out.write("\"/>\r\n\t\t\r\n\t\t\t\t\t<!-- 新增表单域 -->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"isSend\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"fromdesktop\" value=\"0\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"operName\" value=\"");
      out.print(operName);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"operId\" value=\"");
      out.print(operId);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainUserType\" value=\"");
      out.print(mainUserType);
      out.write("\"/><!--参与人类型-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainAllowStandFor\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainAllowCancel\" value=\"");
      out.print(po.getWorkAllowCancel() );
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainAllowTransition\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainPressType\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"mainDeadLineTime\" name=\"mainDeadLineTime\" value=\"-1\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"mainPressMotionTime\" name=\"mainPressMotionTime\" value=\"-1\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainNextActivityId\" value=\"");
      out.print(mainNextActivityId);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainNextActivityName\" value=\"");
      out.print(mainNextActivityName);
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"emergence\" name=\"emergence\" value=\"0\"/><!--缓急程度-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"needSendMsg\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"smsContent\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"dealTips\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"processDeadlineDate\" value=\"\"/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!--阅件参数-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"mainNeedPassRound\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"mainPassRoundUserType\" name=\"mainPassRoundUserType\" value=\"100\"/><!--阅件人类型-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"passRoundId\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"passRoundName\" value=\"\"/>\r\n\t\r\n\t\t\t\t\t<!--子流程临时workID-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"subProcTempWorkId\" value=\"\"/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!--催办-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"pressUserId\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"pressUserName\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"pressTitle\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"pressContent\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"pressSMS\" value=\"\"/>\r\n");
      out.write("\t\t\t\t\t\r\n\t\t\t\t\t<!--反馈-->\r\n\t\t\t\t\t<input type=\"hidden\" id=\"feedUserId\" name=\"feedUserId\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"feedUserName\" name=\"feedUserName\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"feedTitle\" name=\"feedTitle\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" id=\"feedContent\" name=\"feedContent\" value=\"\"/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!--转办-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"transitionUser\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"transitionUserName\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"tranType\" value=\"");
      out.print(po.getTranType());
      out.write("\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"tranFromPersonId\" value=\"");
      out.print(po.getTranFromPersonId());
      out.write("\"/>\r\n\t\t\r\n\t\t\t\t\t<!--收回-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"receiveActivityId\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"receiveActivityName\" value=\"\"/>\r\n\t\t\t\t\t<input type=\"hidden\" name=\"receiveUserName\" value=\"\"/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!--阅件-->\r\n\t\t\t\t\t<input type=\"hidden\" id=\"passLinkFile\" name=\"passLinkFile\" value=\"/jsoa/GovSendFileLoadAction.do?action=load\"/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<!--当前节点办理方式 默认 1为多人并行-->\r\n\t\t\t\t\t<input type=\"hidden\" name=\"approveMode\" value=\"0\"/>\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t<input type=\"hidden\" name=\"activityClass\" value=\"");
      out.print(activityClass);
      out.write("\">\r\n\t\t\t\t\t");
if("2".equals(status)){ 
						if(curPassRoundCommField != null && !curPassRoundCommField.equals("") && !"null".equals(curPassRoundCommField)){
      out.write("\r\n\t\t\t\t\t\t<input type=\"hidden\" name=\"include_commField\" value=\"");
      out.print(curPassRoundCommField);
      out.write("\">\r\n\t\t\t\t\t");
  }
					}else{ 
      out.write("\r\n\t\t\t\t\t<input type=\"hidden\" name=\"include_commField\" value=\"");
      out.print(curCommField);
      out.write("\">\r\n\t\t\t\t\t");
} 
      out.write("\r\n\t\t\t\t\t\r\n\t\t\t\t\t<input type=\"hidden\" name=\"showDoc\" value=\"");
      out.print(request.getParameter("showDoc")==null?"":request.getParameter("showDoc") );
      out.write("\">\r\n\t\r\n\t     \t\t\t<div class=\"infoTitle\">");
      out.print(po.getWorkFileType() );
      out.write("</div>\r\n\t     \t\t\t");

			     	//循环显示每一个字段的内容
			     	List<String[]> fieldInfo = (List<String[]>) itemInfo.get("mainTableInfo");
			     	String[] temp;
			     	for(int i=0; i<fieldInfo.size(); i++){
			     		temp = fieldInfo.get(i);
			     		if(temp[1] != null){
				     		if(temp[1].equals("会议室")){
				     		
      out.write(" \t\r\n\t\t\t\t     \t\t<!-- 会议室申请中的会议室名称参数 -->\r\n\t\t\t\t\t\t\t<input type=\"hidden\" id=\"boardroomName\" name=\"boardroomName\" value=\"");
      out.print(temp[6] );
      out.write("\">\r\n\t\t\t\t\t\t\t");
} 
      out.write("\r\n\t\t\t\t     \t\t<div class=\"item\">\r\n\t\t\t\t\t\t\t\t<div class=\"title\">");
      out.print(temp[1] );
      out.write("：</div>\r\n\t\t\t\t\t\t\t\t<div class=\"content\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t");

										String tempString = temp[6]==null ? "" : temp[6];
										if(tempString.indexOf("查看正文") > 0){
											tempString = tempString.substring(tempString.indexOf("href=\"") + 6);
											tempString = tempString.substring(0, tempString.indexOf("\""));
											tempString = tempString.substring(tempString.lastIndexOf("/") + 1);
											
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"javascript:void(0);\" onclick=\"viewContent('");
      out.print(tempString );
      out.write("');\">查看正文</a>\r\n\t\t\t\t\t\t\t\t\t\t\t");

										} else{
											
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t");
      out.print((temp[6]==null ? "" : temp[6]).replace("@@curUser@@",session.getAttribute("userName") + "")
												.replace("@@curOrg@@",session.getAttribute("orgName") + "") );
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t");

										}
										
      out.write("\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t");

						}
			     	}
     				//显示子表
			     	if(subTable!=null && subTable.size()>0){
			     		int fieldCount = 0;
			     		List<String> keyList = new ArrayList<String>();
			     		String key;
			     		Iterator it = subTable.keySet().iterator();
			     		while(it.hasNext()){
			     			//取得key(子表名)
			     			key = it.next().toString();
			     			Map<String,List<String[]>> subTableList = (Map<String,List<String[]>>)subTable.get(key);
			     			
      out.write("\r\n\t\t\t     \t\t\t<div class=\"item\">\r\n\t\t\t\t\t\t\t\t<div class=\"title\">");
      out.print(key );
      out.write("：</div>\r\n\t\t\t\t\t\t\t\t<div class=\"content\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"info\" style=\"overflow: auto; padding: 5px;\">\r\n\t\t\t\t\t\t\t\t\t\t<table width=98% border=\"1\" cellpadding=\"1\" cellspacing=\"0\" bordercolordark=\"#000000\">\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t");
				
												//显示子表的字段名称
												List<String[]> tableFieldInfo = subTableList.get("fieldInfo");
												fieldCount = tableFieldInfo.size();
												int eq = 100 / fieldCount;
												for(int i=0; i<fieldCount; i++){
													temp = tableFieldInfo.get(i);
													if(i == 0){
														
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td nowrap>");
      out.print(temp[1]);
      out.write("</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t");
	
													}else{
														
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td nowrap>");
      out.print(temp[1]);
      out.write("</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t");

													}
												}
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t");

											//显示字段值
											tableFieldInfo = subTableList.get("subTableFieldValue");
											for(int i=0;i<tableFieldInfo.size();i++){
												
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t");

													temp = tableFieldInfo.get(i);
													for(int j=0; j<fieldCount; j++){
														if(j == 0){
															
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td nowrap>");
      out.print((temp[j]==null || "".equals(temp[j]))?"&nbsp;":temp[j]);
      out.write("</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t");
	
														}else{
															
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td nowrap>");
      out.print((temp[j]==null || "".equals(temp[j]))?"&nbsp;":temp[j]);
      out.write("</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t");

														}
													}
													
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t");

											}				
											if(subTableList.get("subTableSumValue")!=null){
												
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td colspan=\"");
      out.print(fieldCount);
      out.write("\" align=\"right\">合计：");
      out.print(subTableList.get("subTableSumValue").get(0)[0] );
      out.write("</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t");

											}
											
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t     \t\t\t");

			     		}
			     	}
		     		//循环显示每一个批示意见的内容
		     		temp=(String[])itemInfo.get("mainCommentInfo");
     	
			     	if(temp != null){
			     		
      out.write(" \t\r\n\t\t\t     \t\t<div class=\"item\">\r\n\t\t\t\t\t\t\t<div class=\"title\">");
      out.print(temp[1] );
      out.write("：</div>\r\n\t\t\t\t\t\t\t<div class=\"content\" >\r\n\t\t\t\t\t\t\t\t<div class=\"info\">");
      out.print(temp[6] );
      out.write("</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t");

			     	}
			     	
			     	// 是否需要发起子流程
			     	boolean needChildFlow = false;
			     	String over = "";
					String operButton = itemInfo.get("operButton")==null ? "" : itemInfo.get("operButton").toString();
					if(activityClass.equals("0")){
						//子过程节点
						needChildFlow = true;
					} else if(0 == po.getWorkStatus()){
						if(operButton.indexOf(",Send,")>=0 && operButton.indexOf(",EndAutoReturn,")<0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "发&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;送", "submitForm();"});
						}
						if(operButton.indexOf(",End,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "办理完毕", "endCurrStep();"});
						}
						if(operButton.indexOf(",EndAutoReturn,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "办理完毕", "submitForm();"});
						}
						if(operButton.indexOf(",EndOnlyComp,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "办理结束", "submitForm();"});
						}
						if(operButton.indexOf(",Tran,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "转&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;办", "transAction();"});
						}				
						if(operButton.indexOf(",Back,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "退&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;回", "backForm();"});
						}
						//自动返回节点显示【办理完毕】按钮
						if(operButton.indexOf(",Delete,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "作&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;废", "deleteItem();"});
						}
						
						//反馈
						if(operButton.indexOf(",Feedback,")>=0 && !"-1".equals(workStatus)){
							buts.add(new String[]{"", "反&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;馈", "cmdFeedback();"});
						}
					} else if(2 == po.getWorkStatus()){
						// 待阅
						//modiButton += ",End";
						buts.add(new String[]{"", "办理完毕", "cmdEnd();"});

						// 反馈
						if(operButton.indexOf("Feedback")!=-1){
							//modiButton += ",Feedback";
							buts.add(new String[]{"", "反&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;馈", "cmdFeedback();"});
						}

						// 转阅
						if(operButton.indexOf("TranRead")!=-1){
							//modiButton += ",TranRead";
							buts.add(new String[]{"", "转&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;阅", "cmdTranRead();"});
						}

						// 发文
						//if("2".equals(moduleId) || "3".equals(moduleId)){
							//modiButton +=  ",Viewtext,Viewacc,Printcomm,Printtext";
						//}
						//文件送审签
						//if("34".equals(moduleId)){
							//modiButton +=  ",Viewtext,Viewacc";
						//}
					}
					if(!SystemCommon.getCustomerName().equals("zcl")){
						if(null!=isMessage && "yes".equals(isMessage)){
							buts.add(new String[]{"closeWindow", over + "退出", ""});
						} else{
							buts.add(new String[]{"", "退&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;出", "closeWindow();"});
						}
					}
					if(needChildFlow){
						buts.add(new String[]{"", "当前节点为子过程节点，请先发起子流程！", ""});
					}
				}
			
      out.write("\r\n\t\t\t</form>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/weixin/workflow/daibanflow/weixinshowhtmlfordoc.jsp", out, false);
      out.write("\r\n\t\t<!-- 按钮 -->\r\n\t\t<div class=\"weixin_buttonsBar\">\r\n\t\t \t<div id=\"weixin_butsDiv\">\r\n\t\t  \t\t");

		  		for(int i=0; i<buts.size(); i++){
					
      out.write("\r\n\t\t\t\t\t<div id=\"");
      out.print(buts.get(i)[0] );
      out.write("\" class=\"weixin_button\" onclick=\"");
      out.print(buts.get(i)[2] );
      out.write("weixin_showButs()\">");
      out.print(buts.get(i)[1] );
      out.write("</div>\r\n\t\t\t\t\t");

		  		}
		  		
      out.write("\r\n\t \t\t</div>\r\n\t\t\t<div id=\"weixinDealwithBut\" class=\"weixin_button weixin_gray\" ");
if(SystemCommon.getCustomerName().equals("zcl") && !"0".equals(status)){
      out.write("style=\"display:none;\"");
} 
      out.write(" onclick=\"weixin_showButs(this)\">处&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;理</div>\r\n\t\t</div>\r\n\t\t<div id=\"commonPopDiv\" class=\"nextStep\" style=\"text-align: center;vertical-align: middle;\">\r\n    \t\t<iframe id=\"commonPopIframe\" style=\"width: 100%;height: 100%;border: none;\"></iframe>\r\n\t\t</div>\r\n\t\t<iframe id=\"include_iframe\" name=\"include_iframe\" style=\"display:none\"></iframe>\r\n\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/weixin/common/weixin_buttons.jsp", out, false);
      out.write("\r\n\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/weixin/common/weixin_messageReminders.jsp", out, false);
      out.write("\r\n\t\t");

		int inWorkStatus = po.getWorkStatus();
		
      out.write("\r\n\t\t<script type=\"text/javascript\">\r\n\t\t//在线锁提醒\r\n\t\tfunction checkWFOnlineUser(){\r\n\t\t\t\r\n\t\t\tvar nolock = false;\r\n\t\t\tfunction alertOnlineUser(s){\r\n\t\t\t\tif(s != \"\"){\r\n\t\t\t\t\tweixinMessageReminder(\"alert\", \"提示：\", s+\"");
      out.print(Resource.getValue(localhi,"workflow","workflow.includeediting"));
      out.write("\", \"\");\r\n\t\t\t\t\tnolock = false;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tnolock = true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tDWREngine.setAsync(false);       //设置成同步\r\n\t\t\tworkflowSync.getWFOnlineUser(document.all.recordId.value, document.all.tableId.value, document.all.processId.value, document.all.workId.value,'");
      out.print(session.getAttribute("userAccount").toString());
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(pageKey);
      out.write("', alertOnlineUser);\r\n\t\t\tDWREngine.setAsync(true);       //重新设置为异步方式\r\n\t\t\treturn nolock;    \r\n\t\t}\r\n\t\t\r\n\t\t//内部分发\r\n\t\tfunction include_selfsendSubmit(type){\r\n\t\t\tvar _mainPassRoundUserType=document.all.mainPassRoundUserType.value;\r\n\t\t\tif(_mainPassRoundUserType==\"10\"){\r\n\t\t\t\t//组织领导方式按照用户处理(已经选择了领导)\r\n\t\t\t\t_mainPassRoundUserType=\"100\";\r\n\t\t\t}\r\n\t\t    switch (parseInt(_mainPassRoundUserType)) {\r\n\t\t\t\tcase 10:\r\n\t\t\t\t\t//组织领导\r\n\t\t\t\t\tvar orgId = \"\";\r\n\t\t\t\t\tvar idstr = document.all.operId.value;\r\n\t\t\t\t\tif(idstr != \"\"){\r\n\t\t\t\t\t\tfor( var i = 0; i < idstr.length; i ++ ){\r\n\t\t\t\t\t\t\tflagCode = idstr.charAt(i);\r\n\t\t\t\t\t\t\tnextPos = idstr.indexOf(flagCode,i + 1);\r\n\t\t\t\t\t\t\tstr = idstr.substring(i+1,nextPos);\r\n\t\t\t\t\t\t\tif(flagCode == \"*\"){\r\n\t\t\t\t\t\t\t\torgId = orgId + str + \",\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ti = nextPos;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\torgId = orgId.substring(0,orgId.length-1);\r\n\t\t\t\t\tdocument.all.operId.value = orgId;\r\n\t\t\t\t\tworkflowSync.getLeaderByOrgId(orgId, include_checkUserStatusSelfsend(type));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tdocument.all.");
      out.print(formName);
      out.write(".target = \"include_iframe\";\r\n\t\t\t\t\tdocument.all.");
      out.print(formName);
      out.write(".action = \"/jsoa/WorkflowButtonForWeiXinAction.do?flag=passround&type=\"+type;\r\n\t\t\t\t\tdocument.all.");
      out.print(formName);
      out.write(".submit();\r\n\t\t\t\t\tvar message = \"");
      out.print(Resource.getValue(localhi,"workflow","workflow.includehassuccessturn"));
      out.write("\"+(document.all.operName.value==''?\"\":(\"");
      out.print(Resource.getValue(localhi,"workflow","workflow.includeto"));
      out.write("\"+document.all.operName.value))+(document.all.mainPassRoundUserType.value=='10'?\"");
      out.print(Resource.getValue(localhi,"workflow","workflow.includeleader"));
      out.write("\":\"\")+\"！\"\r\n\t\t\t\t\tparent.weixinMessageReminder(\"alert\", \"提示：\", message, \"\");\r\n\t\t\t\t\tparent.document.getElementById('formBody').style.display = 'block';\r\n\t\t\t\t\tdocument.getElementById('commonPopDiv').style.display = 'none';\r\n\t\t    }\r\n\t\t}\r\n\t\t\r\n\t\t//按钮反馈\r\n\t\tfunction include_feedbackSubmit(){\r\n\t\t    //发邮件\r\n\t\t\t");
      out.print(formName);
      out.write(".target = \"include_iframe\";\r\n\t\t\t");
      out.print(formName);
      out.write(".action = \"/jsoa/WorkflowButtonForWeiXinAction.do?flag=feedback\";\r\n\t\t\t");
      out.print(formName);
      out.write(".submit();\r\n\t\t\tweixinMessageReminder(\"alert\", \"提示：\", \"");
      out.print(Resource.getValue(localhi,"workflow","workflow.includehassuccessfeedback"));
      out.write("\", \"\");\r\n\t\t\t\r\n\t\t\t\tparent.document.getElementById('formBody').style.display = 'block';\r\n\t\t\t\tdocument.getElementById('commonPopDiv').style.display = 'none';\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t/*检查页面参数有效性*/\r\n\t\tfunction initPara(){     \r\n\t\t\tif(!isPhone(document.all.field10)){   \r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif(!checkFieldLength()){ \r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t//if(checkText(GovSendFileActionForm.documentSendFileTitle, 95, \"发文标题\")){\r\n\t\t\tif(true){\r\n\t\t\t\t//checkOffice();//\r\n\t\t\t\tif(document.all.documentSendFileTitle.value.indexOf(\"#\")>0){\r\n\t\t\t\t\talert(\"标题不能含'#'\");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar numId = document.all.sendFilePoNumId.value;\r\n\t\t\t\tvar numxuhao = document.all.field2.value;\r\n\r\n\t\t\t\tif(numId!=\"\" && numxuhao!=\"\"){\r\n\t\t\t\t\tvar http_request = false;\r\n\t\t   \r\n\t\t\t\t\tif(window.XMLHttpRequest) {\r\n\t\t\t\t\t\thttp_request = new XMLHttpRequest();\r\n\t\t\t\t\t\tif(http_request.overrideMimeType){\r\n\t\t\t\t\t\t\thttp_request.overrideMimeType('text/xml');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if(window.ActiveXObject){ \r\n\t\t\t\t\t\ttry{\r\n\t\t            \t\thttp_request = new ActiveXObject(\"Msxml2.XMLHTTP\");\r\n");
      out.write("\t\t        \t\t} catch(e){\r\n\t\t            \t\ttry{\r\n\t\t                \t\thttp_request = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\t\t            \t\t} catch(e){}\r\n\t\t        \t\t}\r\n\t\t    \t\t}\r\n\t\t    \t\tif(!http_request){ \r\n\t\t        \t\twindow.alert(\"不能创建XMLHttpRequest对象实例.\");\r\n\t\t   \t\t\t\treturn false;\r\n\t\t    \t\t} else{\r\n\t\t        \t\tvar url = \"/jsoa/doc/doc/doc_judge.jsp?numId=\" + numId + \"&record=");
      out.print(request.getParameter("record"));
      out.write("\" + \r\n\t\t        \t\t\t\t\"&field2=\" + numxuhao;\r\n\t\t       \r\n\t\t        \t\thttp_request.open(\"GET\", url, false);\t/*此处需同步执行*/\r\n\t\t        \t\thttp_request.send(null);\r\n\t\t    \t\t}\r\n\t\t    \t\tif(http_request.readyState == 4){\r\n\t\t        \t\tif(http_request.status == 200){ \r\n\t\t            \t\tvar result = http_request.responseText;\r\n\t\t            \t\tif(result == 0){\r\n\t\t                \t\talert(\"文号重复！\");\r\n\t\t                \t\treturn false;\r\n\t\t            \t\t}\r\n\t\t        \t\t} else{\t/*页面不正常*/\r\n\t\t            \t\talert(\"您所请求的页面有异常。\");\r\n\t\t        \t\t}\r\n\t\t    \t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//setNewUpdate();\t// 判断哪些标签修改了\r\n\t\t\t\t//trimrnTitle();\t// 去掉 标题与 附件描述的 换行\t\t\r\n\t\t\t\t");

		   		// 判断手写意见是否为空
		   		//if(com.js.util.config.SystemCommon.getHandWriteNotEmpty() == 1){
		   		if(false){
		   			
      out.write("\r\n\t\t   \t\t\tif(!include_saveSignature()){\r\n\t\t             \treturn false;\r\n\t\t      \t\t}\r\n\t\t   \t\t\t");

		   		}
		   		
      out.write("   \t\r\n\t\t\t\treturn true;\t\r\n\t\t\t} else{\t\r\n\t\t    \treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t//是否是号码\r\n\t\tfunction isPhone(obj) {\r\n\t\t    var str = \"0123456789- ()\" ;\r\n\t\t    var val = obj.value ;\r\n\t\t    for(var i = 0  ; i < val.length ; i++ ) {\r\n\t\t        if(str.indexOf(val.substring(i,i+1))==-1) {\r\n\t\t            alert(\"号码允许字符：0123456789-( )\") ;\r\n\t\t            obj.focus() ;\r\n\t\t            obj.select();\r\n\t\t            return false ;\r\n\t\t        }\r\n\t\t    }\r\n\t\t    return true ;\r\n\t\t}\r\n\t\t\r\n\t\tfunction checkFieldLength(){\r\n\t\t\t//if(true&checkTextLengthOnly(document.all.sendFileDepartWord,1000,\"机关代字\")&checkTextLengthOnly(document.all.documentSendFileByteNumber,1000,\"文号\")&checkTextLengthOnly(document.all.documentSendFileTitle,95,\"发文标题\")){\r\n\t\t\tif(true){\r\n\t\t\t  \treturn true;\r\n\t\t\t} else{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\t\r\n\t\t//办理完毕与阅件保存--多人办理--待阅办理\r\n\t\tfunction include_endAndSaveSubmit(){\r\n\t\t\tif('");
      out.print(inWorkStatus);
      out.write("'=='2'){\r\n\t\t\t\t//阅件\r\n\t\t\t\tif(confirm(\"");
      out.print(Resource.getValue(localhi,"workflow","workflow.includeconfirmsaveread"));
      out.write("\")){\r\n\t\t\t\t\tdocument.all.");
      out.print(formName);
      out.write(".target = \"_self\";\r\n\t\t\t\t\tinclude_save();\r\n\t\t\t\t}\r\n\t\t\t} else{\r\n\t\t\t\t//办理完毕\r\n\t\t\t\tinclude_endSubmit();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t//阅件时保存意见\r\n\t\tfunction include_save(){\r\n\t\t\t//if(!include_saveSignature()){\r\n\t\t    if(false){\r\n\t\t        return;\r\n\t\t    }\r\n\t\t    //include_setComment();\t// 批示意见\r\n\t\t    \r\n\t\t    \r\n\t\t    var readyFunc = function onBridgeReady() {\r\n\t\t\t\tWeixinJSBridge.invoke('closeWindow', {}, function(res) {\r\n\t\t\t\t\t//alert(res.err_msg);\r\n\t\t\t\t\t//2017-01-04 微信端因iphone与andriod差异，提交表单代码必须写在这里才能执行 \r\n\t\t\t\t\tdocument.all.");
      out.print(formName);
      out.write(".action = \"/jsoa/WorkflowButtonForWeiXinAction.do?flag=dealpassround\";\r\n\t\t\t\t    document.all.");
      out.print(formName);
      out.write(".submit();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof WeixinJSBridge === \"undefined\") {\r\n\t\t\t\tdocument.all.");
      out.print(formName);
      out.write(".action = \"/jsoa/WorkflowButtonForWeiXinAction.do?flag=dealpassround\";\r\n\t\t\t    document.all.");
      out.print(formName);
      out.write(".submit();\r\n\t\t\t\r\n\t\t\t\tif (document.addEventListener) {\r\n\t\t\t\t\tdocument.addEventListener('WeixinJSBridgeReady', readyFunc, false);\r\n\t\t\t\t} else if (document.attachEvent) {\r\n\t\t\t\t\tdocument.attachEvent('WeixinJSBridgeReady', readyFunc);\r\n\t\t\t\t\tdocument.attachEvent('onWeixinJSBridgeReady', readyFunc);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treadyFunc();\r\n\t\t\t}\r\n\t\t}\r\n\t\t</script>\r\n\t</body>\r\n</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
