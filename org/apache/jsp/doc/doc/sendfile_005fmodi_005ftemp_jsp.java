/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 10:05:58 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.doc.doc;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.doc.doc.service.SendFileBD;
import com.js.doc.doc.service.SenddocumentBD;
import com.js.oa.jsflow.service.WorkFlowBD;
import java.util.*;
import com.js.system.util.StaticParam;
import com.js.util.config.SystemCommon;
import com.js.doc.doc.bean.DocWordMust;
import com.js.util.util.DataSourceBase;
import java.util.Random;
import com.js.lang.Resource;
import com.js.util.config.SystemCommon;
import com.js.util.util.BrowserJudge;
import java.util.*;
import java.util.Set;
import java.util.Map;
import com.js.lang.Resource;
import com.js.util.util.BrowserJudge;

public final class sendfile_005fmodi_005ftemp_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(3);
    _jspx_dependants.put("/jsflow/workflow_include_middleHidden.jsp", Long.valueOf(1499751422000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-html.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/jsflow/workflow_include_firstHidden.jsp", Long.valueOf(1499751422000L));
  }

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.doc.doc.service.SenddocumentBD");
    _jspx_imports_classes.add("com.js.doc.doc.bean.DocWordMust");
    _jspx_imports_classes.add("com.js.lang.Resource");
    _jspx_imports_classes.add("com.js.system.util.StaticParam");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("java.util.Map");
    _jspx_imports_classes.add("com.js.util.util.DataSourceBase");
    _jspx_imports_classes.add("java.util.Set");
    _jspx_imports_classes.add("com.js.doc.doc.service.SendFileBD");
    _jspx_imports_classes.add("java.util.Random");
    _jspx_imports_classes.add("com.js.util.util.BrowserJudge");
    _jspx_imports_classes.add("com.js.oa.jsflow.service.WorkFlowBD");
  }

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fhtml_005fhtml;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fhtml_005fform_0026_005fmethod_005faction;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fvalue_005fproperty_005fnobody;
  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fstyleId_005fproperty_005fnobody;

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fhtml_005fhtml = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fhtml_005fform_0026_005fmethod_005faction = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fvalue_005fproperty_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
    _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fstyleId_005fproperty_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fhtml_005fhtml.release();
    _005fjspx_005ftagPool_005fhtml_005fform_0026_005fmethod_005faction.release();
    _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.release();
    _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fvalue_005fproperty_005fnobody.release();
    _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fstyleId_005fproperty_005fnobody.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!DOCTYPE HTML>\r\n");

String tableid=request.getParameter("table")+"";
DocWordMust dm=new DocWordMust();
Map map=dm.getMustWord(tableid);
//必填字段
String mustword=map.get("mustword")==null?"":map.get("mustword")+"";
//表中被选中的字段
String govcheckfield=map.get("govcheckfield")==null?"":map.get("govcheckfield")+"";

String docFormFontSize=SystemCommon.getDocFormFontSize();
com.js.util.util.RepacleSpaceUtil repacleSpaceUtil=new com.js.util.util.RepacleSpaceUtil();
//邮件转发 返回  （转本 部门）
String transmitSu="";
if(request.getAttribute("transmitSu")!=null){
  transmitSu=request.getAttribute("transmitSu").toString();
  if(transmitSu.equals("1")){
      out.write("   \r\n   <script>\r\n  alert(\"发送成功\");\r\n   window.close();\r\n   </script> \r\n ");
}else{
      out.write("  \r\n  <script>\r\n\talert(\"发送失败\");\r\n   window.close();\r\n  </script>  \r\n  ");
}
}     
String path1 = request.getContextPath();
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path1+"/";
SendFileBD  sendB=new SendFileBD();

 String domainId = session.getAttribute("domainId")==null?"0":session.getAttribute("domainId").toString();
 String userId=session.getAttribute("userId").toString();
String fileServer ="";
if(session.getAttribute("fileServer")!=null)
fileServer=session.getAttribute("fileServer").toString();

java.util.Map sysMap = com.js.system.util.SysSetupReader.getInstance().getSysSetupMap(session.getAttribute("domainId").toString());
int smartInUse = 0;
if(sysMap != null && sysMap.get("附件上传") != null){
	smartInUse = Integer.parseInt(sysMap.get("附件上传").toString());
}
boolean handSignInUse = false;//是否使用了手写签名
boolean signatureInUse=false; //是否使用了电子签章
if(sysMap != null && sysMap.get("使用手写意见") != null && "1".equals(sysMap.get("使用手写意见").toString())){
    handSignInUse = true;
}
if(sysMap != null && sysMap.get("电子签章") != null && "1".equals(sysMap.get("电子签章").toString())){
	signatureInUse = true;//电子签章
}
//电子签章div的位置
String inc_divId = java.util.Calendar.getInstance().getTimeInMillis() + "";

String curCommField = request.getAttribute("curCommField").toString();//批示意见对应字段
String curPassRoundCommField = request.getAttribute("curPassRoundCommField").toString();//阅办意见对应字段
//取常用语
java.util.List officelist = new WorkFlowBD().getOffiDict(userId, domainId);
String  read_tableId=request.getParameter("table");
String  read_processId=request.getParameter("processId");
String  read_recordId=request.getParameter("record");

int   read_inWorkType = ("null".equals(request.getParameter("workType")) || request.getParameter("workType")==null)?-1:Integer.parseInt(request.getParameter("workType"));//流程类型
String  read_option=request.getParameter("option")==null?"":request.getParameter("option").toString();
String  read_submitPerson=request.getParameter("submitPerson")==null?"":request.getParameter("submitPerson").toString();
String  read_submitTime=request.getParameter("submitTime")==null?"":request.getParameter("submitTime").toString();
String  read_moduleId=request.getParameter("moduleId")==null?"":request.getParameter("moduleId").toString();
String  read_activity=request.getParameter("activity")==null?"":request.getParameter("activity").toString();

String noDisplayFields=new com.js.oa.jsflow.util.NewWorkflowUtil().getNoDisplayField(request.getParameter("initActivity"),request.getParameter("work"),read_processId);
if("0".equals(request.getParameter("editType"))){
	//判断当前查看人是否是发起人，不是发起人则应该不受发起节点限制
	if(session.getAttribute("userId").toString().equals(request.getParameter("submitPersonId"))){
		//发起人
	}else{
		noDisplayFields="";
	}
}
String  qianfaName="";
String  qianfaTime="";
String  qianfaContent = "";
String [] qianfaStr=new com.js.oa.jsflow.service.WorkFlowButtonBD().getCommentUserAndDateByCommField(read_tableId,read_recordId,"documentSendFileSendFile");
if(qianfaStr!=null&&qianfaStr.length>2){
  qianfaName=qianfaStr[1];
  qianfaTime=qianfaStr[2];
  if(qianfaTime!=null&&qianfaTime.length()>5){
       int nh = qianfaTime.indexOf("日");
	   if (nh != -1) {
        qianfaTime = qianfaTime.substring(0, nh+1) ;
       }
  }
  qianfaContent = qianfaStr[3]==null?"":qianfaStr[3].replaceAll("\n","<br>").replaceAll("\r","");
}

//取附件信息
String contentAccName=request.getAttribute("contentAccName")==null?"":request.getAttribute("contentAccName").toString();
String contentAccSaveName=request.getAttribute("contentAccSaveName")==null?"":request.getAttribute("contentAccSaveName").toString();

String modifyContent[]={"","","","","",""};
String commentName[]=(String [])request.getAttribute("commentName");

String pd=request.getParameter("processId")==null?"":request.getParameter("processId");
String isEdit = request.getParameter("isEdit")==null?"0":request.getParameter("isEdit");//办理查阅中修改
com.js.doc.doc.action.GovSendFileActionForm myform = (com.js.doc.doc.action.GovSendFileActionForm)request.getAttribute("myform") ;
java.util.Date sendFileDate = new java.util.Date() ;
java.util.Date sendFileSendDate = new java.util.Date() ;
java.util.Date documentCreateTime=new java.util.Date();

if(request.getAttribute("sendFileDate")!=null)
    sendFileDate =  (java.util.Date)request.getAttribute("sendFileDate") ;
if(request.getAttribute("sendFileSendDate")!=null)
    sendFileSendDate =  (java.util.Date)request.getAttribute("sendFileSendDate") ;

if(request.getAttribute("documentCreateTime")!=null&&!request.getAttribute("documentCreateTime").toString().equals("")){
  documentCreateTime=(java.util.Date)request.getAttribute("documentCreateTime");
}

int createTimeYear= documentCreateTime.getYear()+1900;
int createTimeMonth= documentCreateTime.getMonth()+1;
int createTimeDate= documentCreateTime.getDate();
String createTimeStr=""+createTimeYear+"/"+createTimeMonth+"/"+createTimeDate;
int sendFileDateYear = sendFileDate.getYear()+1900 ;
int sendFileDateMonth = sendFileDate.getMonth()+1 ;
int sendFileDateDate = sendFileDate.getDate();
int sendFileSendDateYear = sendFileSendDate.getYear()+1900 ;
int sendFileSendDateMonth = sendFileSendDate.getMonth()+1 ;
int sendFileSendDateDate = sendFileSendDate.getDate();
String sendFileDateShow=String.valueOf(sendFileSendDateYear)+" 年 "+String.valueOf(sendFileSendDateMonth)+" 月 " +String.valueOf(sendFileSendDateDate)+" 日";
String sendStatus=request.getAttribute("sendStatus")==null?"0":request.getAttribute("sendStatus").toString();

java.util.List commentList;
if(com.js.util.config.SystemCommon.getShowBackFordoc()==1){
	commentList= new com.js.oa.jsflow.service.WorkFlowBD().getDealWithCommentFordoc(request.getParameter("table"),request.getParameter("record"),request.getParameter("workType"));
}else{
	commentList= new com.js.oa.jsflow.service.WorkFlowBD().getDealWithCommentNotBackFordoc(request.getParameter("table"),request.getParameter("record"),request.getParameter("workType"));
}

/// 控制按纽出现 
String workStatus = request.getParameter("workStatus")==null?"":request.getParameter("workStatus").toString();
String modiButton = "none";

if(request.getParameter("isEdit")!=null&&"1".equals(request.getParameter("isEdit").toString())){

 modiButton=",Viewtext,Readtext,Print,Sendclose,Saveclose";

if(sendStatus.equals("1")){
 //modiButton=",Viewtext,Readtext,Back,Print,Sendclose,Hasread,Noread,Saveclose";
 modiButton=",Viewtext,Print,Hasread,Noread";
 }else{
 modiButton=",Viewtext,Readtext,Wait,Back,Print,Sendclose,Hasread,Noread,Saveclose";
 }

}else if(request.getParameter("viewOnly")!=null&&"1".equals(request.getParameter("viewOnly").toString())){
 modiButton=",Viewtext,ShowDocHistory,ShowDocHistorySecond,UndoCancel";
 if(request.getParameter("finish")==null){
	 modiButton += ",DocToArchives";
 }
}

 if(workStatus.equals("102")){
  modiButton=",Viewtext,Print";	 
}

if(workStatus.equals("2"))
modiButton="none";
    
//取 基础信息
String [] sendFileGrade_Arr=null;
	String [] documentSendFileSecurityGrade_Arr=null;
	String [] zjkySecrecyterm_Arr=null;
	String [] zjkyContentLevel_Arr=null;
	String [] openProperty_Arr=null;
   	String [] fileType_Arr=null;
   	String [] sendDropDownSelect1_Arr=null;
    String [] sendDropDownSelect2_Arr=null;

Object [] baseObj=(Object[]) new SenddocumentBD().getSenddocumentBaseInfo();
if(baseObj!=null&&baseObj.length>0){
  if(baseObj[4]!=null&&!baseObj[4].toString().equals("")){
		documentSendFileSecurityGrade_Arr=baseObj[4].toString().split(";");//秘密级别：
		zjkySecrecyterm_Arr=baseObj[3].toString().split(";");//保密期限：
		sendFileGrade_Arr=baseObj[5].toString().split(";"); // 办理紧急：
		zjkyContentLevel_Arr=baseObj[1].toString().split(";");//内容紧急：
		if(baseObj.length>11&&baseObj[11]!=null&&!baseObj[11].toString().equals("")){
	    openProperty_Arr=baseObj[11].toString().split(";");
	    }
	    if(baseObj.length>12&&baseObj[12]!=null&&!baseObj[12].toString().equals("")){
	    sendDropDownSelect1_Arr=baseObj[12].toString().split(";");
	    }
		if(baseObj.length>13&&baseObj[13]!=null&&!baseObj[13].toString().equals("")){
	    sendDropDownSelect2_Arr=baseObj[13].toString().split(";");
	    }
	    fileType_Arr=baseObj[2].toString().split(";");// 文件种类
  } 
}
// 机关代字 名称
String sendWord=request.getAttribute("sendFileDeparatWord")==null?"":request.getAttribute("sendFileDeparatWord").toString();

com.js.oa.jsflow.util.WorkflowCommon workflowCommon = new com.js.oa.jsflow.util.WorkflowCommon();
com.js.doc.doc.service.SendFileBD sendFileBD = new com.js.doc.doc.service.SendFileBD();
String curModifyField = request.getAttribute("curModifyField")==null?"":request.getAttribute("curModifyField").toString();//当前活动可写字段

String curProcCommField = request.getAttribute("curProcCommField")==null?"":request.getAttribute("curProcCommField").toString();//当前流程所有的批示意见对应字段名称
String processName = request.getParameter("processName");
String  contentText=request.getAttribute("content")==null?"":request.getAttribute("content").toString();
String nowYearInt= (new java.util.Date().getYear()+1900)+"";

java.util.List senddocuementList= new java.util.ArrayList();
if(request.getAttribute("unitWord")!=null){
senddocuementList=(java.util.List) request.getAttribute("unitWord");
}

boolean canModify = true;
String buttonName="上传";
String[] realFileArray ;
String[] saveFileArray ;
Object accName;
Object accSName;
String path = "govdocumentmanager" ;
String tableName="";
String fileName = "" ;
String saveName = "";
int fileMaxSize = 0;
int fileMaxNum  = 20 ;
int fileMaxWidth = 0 ;
int fileMaxHeight = 0;
int fileMinWidth = 0;
int fileMinHeight = 0;
String fileType = "" ;

String accessoryName=request.getAttribute("accessoryName")==null?"":request.getAttribute("accessoryName").toString();
String accessorySaveName=request.getAttribute("accessorySaveName")==null?"":request.getAttribute("accessorySaveName").toString();

String  comment_variableName="";
String  comment_variableModifyContent="";

      out.write('\r');
      out.write('\n');
      //  html:html
      org.apache.struts.taglib.html.HtmlTag _jspx_th_html_005fhtml_005f0 = (org.apache.struts.taglib.html.HtmlTag) _005fjspx_005ftagPool_005fhtml_005fhtml.get(org.apache.struts.taglib.html.HtmlTag.class);
      boolean _jspx_th_html_005fhtml_005f0_reused = false;
      try {
        _jspx_th_html_005fhtml_005f0.setPageContext(_jspx_page_context);
        _jspx_th_html_005fhtml_005f0.setParent(null);
        int _jspx_eval_html_005fhtml_005f0 = _jspx_th_html_005fhtml_005f0.doStartTag();
        if (_jspx_eval_html_005fhtml_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
          do {
            out.write("\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\">\r\n<title>发文</title>\r\n<link href=\"/jsoa/skin/");
            out.print(session.getAttribute("skin"));
            out.write("/style-");
            out.print(session.getAttribute("browserVersion"));
            out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<script src=\"/jsoa/js/js.js\" language=\"javascript\"></script>\r\n<link rel=\"stylesheet\" type=\"text/css\" href=\"public/date_picker/DateObject2.css\">\r\n<SCRIPT language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("public/date_picker/DateObject.js\"></SCRIPT>\r\n<SCRIPT language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("public/date_picker/DatePicker.js\"></SCRIPT>\r\n<SCRIPT language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("public/date_picker/editlib.js\"></SCRIPT>\r\n<SCRIPT language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("public/date_picker/tree.js\"></SCRIPT>\r\n<script language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("js/openEndow.js\"></script>\r\n<script language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("js/checkForm.js\"></script>\r\n<script language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("eform/datetime/datetime_check.js\"></script>\r\n<script language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("eform/datetime/datetime_select.js\"></script>\r\n<script src=\"");
            out.print(basePath );
            out.write("doc/js/trim.js\" language=\"javascript\"></script>\r\n");
if("1".equals(request.getParameter("resubmit"))){
            out.write("\r\n<script src=\"");
            out.print(basePath );
            out.write("js/toolbar/standardAdd.js\" language=\"javascript\"></script>\r\n<script src=\"");
            out.print(basePath );
            out.write("js/toolbar/govsendfileAdd.js\" language=\"javascript\"></script>\r\n<script src=\"");
            out.print(basePath );
            out.write("js/clsPullXMenu.js\" language=\"javascript\"></script>\r\n<script src=\"");
            out.print(basePath );
            out.write("public/jsp/cmdbutton.jsp?button=Close,Send,Writetext\">\r\n</script>\r\n");
}else{
            out.write("\r\n<script src=\"");
            out.print(basePath );
            out.write("js/toolbar/standardModi.js\" language=\"javascript\"></script>\r\n<script src=\"");
            out.print(basePath );
            out.write("js/toolbar/govsendfileModi.js\" language=\"javascript\"></script>\r\n<script src=\"");
            out.print(basePath );
            out.write("js/clsPullXMenu.js\" language=\"javascript\"></script>\r\n");
}
            out.write("\r\n<script src=\"clsPupMenu.js\" type=\"text/javascript\"></script>\r\n<script  src=\"");
            out.print(basePath );
            out.write("js/checkText.js\"  language=\"javascript\" ></script>\r\n<SCRIPT language=\"javascript\" src=\"");
            out.print(basePath );
            out.write("js/openEndow.js\"></SCRIPT>\r\n<script>\r\nfunction openPupWin(url,w,h){\r\n    JSMainWinOpen4(url,\"_blank\",\"width=\"+w+\",height=\"+h+\",location=no,resizable=no,status=no\",500,250);\r\n}\r\n\r\nfunction MM_openBrWindow(theURL,winName,features) { \r\n  JSMainWinOpen(theURL,winName,features);\r\n}\r\n</script>\r\n<script>\r\nvar noteTimer=null;\r\nfunction getNote(index){\r\n var sTop=document.getElementById(\"mainContent\").scrollTop;\r\n var noteDiv=\"noteDiv_\"+index;\r\n  var d=document.getElementById(noteDiv);\r\n  d.style.left=event.x-200;\r\n  d.style.top=event.y+sTop-30;\r\n  d.style.display=\"inline\";\r\n}\r\nfunction hiddenNote(dd){\r\n\tvar dealFunct=\"closeNote('\"+dd+\"')\";\r\n  noteTimer=window.setTimeout(dealFunct,500);\r\n}\r\nfunction closeNote(dd){\r\n\t  var noteDiv=\"noteDiv_\"+dd;\r\n  var d=document.getElementById(noteDiv);\r\n  d.style.display=\"none\";\r\n}\r\nfunction lockedNote(){\r\n  window.clearTimeout(noteTimer);\r\n}\r\nfunction setNote(obj,dd){\r\n\tdocument.getElementById(dd).value+=obj.innerText;\r\n}\r\nfunction setNoteValue(obj,dd){\r\n  document.getElementById(dd).value=obj.value;\r\n");
            out.write("}\r\nfunction addDivContent(){\r\n\tvar adddivcontent=document.all.addDivContent.value;\r\n    ");

	if(commentName!=null&&commentName.length>0){
	for(int i=0;i<commentName.length;i++){	
	
            out.write("\r\n   ");
if((workStatus.equals("0") && (curCommField.indexOf("$"+commentName[i]+"$")>=0 || curCommField.equals(commentName[i].toString())))|| (workStatus.equals("2") && (curPassRoundCommField.equals(commentName[i].toString()) || curPassRoundCommField.indexOf("$"+commentName[i]+"$") >= 0))){
            out.write("\r\n\r\n\tdocument.getElementById(\"noteDiv_");
            out.print(commentName[i].toString());
            out.write("\").innerHTML= \"\"+\"<div class='divOut' onmouseover='lockedNote();this.className=\\\"divOver\\\"' onmouseout='this.className=\\\"divOut\\\"' onclick=\\\"setNote(this,\\'");
            out.print(commentName[i]);
            out.write("\\');\\\">\"+adddivcontent+\"<\\/div>\"+document.getElementById(\"noteDiv_");
            out.print(commentName[i]);
            out.write("\").innerHTML;\r\n\t");
}
            out.write("\r\n    ");
}}
            out.write("\r\n}\r\n</script>\r\n<style type=\"text/css\">\r\n* { margin: 0; padding: 0;}\r\n");

if("shandongguotou".equals(com.js.util.config.SystemCommon.getCustomerName())){
	
            out.write("\r\n\tdiv { margin-top: 5px; padding: 0;}\r\n\t");

}

            out.write("\r\n\r\n<!--\r\n.bg {\r\n\tbackground-image: url(\"");
            out.print(basePath );
            out.write("images/gw_line.jpg);\r\n\tbackground-repeat: repeat-y;\r\n}\r\n.sw {\r\n    background:transparent;\r\n\tborder-top-width: 0px;\r\n\tborder-right-width: 0px;\r\n\tborder-bottom-width: 1px;\r\n\tborder-left-width: 0px;\r\n\tborder-top-style: solid;\r\n\tborder-right-style: solid;\r\n\tborder-bottom-style: solid;\r\n\tborder-left-style: solid;\r\n\tborder-bottom-color: #CCCCCC;\r\n}\r\n.btnButton4font{\r\n    width:65px;\r\n    height:20px;\r\n    background-image:url(");
            out.print(basePath );
            out.write("skin/");
            out.print(session.getAttribute("skin"));
            out.write("/images/btnButton4font.gif);\r\n    border:0px;\r\n    padding-top:0px;\r\n    margin-left:3px;\r\n    margin-right:3px;\r\n    margin-bottom:4px;\r\n\ttext-align: center;\r\n\tvertical-align: middle;\r\n}\r\n.btnButton5font{\r\n    width:90px;\r\n    height:20px;\r\n    background-image:url(");
            out.print(basePath );
            out.write("skin/");
            out.print(session.getAttribute("skin"));
            out.write("/images/btnButton6font.gif);\r\n    border:0px;\r\n    padding-top:0px;\r\n    margin-left:3px;\r\n    margin-right:3px;\r\n    margin-bottom:4px;\r\n\ttext-align: center;\r\n\tvertical-align: middle;\r\n}\r\n.btnButton2font{\r\n    width:44px;\r\n    height:20px;\r\n    background-image:url(");
            out.print(basePath );
            out.write("skin/");
            out.print(session.getAttribute("skin"));
            out.write("/images/btnButton2font.gif);\r\n    border:0px;\r\n    padding-top:1px;\r\n    margin-left:3px;\r\n    margin-right:3px;\r\n    margin-bottom:4px;\r\n\ttext-align: center;\r\n\tvertical-align: middle;\r\n}\r\n-->\r\n</style>\r\n<style type=\"text/css\">\r\n<!--\r\n#noteDiv_documentSendFileAssumeUnit {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n}\r\n\r\n#noteDiv_sendFileMassDraft {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n}\r\n#noteDiv_sendFileProveDraft {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n}\r\n#noteDiv_sendFileReadComment {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n}\r\n#noteDiv_documentSendFileCheckCommit {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n");
            out.write("\tdisplay:none;\r\n}\r\n#noteDiv_documentSendFileSendFile {\r\n\tposition:absolute;\r\n\twidth:220px;\r\n\theight:126px;\r\n\tz-index:1;\r\n\toverflow:auto;\r\n\tborder:1px solid #829FBB;\r\n\tdisplay:none;\r\n}\r\n\r\n.divOver{\r\n    background-color:#003399;\r\n\tcolor:#FFFFFF;\r\n\tborder-bottom:1px dashed #cccccc;\r\n    width:100%;\r\n\theight:20px;\r\n\tline-height:20px;\r\n\tcursor:default;\r\n\tpadding-left:5px;\r\n}\r\n.divOut{\r\n    background-color:#ffffff;\r\n\tcolor:#000000;\r\n\tborder-bottom:1px dashed #cccccc;\r\n    width:100%;\r\n\theight:20px;\r\n\tline-height:20px;\r\n\tcursor:default;\r\n\tpadding-left:5px;\r\n}\r\n-->\r\n</style>\r\n");
if(signatureInUse){
            out.write("\r\n<OBJECT id=\"SignatureControl\" classid=\"clsid:D85C89BE-263C-472D-9B6B-5264CD85B36E\" codebase=\"/jsoa/iSignatureHTML.jsp/iSignatureHTML.cab#version=9,0,0,0\" width=\"0\" height=\"0\" VIEWASTEXT>\r\n<param name=\"ServiceUrl\" value=\"");
            out.print(request.getScheme());
            out.write(':');
            out.write('/');
            out.write('/');
            out.print(request.getServerName());
            out.write(':');
            out.print(request.getServerPort());
            out.write("/jsoa/iSignatureHTML.jsp/Service.jsp\"><!--读去数据库相关信息-->\r\n<param name=\"WebAutoSign\" value=\"0\">             <!--是否自动数字签名(0:不启用，1:启用)-->\r\n<!--param name=\"Weburl\"  value=\"\">        <签章服务器响应-->\r\n</OBJECT>\r\n");
}
            out.write("\r\n</head>\r\n<script language=\"javascript\">\r\n//导航按钮\r\nfunction btnSelect(id){\r\n  for(i=0;i<=6;i++){\r\n \t if(document.getElementById(\"Panle\"+i)){\r\n\t \tdocument.getElementById(\"Panle\"+i).style.color = \"black\";\r\n\t }\r\n \t if(document.getElementById(\"docinfo\"+i)){\r\n\t \tdocument.getElementById(\"docinfo\"+i).style.display = \"none\";\r\n\t }\r\n  }\r\n\r\n   if(document.getElementById(\"Panle\"+id)){\r\n\t \tdocument.getElementById(\"Panle\"+id).style.color = \"red\";\r\n\t }\r\n \t if(document.getElementById(\"docinfo\"+id)){\r\n\t \tdocument.getElementById(\"docinfo\"+id).style.display = \"\";\r\n\t }\r\n\r\n   if(id==1){\r\n\tdocument.all.ifrmPhoto.src = \"/jsoa/doc/doc/flowPhoto.jsp?read_processId=");
            out.print(read_processId);
            out.write("&read_tableId=");
            out.print(read_tableId);
            out.write("&read_recordId=");
            out.print(read_recordId);
            out.write("&inWorkType=");
            out.print(read_inWorkType);
            out.write("&option=");
            out.print(read_option);
            out.write("&submitPerson=");
            out.print(read_submitPerson);
            out.write("&submitTime=");
            out.print(read_submitTime);
            out.write("&moduleId=");
            out.print(read_moduleId);
            out.write("&activity=");
            out.print(read_activity);
            out.write("\" ;\r\n\t}\r\n}\r\n</script>\r\n<body  onload=\"init();loadToolbar('commandBar');\" onResize=\"loadToolbar('commandBar');\" class=\"MainFrameBox Pupwin\">\r\n<!--存放原放在外面的内容-->\r\n<script language=\"javascript\">\r\n");

/*归档*/
String close="";
if(request.getAttribute("close")!=null)
close=request.getAttribute("close").toString();

            out.write("\r\nfunction init() {\r\n");
if(!"".equals(close)&&"yes".equals(close)){
            out.write("\r\n\tparent.window.alert(\"操作成功！\");\r\n    parent.window.close();\r\n");
}
            out.write("\r\n   var done = \"");
            out.print(request.getParameter("done"));
            out.write("\" ;\r\n   if(done==\"done\") {\r\n        ");
if(!"yes".equals(close)){
            out.write("\r\n        window.close();\r\n\t\t");
}
            out.write("\r\n    }\r\n   /*显示批示意见到指定字段中 */\r\n   ");

	if(!"0".equals(request.getParameter("workType"))){
		if(commentList!=null && commentList.size() > 0){
			com.js.system.service.usermanager.UserBD _userBD = new com.js.system.service.usermanager.UserBD();
			String[] str3 = null;
			String commentStr = "";
			String dbrInfo;
			for(int i = 0; i < commentList.size(); i ++){
				str3 = (String[]) commentList.get(i);
				if(noDisplayFields.indexOf("$"+str3[8]+"$")>=0){
					continue;
				}
				boolean sx = false;
				try{
					Long.parseLong(str3[3]);
					sx = true;
				}catch(Exception e){}
				
				//设置时间格式
				if(str3[4].indexOf(".")>0){
					str3[4]=str3[4].substring(0,str3[4].indexOf("."));
				}
				if(str3[4].indexOf(":")>0){
					str3[4]=str3[4].substring(0,str3[4].lastIndexOf(":"));
				}
				//用户是否有图片签名
				String userShowHTML=_userBD.getSignature(str3[12]);
				if("".equals(userShowHTML)){
					userShowHTML=str3[2]==null?"已阅":str3[2];
				}else{
					if(userShowHTML!=null && userShowHTML.length()>6 && userShowHTML.substring(4,5).equals("_")){
						userShowHTML="<IMG SRC='/jsoa/upload/"+userShowHTML.substring(0,4)+"/peopleinfo/"+userShowHTML+"'>";
					}else{
						userShowHTML="<IMG SRC='/jsoa/upload/0000/peopleinfo/"+userShowHTML+"'>";
					}
				}
				//代办人信息
				if("1".equals(SystemCommon.getDocShowDbrName()) && str3[6] != null && !str3[6].toString().equals("")){
					dbrInfo="("+str3[6]+"代办)";
				}else{
					dbrInfo="";
				} 
				if(sx && str3.length>=9){
				//使用手写签名
					if(str3[8]!=null && !"-1".equals(str3[8]) && str3[8].trim().length()>0 && !str3[8].trim().toUpperCase().equals("NULL")){
            out.write("\r\n\t\t\t\t\t\tif(document.all.");
            out.print(str3[8]+"_tr");
            out.write("){\r\n\t\t\t\t\t\t\t");
if(commentStr.indexOf(str3[8])<0){
            out.write("\r\n\t\t\t\t\t\t\t\t/*if(document.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML.indexOf('name=')<0){\r\n\t\t\t\t\t\t\t\t\tdocument.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML = \"\";\r\n\t\t\t\t\t\t\t\t}*/\r\n\t\t\t\t\t\t\t");

							}
							commentStr+=str3[8];
							
            out.write("\r\n\t\t\t\t\t\t\tdocument.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML += \"<div><div><OBJECT name=\\\"incSig");
            out.print(i);
            out.write("\\\" classid=\\\"clsid:2294689C-9EDF-40BC-86AE-0438112CA439\\\" codebase=\\\"/jsoa/iWebRevision.jsp/iWebRevision.cab#version=6,0,0,0\\\" width=\\\"100%\\\" height=\\\"200\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"weburl\\\" value=\\\"");
            out.print(request.getScheme());
            out.write(':');
            out.write('/');
            out.write('/');
            out.print(request.getServerName());
            out.write(':');
            out.print(request.getServerPort());
            out.write("/jsoa/iWebRevision.jsp/iWebServer.jsp\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"recordid\\\" value=\\\"");
            out.print(str3[3]);
            out.write("\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"fieldname\\\" value=\\\"SendOut\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"username\\\" value=\\\"\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"Enabled\\\" value=\\\"0\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"PenColor\\\" value=\\\"00000000\\\">\"\r\n                                        \t\t\t+\"<param name=\\\"BorderStyle\\\" value=\\\"0\\\">\"\r\n                                    \t\t\t\t+\"</OBJECT></div>\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\"<div style=\\\"text-align:right;\\\">(");
            out.print(userShowHTML);
            out.write("&nbsp;");
            out.print(str3[4]);
            out.print(dbrInfo);
            out.write(")&nbsp;</div>\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\"</div>\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\teval(\"document.all.incSig");
            out.print(i);
            out.write(".LoadSignature()\");\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t");
 if((workStatus.equals("0") && (curCommField.indexOf("$"+str3[8]+"$")>=0 || curCommField.equals(""+str3[8])))|| (workStatus.equals("2") && (curPassRoundCommField.equals(""+str3[8]) || curPassRoundCommField.indexOf("$"+str3[8]+"$") >= 0))){
            out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t");
}
            out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t");
}
				}else{ 
				//普通意见
				if(str3[8]!=null && !"-1".equals(str3[8]) && str3[8].trim().length()>0 && !str3[8].trim().toUpperCase().equals("NULL")){
				String noSpace=repacleSpaceUtil.getNoSpaceStr(str3[3]+"");
				
            out.write("\r\n\t\t\t\tif(document.all.");
            out.print(str3[8]+"_tr");
            out.write("){\r\n\t\t\t\t\tvar comm_comment=\"");
            out.print(noSpace==null||noSpace=="null"?"":noSpace);
            out.write("\";\r\n\t\t\t\t\tif(\"null\"==comm_comment){\r\n\t\t\t\t\t  comm_comment=\"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(comm_comment==\"\"){\r\n\t\t\t\t\t\tcomm_comment=\"</br>\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\t");

	 				String projectType = session.getServletContext().getInitParameter("projectType");
						String brHtml = "";
	 				if(projectType!=null&&"tjgzw".equals(projectType)){//是天津国资委项目 批示意见 格式为 "部门姓名 <换行>日期时间"
	 					brHtml = "</br>";
	 				}
	 				String divLineHeightStr ="";
	 		        if("1".equals(SystemCommon.getIsSsdz())){
	 		        	divLineHeightStr = "line-height:1.4";
	 		        }
	 		        
            out.write("\r\n\t\t\t\t\t\r\n\t\t\t\t    ");
if("ynnt".equals(com.js.util.config.SystemCommon.getCustomerName())){
            out.write("\r\n\t\t\t\t    \tdocument.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML +=\"<div><div style='padding-top:5px;font-size:");
            out.print(com.js.util.config.SystemCommon.getDocCommentFontSize());
            out.write(';');
            out.print(divLineHeightStr);
            out.write("'>\"+comm_comment+\"");
            out.print(userShowHTML);
            out.write("&nbsp;");
            out.print(brHtml+str3[4]);
            out.print(dbrInfo);
            out.write("</div>\";\r\n\t\t\t\t    ");
}else{
				    	if(userShowHTML.indexOf("img")>=0||userShowHTML.indexOf("IMG")>=0){
				    		
            out.write("\t\t\r\n\t\t\t\t    \t\tdocument.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML +=\"<div><div style='padding-top:5px;font-size:");
            out.print(com.js.util.config.SystemCommon.getDocCommentFontSize());
            out.write(';');
            out.print(divLineHeightStr);
            out.write("'>\"+comm_comment+\"</div>\"\r\n\t\t                    +\"<div style=\\\"text-align:right;font-size:");
            out.print(com.js.util.config.SystemCommon.getDocCommentFontSize());
            out.write(";\\\">");
            out.print(userShowHTML);
            out.write("&nbsp;");
            out.print(brHtml+str3[4]);
            out.print(dbrInfo);
            out.write("&nbsp;</div>\"\r\n\t\t\t\t\t\t  +\"</div>\";\r\n\t\t    \t\t");
	}else{
            out.write("\r\n\t\t\t\t    \t\tdocument.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML +=\"<div><div style='padding-top:5px;font-size:");
            out.print(com.js.util.config.SystemCommon.getDocCommentFontSize());
            out.write(';');
            out.print(divLineHeightStr);
            out.write("'>\"+comm_comment+\"</div>\"\r\n\t\t                    +\"<div style=\\\"text-align:right;font-size:");
            out.print(com.js.util.config.SystemCommon.getDocCommentFontSize());
            out.write(";\\\">");
            out.print(userShowHTML);
            out.write("&nbsp;");
            out.print(brHtml+str3[4]);
            out.print(dbrInfo);
            out.write("&nbsp;</div>\"\r\n\t\t\t\t\t\t  +\"</div>\";\r\n\t\t    \t\t\r\n\t\t    \t\t");
	} 
			    	}
            out.write("\r\n\t\t\t\t}\r\n\t\t\t\t");

 				if("shandongguotou".equals(com.js.util.config.SystemCommon.getCustomerName())){
 					
            out.write("\r\n \t\t\t\t\tdocument.all.");
            out.print(str3[8]+"_tr");
            out.write(".innerHTML +=\"<hr style=\\\"border-style: dashed;border-color:#A3A3A3;\\\"/>\";\r\n \t\t\t\t");
}}} //end of 普通意见
            out.write("\t\t\t\t\r\n\t\t\t\t");
}
            out.write("\r\n\t\t\t");
}}
            out.write("\r\n    /*显示批示意见到指定字段中 */\r\n}\r\nfunction changeNumber(){\t   \r\n\tvar wordValue=document.all.sendFileDepartWord.value;\r\n\tvar field3 = document.getElementById(\"field3\").value;\r\n\tif(wordValue!=\"\"){\t\t \r\n\t\tmystr=wordValue.split(\";\");      \r\n\t\tvar sendWordId=mystr[0];\r\n\t\tif(sendWordId==\"\"){\r\n\t\t\talert(\"机关代字为空！\");\r\n\t\t\treturn ;\r\n\t\t}else{\r\n\t\t\topenPupWin(\"/jsoa/GovSendFileAction.do?action=initZjkySendWord&sendWordId=\"+sendWordId+\"&changeNumType=add&field3=\"+field3,400,200);\r\n\t\t}\t\t\t\t\t\r\n\t}else{\r\n\t\talert(\"机关代字为空！\");\t\t \r\n\t\treturn;\t\t \r\n\t} \r\n}\r\n\r\n/*选择文号*/\r\nfunction changeNumber2(){\r\n    if(GovSendFileActionForm.documentSendFileHead.value ==-1) {\r\n    GovSendFileActionForm.documentSendFileByteNumber.value = \"\" ;\r\n\tif(GovSendFileActionForm.field1&&GovSendFileActionForm.field1.type!=\"hidden\")\r\n    GovSendFileActionForm.field1.value = \"\" ;\r\n    if(GovSendFileActionForm.field2&&GovSendFileActionForm.field2.type!=\"hidden\")\r\n    GovSendFileActionForm.field2.value = \"\" ;\r\n\tif(GovSendFileActionForm.field3&&GovSendFileActionForm.field3.type!=\"hidden\")\r\n");
            out.write("\tGovSendFileActionForm.field3.value = \"\" ;\r\n    return ;\r\n    }\r\n    document.all.ifrm.src = \"/jsoa/GovSendFileAction.do?action=initNumber&fileNumberId=\"+GovSendFileActionForm.documentSendFileHead.value+\"&sendFileYear=\"+ GovSendFileActionForm.field2.value;\r\n}\r\n<govCheckLength>\r\n/*检查页面参数有效性*/\r\nfunction initPara() {     \r\n  if(!isPhone(document.all.field10)){   \r\n   return false;\r\n  }\r\n  if(!checkFieldLength()){ \r\n    return false;\r\n  }    \r\n  if(checkText(GovSendFileActionForm.documentSendFileTitle,95,\"发文标题\")){  \r\n      checkOffice();//\r\n\tif(document.all.documentSendFileTitle.value.indexOf(\"#\")>0){\r\n\talert(\"标题不能含'#'\");\r\n\treturn false;\r\n\t}\r\n    var numId=document.all.sendFilePoNumId.value;\r\n\tvar numxuhao=document.all.field2.value;\r\n\r\n\tif(numId!=\"\"&&numxuhao!=\"\"){\r\n     var http_request = false;\r\n   \r\n    if(window.XMLHttpRequest) {\r\n        http_request = new XMLHttpRequest();\r\n        if (http_request.overrideMimeType) {\r\n            http_request.overrideMimeType('text/xml');\r\n        }\r\n    } else if (window.ActiveXObject) { \r\n");
            out.write("        try {\r\n            http_request = new ActiveXObject(\"Msxml2.XMLHTTP\");\r\n        } catch (e) {\r\n            try {\r\n                http_request = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n            } catch (e) {}\r\n        }\r\n    }\r\n    if (!http_request) { \r\n        window.alert(\"不能创建XMLHttpRequest对象实例.\");\r\n        return false;\r\n    }else{\r\n        var url = \"/jsoa/doc/doc/doc_judge.jsp?numId=\" + numId+\"&record=");
            out.print(request.getParameter("record"));
            out.write("\"+\"&field2=\"+numxuhao;\r\n       \r\n        http_request.open(\"GET\", url, false);/*此处需同步执行*/\r\n        http_request.send(null);\r\n    }\r\n    if (http_request.readyState == 4) { \r\n        if (http_request.status == 200) { \r\n            var result = http_request.responseText;\r\n            if(result == 0){\r\n                alert(\"文号重复！\");\r\n                return false;\r\n            }\r\n        } else { /*页面不正常*/\r\n            alert(\"您所请求的页面有异常。\");\r\n        }\r\n    }\r\n\t}\r\n\tsetNewUpdate();//判断哪些标签修改了\r\n\ttrimrnTitle();//去掉 标题与 附件描述的 换行\t\r\n\tif(false==wordMustCheck()){\r\n    \treturn false;\r\n    }\r\n\t");

   	//判断手写意见是否为空
   	if(com.js.util.config.SystemCommon.getHandWriteNotEmpty()==1){
   	
            out.write("\r\n   \t\tif(!include_saveSignature()){\r\n             return false;\r\n      }\r\n   \t");
}
            out.write("   \t\r\n\treturn true;\t\r\n\t}else{\t\r\n    return false;\r\n\t}\r\n}\r\n//去掉标题 ，附件说明换行\r\nfunction trimrnTitle(){\r\n\tvar title=document.all.documentSendFileTitle.value;\r\n\ttitle=title.Trimrn();\r\n\tdocument.all.documentSendFileTitle.value=title;\r\n}\r\n\r\n//是否是号码\r\nfunction isPhone(obj) {\r\n    var str = \"0123456789- ()\" ;\r\n    var val = obj.value ;\r\n    for(var i = 0  ; i < val.length ; i++ ) {\r\n        if(str.indexOf(val.substring(i,i+1))==-1) {\r\n            alert(\"号码允许字符：0123456789-( )\") ;\r\n            obj.focus() ;\r\n            obj.select();\r\n            return false ;\r\n        }\r\n    }\r\n    return true ;\r\n}\r\n\r\nfunction setNewUpdate(){\r\n      if(document.all.oldTitle.value!=document.all.documentSendFileTitle.value){\r\n       document.all.oldTitle.value=\"1\";     \r\n      }\r\n\t if(document.all.toPerson1){\r\n      if(document.all.oldToPerson1.value!=document.all.toPerson1.value){ \r\n\t    document.all.oldToPerson1.value=\"2\";\r\n       }\r\n      }\r\n\t  if(document.all.toPerson2){\r\n\t\t  if(document.all.oldToPerson2.value!=document.all.toPerson2.value){\r\n");
            out.write("\t\t\t  document.all.oldToPerson2.value=\"3\";\r\n\t\t  }\r\n      }\r\n\t  if(document.all.toPersonInner){\r\n        if(document.all.oldToInnner.value!=document.all.toPersonInner.value){\r\n\t      document.all.oldToInnner.value=\"4\";\r\n        }\r\n\t  }     \r\n}\r\n//转收文\r\nfunction sendToReceive(){\r\nopenPupWin(\"/jsoa/doc/doc/sendocument_bottom_toSend.jsp?fileTitle=\"+document.all.documentSendFileTitle.value+\"&byteNum=\"+document.all.documentSendFileByteNumber.value+\"&seqNum=\"+document.all.zjkySeq.value+\"&sendRecordId=\"+document.all.editId.value+\"&accessoryName1=");
            out.print(contentAccName);
            out.write("&accessorySaveName1=");
            out.print(contentAccSaveName);
            out.write("&accessoryName2=");
            out.print(request.getAttribute("accessoryName")==null?"":request.getAttribute("accessoryName"));
            out.write("&accessorySaveName2=");
            out.print(request.getAttribute("accessorySaveName")==null?"":request.getAttribute("accessorySaveName"));
            out.write("&tableId=");
            out.print(read_tableId);
            out.write("\",'mydwin','TOP=0,LEFT=0,scrollbars=yes,resizable=yes,width=400,height=200');\r\n}\r\n//收文 转文件送审签\r\nfunction  toSendfilecheck(){\r\n\tJSMainWinOpen4(\"/jsoa/doc/doc/sendocument_bottom_tosendfilecheck.jsp?id=");
            out.print(request.getParameter("record"));
            out.write("&sendType=sendFile&fileTitle=\"+document.all.documentSendFileTitle.value+\"&accessory1=");
            out.print(contentAccName);
            out.write("&accessorySaveName1=");
            out.print(contentAccSaveName);
            out.write("&accessoryName2=");
            out.print(request.getAttribute("accessoryName")==null?"":request.getAttribute("accessoryName"));
            out.write("&accessorySaveName2=");
            out.print(request.getAttribute("accessorySaveName")==null?"":request.getAttribute("accessorySaveName"));
            out.write("\",'mydwin','TOP=0,LEFT=0,scrollbars=yes,resizable=yes,width=400,height=200',500,250);\r\n}\r\nfunction selecttw() {\r\nvar hhref = \"/jsoa/SenddocumentBaseAction.do?action=chooseSendTopical\" ;\r\n    JSMainWinOpen4(hhref,'','TOP=0,LEFT=0,scrollbars=yes,resizable=no,width=600,height=300',600,300) ;\r\n}\r\nfunction showAcc(scan){\r\nopenPupWin(\"/jsoa/public/jsp/pup.jsp?path=govdocumentmanager&fileName=accessoryName&saveName=accessorySaveName&canModify=\"+scan,550,400);\r\n}\r\n //起草正文\r\nfunction wordWindowFirst(){\r\n\t  var underwriteTime=\"\";\r\n\t  var hasSeal=\"\";\r\n      var departWord=\"\";\r\n      var  wordValue=document.all.sendFileDepartWord.value;   \r\n  \t  if(typeof(wordValue)!=\"undefined\"&&wordValue!=\"\"){\r\n          mystr=wordValue.split(\";\");      \r\n\t\t  departWord=mystr[1];               \r\n\t   }\r\n\t   document.all.RecordID.value = document.all.content.value;\r\n\t   document.all.Template.value =\"\";//现在起抄的时候不套模板\r\n\t   document.all.showSignButton.value=\"0\";\r\n\t   document.all.ShowSign.value=\"-1\";\r\n\t   document.all.textContent.value=\"\";\r\n\t   document.all.loadTemp.value=\"0\";\r\n");
            out.write("\t");
if(SystemCommon.getiWebOfficeVersion().equals("2015")) {
		
            out.write("\r\n\t\tvar docUrl = \"/jsoa/iWebOffice2015/DocumentEdit.jsp?1=1\";\r\n\t\t");

	}else{	
	
            out.write("\r\n\tvar docUrl = \"/jsoa/iWebOfficeSign/DocumentEdit.jsp?1=1\";\r\n\t");

		} 
	
            out.write("\r\n\tvar formlist = document.getElementById(\"form1\").childNodes;\r\n\tfor(var i=0;i<formlist.length;i++){\r\n\t    //alert(formlist[i].type+\"  \"+i+\"  \"+formlist[i].name+\"   \"+formlist[i].value);\r\n\t    if(formlist[i].type==\"hidden\"){\r\n\t    \tdocUrl += \"&\"+formlist[i].name+\"=\"+formlist[i].value;\r\n\t    }\r\n\t}\r\n\t//alert(docUrl);\r\n\tJSMainWinOpen(docUrl, \"editContent\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\");\r\n\t//form1.target=\"editContent\";\r\n\t//form1.submit();\r\n}\r\n//生成正式文件\r\nfunction wordWindowDue(){\r\n\t var underwriteTime=\"\";\r\n\t var hasSeal=\"\";\r\n\t var underwritePerson=\"\";\t\r\n\t var underwriteCont = \"");
            out.print(qianfaContent);
            out.write("\";\r\n\t underwriteTime=\"");
            out.print(qianfaTime);
            out.write("\";\r\n\t underwritePerson=\"");
            out.print(qianfaName);
            out.write("\";\r\n\t hasSeal=\"1\";\t \r\n\t  var departWord=\"\";\r\n      var  wordValue=document.all.sendFileDepartWord.value;  \r\n      if(wordValue!=\"\"){\t\t \r\n             mystr=wordValue.split(\";\");      \r\n\t\t\t  departWord=mystr[1];               \r\n\t  }            \r\n\t //检查\r\n\t if(!checkTextBe()){\r\n\t\t return ;\r\n\t }\r\n\t trimrnTitle();//去掉 标题与 附件描述的 换行\r\n\tdocument.all.RecordID.value = document.all.content.value;\r\n\tvar rr=document.all.documentSendFileSendTime.value;\r\n\trr=rr.replace(\"/\",\"年\");\r\n\trr=rr.replace(\"/\",\"月\");\r\n\trr=rr+\"日\"; \r\n\t//document.all.documentSendFileSendTime_1.value=rr;\r\n\tdocument.all.sendFileRedHeadId_1.value = document.all.sendFileRedHeadId.value;\r\n\tdocument.all.hasSeal.value =hasSeal;\r\n\tdocument.all.underwriteTime.value=underwriteTime;\r\n\t<setGovBookMarks>\r\n\tdocument.all.showTempSign.value=\"1\";\r\n\tdocument.all.showTempHead.value=\"1\";\r\n\tdocument.all.showTransPDF.value=\"1\";\r\n\tdocument.all.FileType.value=document.all.documentWordType.value;\r\n    var  wordValue=document.all.sendFileDepartWord.value;  \r\n     if(wordValue!=\"\"){\t\t \r\n");
            out.write("             mystr=wordValue.split(\";\");    \r\n\t\t\t document.all.wordId.value=mystr[0];               \r\n\t }else{\r\n\t     document.all.wordId.value=\"\";\t \r\n\t }  \r\n     if(document.all.Template.value!=\"\"){\r\n    \t MTWordWindowDue();\r\n    \t return;\r\n     }\r\n     ");

     String alreadyChooseTemplate=null;
     String thenRecordId=request.getAttribute("content")==null?"":request.getAttribute("content").toString();
     if(!"".equals(thenRecordId)){
     	//打开数据库
     	DBstep.iDBManager2000 DbaObj=new DBstep.iDBManager2000();
     	if ( DbaObj.OpenConnection()){
     	  String mSql="Select * From Document Where RecordID='"+thenRecordId + "'";
     	  try {
     		  java.sql.ResultSet result=DbaObj.ExecuteQuery(mSql);
     	    if (result.next()) {
     	    	alreadyChooseTemplate=result.getString("Template");
     	    }
     	    result.close();
     	  } catch(java.sql.SQLException e){
     	   // System.out.println(e.toString());
     	  }
     	  DbaObj.CloseConnection() ;
     	}
     }
     if(null !=alreadyChooseTemplate && !alreadyChooseTemplate.isEmpty() && !"null".equals(alreadyChooseTemplate)){
  	    
            out.write("\r\n  \t    document.all.Template.value=\"");
            out.print(alreadyChooseTemplate);
            out.write("\";\r\n  \t    MTWordWindowDue();\r\n  \t    ");

  	     }else{
     if("shandongguotou".equals(com.js.util.config.SystemCommon.getCustomerName())){
     
            out.write("\r\n     JSMainWinOpen4(\"/jsoa/doc/doc/senddocument_selectTemplate.jsp?templates=\"+document.all.templateId.value, \"fff\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\",500,250);\r\n     ");
}else{
            out.write("\r\n\t var  templateIds=document.all.templateId.value;\r\n\t if(templateIds.charAt(templateIds.length-1)==\";\"){\r\n\t\t templateIds=templateIds.substring(0,templateIds.length-1);//去掉最后一个分号\r\n\t }\r\n\t var  templateArr=templateIds.split(\";\");\r\n\t if(templateArr.length>1){ \r\n\t    JSMainWinOpen4(\"/jsoa/doc/doc/senddocument_selectTemplate.jsp?templates=\"+templateIds, \"fff\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\"); \r\n\t }else{\r\n\t document.all.Template.value = templateIds;\r\n\t JSMainWinOpen4(\"\", \"editContent\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\",\"\",\"800\"); \r\n\t form1.target=\"editContent\";\r\n\t form1.submit();\r\n\t managerDueWord();\r\n\t } \r\n\t ");
}}
            out.write("\r\n}\r\nfunction MTWordWindowDue(){\r\n\tJSMainWinOpen4(\"\", \"editContent\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\",\"\",\"800\"); \r\n\tform1.target=\"editContent\";\r\n\tform1.submit();\r\n\tmanagerDueWord(); \r\n}\r\n//已查看用户\r\nfunction showHasRead() {\r\nJSMainWinOpen('/jsoa/GovReceiveFileBoxAction.do?action=userinfo&type=showHasRead&editId=");
            out.print(read_recordId);
            out.write("','','left=0,top=0,scrollbars=yes,resizable=yes,width=780,height=500');\r\n}\r\n//未查看用户\r\nfunction showNotRead() {\r\nJSMainWinOpen('/jsoa/GovReceiveFileBoxAction.do?action=userinfo&type=showNotRead&editId=");
            out.print(read_recordId);
            out.write("','','left=0,top=0,scrollbars=yes,resizable=yes,width=780,height=500');\r\n}\r\n//查看传阅\r\nfunction viewRead(){\r\nJSMainWinOpen(\"/jsoa/doc/doc/sendocument_Read_main.jsp?tableId=");
            out.print(read_tableId);
            out.write("&processId=");
            out.print(read_processId);
            out.write("&recordId=");
            out.print(read_recordId);
            out.write("\",'查看传阅','menubar=0,scrollbars=0,locations=0,width=800,height=600,resizable=no');\r\n}\r\n//选择主送 ，抄送\r\nfunction openEndowSend(type){\r\n\tif(type==\"toPerson1\"){   \r\n\t    openEndow('toPerson1Id','toPerson1',document.all.toPerson1Id.value,document.all.toPerson1.value,'org','no','org','");
            out.print(session.getAttribute("browseRange"));
            out.write("');\r\n\t}\r\n\tif(type==\"toPerson2\"){   \r\n\t    openEndow('toPerson2Id','toPerson2',document.all.toPerson2Id.value,document.all.toPerson2.value,'org','no','org','");
            out.print(session.getAttribute("browseRange"));
            out.write("');\r\n\t}\r\n\r\n\tif(type==\"toPersonBao\"){   \r\n\t    openEndow('toPersonBaoId','toPersonBao',document.all.toPersonBaoId.value,document.all.toPersonBao.value,'org','no','org','");
            out.print(session.getAttribute("browseRange"));
            out.write("');\r\n\t}\r\n\r\n\tif(type==\"toPersonInner\"){   \r\n\t    openEndow('toPersonInnerId','toPersonInner',document.all.toPersonInnerId.value,document.all.toPersonInner.value,'org','no','org','");
            out.print(session.getAttribute("browseRange"));
            out.write("');\r\n\t}\r\n}\r\n//套用模板时检验\r\nfunction checkTextBe(){\r\n  if(document.all.sendFileDepartWord.value==\"\"){\r\n   alert(\"机关代字不能为空！\");\r\n   return false;\r\n  }\r\n   if(document.all.documentSendFileTitle.value==\"\"){\r\n   alert(\"标题不能为空！\");\r\n   return false;\r\n  }\r\n return true;\r\n}\r\n// 生成正文管理文件\r\n function managerDueWord(){\r\n   if(document.all.content.value!=\"\"){\r\n    var oldName=document.all.contentAccSaveName.value;\r\n\tif(oldName==\"\"){\r\n\t document.all.contentAccSaveName.value=document.all.content.value+document.all.documentWordType.value;\r\n     document.all.contentAccName.value=document.all.documentSendFileTitle.value+document.all.documentWordType.value;\r\n\t}else{\r\n        var  name=document.all.content.value+document.all.documentWordType.value;\r\n        var resultJ=oldName.indexOf(name);\r\n\t\tif(resultJ==-1){\r\n           document.all.contentAccSaveName.value+=\"|\"+document.all.content.value+document.all.documentWordType.value;\r\n           document.all.contentAccName.value+=\"|\"+document.all.documentSendFileTitle.value+document.all.documentWordType.value;\r\n");
            out.write("\t\t\r\n\t\t}\t\r\n\t}\r\n   } \r\n }\r\n\r\nfunction commPrint(){\r\nalert(\"预留接口，功能暂未实现!\");\r\n}\r\n\r\nfunction sendPrinttext(){\r\nalert(\"预留接口，功能暂未实现!\");\r\n}\r\n\r\n//归档\r\nfunction saveDocument(){\r\nalert(\"预留接口，功能暂未实现!\");\r\n}\r\n\r\n//打印\r\nfunction printTable(){\r\n\tJSMainWinOpen(\"/jsoa/GovSendFileAction.do?action=listLoad&editId=");
            out.print(request.getParameter("record"));
            out.write("&editType=0&canEdit=0&viewOnly=1&myFile=1&isPrint=1&tableId=");
            out.print(read_tableId);
            out.write("&work=\"+document.getElementsByName(\"workId\")[0].value, \"\", \"TOP=0,LEFT=0,scrollbars=yes,resizable=yes,width=800,height=600\");\r\n\r\n}\r\n\r\n\r\n //检查办公用语\r\n function checkOffice(){\r\n\t //承办单位意见：\r\n\t");
 
	  if(commentName!=null&&commentName.length>0){	
		for(int i=0;i<commentName.length;i++){
			if((workStatus.equals("0") && (curCommField.indexOf("$"+commentName[i]+"$")>=0 || curCommField.equals(commentName[i].toString())))|| (workStatus.equals("2") && (curPassRoundCommField.equals(commentName[i].toString()) || curPassRoundCommField.indexOf("$"+commentName[i]+"$") >= 0))){
			
            out.write("\r\n\r\n\t\t   \tdocument.all.whichBatch.value=\"");
            out.print(commentName[i].toString());
            out.write("\";  \r\n\t\t   \t//为空加默认的\r\n\t\t   \tif(document.all.commentSignType){\r\n\t\t\t   \tif(document.getElementsByName(\"");
            out.print(commentName[i].toString());
            out.write("\")[document.all.commentSignType.value].value==\"\"){\r\n\t\t\t\t\t//var dd=getRadiovalue(\"");
            out.print(commentName[i]);
            out.write("_radio\");\r\n\t\t\t\t\tdocument.getElementsByName(\"");
            out.print(commentName[i].toString());
            out.write("\")[document.all.commentSignType.value].value=getRadiovalue(\"");
            out.print(commentName[i]);
            out.write("_radio\");\r\n\t\t\t\t}\r\n\t\t   \t}\r\n\t      ");
}
		}
	}
            out.write("\r\n}\r\n//取radio 值函数\r\nfunction getRadiovalue(objStr){\r\n \tvar haveY=document.getElementsByName(objStr); \r\n\tvar yvalue=\"\";\r\n\tfor(i=0;i<haveY.length;i++){\r\n\t\tif(haveY[i].checked){\r\n\t\t\tyvalue=haveY[i].value;  \r\n\t\t}\r\n    }\r\n\treturn yvalue;\r\n}\r\n//邮件转发\r\nfunction transmit(){\r\n var  toId=document.all.candidateId.value;\r\n var  toName=document.all.candidate.value;\r\n var  editId=document.all.editId.value;\r\n \r\n  if(toName==\"\"){\r\n   alert(\"请选择接收者\");\r\n   return;\r\n  }\r\n  document.all.GovSendFileActionForm.action=\"/jsoa/GovSendFileAction.do?action=mailtransmit&toId=\"+toId+\"&toName=\"+toName+\"&editId=\"+editId+\"&isEdit=1\";\r\n  document.all.GovSendFileActionForm.submit();\r\n}\r\n\r\n\r\n// 发文分发\r\nfunction sendToMy(){\r\n\tvar  toId=document.all.sendToMyId.value;\r\n\tvar  toName=document.all.sendToMyName.value;\r\n\tvar  editId=document.all.editId.value;\r\n\tif(toName==\"\"){\r\n\talert(\"请选择接收者\");\r\n\treturn;\r\n\t}\r\n\tdocument.all.GovSendFileActionForm.action=\"/jsoa/GovSendFileAction.do?action=sendToMy&sendToId=\"+toId+\"&toName=\"+toName+\"&editId=\"+editId+\"&isEdit=1&documentSendFileTitle\"+document.all.documentSendFileTitle.value+\"&sendFileNeedRTX=\"+document.all.sendFileNeedRTX.value+\"&sendFileNeedSendMsg2=\"+document.all.sendFileNeedSendMsg2.value+\"&isinmodijsp=1&isInModify=isInModify&sendStatus=");
            out.print(sendStatus);
            out.write("\";\r\n\tdocument.all.GovSendFileActionForm.target=\"ifrm1\";//发送不关闭\r\n\tdocument.all.GovSendFileActionForm.submit();\r\n\tdocument.all.GovSendFileActionForm.target=\"\";\r\n}\r\nfunction sendToMyCancel(){\r\n\tvar  editId=document.all.editId.value;\r\n\tdocument.all.GovSendFileActionForm.action=\"/jsoa/GovSendFileAction.do?action=sendToMyCancel&editId=\"+editId;\r\n\tdocument.all.GovSendFileActionForm.target=\"ifrm1\";//发送不关闭\r\n\tdocument.all.GovSendFileActionForm.submit();\r\n\tdocument.all.GovSendFileActionForm.target=\"\";\r\n}\r\n//选择办公用语\r\nfunction offiDict(textAreaName){\r\n  JSMainWinOpen4('/jsoa/jsflow/workflow_offiDict.jsp?userId=");
            out.print(session.getAttribute("userId"));
            out.write("&textAreaName=' + textAreaName,'','menubar=0,scrollbars=yes,locations=0,width=400,height=200,resizable=yes',500,250);\r\n}\r\nfunction getNum(){\r\n document.all.ifrm.src = \"/jsoa/GovSendFileAction.do?action=initSendNum&processId=");
            out.print(pd);
            out.write("\";\r\n}\r\nfunction modify(){\r\n\t   if(!initPara()){\r\n\t    return ;\r\n\t   }       \r\n\t document.all.isInModify.value=\"isInModify\";\t document.all.GovSendFileActionForm.action=\"/jsoa/GovSendFileAction.do?action=update&sendStatus=");
            out.print(sendStatus);
            out.write("&table=");
            out.print(read_tableId);
            out.write("\";\r\n    document.all.GovSendFileActionForm.submit();\r\n}\r\n//补发直接发送\r\nfunction supplySend(){\r\n    if(!initPara()) return;\r\n\tif(document.all.sendToId2.value==\"\"){\r\n    window.alert(\"请选择要发送的人！\");\r\n\treturn;\r\n\t}\r\n    GovSendFileActionForm.action = \"GovSendFileAction.do?action=supplySend\";\r\n    GovSendFileActionForm.submit();\r\n}\r\n\r\n//切换 机关代字\r\nfunction   changeSenddocumentWord(){\r\n   var  wordValue=document.all.sendFileDepartWord.value;\r\n     if(wordValue!=\"\"){\t\t \r\n             mystr=wordValue.split(\";\"); \t\t\t \r\n\t\t\t if(mystr.length>3){\r\n\t\t\t\t   var  sendWordId=mystr[0]; //机关代字 id \r\n\t\t\t       var  sendWord=mystr[1];   //机关代字名\r\n\t\t\t\t   var  temId=\"\";      //模班id \t\t\r\n\t\t\t\t   for(ii=2;ii<mystr.length;ii++){\r\n                        temId+=mystr[ii]+\";\";\r\n\t\t\t\t   }\r\n\t\t\t\t   temId=temId.substring(0,temId.length-1);\r\n\t               document.all.templateId.value=temId;\t\t\t \r\n\t\t\t }else{\r\n\t\t\t\t  var  sendWordId=mystr[0]; //机关代字 id \r\n\t\t\t      var  sendWord=mystr[1];   //机关代字名\r\n\t\t\t      var  temId=mystr[2];      //模班id \t\t\r\n\t              document.all.templateId.value=temId;\t\t\t \r\n");
            out.write("\t\t\t }         \r\n\t }else{\r\n\t     document.all.templateId.value=\"\";\t \r\n\t }  \t \r\n\t document.all.documentSendFileByteNumber.value=\"\";\r\n\t document.all.sendFilePoNumId.value=\"\";\r\n}\r\nfunction wordMustCheck(){\r\n\t");

	if(!"".equals(mustword) && !"null".equals(mustword) && mustword!=null){
		String[] must=mustword.split(",");
		for(int i=0;i<must.length;i++){
			if(govcheckfield.indexOf(must[i])>=0){
				if(curModifyField.indexOf(must[i])>=0){
					
            out.write("\r\n\t\t\t\t\tvar val=document.getElementById(\"");
            out.print(must[i]);
            out.write("\").value;\r\n\t\t\t\t\tif(val==\"\" || val==null){\r\n\t\t\t\t\t\talert(\"必填项不能为空！\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t");

				}
			}
		}
	}
	
            out.write("\r\n\treturn true;\r\n}\r\n</script>\r\n<iframe id=\"myIframe\" name=\"myIframe\" style=\"display:none;\"></iframe>\r\n<form name=\"form1\" id=\"form1\" ");
 if(SystemCommon.getiWebOfficeVersion().equals("2015")){
            out.write("action=\"/jsoa/iWebOffice2015/DocumentEdit.jsp\"");
}else{
            out.write("action=\"/jsoa/iWebOfficeSign/DocumentEdit.jsp\"");
}
            out.write(" method=\"post\">\r\n<input type=\"hidden\" name=\"RecordID\">\r\n<input type=\"hidden\" name=\"EditType\" value=\"1\">\r\n<input type=\"hidden\" name=\"UserName\" value=\"");
            out.print(session.getAttribute("userName"));
            out.write("\">\r\n<input type=\"hidden\" name=\"ShowSign\" value=\"0\">\r\n<input type=\"hidden\" name=\"CanSave\" value=\"1\">\r\n<input type=\"hidden\" name=\"showTempSign\" value=\"0\">\r\n<input type=\"hidden\" name=\"showTempHead\" value=\"1\">\r\n<input type=\"hidden\" name=\"showSignButton\" value=\"1\">\r\n<input type=\"hidden\" name=\"showEditButton\" value=\"1\">\r\n<input type=\"hidden\" name=\"loadTemp\" value=\"1\">\r\n<input type=\"hidden\" name=\"textContent\" value=\"-1\"> <!--  1 套用 content   0  不套用 content-->\r\n <input type=\"hidden\" name=\"sendFileRedHeadId_1\"  >\r\n <input type=\"hidden\" name=\"Template\" >\r\n <input type=\"hidden\" name=\"hasSeal\">\r\n <input type=\"hidden\" name=\"underwriteTime\">\r\n <govBookMarksHidden>\r\n<input type=\"hidden\" name=\"showTransPDF\" value=\"0\">\r\n<input type=\"hidden\" name=\"moduleType\"  value=\"govdocument\">\r\n<input type=\"hidden\" name=\"saveDocFile\"  value=\"1\">\r\n<input type=\"hidden\" name=\"wordId\">\r\n<input type=\"hidden\" name=\"FileType\">\r\n</form>\r\n");
            //  html:form
            org.apache.struts.taglib.html.FormTag _jspx_th_html_005fform_005f0 = (org.apache.struts.taglib.html.FormTag) _005fjspx_005ftagPool_005fhtml_005fform_0026_005fmethod_005faction.get(org.apache.struts.taglib.html.FormTag.class);
            boolean _jspx_th_html_005fform_005f0_reused = false;
            try {
              _jspx_th_html_005fform_005f0.setPageContext(_jspx_page_context);
              _jspx_th_html_005fform_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fhtml_005f0);
              // /doc/doc/sendfile_modi_temp.jsp(1189,0) name = action type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
              _jspx_th_html_005fform_005f0.setAction("/GovSendFileAction.do?action=update");
              // /doc/doc/sendfile_modi_temp.jsp(1189,0) name = method type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
              _jspx_th_html_005fform_005f0.setMethod("post");
              int _jspx_eval_html_005fform_005f0 = _jspx_th_html_005fform_005f0.doStartTag();
              if (_jspx_eval_html_005fform_005f0 != javax.servlet.jsp.tagext.Tag.SKIP_BODY) {
                do {
                  out.write("\r\n<input type=\"hidden\" name=\"thisDocProcess\" id=\"thisDocProcess\" value=\"1\" />\r\n<input type=\"hidden\" name=\"htmlContent\">\r\n<input type=\"hidden\" name=\"content\" value=\"");
                  out.print(request.getAttribute("content"));
                  out.write("\">\r\n");
                  if (_jspx_meth_html_005fhidden_005f0(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write("\r\n<!--  标记那些标签修改过了  -->\r\n<input type=\"hidden\" name=\"oldTitle\" >\r\n<input type=\"hidden\" name=\"oldToPerson1\">\r\n<input type=\"hidden\" name=\"oldToPerson2\">\r\n<input type=\"hidden\" name=\"oldToInnner\">\r\n<!--  end -->\r\n<input type=\"hidden\" name=\"sendSeqId\">\r\n<input type=\"hidden\" name=\"sendSeqfig\">\r\n<input type=\"hidden\" name=\"done\">\r\n<input type=\"hidden\" name=\"editId\" value=\"");
                  out.print(request.getParameter("record"));
                  out.write("\">\r\n");
                  if (_jspx_meth_html_005fhidden_005f1(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f2(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f3(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f4(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f5(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f6(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f7(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('	');
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f8(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f9(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f10(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f11(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f12(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f13(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f14(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f15(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f16(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f17(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f18(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f19(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write("\r\n<!--  文件类型 是 word 还是wps-->\r\n");
                  if (_jspx_meth_html_005fhidden_005f20(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write("\r\n<input type=\"hidden\" name=\"tableNameOrId\" value=\"");
                  out.print(read_tableId);
                  out.write("\">\r\n<govHiddenField>\r\n<input type=\"hidden\" name=\"candidateId\" id=\"candidateId\"><!-- 邮件 转发 时 用到-->\r\n<input type=\"hidden\" name=\"candidate\" id=\"candidate\"><!-- 邮件 转发 时 用到-->\r\n<input type=\"hidden\" name=\"addDivContent\" id=\"addDivContent\" value=\"\"> <!-- 在  常用语中用到-->\r\n<input type=\"hidden\" name=\"whichBatch\" id=\"whichBatch\" value=\"\"><!--记录哪个是批示意见-->\r\n<input type=\"hidden\" name=\"isInModify\" id=\"isInModify\" value=\"\">\r\n<input type=\"hidden\" name=\"contentAccName\" id=\"contentAccName\" value=\"");
                  out.print(contentAccName);
                  out.write("\">\r\n<input type=\"hidden\" name=\"contentAccSaveName\" id=\"contentAccSaveName\" value=\"");
                  out.print(contentAccSaveName);
                  out.write("\">\r\n<input type=\"hidden\" name=\"sendToMyId\" id=\"sendToMyId\" >\r\n<input type=\"hidden\" name=\"sendToMyName\" id=\"sendToMyName\">\r\n<input type=\"hidden\" name=\"sendToType\" id=\"sendToType\" value=\"0\">\r\n<input type=\"hidden\" name=\"documentCreateTime\" id=\"documentCreateTime\" value=\"");
                  out.print(createTimeStr);
                  out.write("\">\r\n<input type=\"hidden\" name=\"sendFileNeedSendMsg2\" id=\"sendFileNeedSendMsg2\" value=\"0\">\r\n<input type=\"hidden\" name=\"sendFileNeedRTX\" id=\"sendFileNeedRTX\" value=\"0\">\r\n<input type=\"hidden\" name=\"sendSMS\" id=\"sendSMS\" value=\"0\" /><!-- 是否发送短信标识 -->\r\n<input type=\"hidden\" name=\"commentOrg\" id=\"commentOrg\" value=\"");
                  out.print(StaticParam.getOrgNameStringByEmpId(userId));
                  out.write("\"><!-- 批示用户所在组织 -->\r\n");
if(request.getParameter("resubmit")!=null&&request.getParameter("resubmit").toString().equals("1")&&request.getParameter("work") != null){
                  out.write("\r\n  <input type=\"hidden\" name=\"resubmitWorkId\" value=\"");
                  out.print(request.getParameter("work").toString());
                  out.write("\">\r\n  ");
}
                  out.write('\r');
                  out.write('\n');

boolean banli=(request.getParameter("option")!=null&&"banli".equals(request.getParameter("option")))?true:false;
if(banli){

                  out.write("\r\n<script src=\"");
                  out.print(basePath );
                  out.write("js/js.js\" language=\"javascript\"></script>\r\n<script language=\"javascript\">\r\nresizeWin(700,600);\r\n</script>\r\n");
}
                  out.write("\r\n<!--重新提交-->\r\n");
String weburl=request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+ "/jsoa/iWebRevision.jsp/iWebServer.jsp";
                  out.write("\r\n\r\n");
String prName="";
				 if(request.getParameter("processName")!=null&&!request.getParameter("processName").toString().equals("null")&&!request.getParameter("processName").toString().equals("NULL")){
				  prName=request.getParameter("processName").toString();				 
				 }				 
				
                  out.write('\r');
                  out.write('\n');
                  if (_jspx_meth_html_005fhidden_005f21(_jspx_th_html_005fform_005f0, _jspx_page_context))
                    return;
                  out.write("\r\n\r\n\r\n\r\n\r\n<div id=\"popToolbar\" style=\"height:23px; width: 100%;\"><div id=\"commandBar\" style=\"width: 100%;\"></div></div>\r\n \r\n<div id=\"mainContent\" style=\"width:100%; overflow:auto;z-index:-1\">\r\n\t<table width=\"100%\" border=\"0\" cellpadding=\"10\" cellspacing=\"0\" class=\"docBoxNo\"  style=\"background-color:#ffffff;border:0px;\">\r\n\t\t<tr>\r\n\t\t\t<td align=\"right\" valign=\"middle\" style=\"padding-top:5px;\">\r\n\t\t\t\t<table width=\"96%\" border=\"0\" align=\"center\" cellpadding=\"1\" cellspacing=\"1\">\r\n         \t\t\t<tr>\r\n         \t\t\t\t<td width=\"100%\">\r\n         \t\t\t\t\t<div id=\"panleAll\" style=\"text-align:left\">\r\n\t\t\t\t\t\t\t\t<span id=\"Panle0\" onClick=\"btnSelect(0);\" style=\"color:red;cursor:pointer\">基本信息</span>\t\r\n\t\t\t\t\t\t\t\t| \r\n\t\t\t\t\t\t\t\t\t<span id=\"Panle1\" onClick=\"btnSelect(1);\" style=\"color:black;cursor:pointer;\">流程图</span>\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t| <span id=\"Panle2\" onClick=\"btnSelect(2);\" style=\"color:black;cursor:pointer\">流程记录</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td height=\"312\" valign=\"top\" width=\"100%\">\r\n");
                  out.write("\t\t\t\t<div id=\"docinfo0\">\r\n\t\t\t\t\t<table width=\"100%\">\r\n\t\t\t     \t\t");

			     		if("1".equals(SystemCommon.getShowDocumentProcessTitle())){
			     			
                  out.write("\r\n\t\t\t       \t\t\t<tr ");
                  out.print(banli?"style='display:none'":"");
                  out.write(">\r\n                      \t\t\t<td width=\"100%\" height=\"15\"  align=\"center\" class=big0>\r\n                      \t\t\t\t<font style=\"font-size:30\" class=\"mustFillcolor\"><b>");
                  out.print(prName);
                  out.write("</b></font>\r\n\t\t\t\t\t  \t\t\t</td>\r\n                    \t\t</tr>\r\n\t\t\t\t\t\t\t");

						}
			     		if(request.getAttribute("fromReceiveFileLink") != null && !request.getAttribute("fromReceiveFileLink").toString().equals("null")){
			     			
                  out.write("\r\n\t\t\t\t        \t<input type=\"hidden\" name=\"fromReceiveFileId\" value=\"");
                  out.print(request.getAttribute("fromReceiveFileId"));
                  out.write("\">\r\n\t\t\t\t\t        <input type=\"hidden\" name=\"fromReceiveFileLink\" value=\"");
                  out.print(request.getAttribute("fromReceiveFileLink"));
                  out.write("\">\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t  \t\t\t<td height=\"40\">\r\n\t\t\t\t\t  \t\t\t\t<span style=\"cursor:pointer\" onClick=\"JSMainWinOpen('");
                  out.print(request.getAttribute("fromReceiveFileLink"));
                  out.write("','','TOP=0,LEFT=0,scrollbars=yes,resizable=yes,width=800,height=580');\">\r\n\t\t\t\t\t  \t\t\t\t\t<font color=\"blue\">查询相关收文审批</font>\r\n\t\t\t\t\t  \t\t\t\t</span>\r\n\t\t\t\t\t  \t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t");

						}
						
			     		//文件送审签转发文
						if(request.getAttribute("fromFileSendCheckLink") != null){
							
                  out.write("\r\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"fromFileSendCheckId\" value=\"");
                  out.print(request.getAttribute("fromFileSendCheckId"));
                  out.write("\">\r\n\t\t\t\t\t\t\t<input type=\"hidden\" name=\"fromFileSendCheckLink\" value=\"");
                  out.print(request.getAttribute("fromFileSendCheckLink"));
                  out.write("\">\r\n\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t<td height=\"28\">\r\n\t\t\t\t\t    \t\t\t<span style=\"cursor:pointer;color:blue\" onClick=\"JSMainWinOpen('");
                  out.print(request.getAttribute("fromFileSendCheckLink"));
                  out.write("','','TOP=0,LEFT=0,scrollbars=yes,resizable=yes,width=800,height=580');\" >查询相关文件送审签</span>\r\n\t\t\t\t\t   \t\t\t</td>\r\n\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t");

						}
						
                  out.write("\r\n\t\t\t\t \t\t<tr>\r\n\t\t\t\t \t\t\t<td>\r\n\t\t\t\t \t\t\t\t<govContent>\r\n\t\t\t\t \t\t\t</td>\r\n\t\t\t\t \t\t</tr>\r\n\t\t\t    \t\t");

			    		if(com.js.util.config.SystemCommon.getShowBackFordoc()==1){
			    			String backComment=new com.js.oa.jsflow.service.WorkFlowButtonBD().getBackComment(read_processId,read_tableId,read_recordId)==null?"":new com.js.oa.jsflow.service.WorkFlowButtonBD().getBackComment(read_processId,read_tableId,read_recordId);
          
			    			if(backComment!=null&&!backComment.equals("")&&!backComment.equals("null")){
			    				
                  out.write("\t\t\t\t\t\r\n\t            \t\t\t\t<tr>\r\n\t            \t\t\t\t\t<td>\r\n\t            \t\t\t\t\t\t<font color=\"#FF0000\">退回意见：</font > ");
out.print(backComment);
                  out.write("\r\n\t            \t\t\t\t\t</td>\r\n\t            \t\t\t\t</tr>\r\n\t\t\t\t \t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td height=\"28\" ><hr color=\"#FF0000\" size=\"1\"></td>\r\n\t\t\t    \t\t\t\t</tr>\r\n\t\t\t     \t\t\t\t");

			     			}
			     		}
               			String cancelHref = "JSMainWinOpen('/jsoa/doc/doc/workflow_cancelReason.jsp?workStatus=1&workId=workIdValue&search=searchValue&workTitle=workTitleValue&tableId=tableIdValue&processName=processName&processId=processIdValue&recordId=recordIdValue&fileType=GSF&fileTitle=fileTitleValue','','TOP=0,LEFT=0,scrollbars=no,resizable=no,width=480,height=250')";
                    	String formName = "GovSendFileActionForm";//在包含页中指定form的名称
                    	String saveCheckFn = "initPara()";//保存时校验表单的javascript函数名称
                     	String mainLinkFile = "/jsoa/GovSendFileLoadAction.do?action=load";//文件办理时打开的页面链接
						//String passLinkFile="/jsoa/GovReceiveFileBoxAction.do?action=loadFile&editId="+request.getParameter("record")+"&canEdit=1&isEdit=0&viewType=1&showReceiveFile=1&transmitType=wordTransmit";//文件查阅的页面链接

						String passLinkFile="/jsoa/GovSendFileLoadAction.do?action=load";//文件查阅的页面链接
                   		String subProcHref = "/jsoa/GovSendFileAction.do?action=see&moduleId=2";//新建子流程链接
                      	String titleFieldName = "documentSendFileTitle";//作为显示标题的表单中的元素的名称,如果为""则按工作流程的标题
				     	String title = myform.getDocumentSendFileTitle()==null?"临时标题":myform.getDocumentSendFileTitle();
				      	String[][] button = null;//包含页面中的附加按钮的名称和触发的javascript函数名称
				     	if("1".equals(request.getParameter("resubmit"))&&(1>2)){
							button = new String[2][2];
                       		button[0][0] = "直接发送";
                      		button[0][1] = "directSendShow()";
							button[1][0] = "保存草稿";
                         	button[1][1] = "draft()";
						}else if((!banli)&&(1>2)){
							button = new String[1][2];
                          	button[0][0] = "打印";
                          	button[0][1] = "myPrint()";
                    	}
                    	String msgFrom = "发文管理";//短信提醒模块名称
                     	
                    	if("1".equals(isEdit) && !"1".equals(request.getParameter("resubmit"))){
                    		
                  out.write("\r\n                          \t<tr id=\"directSendTR2\" style=\"display:none\">\r\n                              \t<td height=\"22\" nowrap>\r\n\t\t\t\t                \t<div align=center>发送到：\r\n\t\t\t\t                \t\t<input type=hidden name=sendToId2>\r\n\t\t\t\t                       \t<textarea cols=40 rows=5 class=css0 readonly=true name=sendToName2></textarea>&nbsp;&nbsp;&nbsp;&nbsp;\r\n\t\t\t\t                       \t<img src=/jsoa/images/group.gif>&nbsp;\r\n\t\t\t\t                       \t<img src=/jsoa/images/select.gif style=cursor:pointer onClick=\"openEndow('sendToId2','sendToName2',document.all.sendToId2.value,document.all.sendToName2.value,'user','no','userorggroup','*0*');\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t             \t\t");

				             		if(new com.js.oa.message.action.ModelSendMsg().judgePurviewMessage("发文管理",session.getAttribute("domainId")==null?"0":session.getAttribute("domainId").toString())){
				             			
                  out.write("<input type=\"checkbox\" name=\"sendFileNeedSendMsg2\" value=\"1\">短信提醒");

				             		}
				             		
                  out.write("\r\n                              \t</td>\r\n                          \t</tr>                          \r\n                          \t");

						}
						
                  out.write("\t\t \r\n\t\t\t\t\t\t<tr name=\"comment_TR\" id=\"comment_TR\" style=\"display:");
                  out.print(("2".equals(request.getParameter("workStatus")) || "0".equals(request.getParameter("workStatus")))?"":"none" );
                  out.write("\">\r\n\t\t\t\t\t\t\t<td></td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr name=\"comment_TR1\" id=\"comment_TR1\" style=\"display:");
                  out.print(("1".equals(request.getParameter("resubmit")))?"":"none" );
                  out.write("\">\r\n\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t<font style=\"color:red\">重新发起的文件，批示意见将不被保存！</font>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n                  \t\t<tr>\r\n                  \t\t\t<td id=\"TR1\">\r\n\t\t\t\t\t\t  \t\t");

						  		if(!"1".equals(request.getParameter("resubmit"))){
						  			
                  out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

	request.setCharacterEncoding("GBK");
	String localhi = session.getAttribute(
			"org.apache.struts.action.LOCALE").toString();
	String urlPath = request.getHeader("Referer");
	String currentUrl = request.getRequestURL().toString();
	String send=request.getAttribute("send")==null?"":request.getAttribute("send").toString();
	//System.out.println(urlPath);
	//Random random = new Random();
	//String pageKey = random.nextLong()+"";

	String pageKey = String.valueOf(new java.util.Date().getTime());

	//workVO
	String workId = request.getParameter("work");
	String processId = request.getParameter("processId");
	String tableId = request.getParameter("table");
	String recordId = request.getParameter("record");
	String stepCount = request.getParameter("stepCount");
	String hangup = (String) request.getAttribute("hangup");
	int inWorkType = ("null".equals(request.getParameter("workType")) || request
			.getParameter("workType") == null) ? -1 : Integer
			.parseInt(request.getParameter("workType"));//流程类型 0随机流程,1业务流程
	String curTransactType = new com.js.oa.jsflow.service.WorkFlowButtonBD()
			.getCurTransactTypeByWorkId(workId);//当前节点办理方式
	//判断是否已经发起子流程
	String subProcWorkId = new com.js.oa.jsflow.service.WorkFlowButtonBD()
			.getSubProcWorkId(processId, tableId, recordId,
					request.getParameter("activity"));
	if (subProcWorkId == null) {
		subProcWorkId = "";
	}

	com.js.oa.jsflow.vo.WorkVO workVO = new com.js.oa.jsflow.vo.WorkVO();
	if (workId != null && tableId != null && recordId != null) {
		workVO.setId(Long.valueOf(workId));
		workVO.setTableId(Long.valueOf(tableId));
		workVO.setRecordId(Long.valueOf(recordId));
		workVO.setStepCount(stepCount);
	}

	int inWorkStatus = new com.js.oa.jsflow.service.WorkFlowBD()
			.getWorkStatusByWorkId(workId);
	String curParallelActId = request
			.getAttribute("workPrarllelCurActId") == null
			? "0"
			: request.getAttribute("workPrarllelCurActId").toString();

                  out.write("\r\n<script type='text/javascript'\r\n\tsrc='/jsoa/workflow/dwr/interface/workflowSync.js'></script>\r\n<script type='text/javascript' src='/jsoa/workflow/dwr/engine.js'></script>\r\n\r\n<link\r\n\thref=\"/jsoa/skin/");
                  out.print(session.getAttribute("skin"));
                  out.write("/style-");
                  out.print(session.getAttribute("browserVersion"));
                  out.write("-doc.css\"\r\n\trel=\"stylesheet\" type=\"text/css\" />\r\n<input type=\"hidden\" name=\"workId\" id=\"workId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("work"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"tableId\" id=\"tableId\"\r\n\tvalue=\"");
                  out.print((request.getParameter("table") != null
					&& !request.getParameter("table").toUpperCase()
							.equals("NULL") && request.getParameter("table")
					.length() > 0) ? request.getParameter("table") : request
					.getAttribute("tableId").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"recordId\" id=\"recordId\"\r\n\tvalue=\"");
                  out.print((request.getParameter("record") != null
					&& !request.getParameter("record").toUpperCase()
							.equals("NULL") && request.getParameter("record")
					.length() > 0) ? request.getParameter("record") : request
					.getAttribute("recordId").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"workType\" id=\"workType\"\r\n\tvalue=\"");
                  out.print(request.getParameter("workType"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"processName\" id=\"processName\"\r\n\tvalue=\"");
                  out.print(request.getParameter("processName"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"curActivityId\" id=\"curActivityId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("activity"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"curActivityName\" id=\"curActivityName\"\r\n\tvalue=\"");
                  out.print(request.getParameter("activityName"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"submitPerson\" id=\"submitPerson\"\r\n\tvalue=\"");
                  out.print(request.getParameter("submitPerson"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"submitPersonId\" id=\"submitPersonId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("submitPersonId"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"stepCount\" id=\"stepCount\"\r\n\tvalue=\"");
                  out.print(request.getParameter("stepCount"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"remindField\" id=\"remindField\"\r\n\tvalue=\"");
                  out.print(request.getAttribute("remindField"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"isStandForWork\" id=\"isStandForWork\"\r\n\tvalue=\"");
                  out.print(request.getParameter("isStandForWork"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"standForUserId\" id=\"standForUserId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("standForUserId"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"standForUserName\" id=\"standForUserName\"\r\n\tvalue=\"");
                  out.print(request.getParameter("standForUserName"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"mainLinkFile\" id=\"mainLinkFile\"\r\n\tvalue=\"");
                  out.print(mainLinkFile);
                  out.write("\">\r\n\r\n<input type=\"hidden\" name=\"titleFieldName\" id=\"titleFieldName\"\r\n\tvalue=\"");
                  out.print(titleFieldName);
                  out.write("\">\r\n<!-- <input type=\"hidden\" name=\"title\" value=\"");
//=title
                  out.write("\"> -->\r\n<input type=\"hidden\" name=\"processId\" id=\"processId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("processId"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"msgFrom\" id=\"msgFrom\" value=\"");
                  out.print(msgFrom);
                  out.write("\">\r\n<input type=\"hidden\" name=\"inWorkType\" id=\"inWorkType\"\r\n\tvalue=\"");
                  out.print(inWorkType);
                  out.write("\">\r\n<input type=\"hidden\" name=\"submitTime\" id=\"submitTime\"\r\n\tvalue=\"");
                  out.print(request.getParameter("submitTime"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"submitPersonTime\" id=\"submitPersonTime\"\r\n\tvalue=\"");
                  out.print(request.getParameter("submitTime"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"initActivity\" id=\"initActivity\"\r\n\tvalue=\"");
                  out.print(request.getParameter("initActivity"));
                  out.write("\">\r\n\r\n<input type=\"hidden\" id=\"workPrarllelCurActId\"\r\n\tname=\"workPrarllelCurActId\" value=\"");
                  out.print(curParallelActId);
                  out.write("\" />\r\n<input type=\"hidden\" id=\"curActivityIsBranch\" name=\"curActivityIsBranch\"\r\n\tvalue=\"");
                  out.print(request.getAttribute("curActivityIsBranch") == null
					? "0"
					: request.getAttribute("curActivityIsBranch"));
                  out.write("\" />\r\n<input type=\"hidden\" id=\"branchActInfo\" name=\"branchActInfo\" value=\"\">\r\n\r\n<!-- 新增表单域 -->\r\n<input type=\"hidden\" name=\"isSend\" id=\"isSend\" value=\"0\">\r\n<!-- 是否发送事件 -->\r\n<input type=\"hidden\" name=\"fromdesktop\" id=\"fromdesktop\"\r\n\tvalue=\"");
                  out.print(request.getParameter("fromdesktop"));
                  out.write("\">\r\n<INPUT TYPE=\"hidden\" name=\"operName\" id=\"operName\">\r\n<INPUT TYPE=\"hidden\" name=\"operId\" id=\"operId\">\r\n<input type=hidden name=mainUserType id=\"mainUserType\" value=100>\r\n<!--参与人类型-->\r\n<input type=hidden name=mainAllowStandFor id=\"mainAllowStandFor\" value=0>\r\n<input type=hidden name=mainAllowCancel id=\"mainAllowCancel\" value=0>\r\n<input type=hidden name=mainAllowTransition id=\"mainAllowTransition\"\r\n\tvalue=0>\r\n<input type=hidden name=mainPressType id=\"mainPressType\" value=0>\r\n<input type=hidden name=mainDeadLineTime id=\"mainDeadLineTime\" value=-1>\r\n<input type=hidden name=mainPressMotionTime id=\"mainPressMotionTime\"\r\n\tvalue=-1>\r\n<input type=hidden name=\"mainNextActivityId\" id=\"mainNextActivityId\">\r\n<input type=hidden name=\"mainNextActivityName\" id=\"mainNextActivityName\">\r\n<input type=hidden name=\"emergence\" id=\"emergence\" value=0>\r\n<!--缓急程度-->\r\n<input type=hidden name=\"needSendMsg\" id=\"needSendMsg\">\r\n<!--短信-->\r\n<input type=hidden name=\"smsContent\" id=\"smsContent\">\r\n<!--短信内容-->\r\n<input type=hidden name=\"dealTips\" id=\"dealTips\">\r\n");
                  out.write("<!--tips内容-->\r\n<input type=hidden name=\"processDeadlineDate\" id=\"processDeadlineDate\"\r\n\tvalue=\"");
                  out.print(request.getParameter("processDeadlineDate"));
                  out.write("\">\r\n<!--流程办理期限-->\r\n");

	String[][] sendMsgToInit = new DataSourceBase()
			.queryArrayBySql("SELECT sendMsgToInitiator,opinionmust,opinionLengthSet,opinionLengthMin,opinionLengthMax,sendMsgToDealDone FROM jsf_activity WHERE WF_ACTIVITY_ID="
					+ request.getParameter("activity"));

                  out.write("\r\n<input type=\"hidden\" name=\"sendMsgToInitiator\" id=\"sendMsgToInitiator\"\r\n\tvalue=\"");
                  out.print(sendMsgToInit.length > 0 ? sendMsgToInit[0][0] : "0");
                  out.write("\">\r\n<!-- 是否给发起人发送提醒 -->\r\n<input type=\"hidden\" name=\"opinionmust\" id=\"opinionmust\"\r\n\tvalue=\"");
                  out.print(sendMsgToInit.length > 0 ? sendMsgToInit[0][1] : "0");
                  out.write("\">\r\n<!-- 意见必填 -->\r\n<input type=\"hidden\" name=\"opinionLengthSet\" id=\"opinionLengthSet\"\r\n\tvalue=\"");
                  out.print(sendMsgToInit.length > 0 ? sendMsgToInit[0][2] : "0");
                  out.write("\">\r\n<!-- 意见长度 -->\r\n<input type=\"hidden\" name=\"opinionLengthMin\" id=\"opinionLengthMin\"\r\n\tvalue=\"");
                  out.print(sendMsgToInit.length > 0 ? sendMsgToInit[0][3] : "10");
                  out.write("\">\r\n<!-- 意见最短长度 -->\r\n<input type=\"hidden\" name=\"opinionLengthMax\" id=\"opinionLengthMax\"\r\n\tvalue=\"");
                  out.print(sendMsgToInit.length > 0 ? sendMsgToInit[0][4] : "1000");
                  out.write("\">\r\n<!-- 意见最长长度 -->\r\n<input type=\"hidden\" name=\"sendMsgToDealDone\" id=\"sendMsgToDealDone\"\r\n\tvalue=\"");
                  out.print(sendMsgToInit.length > 0 ? sendMsgToInit[0][5] : "0");
                  out.write("\">\r\n<!-- 是否给已办人员发送提醒 -->\r\n\r\n<input type=\"hidden\" name=\"backCheckMust\" id=\"backCheckMust\"\r\n\tvalue=\"");
                  out.print(SystemCommon.getBackCheckMust());
                  out.write("\">\r\n\r\n<input type=\"hidden\" name=\"changeDeadLineTime\" id=\"changeDeadLineTime\"\r\n\tvalue=\"-1\">\r\n");
                  out.write("\r\n<!--阅件参数-->\r\n<input type=hidden name=\"mainNeedPassRound\" id=\"mainNeedPassRound\"\r\n\tvalue=\"1\">\r\n<input type=hidden name=\"mainPassRoundUserType\"\r\n\tid=\"mainPassRoundUserType\" value=100>\r\n<!--阅件人类型-->\r\n<input type=hidden name=\"passRoundId\" id=\"passRoundId\">\r\n<input type=hidden name=\"passRoundName\" id=\"passRoundName\">\r\n\r\n\r\n<!--子流程临时workID-->\r\n<input type=\"hidden\" name=\"subProcTempWorkId\" id=\"subProcTempWorkId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("subProcWorkId") == null
					? ""
					: request.getParameter("subProcWorkId"));
                  out.write("\">\r\n\r\n<!--催办-->\r\n<input type=hidden name=pressUserId id=\"pressUserId\">\r\n<input type=hidden name=pressUserName id=\"pressUserName\">\r\n<input type=hidden name=pressTitle id=\"pressTitle\">\r\n<input type=hidden name=pressContent id=\"pressContent\">\r\n<input type=hidden name=pressSMS id=\"pressSMS\">\r\n\r\n<!--反馈-->\r\n<input type=hidden name=feedUserId id=\"feedUserId\">\r\n<input type=hidden name=feedUserName id=\"feedUserName\">\r\n<input type=hidden name=feedTitle id=\"feedTitle\">\r\n<input type=hidden name=feedContent id=\"feedContent\">\r\n\r\n<!--转办-->\r\n<input type=hidden name=transitionUser id=\"transitionUser\">\r\n<input type=hidden name=transitionUserName id=\"transitionUserName\">\r\n<input type=hidden name=\"tranType\" id=\"tranType\"\r\n\tvalue=\"");
                  out.print(request.getParameter("tranType") == null ? "" : request
					.getParameter("tranType"));
                  out.write("\">\r\n<input type=hidden name=\"tranFromPersonId\" id=\"tranFromPersonId\"\r\n\tvalue=\"");
                  out.print(request.getParameter("tranFromPersonId") == null
					? "-1"
					: request.getParameter("tranFromPersonId"));
                  out.write("\">\r\n\r\n<!--收回-->\r\n<input type=hidden name=receiveActivityId id=\"receiveActivityId\">\r\n<input type=hidden name=receiveActivityName id=\"receiveActivityName\">\r\n<input type=hidden name=receiveUserName id=\"receiveUserName\">\r\n\r\n<!--阅件-->\r\n<input type=hidden name=\"passLinkFile\" id=\"passLinkFile\"\r\n\tvalue=\"");
                  out.print(passLinkFile);
                  out.write("\">\r\n\r\n<!--当前节点办理方式--默认'1'为多人并行-->\r\n<input type=hidden name=approveMode value=\"1\" id=\"approveMode\">\r\n\r\n<input type=hidden name=saveCheckFn id=\"saveCheckFn\"\r\n\tvalue=\"");
                  out.print(saveCheckFn);
                  out.write("\">\r\n<input type=hidden name=formName id=\"formName\" value=\"");
                  out.print(formName);
                  out.write("\">\r\n<input type=hidden name=bodyContent id=\"bodyContent\" value=\"\">\r\n\r\n<!--流程按钮-->\r\n");

	com.js.oa.jsflow.service.WorkFlowBD workFlowBD = new com.js.oa.jsflow.service.WorkFlowBD();
	com.js.oa.jsflow.service.WorkFlowCommonBD workFlowCommonBD = new com.js.oa.jsflow.service.WorkFlowCommonBD();
	com.js.oa.jsflow.service.WorkFlowButtonBD wfbd = new com.js.oa.jsflow.service.WorkFlowButtonBD();
	String moduleId = workFlowCommonBD.getModuleId(tableId);//模块ID
	String operButton = "";
	/*if(inWorkStatus==101){
	 modiButton = ",Print";	
	 }*/

	//流程中显示按钮
	if ("none".equals(modiButton)) {
		com.js.oa.jsflow.vo.ActivityVO avo = workFlowBD
				.getProceedActiVO(
						request.getParameter("table"),
						request.getParameter("record"),
						(curParallelActId == null || "0"
								.equals(curParallelActId))
								? request.getParameter("activity")
								: curParallelActId, "0");
		operButton = avo.getOperButton();
		if (operButton != null && !"".equals(operButton)) {
			operButton = operButton.replaceAll("cmd", ",");
		}

		modiButton = "";
		if (inWorkStatus == 0) {
			//待办

			//发文
			if ("1".equals(moduleId)
					|| "2".equals(moduleId)
					|| "3".equals(moduleId)
					|| (Integer.parseInt(moduleId) >= 200 && Integer
							.parseInt(moduleId) <= 300)) {
				modiButton += ",Saveclose";
			}

			//起草正文
			if (operButton.indexOf("Writetext") != -1) {
				modiButton += ",Writetext";
			}

			//引入正文
			if (operButton.indexOf("Imptext") != -1) {
				modiButton += ",Imptext";
			}

			//附件管理
			if (operButton.indexOf("Manageracc") != -1) {
				modiButton += ",Manageracc";
				modiButton = modiButton.replaceAll(",Viewacc", "");
			}

			//默认显示发送
			modiButton += ",Send";

			//显示【办理完毕】按钮,不为代办且为多人审批时显示办理完毕按钮
			//com.js.oa.jsflow.service.WorkFlowButtonBD wfbd = new com.js.oa.jsflow.service.WorkFlowButtonBD();
			boolean showEnd = wfbd.hasMoreDealFile(workVO);
			if (!"1".equals(request.getParameter("isStandForWork"))
					&& showEnd) {
				modiButton = modiButton.replaceAll("Send", "End");
			} else if ("1".equals(request
					.getParameter("isStandForWork"))
					&& showEnd
					&& ("3".equals(curTransactType) || "1"
							.equals(curTransactType))) {
				//当是多人并行或串行时，是代办人的情况也只显示办理完毕
				modiButton = modiButton.replaceAll("Send", "End");
			}

			//自动返回节点显示【办理完毕】按钮
			String[] activityInfo = workFlowBD.getActivityClass(
					request.getParameter("table"),
					request.getParameter("record"),
					("0".equals(curParallelActId))
							? request.getParameter("activity")
							: curParallelActId);
			if ("3".equals(activityInfo[0])) {
				//自动返回节点
				modiButton = modiButton.replaceAll("Send",
						"EndAutoReturn");
			}

			//转办后自动返回待办文件显示【办理完毕】按钮
			String tranType = request.getParameter("tranType") == null
					? "0"
					: request.getParameter("tranType");
			if ("1".equals(tranType)) {
				modiButton = modiButton.replaceAll("Send",
						"EndAutoReturn");
			}

			//后继为结束节点显示【办理完毕】按钮
			java.util.List activityList = workFlowBD
					.getAllNextActivity(request.getParameter("table"),
							request.getParameter("record"), ("0"
									.equals(curParallelActId))
									? request.getParameter("activity")
									: curParallelActId);
			if (activityList.size() == 1
					&& ((com.js.oa.jsflow.vo.ActivityVO) activityList
							.get(0)).getBeginEnd() == 2) {
				//后继为结束节点
				modiButton = modiButton.replaceAll("Send",
						"EndOnlyComp");
			}

			//转办
			if (operButton.indexOf("Tran") != -1) {
				//转办(Tran)，转阅(TranRead) 会混淆 故判断较复杂		
				if ("Tran".equals(operButton)
						|| ",Tran".equals(operButton)) {
					modiButton += ",Tran";
				} else {
					if (operButton.endsWith("Tran")
							|| operButton.startsWith("Tran,")) {
						modiButton += ",Tran";
					} else {
						if (operButton.indexOf(",Tran,") != -1) {
							modiButton += ",Tran";
						}
					}
				}

			}

			//退回
			if (operButton.indexOf("Back") != -1) {
				modiButton += ",Back";
			}

			//反馈
			if (operButton.indexOf("Feedback") != -1) {
				modiButton += ",Feedback";
			}

			//打印
			if (operButton.indexOf("Print") != -1) {
				modiButton += ",Print";
			}
			if ("1".equals(SystemCommon.getIsOpenPDF())) {
				//pdf
				if (operButton.indexOf("Pdf") != -1) {
					modiButton += ",Pdf";
				}
			}
			//作废
			if (operButton.indexOf("Delete") != -1) {
				modiButton += ",Delete";
			}

			//查看正文
			if (operButton.indexOf("Viewtext") != -1) {
				modiButton += ",Viewtext";
			}

			//查看附件
			if (operButton.indexOf("Viewacc") != -1) {
				modiButton += ",Viewacc";
			}

			//打印阅办单
			if (operButton.indexOf("Printcomm") != -1) {
				modiButton += ",Printcomm";
			}

			//打印正文
			if (operButton.indexOf("Printtext") != -1) {
				modiButton += ",Printtext";
			}

			//附件管理
			if (operButton.indexOf("Manageracc") != -1) {
				//modiButton += ",Manageracc";
				modiButton = modiButton.replaceAll(",Viewacc", "");
			}

			//归档
			if (operButton.indexOf("Document") != -1) {
				modiButton += ",Document";
			}

			//正文管理
			if (operButton.indexOf("Textmanager") != -1) {
				modiButton += ",Textmanager";
			}

			//批阅正文
			if (operButton.indexOf("Readtext") != -1) {
				modiButton += ",Readtext";
				modiButton = modiButton.replaceAll(",Viewtext", "");
			}

			//生成正式文件
			if (operButton.indexOf("Savefile") != -1) {
				modiButton += ",Savefile";
				modiButton = modiButton.replaceAll(",Viewtext", "");
				//modiButton = modiButton.replaceAll(",Readtext","");
			}

			//编号
			if (operButton.indexOf("Code") != -1) {
				modiButton += ",Code";
			}

			//内部分发
			if (operButton.indexOf("Selfsend") != -1) {
				modiButton += ",Selfsend";
			}

			//转本部门
			if (operButton.indexOf("Toselfdept") != -1) {
				modiButton += ",Toselfdept";
			}

			//分发
			if (operButton.indexOf("Sendclose") != -1) {
				modiButton += ",Sendclose";
			}

		} else if (inWorkStatus == 1011 || inWorkStatus == 101) {
			//在办
			avo = workFlowBD.getProceedActiVO(
					request.getParameter("table"),
					request.getParameter("record"),
					request.getParameter("initActivity"), "0");
			operButton = avo.getOperButton();
			if (operButton != null && !"".equals(operButton)) {
				operButton = operButton.replaceAll("cmd", ",");
			}

			//撤办(超过一步不显示撤办)
			if (operButton.indexOf("Undo") != -1
					&& wfbd.showUndoButton(workVO)) {
				modiButton += ",Undo";
			}

			//催办
			if (operButton.indexOf("Wait") != -1) {
				modiButton += ",Wait";
			}

			//反馈
			if (operButton.indexOf("Feedback") != -1) {
				modiButton += ",Feedback";
			}

			//收回
			if (operButton.indexOf("Return") != -1) {
				modiButton += ",Return";
			}

			//打印
			if (operButton.indexOf("Print") != -1) {
				modiButton += ",Print";
			}
			if ("1".equals(SystemCommon.getIsOpenPDF())) {
			  //pdf
			  if (operButton.indexOf("Pdf") != -1) {
				modiButton += ",Pdf";
			   }
			}
			//转阅
			/*if(operButton.indexOf("TranRead")!=-1){
				modiButton += ",TranRead";
			}*/

			//发文
			//if("2".equals(moduleId) || "3".equals(moduleId)){
			if ("2".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext,Viewread";
			}

			//收文
			if ("3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Viewread";
			}

			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}

			//增加批阅人
			/*if(operButton.indexOf("Addperson")!=-1){
				modiButton += ",Addperson";
			}*/

		} else if (inWorkStatus == 1012) {
			//办结
			avo = workFlowBD.getProceedActiVO(
					request.getParameter("table"),
					request.getParameter("record"),
					request.getParameter("initActivity"), "0");
			operButton = avo.getOperButton();
			if (operButton != null && !"".equals(operButton)) {
				operButton = operButton.replaceAll("cmd", ",");
			}

			//收回
			/*if(operButton.indexOf("Return")!=-1){
				modiButton += ",Return";
			}*/

			//反馈
			if (operButton.indexOf("Feedback") != -1) {
				modiButton += ",Feedback";
			}

			//打印
			if (operButton.indexOf("Print") != -1) {
				modiButton += ",Print";
			}
			if ("1".equals(SystemCommon.getIsOpenPDF())) {
				//pdf
				if (operButton.indexOf("Pdf") != -1) {
					modiButton += ",Pdf";
				}
			}
			//转阅
			/*if(operButton.indexOf("TranRead")!=-1){
				modiButton += ",TranRead";
			}*/

			//发文
			if ("2".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext,Viewread";
			}

			//收文
			if ("3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Viewread";
			}

			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}

		} else if (inWorkStatus == 2) {
			//待阅
			modiButton += ",End";

			//反馈
			if (operButton.indexOf("Feedback") != -1) {
				modiButton += ",Feedback";
			}

			//转阅
			if (operButton.indexOf("TranRead") != -1) {
				modiButton += ",TranRead";
			}

			//发文
			if ("2".equals(moduleId) || "3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext";
			}
			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}

		} else if (inWorkStatus == 102) {
			//已阅

			//转阅
			/*if(operButton.indexOf("TranRead")!=-1){
				modiButton += ",TranRead";
			}*/

			//发文
			if ("2".equals(moduleId) || "3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext";
			}
			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}

		} else if (inWorkStatus == 1) {
			//我的在办

			//打印
			//if(operButton.indexOf("Print")!=-1){
			modiButton += ",Print";
			//}
			if ("1".equals(SystemCommon.getIsOpenPDF())) {
				if ((urlPath != null
						&& urlPath.indexOf("FileDealWithAction") != -1)||(urlPath==null)) {//办理中心，已发事项，已发在办
					if (currentUrl != null
							&& currentUrl.indexOf("workflow_myflow") != -1) {//流程相关
						if (operButton.indexOf("Pdf") != -1) {//勾选了pdf按钮

							modiButton += ",Pdf";//添加按钮
						}
					}
				} else if (urlPath != null
						&& urlPath.indexOf("workflow_listInfo") != -1) {//工作流程在办监控
					modiButton += ",Pdf";//添加按钮
				}
			}
			//催办
			//if(operButton.indexOf("Wait")!=-1){
			modiButton += ",Wait";
			//}

			//发文
			if ("2".equals(moduleId) || "3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext";
			}

			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}
			//取消
			if (operButton.indexOf("Cancel") != -1
					&& "dealwith".equals(request.getParameter("from"))) {
				modiButton += ",Cancel";
			}
		} else if (inWorkStatus == 100) {
			//我的办结
			modiButton += ",Print";
			if ("1".equals(SystemCommon.getIsOpenPDF())) {
				if ((urlPath != null
						&& urlPath.indexOf("FileDealWithAction") != -1)||(urlPath==null)) {//办理中心，已发事项，已发办结
					if (currentUrl != null
							&& currentUrl.indexOf("workflow_myflow") != -1) {//流程相关
						modiButton += ",Pdf";//添加按钮
					}
				} else if (urlPath != null
						&& urlPath.indexOf("workflow_listInfo") != -1) {//工作流程在办监控
					modiButton += ",Pdf";//添加按钮
				}
			}
			//发文
			if ("2".equals(moduleId) || "3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext";
			}

			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}

		} else if (inWorkStatus == -1) {
			//我的退回
			if(!"0".equals(send)){
				modiButton +=",resubmit";
			}
			//发文
			if ("2".equals(moduleId) || "3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext";
			}
			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}

		} else if (inWorkStatus == -2) {
			//我的取消
			//发文
			if ("2".equals(moduleId) || "3".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc,Printcomm,Printtext";
			}
			//文件送审签
			if ("34".equals(moduleId)) {
				modiButton += ",Viewtext,Viewacc";
			}
		}

		//通用公文按钮
		//转收文
		if (operButton.indexOf("Toreceive") != -1) {
			modiButton += ",Toreceive";
		}
		//转发文
		if (operButton.indexOf("Tosend") != -1) {
			modiButton += ",Tosend";
		}
		//转文件按送审签
		if (operButton.indexOf("Tocheck") != -1) {
			modiButton += ",Tocheck";
		}

		if ("".equals(modiButton) && inWorkStatus == 101) {
			modiButton = ",Print";
		}
		if ("1".equals(request.getAttribute("preGD"))) {
			modiButton += ",PreGD";
		}
		if ("1".equals(request.getAttribute("canBeGuiDang"))) {
			modiButton += ",RWSGD";
		}
		if ("1".equals(request.getAttribute("canBeCheHuiGuiDang"))) {
			modiButton += ",CheHuiGD";
		}

		//隐藏查看附件按钮
		modiButton = modiButton.replaceAll("Viewacc,", "")
				.replaceAll("Viewacc", "").replaceAll("Printcomm,", "")
				.replaceAll("Printcomm", "")
				.replaceAll("Printtext,", "")
				.replaceAll("Printtext", "");
		modiButton = modiButton.replaceAll("Manageracc,", "")
				.replaceAll("Manageracc", "")
				.replaceAll("Textmanager,", "")
				.replaceAll("Textmanager", "");
		modiButton = modiButton.replaceAll("Document,", "")
				.replaceAll("Document", "")
				.replaceAll("Toselfdept,", "")
				.replaceAll("Toselfdept", "");

	}
	if ("3".equals(moduleId)) {
		modiButton = modiButton.replaceAll("Viewtext,", "").replaceAll(
				"Viewtext", "");
	}

	//办理查阅时按钮
	operButton = modiButton;

	/************************************** **************************************************************/
	/*在线用户锁处理*/
	/****************************************************************************************************/

	//在线参数
	String onlineEditUser = "";//帐号
	String onlineEditUserName = "";//人名
	String onlineWorkId = "";//
	boolean onlineUserValidate = false;

	//多人并行时判断在线用户同时编辑
	java.util.Map para = new java.util.HashMap();
	java.text.SimpleDateFormat dfTime = new java.text.SimpleDateFormat(
			"yyyy-MM-dd HH:mm:ss");//设置日期格式
	para.put("recordId", request.getParameter("record"));
	para.put("tableId", request.getParameter("table"));
	para.put("processId", request.getParameter("processId"));
	para.put("userAccount", session.getAttribute("userAccount")
			.toString());
	para.put("userName", session.getAttribute("userName").toString());
	para.put("workId", request.getParameter("work"));
	para.put("pageKey", pageKey);
	para.put("onlinebegintime", dfTime.format(new Date()).toString());

	//返回在线编辑人员
	String[] userArr = wfbd.getWFOnlineUser(para);
	onlineEditUser = userArr[0];
	onlineEditUserName = userArr[1];
	onlineWorkId = userArr[2];
	if ("".equals(onlineEditUser)) {
		onlineUserValidate = false;
	} else if (onlineEditUser.equals(session
			.getAttribute("userAccount").toString())) {
		onlineUserValidate = false;
	} else {
		onlineUserValidate = true;
	}

	if (onlineEditUser.equals(session.getAttribute("userAccount")
			.toString())
			&& onlineWorkId.equals(request.getParameter("work"))) {
		onlineUserValidate = false;
		para.put("workId", onlineWorkId);
		wfbd.delWFOnlineUser(para);
		para.put("workId", request.getParameter("work"));
	}

	//上锁
	//if(!onlineUserValidate && ("0".equals(request.getParameter("workStatus")) || "1012".equals(request.getParameter("workStatus")) || "1011".equals(request.getParameter("workStatus")))){
	if (!onlineUserValidate && inWorkStatus == 0) { //只在办理的时候上锁		

		wfbd.setWFOnlineUser(para);
		onlineEditUser = session.getAttribute("userAccount").toString();//新进员工
		onlineEditUserName = session.getAttribute("userName")
				.toString();//新进员工
		onlineWorkId = request.getParameter("work");
	}

	//在线编辑提醒
	//if(onlineUserValidate && !onlineEditUser.equals(session.getAttribute("userAccount").toString())){//不判断本人
	if (onlineUserValidate) {//判断本人
		operButton = "";

                  out.write("\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n\talert(\"");
                  out.print(onlineEditUserName);
                  out.write('(');
                  out.print(onlineEditUser);
                  out.write(')');
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeediting"));
                  out.write("\");\r\n\t</SCRIPT>\r\n");

	}

                  out.write("\r\n<SCRIPT LANGUAGE=\"JavaScript\">function sendRequest(recordId,tableId,processId,workId)\r\n{\r\n\tvar xmlhttp;\r\n\t//开始初始化XMLHttpRequest对象\r\n\tif(window.XMLHttpRequest) { //Mozilla 浏览器\r\n\t\txmlhttp = new XMLHttpRequest();\r\n\t\tif (xmlhttp.overrideMimeType) {//设置MiME类别\r\n\t\t\txmlhttp.overrideMimeType('text/xml');\r\n\t\t}\r\n\t}\r\n\telse if (window.ActiveXObject) { // IE浏览器\r\n\t\ttry {\r\n\t\t\txmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\t\t} catch (e) {\r\n\t\t\ttry {\r\n\t\t\t\txmlhttp = new ActiveXObject(\"MSXML2.XMLHTTP\");\r\n\t\t\t} catch (e) {\r\n\t\t\t\talert(\"您看到此信息，说明您的浏览器不支持XML解析。\\r\\n请在弹出页面中下载XML解析器并安装！\");\r\n\t\t\t\tJSMainWinOpen('/jsoa/public/select_user/XMLSetup.html','下载说明','toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,width=10,height=10');\r\n\t\t\t}\r\n\t\t}\r\n\t}\t\r\n\t//alert(recordId+\"--\"+tableId+\"--\"+processId+\"----\"+workId);\r\n\txmlhttp.open(\"POST\",\"/jsoa/jsflow/closeWindow.jsp?recordId=\"+recordId+\"&tableId=\"+tableId+\"&processId=\"+processId+\"&workId=\"+workId,false);\r\n\txmlhttp.send();\r\n}\r\n</SCRIPT>\r\n\r\n");

	//用户退出当前页面,在线编辑解锁函数
	//if(!onlineUserValidate && (("0".equals(request.getParameter("workStatus")) || "1012".equals(request.getParameter("workStatus")) || "1011".equals(request.getParameter("workStatus"))))){

                  out.write("\r\n<SCRIPT FOR=window EVENT=onbeforeunload>\r\n\tsendRequest(\"");
                  out.print(recordId);
                  out.write('"');
                  out.write(',');
                  out.write('"');
                  out.print(tableId);
                  out.write('"');
                  out.write(',');
                  out.write('"');
                  out.print(processId);
                  out.write('"');
                  out.write(',');
                  out.write('"');
                  out.print(workId);
                  out.write("\");\r\n\t</SCRIPT>\r\n");

	//}

	/****************************************************************************************************/

                  out.write("\r\n\r\n<!--记录待办首次查看时间-->\r\n");

	if (inWorkStatus == 0 || inWorkStatus == 2) {
		com.js.oa.jsflow.vo.WorkLogVO workLogVO = new com.js.oa.jsflow.vo.WorkLogVO();
		workLogVO.setSendUserId(session.getAttribute("userId")
				.toString());
		workLogVO.setSendUserName(session.getAttribute("userName")
				.toString());
		workLogVO
				.setSendAction((request.getParameter("activityName") == null
						|| "".equals(request
								.getParameter("activityName"))
						|| "null".equals(request
								.getParameter("activityName"))
						? ""
						: request.getParameter("activityName"))
						+ "签收");
		workLogVO.setReceiveUserName(" ");
		workLogVO.setProcessId(request.getParameter("processId"));
		workLogVO.setTableId(request.getParameter("table"));
		workLogVO.setRecordId(request.getParameter("record"));
		workLogVO.setDomainId(session.getAttribute("domainId")
				.toString());
		new com.js.oa.jsflow.service.WorkFlowButtonBD()
				.setWorkViewedDate(
						workId,
						workLogVO,
						String.valueOf((Integer.parseInt(request
								.getParameter("stepCount") == null
								|| "null".equals(request
										.getParameter("stepCount"))
								? "0"
								: request.getParameter("stepCount")) - 1)));
	}

                  out.write("\r\n<!--待办首次查看时间-->\r\n");

	if (request.getParameter("processId") != null
			&& !"null".equals(request.getParameter("processId"))) {
		//表示是走了流程的
		boolean handSignInUse1 = false;//是否使用了手写签名
		java.util.Map include_sysMap1 = com.js.system.util.SysSetupReader
				.getInstance().getSysSetupMap(
						session.getAttribute("domainId").toString());
		if (include_sysMap1 != null
				&& include_sysMap1.get("使用手写意见") != null
				&& "1".equals(include_sysMap1.get("使用手写意见").toString())) {
			handSignInUse1 = true;
		}

                  out.write("\r\n<input type=\"hidden\" name=\"moduleId\" id=\"moduleId\" value=\"");
                  out.print(moduleId);
                  out.write("\">\r\n<input type=\"hidden\" name=\"curTransactType\" id=\"curTransactType\"\r\n\tvalue=\"");
                  out.print(curTransactType);
                  out.write("\">\r\n<table align=\"center\" width=\"100%\" border=\"0\" id=\"inc_tb\">\r\n\t");

		if (inWorkStatus == 0 || inWorkStatus == 2) {
				//待批或待阅文件  
				//业务流程
				if (inWorkStatus == 0) {
					//待批文件
					com.js.oa.jsflow.service.WorkFlowBD include_workFlowBD = new com.js.oa.jsflow.service.WorkFlowBD();
					String[] include_actiClass = null;
					if ("".equals(subProcWorkId)) {
						include_actiClass = include_workFlowBD
								.getActivityClass(request
										.getParameter("table"), request
										.getParameter("record"), ("0"
										.equals(curParallelActId))
										? request.getParameter("activity")
										: curParallelActId);
					} else {
						include_actiClass = include_workFlowBD
								.getActivityClass(request
										.getParameter("table"), request
										.getParameter("record"), ("0"
										.equals(curParallelActId))
										? request.getParameter("activity")
										: curParallelActId, subProcWorkId);
					}
					if (include_actiClass[0].equals("0")) {
						//子过程节点
	
                  out.write("\r\n\t<tr\r\n\t\tstyle=\"display:");
                  out.print("1".equals(request
									.getParameter("transend")) ? "none" : "");
                  out.write("\">\r\n\t\t<td><span style=\"cursor:pointer\"\r\n\t\t\tonclick=\"createSubProcess('");
                  out.print(subProcHref);
                  out.write("&processId=");
                  out.print(include_actiClass[1]);
                  out.write("&tableId=");
                  out.print(include_actiClass[3]);
                  out.write("&processName=");
                  out.print(include_actiClass[4]);
                  out.write("&processType=");
                  out.print(include_actiClass[5]);
                  out.write("&remindField=");
                  out.print(include_actiClass[6]);
                  out.write("&subProc=1&isSubProcWork=1&pareProcActiId=");
                  out.print(request.getParameter("activity"));
                  out.write("&pareStepCount=");
                  out.print(request.getParameter("stepCount"));
                  out.write("&pareTableId=");
                  out.print(request.getParameter("table"));
                  out.write("&pareRecordId=");
                  out.print(request.getParameter("record"));
                  out.write("&subProcess=1','','menubar=0,scrollbars=yes,locations=0,width=400,height=200,resizable=yes');\"><a\r\n\t\t\t\thref=\"#\">启动“");
                  out.print(include_actiClass[4]);
                  out.write("”(子流程)</a> </span></td>\r\n\t</tr>\r\n\t<input type=\"hidden\" name=\"subProcType\" id=\"subProcType\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[2]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subProcName\" id=\"subProcName\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[4]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subProcId\" id=\"subProcId\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[1]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"processId\" id=\"processId\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[1]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subProcTableId\" id=\"subProcTableId\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[3]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subProcessType\" id=\"subProcessType\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[5]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subRemindField\" id=\"subRemindField\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[6]);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subProcWorkId\" id=\"subProcWorkId\"\r\n\t\tvalue=\"");
                  out.print(subProcWorkId);
                  out.write("\">\r\n\t<input type=\"hidden\" name=\"subWorkstatus\" id=\"subWorkstatus\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[7]);
                  out.write("\">\r\n\t");

		}
	
                  out.write("\r\n\t<input type=\"hidden\" name=\"activityClass\" id=\"activityClass\"\r\n\t\tvalue=\"");
                  out.print(include_actiClass[0]);
                  out.write("\">\r\n\r\n\r\n\t");

		}

			}
	
                  out.write("\r\n</table>\r\n<input type=\"hidden\" name=\"include_comment\" id=\"include_comment\">\r\n");

	if (inWorkStatus == 0) {
			//待批文件,取批示意见对应字段
			if (curCommField != null && !curCommField.equals("")) {

                  out.write("\r\n<input type=\"hidden\" name=\"include_commField\" id=\"include_commField\"\r\n\tvalue=\"");
                  out.print(curCommField);
                  out.write("\">\r\n");

	}
		} else {
			//待阅文件,取阅示意见对应字段
			if (curPassRoundCommField != null
					&& !curPassRoundCommField.equals("")) {

                  out.write("\r\n<input type=\"hidden\" name=\"include_commField\" id=\"include_commField\"\r\n\tvalue=\"");
                  out.print(curPassRoundCommField);
                  out.write("\">\r\n");

	}
		}

                  out.write("\r\n<!-- 阅件提交的iframe，避免关闭页面 -->\r\n<iframe id=\"tempIframe\" name=\"tempIframe\" style=\"display:none\"></iframe>\r\n<script language=\"javascript\">var include_td1HTML = \"\";\r\nif(document.all.include_td1){\r\n    include_td1HTML = document.all.include_td1.innerHTML;\r\n}\r\n\r\n//阅件时保存意见\r\nfunction include_save(){\r\n    if(!include_saveSignature()){\r\n        return;\r\n    }\r\n    include_setComment();\r\n    \r\n    document.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=dealpassround\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n}\r\n\r\n//取消显示退回信息\r\nfunction include_backCacnel(){\r\n    document.all.include_td1.innerHTML = include_td1HTML;\r\n}\r\n\r\n//按钮提交退回\r\nfunction include_backSubmit(include_backActivity){\r\n    if(!include_saveSignature()){       \r\n        return;\r\n    }\r\n    include_setComment();       \r\n\tvar tmpPerson;\r\n    var tmp = include_backActivity;\r\n    var formAction = \"/jsoa/WorkflowButtonAction.do?flag=back\";\r\n    if(tmp == 0){\r\n        //退回发起人\r\n        formAction += \"&type=0&backToUserName=\"+document.all.submitPerson.value+\"&backToActivityName=发起人\";\r\n\t\ttmpPerson = \"发起人\";\r\n    }else{\r\n        //退回到其他步骤\r\n        tmpArr = tmp.split(\",\");\r\n        formAction += \"&type=1&backToUserId=\" + tmpArr[3] +\"&backToUserName=\" + tmpArr[4]+ \"&backToActivityId=\" + tmpArr[0] + \"&backToStep=\" + tmpArr[1] + \"&backToActivityName=\" + tmpArr[2];\r\n\t\ttmpPerson = tmpArr[2];\r\n    }\r\n    document.all.");
                  out.print(formName);
                  out.write(".action = formAction;\r\n    document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n    pullXMenuDisabledAllMenu();\r\n}\r\n\r\n//按钮催办\r\nfunction include_waitSubmit(){\r\n    //发邮件\r\n\t");
                  out.print(formName);
                  out.write(".target = \"include_iframe\";\r\n\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=press\";\r\n\t");
                  out.print(formName);
                  out.write(".submit();\r\n\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includehassuccesspress"));
                  out.write("\");\r\n}\r\n\r\n//按钮反馈\r\nfunction include_feedbackSubmit(){\r\n    //发邮件\r\n\t");
                  out.print(formName);
                  out.write(".target = \"include_iframe\";\r\n\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=feedback\";\r\n\t");
                  out.print(formName);
                  out.write(".submit();\r\n\tvar userAgent=navigator.userAgent;\r\n\tvar isEdge = userAgent.indexOf(\"Edge\") > -1; //判断是否IE的Edge浏览器\r\n\tif(!isEdge){\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includehassuccessfeedback"));
                  out.write("\");\r\n\t}\r\n}\r\n\r\n//按钮撤办\r\nfunction include_undoSubmit(){\r\n\tif(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmundo"));
                  out.write("\")){\r\n\tdocument.all.");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=undo\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n\t}\r\n}\r\n\r\n//按钮收回\r\nfunction include_returnSubmit(){\r\n\tdocument.all.");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=return\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includesuccessreceive"));
                  out.write("\"+document.all.receiveActivityName.value+\"！\");\r\n}\r\n\r\n//按钮作废\r\nfunction include_deleteSubmit(){\r\n\tif(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmdelete"));
                  out.write("\")){\r\n\tdocument.all.");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=delete\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n\t}\r\n}\r\n\r\n//办理完毕与阅件保存--多人办理--待阅办理\r\nfunction include_endAndSaveSubmit(){\r\n\tif('");
                  out.print(inWorkStatus);
                  out.write("'=='2'){\r\n\t\t//阅件\r\n\t\tif(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmsaveread"));
                  out.write("\")){\r\n\t\t\tdocument.all.");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n\t\t\tinclude_save();\r\n\t\t}\r\n\t} else{\r\n\t\t//办理完毕\r\n\t\tinclude_endSubmit();\r\n\t}\r\n}\r\n\r\n//办理完毕--多人办理\r\nfunction include_endSubmit(){\r\n\tif(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmturntodeal"));
                  out.write("\")){\r\n    if(include_checkUser()){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n\t\t\tif(!include_saveSignature()){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tinclude_setComment();\r\n\t\t\tdocument.all.");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n\t\t\tdocument.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=end\";\r\n\t\t\tdocument.all.");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\tpullXMenuDisabledAllMenu();\r\n\t\t}\r\n\t}\r\n\t}\r\n}\r\n\r\n//办理完毕-自动返回\r\nfunction include_endAutoReturn(){\r\n\tvar hangup=");
                  out.print(hangup);
                  out.write(";\r\n    if(hangup==1){\r\n    \talert(\"该流程已挂起！\");\r\n    }else{\r\n    \tif(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmturntodeal"));
                  out.write("\")){\r\n    \t\t//alert(document.all.activityClass.value);\r\n    \t\tinclude_sub2();\r\n    \t}    \t\r\n    }\t\r\n}\r\n\r\n//办理完毕--后继唯一结束\r\nfunction include_endOnlyComp(){\r\n\tinclude_comp();\r\n}\r\n\r\n//内部分发\r\nfunction include_selfsendSubmit(type){\r\n\tvar _mainPassRoundUserType=document.all.mainPassRoundUserType.value;\r\n\tif(_mainPassRoundUserType==\"10\"){\r\n\t\t//组织领导方式按照用户处理(已经选择了领导)\r\n\t\t_mainPassRoundUserType=\"100\";\r\n\t}\r\n    switch (parseInt(_mainPassRoundUserType)) {\r\n\tcase 10:\r\n\t\t//组织领导\r\n\t\tvar orgId = \"\";\r\n\t\tvar idstr = document.all.operId.value;\r\n\t\tif(idstr != \"\"){\r\n\t\t\tfor( var i = 0; i < idstr.length; i ++ ){\r\n\t\t\t\tflagCode = idstr.charAt(i);\r\n\t\t\t\tnextPos = idstr.indexOf(flagCode,i + 1);\r\n\t\t\t\tstr = idstr.substring(i+1,nextPos);\r\n\t\t\t\tif(flagCode == \"*\"){\r\n\t\t\t\t\torgId = orgId + str + \",\";\r\n\t\t\t\t}\r\n\t\t\t\ti = nextPos;\r\n\t\t\t}\r\n\t\t}\r\n\t\torgId = orgId.substring(0,orgId.length-1);\r\n\t\tdocument.all.operId.value = orgId;\r\n\t\tworkflowSync.getLeaderByOrgId(orgId, include_checkUserStatusSelfsend(type));\r\n\t\tbreak;\r\n\tdefault:\r\n\t\tdocument.all.");
                  out.print(formName);
                  out.write(".target = \"tempIframe\";\r\n\t\tdocument.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=passround&type=\"+type;\r\n\t\tdocument.all.");
                  out.print(formName);
                  out.write(".submit();\r\n\t}\r\n\tvar userAgent=navigator.userAgent;\r\n\tvar isEdge = userAgent.indexOf(\"Edge\") > -1; //判断是否IE的Edge浏览器\r\n\tif(!isEdge){\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includehassuccessturn"));
                  out.write("\"+(document.all.operName.value==''?\"\":(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeto"));
                  out.write("\"+document.all.operName.value))+(document.all.mainPassRoundUserType.value=='10'?\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeleader"));
                  out.write("\":\"\")+\"！\");\r\n\t}\r\n}\r\n\r\n//内部分发检测用户有效\r\nfunction include_checkUserStatusSelfsend(type,s) {\r\n\t if(s==\"noleader\"){\r\n\t\t//组织领导不存在\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includenoleader"));
                  out.write("\");\r\n\t\treturn;\r\n\t}\r\n    document.all.");
                  out.print(formName);
                  out.write(".target = \"tempIframe\";\r\n    document.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=passround&type=\"+type;\r\n    document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n}\r\n\r\n//转办\r\nfunction include_transTo(actiontype){\r\n    if(!include_saveSignature()){\r\n        return;\r\n    }   \r\n     if(document.all.transitionUserName.value == \"\" && actiontype!='tranAutoReturn'){\r\n         alert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeseltranuser"));
                  out.write("\");\r\n     }else{\r\n\t\tinclude_setComment();\r\n         document.all.inc_tb.style.display=\"none\";\r\n         document.all.");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowCommonAction.do?flag=trans&actiontype=\"+actiontype+\"&transend=");
                  out.print(request.getParameter("transend"));
                  out.write("\";\r\n         document.all.");
                  out.print(formName);
                  out.write(".submit();\r\n         ");
if (!BrowserJudge.isFirefox(request)) {
                  out.write("\r\n         var userAgent=navigator.userAgent;\r\n\t\tvar isEdge = userAgent.indexOf(\"Edge\") > -1; //判断是否IE的Edge浏览器\r\n\t\tif(!isEdge){\r\n\t\t\tif(actiontype=='tranAutoReturn'){\r\n\t\t\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
							"workflow.includehassuccessturntosign"));
                  out.write("\");\r\n\t\t\t} else{\r\n\t\t\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
							"workflow.includehassuccessturnto"));
                  out.write("\"+document.all.transitionUserName.value+\"！\");\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n      ");
}
                  out.write("\r\n      pullXMenuDisabledAllMenu();\r\n     }    \r\n}\r\n//用户决定流程走向时的“提交”事件\r\nfunction include_sub(){\r\n\tif(document.all.mainUserType && (document.all.mainUserType.value==\"0\" || document.all.mainUserType.value==\"7\")){\r\n\t\tif(!document.all.mainCandidateUser){alert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includenotsetupleader"));
                  out.write("\");return;}\r\n\t}\r\n    var i = 0;\r\n    if(document.all.nextActivity){\r\n        if(document.all.nextActivity.length){\r\n            for(var j = 0; j < document.all.nextActivity.length; j ++){\r\n                if(document.all.nextActivity[j].checked){\r\n                    i = 1;\r\n                    break;\r\n                }\r\n            }\r\n        }else{\r\n            if(document.all.nextActivity.checked){\r\n                i = 1;\r\n            }\r\n        }\r\n    }\r\n    if(include_checkUser()){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n            if(!include_saveSignature()){\r\n                return;\r\n            }\r\n            include_setComment();\r\n\t\t\t//发送标记\r\n\t\t\tdocument.all.isSend.value = 1;\r\n\t\t\tvar _userType=document.all.mainUserType.value;\r\n        \tif(_userType==\"10\"){\r\n        \t\t//选择方式是部门领导的，已经将领导empId,empName 取出，按照用户处理\r\n        \t\t_userType=\"100\";\r\n        \t}        \t\r\n            switch (parseInt(_userType)) {\r\n\t\t\t\tcase 100:\r\n                    //新节点\r\n                    var empId = \"\";\r\n                    var orgId = \"\";\r\n                    var groupId = \"\";\r\n                    var idstr = document.all.operId.value;\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i,nextPos+1);\r\n                            if(flagCode == \"$\"){\r\n                                empId = empId + str;\r\n                            }else if(flagCode == \"*\"){\r\n");
                  out.write("                                orgId = orgId + str;\r\n                            }else{\r\n                                groupId = groupId + str;\r\n                            }\r\n                            i = nextPos;\r\n                        }\r\n                    }\r\n                    workflowSync.getUserStatusByEmpOrgGrp(empId, orgId, groupId, include_checkUserStatus);\r\n                    break;\r\n\r\n\t\t\t\tcase 10:\r\n                    //组织领导\r\n                    var orgId = \"\";\r\n                    var idstr = document.all.operId.value;\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i+1,nextPos);\r\n                            if(flagCode == \"*\"){\r\n                                orgId = orgId + str + \",\";\r\n                            }\r\n                            i = nextPos;\r\n");
                  out.write("                        }\r\n                    }\r\n\t\t\t\t\torgId = orgId.substring(0,orgId.length-1);\r\n\t\t\t\t\tdocument.all.operId.value = orgId;\r\n                    workflowSync.getLeaderByOrgId(orgId, include_checkUserStatus);\r\n                    break;\r\n\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction include_branch_sub(){\r\n\tif(");
                  out.print(saveCheckFn);
                  out.write("){\r\n\t\tif(confirm(\"您确定提交处理吗？\")){\r\n            document.all.inc_tb.style.display=\"none\";\r\n            include_setComment();\r\n            ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n            ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=branchsend\";\t\t\t\r\n            ");
                  out.print(formName);
                  out.write(".submit();\r\n        }\r\n\t}\r\n}\r\n\r\n//流程决定走向时的“提交”事件\r\nfunction include_sub2(){\r\n    if(include_checkUser()){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n            if(!include_saveSignature()){\r\n                return;\r\n            }\r\n            include_setComment();\r\n            switch (parseInt(document.all.mainUserType.value)) {\r\n                case 0:\r\n                    //流程发起人的上级领导\r\n                    var userIds = \"\";\r\n                    if(document.all.mainCandidateUser.length){\r\n                        for(i = 0; i < document.all.mainCandidateUser.length; i ++ ){\r\n                            if(document.all.mainCandidateUser[i].checked){\r\n                                userIds += document.all.mainCandidateUser[i].value + \",\";\r\n                            }\r\n                        }\r\n                    }else{\r\n                        userIds = document.all.mainCandidateUser.value;\r\n                    }\r\n                    workflowSync.getUserStatusByEmpIdStr(userIds, include_checkUserStatus);\r\n                    break;\r\n                case 1:\r\n                    //由上一节点参与者从所有用户中选择\r\n                    var empId = \"\";\r\n                    var orgId = \"\";\r\n");
                  out.write("                    var groupId = \"\";\r\n                    var idstr = document.all.mainOperProcUser.value;\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i,nextPos+1);\r\n                            if(flagCode == \"$\"){\r\n                                empId = empId + str;\r\n                            }else if(flagCode == \"*\"){\r\n                                orgId = orgId + str;\r\n                            }else{\r\n                                groupId = groupId + str;\r\n                            }\r\n                            i = nextPos;\r\n                        }\r\n                    }\r\n                    workflowSync.getUserStatusByEmpOrgGrp(empId, orgId, groupId, include_checkUserStatus);\r\n                    break;\r\n                case 2:\r\n                    //从候选人员中指定candidateUser\r\n");
                  out.write("                    var userIds = \"\";\r\n                    if(document.all.mainCandidateUser.length){\r\n                        for(i = 0; i < document.all.mainCandidateUser.length; i ++ ){\r\n                            if(document.all.mainCandidateUser[i].checked){\r\n                                userIds += document.all.mainCandidateUser[i].value + \",\";\r\n                            }\r\n                        }\r\n                    }else{\r\n                        userIds = document.all.mainCandidateUser.value;\r\n                    }\r\n                    workflowSync.getUserStatusByEmpIdStr(userIds, include_checkUserStatus);\r\n                    break;\r\n                case 3:\r\n                    //指定全部办理人\r\n                    var userIds = \"\";\r\n                    if(document.all.mainAllUser.length){\r\n                        for(i = 0; i < document.all.mainAllUser.length; i ++ ){\r\n                            userIds += document.all.mainAllUser[i].value + \",\";\r\n                        }\r\n                    }else{\r\n");
                  out.write("                        userIds = document.all.mainAllUser.value;\r\n                    }\r\n                    workflowSync.getUserStatusByEmpIdStr(userIds, include_checkUserStatus);\r\n                    break;\r\n                case 5:\r\n                    //流程发起人\r\n                    workflowSync.getUserStatus(document.all.submitPersonId.value, include_checkUserStatus);\r\n                    break;\r\n                case 6:\r\n                    //角色用户\r\n                    workflowSync.getUserStatusByRole(document.all.mainPartRole.value, document.all.submitPersonId.value, include_checkUserStatus);\r\n                    break;\r\n\t\t\t\tcase 100:\r\n\t\t\t\t\t//默认:自动返回节点\r\n\t\t\t\t\tinclude_checkUserStatus(\"endAutoReturn\");\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction include_checkUserStatus(s) {\r\n\t if(s==\"noleader\"){\r\n\t\t//组织领导不存在\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includenoleader"));
                  out.write("\");\r\n\t\treturn;\r\n\t}\r\n    if(s == \"\"){\r\n        document.all.inc_tb.style.display=\"none\";\r\n        ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n        ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=update\";\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includehassuccessturnto"));
                  out.write("\"+document.all.operName.value+(document.all.mainUserType.value=='10'?\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeleader"));
                  out.write("\":\"\")+\"[\"+document.all.mainNextActivityName.value+\"]\");\r\n        ");
                  out.print(formName);
                  out.write(".submit();\r\n    } else if(s == \"endAutoReturn\"){\r\n\t\t//自动返回\r\n        document.all.inc_tb.style.display=\"none\";\r\n        ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n        ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=update\";\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includehassuccessturntosign"));
                  out.write("\");\r\n        ");
                  out.print(formName);
                  out.write(".submit();\r\n    } else {\r\n        if(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includenextuser"));
                  out.write("：\" + s + \",");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmturntodeal"));
                  out.write("\")){\r\n            document.all.inc_tb.style.display=\"none\";\r\n            ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n            ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=update\";\r\n\t\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includehassuccessturnto"));
                  out.write("\"+document.all.operName.value+(document.all.mainUserType.value=='10'?\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeleader"));
                  out.write("\":\"\")+\"[\"+document.all.mainNextActivityName.value+\"]\");\r\n            ");
                  out.print(formName);
                  out.write(".submit();\r\n        }\r\n    }\r\n    pullXMenuDisabledAllMenu();\r\n}\r\n\r\n//检验办理用户\r\nfunction include_checkUser(){\r\n\tif(document.all.mainUserType && (document.all.mainUserType.value==\"0\" || document.all.mainUserType.value==\"7\")){\r\n\t\tif(!document.all.mainCandidateUser){alert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includenotsetupleader"));
                  out.write("\");return;}\r\n\t}\r\n    if(document.all.mainCandidateUser){\r\n        var i = 0;\r\n        if(document.all.mainCandidateUser.length){\r\n            for(var j = 0; j < document.all.mainCandidateUser.length; j ++){\r\n                if(document.all.mainCandidateUser[j].checked){\r\n                    i = 1;\r\n                    break;\r\n                }\r\n            }\r\n        }else{\r\n            if(document.all.mainCandidateUser.checked){\r\n                i = 1;\r\n            }\r\n        }\r\n        if(i == 0){\r\n            alert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeseldealuser"));
                  out.write("\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    if(document.all.mainOperProcUserName){\r\n        if(document.all.mainOperProcUserName.value == \"\"){\r\n            alert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeseldealuser"));
                  out.write("\");\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\n//结束流程\r\nfunction include_comp(){\r\n    if(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmcompleteprocess"));
                  out.write("\")){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n            if(!include_saveSignature()){\r\n                return;\r\n            }\r\n            include_setComment();\r\n            //alert(\"ready to gd\");\r\n            document.all.inc_tb.style.display=\"none\";\r\n            ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n            ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=complete\";\r\n            if(document.all.moduleId.value!=\"1\"){\r\n                try{\r\n\t\t            //隐藏上面的菜单栏\r\n\t\t            document.getElementById(\"commandBar\").style.display=\"none\";\r\n\t\t            document.getElementById(\"panleAll\").style.display=\"none\";\r\n\t\t            //将body中的内容提交到后台，以备归档处理\r\n\t\t            document.all.bodyContent.value=document.body.innerHTML;\r\n\t            }catch(e){\r\n\t            }\r\n            }else{\r\n            \t");
//如果需要归档
				if (com.js.oa.jsflow.util.WorkflowToArchive
						.isNeedArchive(processId)) {
                  out.write("\r\n            \ttry{\r\n\t\t            //隐藏上面的菜单栏\r\n\t\t            document.getElementById(\"commandBar\").style.display=\"none\";\r\n\t\t            document.getElementById(\"panleAll\").style.display=\"none\";\r\n\t\t            //将body中的内容提交到后台，以备归档处理\r\n\t\t            document.all.bodyContent.value=document.body.innerHTML;\r\n\t            }catch(e){\r\n\t            }\r\n            \t");
}
                  out.write("\r\n            }           \r\n            ");
                  out.print(formName);
                  out.write(".submit();\r\n            pullXMenuDisabledAllMenu();\r\n        }\r\n    }\r\n}\r\n//保存手写意见\r\nfunction include_saveSignature(){\r\n    ");
if (curCommField != null && !curCommField.equals("")
						&& curCommField.indexOf("-1") < 0
						&& !"null".equals(curCommField)) {
					//有批示意见对应字段
					if (!curCommField.startsWith("$")) {
						//有一个批示意见对应字段
                  out.write("\r\n            if(document.all.");
                  out.print(curCommField);
                  out.write("_SendOut){\r\n            \t");
//判断手写意见是否为空
						if (SystemCommon.getHandWriteNotEmpty() == 1) {
                  out.write("\r\n            \tif(document.all.commType){            \t\t\r\n            \t\t//公文中的审批\r\n            \t\tif(document.all.");
                  out.print(curCommField);
                  out.write("_SendOut.DocEmpty){\r\n            \t\t\talert(\"签批意见不能为空！\");\r\n            \t\t\treturn false;\r\n            \t\t}\r\n            \t}else{\r\n            \t\t\r\n            \t\tif(document.getElementById(\"commentSignType\").value==\"1\" && document.all.");
                  out.print(curCommField);
                  out.write("_SendOut.DocEmpty){\r\n            \t\t\talert(\"签批意见不能为空！\");\r\n            \t\t\treturn false;\r\n            \t\t}\r\n            \t}\r\n            \t");
}
                  out.write("\r\n            \tif(document.getElementById(\"commentSignType\").value==\"1\"){\r\n\t                if(document.all.");
                  out.print(curCommField);
                  out.write("_SendOut.SaveSignature()){\r\n\t                    return true;\r\n\t                }else{\r\n\t                \talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
								"workflow.includegoldlinkerror"));
                  out.write("\");\r\n\t                    return false;\r\n\t                }\r\n            \t}else{\r\n            \t\treturn true;\r\n            \t}\r\n            }else{\r\n                return true;\r\n            }\r\n            ");
} else {
						//有多个批示意见对应字段
						String[] curCommFieldArr = curCommField.substring(1,
								curCommField.length() - 1).split("\\$\\$");
                  out.write("\r\n\t\t\tif(document.all.");
                  out.print(curCommFieldArr[0]);
                  out.write("_SendOut){\r\n            var tmpValue = document.all.");
                  out.print(curCommFieldArr[0]);
                  out.write("_SendOut.value;\r\n            var testValue = 0;\r\n            ");
for (int i = 0; i < curCommFieldArr.length; i++) {
                  out.write("\r\n                if(document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write("_SendOut){\r\n                    if(document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write("_SendOut.modify){\r\n                        document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write("_SendOut.SaveSignature();\r\n                        testValue = 1;\r\n                    }else{\r\n                        document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write(".value = \"\";\r\n                    }\r\n                }else{\r\n                    return true;\r\n                }\r\n                ");
}
                  out.write("\r\n\t\t\t}\r\n            if(testValue == 0){\r\n                document.all.");
                  out.print(curCommFieldArr[0]);
                  out.write(".value = tmpValue;\r\n            }\r\n            return true;\r\n            ");
}
				} else {
					//无批示意见对应字段
                  out.write("\r\n        if(document.all.SignSendOutObject){\r\n        \t");
//判断手写意见是否为空
					if (SystemCommon.getHandWriteNotEmpty() == 1) {
                  out.write("\r\n            \tif(document.all.commType){\r\n            \t\t//公文中的审批\r\n            \t\tif(eval(\"document.all.\"+document.all.SignSendOutObject.value+\".DocEmpty\")){\r\n            \t\t\talert(\"签批意见不能为空！\");\r\n            \t\t\treturn false;\r\n            \t\t}\r\n            \t}else{\r\n            \t\tif(document.getElementById(\"commentSignType\").value==\"1\" && eval(\"document.all.\"+document.all.SignSendOutObject.value+\".DocEmpty\")){\r\n            \t\t\talert(\"签批意见不能为空！\");\r\n            \t\t\treturn false;\r\n            \t\t}\r\n            \t}\r\n            \t\t\r\n            \t");
}
                  out.write("\r\n            \tif(document.getElementById(\"commentSignType\").value==\"1\"){\r\n\t\t            if(eval(\"document.all.\"+document.all.SignSendOutObject.value+\".SaveSignature()\")){\r\n\t\t                return true;\r\n\t\t            }else{\r\n\t\t            \talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
							"workflow.includegoldlinkerror"));
                  out.write("\");\r\n\t\t                return false;\r\n\t\t            }\r\n            \t}else{\r\n            \t\treturn true;\r\n            \t}\r\n        }else{\r\n            return true;\r\n        }\r\n        ");
}
                  out.write("\r\n}\r\n\r\n//批示意见\r\nfunction include_setComment(){\r\n    ");
if (inWorkStatus == 0) {
					//批示意见对应字段
					if (curCommField != null && !curCommField.equals("")
							&& !curCommField.trim().equals("-1")
							&& !"null".equals(curCommField)) {
						if (!curCommField.startsWith("$")) {
							//一个批示意见字段
                  out.write("\r\n\t\t\tif(document.all.");
                  out.print(curCommField);
                  out.write("){\r\n\t\t\t\tvar commentSignType = document.all.commentSignType;\r\n\t\t\t\tif(commentSignType && document.all.");
                  out.print(curCommField);
                  out.write(".length){\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.");
                  out.print(curCommField);
                  out.write("[commentSignType.value].value;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.");
                  out.print(curCommField);
                  out.write(".value;\r\n                }\r\n\t\t\t}\r\n        ");
} else {
							//多个批示意见字段
							String[] curCommFieldArr = curCommField.substring(
									1, curCommField.length() - 1).split(
									"\\$\\$");
                  out.write("\r\n                var j = 0;\r\n                commentValue = \"\";\r\n                commFieldValue = \"\";\r\n                ");
for (int i = 0; i < curCommFieldArr.length; i++) {
                  out.write("\r\n                    if(document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write(" && document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write(".value != \"\"){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar commentSignType = document.all.commentSignType[");
                  out.print(i);
                  out.write("].value;\r\n\r\n                        commentValue += document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write("[commentSignType].value + \":::\";\r\n                        commFieldValue += \"$");
                  out.print(curCommFieldArr[i]);
                  out.write("$\";\r\n                        j ++;\r\n                    }\r\n                ");
}
                  out.write("\r\n                if(j == 0){\r\n                    document.all.include_comment.value = document.all.");
                  out.print(curCommFieldArr[0]);
                  out.write("[0].value;\r\n                    document.all.include_commField.value = \"");
                  out.print(curCommFieldArr[0]);
                  out.write("\";\r\n                }else if(j == 1){\r\n                    commentValue = commentValue.substring(3, commentValue.length-3);\r\n                    document.all.include_comment.value = commentValue.substring(commentValue.indexOf(\";;;\") + 3, commentValue.length);\r\n                    document.all.include_commField.value = commFieldValue.substring(1, commFieldValue.length-1);\r\n                }else{\r\n                    document.all.include_comment.value = commentValue;\r\n                    document.all.include_commField.value = commFieldValue;\r\n                }\r\n                ");
}
					} else {
						//自动增长批示意见
                  out.write("\r\n            if(document.all.comment){\r\n\t\t\t\tvar commentSignType = document.all.commentSignType.value;\r\n\t\t\t\tif(document.all.comment.length){\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.comment[commentSignType].value;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.comment.value;\r\n\t\t\t\t}\r\n            }\r\n        ");
}
				}
				if (inWorkStatus == 2) {
					if (curPassRoundCommField != null
							&& !curPassRoundCommField.equals("")
							&& !curPassRoundCommField.trim().equals("-1")) {
						//System.out.println("///////////////////////////////////////\n"+curPassRoundCommField);
						if (!curPassRoundCommField.startsWith("$")) {
                  out.write("\r\n\t\t\tif(document.all.");
                  out.print(curPassRoundCommField);
                  out.write("){\r\n\t\t\t\tvar commentSignType = document.all.commentSignType;\r\n\t\t\t\tif(commentSignType && document.all.");
                  out.print(curPassRoundCommField);
                  out.write(".length){\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.");
                  out.print(curPassRoundCommField);
                  out.write("[commentSignType.value].value;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.");
                  out.print(curPassRoundCommField);
                  out.write(".value;\r\n                }\r\n\t\t\t}\r\n        ");
} else {
							String[] curCommFieldArr = curPassRoundCommField
									.substring(1,
											curPassRoundCommField.length() - 1)
									.split("\\$\\$");
                  out.write("\r\n                var j = 0;\r\n                commentValue = \"\";\r\n                commFieldValue = \"\";\r\n                ");
for (int i = 0; i < curCommFieldArr.length; i++) {
                  out.write("\r\n                    if(document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write(" && document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write(".value != \"\"){\r\n                        commentValue += document.all.");
                  out.print(curCommFieldArr[i]);
                  out.write(".value + \":::\";\r\n                        commFieldValue += \"$");
                  out.print(curCommFieldArr[i]);
                  out.write("$\";\r\n                        j ++;\r\n                    }\r\n                ");
}
                  out.write("\r\n                if(j == 0){\r\n                    document.all.include_comment.value = document.all.");
                  out.print(curCommFieldArr[0]);
                  out.write(".value;\r\n                    document.all.include_commField.value = \"");
                  out.print(curCommFieldArr[0]);
                  out.write("\";\r\n                }else if(j == 1){\r\n                    commentValue = commentValue.substring(3, commentValue.length-3);\r\n                    document.all.include_comment.value = commentValue.substring(commentValue.indexOf(\";;;\") + 3, commentValue.length);\r\n                    document.all.include_commField.value = commFieldValue.substring(1, commFieldValue.length-1);\r\n                }else{\r\n                    document.all.include_comment.value = commentValue;\r\n                    document.all.include_commField.value = commFieldValue;\r\n                }\r\n                ");
}
					} else {
                  out.write("\r\n\t\t\tif(document.all.comment){\r\n\t\t\t\tvar commentSignType = document.all.commentSignType.value;\r\n\t\t\t\tif(document.all.comment.length){\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.comment[commentSignType].value;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tdocument.all.include_comment.value = document.all.comment.value;\r\n\t\t\t\t}\r\n            }\r\n        ");
}
				}
                  out.write("\r\n}\r\n\r\n\r\n//\r\nfunction include_randomSave(s){\r\n    if(s == \"next\"){\r\n        if(document.all.randomProcUser){\r\n            if(document.all.randomProcUser.value == \"\"){\r\n                alert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeseldealuser"));
                  out.write("\");\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n        if(!include_saveSignature()){            \r\n            return;\r\n        }\r\n        include_setComment();\r\n        ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n        ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowCommonAction.do?flag=random&type=\" + s;\r\n        ");
                  out.print(formName);
                  out.write(".submit();\r\n\t\tif(s == \"next\"){\r\n\t\t\talert(\"已成功提交给\"+document.all.randomProcUserName.value+\"！\");\r\n\t\t} else{\r\n\t\t\talert(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeprocesshascomplete"));
                  out.write("\");\r\n\t\t}\r\n    }\r\n}\r\n\r\nfunction include_myOpen(obj, objName, rangeName, rangeId){\r\n    var imgObj = eval(\"document.all.\" + objName);\r\n    if(imgObj.length){\r\n        for(var i = 0; i < imgObj.length; i ++){\r\n            if(imgObj[i] == obj){\r\n                var input_name = eval(\"document.all.\" + rangeName + \"[\" + i + \"]\");\r\n                var input_id = eval(\"document.all.\" + rangeId + \"[\" + i + \"]\");\r\n                openEndow(rangeId + \"[\" + i + \"]\",rangeName + \"[\" + i + \"]\", input_id.value, input_name.value, \"user\",\"no\",\"orgusergroup\",\"*0*\");\r\n                break;\r\n            }\r\n        }\r\n    }else{\r\n        if(obj == imgObj){\r\n            var input_name = eval(\"document.all.\" + rangeName);\r\n            var input_id = eval(\"document.all.\" + rangeId);\r\n            openEndow(rangeId,rangeName,input_id.value,input_name.value,\"user\",\"no\",\"orgusergroup\",\"*0*\");\r\n        }\r\n    }\r\n}\r\n\r\n//选择全部办理/阅件用户\r\nfunction selectAll(name,obj){\r\n\tif(eval(\"document.all.\"+name)){\r\n\t\tif(eval(\"document.all.\"+name+\".length\")){\r\n");
                  out.write("\t\t\tfor(i=0;i<eval(\"document.all.\"+name+\".length\");i++){\r\n\t\t\t\tif(obj.checked){\r\n\t\t\t\t\teval(\"document.all.\"+name)[i].checked = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\teval(\"document.all.\"+name)[i].checked = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tif(obj.checked){\r\n\t\t\t\teval(\"document.all.\"+name).checked = true;\r\n\t\t\t}else{\r\n\t\t\t\teval(\"document.all.\"+name).checked = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//关闭\r\nfunction include_close(){\r\n    if(confirm(\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeconfirmclosewindow"));
                  out.write("\")){\r\n    \twindow.opener=null;\r\n        window.close();\r\n    }\r\n}\r\n\r\n//在线锁提醒\r\nfunction checkWFOnlineUser(){\t\r\n\tvar nolock = false;\r\n\tfunction alertOnlineUser(s){\r\n\t\tif(s != \"\"){\r\n\t\t\talert(s+\"");
                  out.print(Resource.getValue(localhi, "workflow",
						"workflow.includeediting"));
                  out.write("\");\r\n\t\t\tnolock = false;\r\n\t\t} else{\r\n\t\t\tnolock = true;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t DWREngine.setAsync(false);       //设置成同步 \r\n\t workflowSync.getWFOnlineUser(document.all.recordId.value, document.all.tableId.value, document.all.processId.value, document.all.workId.value,'");
                  out.print(session.getAttribute("userAccount").toString());
                  out.write('\'');
                  out.write(',');
                  out.write('\'');
                  out.print(pageKey);
                  out.write("', alertOnlineUser);\r\n\t DWREngine.setAsync(true);       //重新设置为异步方式\t \r\n\t return nolock;    \r\n}\r\n\r\n</script>\r\n<iframe id=\"include_iframe\" name=\"include_iframe\" style=\"display:none\"></iframe>\r\n");

	}

                  out.write('\r');
                  out.write('\n');

	if ("y".equals(request.getParameter("fromDossierData"))
			&& "100".equals(request.getParameter("workStatus"))
			&& request.getParameter("finish") == null) {
		operButton += ",FlowToArchives";
	}

                  out.write("\r\n<!--流程按钮-->\r\n<script src=\"/jsoa/public/jsp/cmdbutton.jsp?button=Close");
                  out.print(operButton);
                  out.write("\"></script>\r\n<!--流程按钮-->\r\n\r\n\r\n");

	//显示办理提示和取消原因
	//System.out.println("work:"+request.getParameter("work"));
	String dealTips = new com.js.oa.jsflow.service.WorkFlowButtonBD()
			.getDealTipsByWorkId(request.getParameter("work"));
	String backdetails=new com.js.oa.jsflow.service.WorkFlowBD().getCancelReason(request.getParameter("work"));
	//System.out.println("dealTips:"+dealTips);

                  out.write("\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\nfunction showDealTips(){\r\n\t");
if (dealTips != null && !dealTips.equals("")||(backdetails !=null && !backdetails.equals(""))) {
                  out.write("\t\t\r\n\t\tJSMainWinOpenNew(\"/jsoa/jsflow/showDealTips.jsp?work=");
                  out.print(request.getParameter("work"));
                  out.write("\",'','scrollbars=yes,resizable=yes,width=250,height=150');\r\n\t");
}
                  out.write("\r\n}\r\n");
if (BrowserJudge.isMSIE(request)) {
                  out.write("\r\n//if(navigator.userAgent.indexOf(\"MSIE\")>0){\r\n\twindow.attachEvent(\"onload\", showDealTips);\r\n//}else{\r\n");
} else {
                  out.write("\r\n\twindow.addEventListener(\"load\",showDealTips,false);\r\n//}");
}
                  out.write("\r\nvar i_link,i_handle,i_para;\r\nfunction createSubProcess(link,handle,para){\r\n\ti_link=link;\r\n\ti_handle=handle;\r\n\ti_para=para;\r\n\tvar subProcWorkId=document.getElementsByName(\"subProcWorkId\")[0].value;\t\r\n\tvar processId=document.getElementsByName(\"subProcId\")[0].value;\r\n\tif(subProcWorkId==\"\"){\r\n\t    //JSMainWinOpen(link,hand,para);\r\n\t    workflowSync.userCanCreateFlow(processId,'");
                  out.print(session.getAttribute("userId").toString());
                  out.write("', '");
                  out.print(session.getAttribute("orgId").toString());
                  out.write("', '");
                  out.print(session.getAttribute("orgIdString").toString());
                  out.write("', getCreateSubProcessRight);\r\n\t}else{\r\n\t\tif(confirm(\"当前流程已经发起过子流程,您确定还要再次发起吗?\")){\r\n\t\t\t//JSMainWinOpen(link,hand,para);\r\n\t\t\tworkflowSync.userCanCreateFlow(processId,'");
                  out.print(session.getAttribute("userId").toString());
                  out.write("', '");
                  out.print(session.getAttribute("orgId").toString());
                  out.write("', '");
                  out.print(session.getAttribute("orgIdString").toString());
                  out.write("', getCreateSubProcessRight);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction getCreateSubProcessRight(res){\r\n\t if(res==\"0\"){\r\n\t \talert(\"您没有发起当前子流程的权限,请与管理员联系!\");\r\n\t }else{\r\n\t\t JSMainWinOpen4(i_link,i_handle,i_para,\"\",\"800\");\r\n\t }\r\n}\r\nfunction editOffices(field,fileType,template,showSign){\r\n\t//alert(\"开始打开\");\r\n\tvar recordId = eval(\"document.all.\"+field+\".value\");\r\n\tvar userName = document.all.user_Name.value;\r\n\t");
if (onlineUserValidate) {
                  out.write("\r\n\twindow.open(\"/jsoa/iWebOfficeSign/DocumentEdit.jsp?RecordID=\"+recordId+\"&EditType=0&UserName=\"+userName+\r\n\t\t\t\"&ShowSign=\"+showSign+\"&CanSave=0&moduleType=information&saveHtmlImage=0&saveDocFile=0&field=\"+field+\r\n\t\t\t\"&FileType=.\"+fileType+\"&showEditButton=1&showSignButton=1&Template=\"+template, \r\n\t\t\t\"\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\");\r\n\t");
} else {
                  out.write("\r\n\twindow.open(\"/jsoa/iWebOfficeSign/DocumentEdit.jsp?RecordID=\"+recordId+\"&EditType=1&UserName=\"+userName+\r\n\t\t\t\"&ShowSign=\"+showSign+\"&CanSave=1&moduleType=information&saveHtmlImage=0&saveDocFile=0&field=\"+field+\r\n\t\t\t\"&FileType=.\"+fileType+\"&showEditButton=1&showSignButton=1&Template=\"+template, \r\n\t\t\t\"\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\");\r\n\t");
}
                  out.write("\r\n}\r\n\r\nfunction cmdSend2(ids){\r\n\tvar formName = document.all.formName.value;\r\n\tvar processIdTmp=document.getElementsByName(\"processId\")[0].value;\t\r\n\tvar standForUserId=document.getElementById(\"standForUserId\").value;//代办人ID\r\n\tvar workPrarllelCurActId=\"0\";\r\n\tif(document.all.workPrarllelCurActId){\r\n\t\tworkPrarllelCurActId=document.all.workPrarllelCurActId.value;\r\n\t}\r\n\tvar url = \"/jsoa/WorkflowButtonAction.do?flag=showsend&processType=\"+document.all.inWorkType.value+\"&processId=\" +processIdTmp +\"&tableId=\" +document.all.tableId.value + \"&recordId=\" + document.all.recordId.value +\"&activityId=\" + document.all.curActivityId.value + \"&submitPersonId=\" +document.all.submitPersonId.value + \"&msgFrom=\" + document.all.msgFrom.value+'&tranFromPersonId='+document.all.tranFromPersonId.value+\"&activityIds=\"+ids+\"&standForUserId=\"+standForUserId+\"&workPrarllelCurActId=\"+workPrarllelCurActId;\r\n\t");
if (com.js.util.util.BrowserJudge.isMobile(request)) {
                  out.write("\r\n\tJSMainWinOpen(url);\r\n\t");
} else {
                  out.write("\r\n\tJSMainWinOpen4(url, \"send\"+randomFrameId, 'menubar=0,scrollbars=0,locations=0,width=500,height=400,resizable=no,location=no,status=no',500,400);\r\n\t");
}
                  out.write("\r\n}\r\n\r\nfunction checkYijianBlur(obj){\r\n\tvar yijian = obj.value;\r\n\tif(yijian.indexOf(\"'\")>=0 || yijian.indexOf(\"\\\"\")>=0){\r\n\t\talert(\"意见中不能有英文状态下的单引号或双引号\");\r\n\t\tobj.focus();\r\n\t}\t\r\n}\r\n</SCRIPT>\r\n");

						  		}else{
						  			
                  out.write("\r\n\r\n \r\n\r\n\r\n");

String localhi = session.getAttribute("org.apache.struts.action.LOCALE").toString();

                  out.write("\r\n<script type='text/javascript' src='/jsoa/workflow/dwr/interface/workflowSync.js'></script>\r\n<script type='text/javascript' src='/jsoa/workflow/dwr/engine.js'></script> \r\n<script src=\"/jsoa/js/util.js\"></script>\r\n\r\n<input type=\"hidden\" name=\"tableId\" id=\"tableId\" value=\"");
                  out.print((request.getAttribute("tableId")==null || request.getAttribute("tableId").toString().toUpperCase().equals("NULL"))?request.getParameter("tableId"):request.getAttribute("tableId").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"recordId\" id=\"recordId\" value=\"");
                  out.print((request.getAttribute("recordId")==null || request.getAttribute("recordId").toString().toUpperCase().equals("NULL"))?request.getParameter("recordId"):request.getAttribute("recordId").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"editId\" id=\"editId\" value=\"");
                  out.print(request.getParameter("editId") != null ? request.getParameter("editId").toString() : "");
                  out.write("\">\r\n\r\n<input type=\"hidden\" name=\"processType\" id=\"processType\" value=\"");
                  out.print((request.getAttribute("processType")==null || request.getAttribute("processType").toString().toUpperCase().equals("NULL"))?request.getParameter("processType"):request.getAttribute("processType").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"processName\" id=\"processName\" value=\"");
                  out.print((request.getAttribute("processName")==null || request.getAttribute("processName").toString().toUpperCase().equals("NULL"))?request.getParameter("processName"):request.getAttribute("processName").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"processId\" id=\"processId\" value=\"");
                  out.print((request.getAttribute("processId")==null || request.getAttribute("processId").toString().toUpperCase().equals("NULL"))?request.getParameter("processId"):request.getAttribute("processId").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"remindField\" id=\"remindField\" value=\"");
                  out.print((request.getAttribute("remindField")==null || request.getAttribute("remindField").toString().toUpperCase().equals("NULL"))?request.getParameter("remindField"):request.getAttribute("remindField").toString());
                  out.write("\">\r\n<input type=\"hidden\" name=\"moduleId\" id=\"moduleId\" value=\"");
                  out.print((request.getAttribute("moduleId")==null || request.getAttribute("moduleId").toString().toUpperCase().equals("NULL"))?request.getParameter("moduleId"):request.getAttribute("moduleId").toString());
                  out.write("\">\r\n\r\n<input type=\"hidden\" name=\"mainLinkFile\" id=\"mainLinkFile\" value=\"");
                  out.print(mainLinkFile);
                  out.write("\">\r\n<input type=\"hidden\" name=\"titleFieldName\" id=\"titleFieldName\" value=\"");
                  out.print(titleFieldName);
                  out.write("\">\r\n<input type=\"hidden\" name=\"msgFrom\" id=\"msgFrom\" value=\"");
                  out.print(msgFrom);
                  out.write("\">\r\n<input type=\"hidden\" name=\"cancelHref\" id=\"cancelHref\" value=\"");
                  out.print(cancelHref);
                  out.write("\">\r\n");
if(request.getParameter("isSubProcWork") != null){
                  out.write("\r\n<input type=\"hidden\" name=\"isSubProcWork\" id=\"isSubProcWork\" value=\"1\">\r\n<input type=\"hidden\" name=\"pareProcActiId\" id=\"pareProcActiId\" value=\"");
                  out.print(request.getParameter("pareProcActiId"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"pareStepCount\" id=\"pareStepCount\" value=\"");
                  out.print(request.getParameter("pareStepCount"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"pareTableId\" id=\"pareTableId\" value=\"");
                  out.print(request.getParameter("pareTableId"));
                  out.write("\">\r\n<input type=\"hidden\" name=\"pareRecordId\" id=\"pareRecordId\" value=\"");
                  out.print(request.getParameter("pareRecordId"));
                  out.write("\">\r\n");
}
                  out.write("\r\n\r\n<!-- 新增表单域 -->\r\n");



String markField="1";//标记此方法可用：1,不可用：0
//Map map=new  com.js.oa.jsflow.util.InitWorkFlowData().getClassMethod(markField,request);

com.js.oa.jsflow.vo.ActivityVO activityVO = new com.js.oa.jsflow.util.WorkflowCommon().getFirstActivityInfo(request);
if(false){

                  out.write("\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\nalert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includenosetupstartactivity"));
                  out.write("\");\r\n//-->\r\n</SCRIPT>\r\n<script src=\"/jsoa/public/jsp/cmdbutton.jsp?button=Close\"></script>\r\n");
}else{
                  out.write("\r\n<input type=hidden name=userType id=\"userType\" value=100>\r\n<INPUT TYPE=\"hidden\" name=\"operName\" id=\"operName\" value=\"");
                  out.print(session.getAttribute("userName").toString());
                  out.write("\">\r\n<INPUT TYPE=\"hidden\" name=\"operId\" id=\"operId\" value=\"$");
                  out.print(session.getAttribute("userId").toString());
                  out.write("$\">\r\n<input type=hidden name=allowStandFor id=\"allowStandFor\" value=\"0\">\r\n<input type=hidden name=allowCancel id=\"allowCancel\" value=\"0\">\r\n<input type=hidden name=activityId id=\"activityId\" value=\"");
                  out.print(activityVO==null? 0:activityVO.getId());
                  out.write("\">\r\n<input type=hidden name=activityName id=\"activityName\" value=\"");
                  out.print(activityVO==null?"":activityVO.getName());
                  out.write("\">\r\n<input type=\"hidden\" id=\"branchActInfo\" name=\"branchActInfo\" value=\"\">\r\n\r\n<input type=hidden name=pressType id=\"pressType\" value=\"0\">\r\n<input type=hidden name=deadLineTime id=\"deadLineTime\" value=\"-1\">\r\n<input type=hidden name=pressMotionTime id=\"pressMotionTime\" value=\"-1\">\r\n<input type=hidden name=\"emergence\" id=\"emergence\" value=0><!--缓急程度-->\r\n<input type=hidden name=\"needSendMsg\" id=\"needSendMsg\"><!--短信-->\r\n<input type=hidden name=\"smsContent\" id=\"smsContent\"><!--短信内容-->\r\n<input type=hidden name=\"dealTips\" id=\"dealTips\"><!--tips内容-->\r\n<input type=hidden name=\"processDeadlineDate\" id=\"processDeadlineDate\" value=\"0\"><!--流程办理期限-->\r\n<input type=hidden name=approveMode id=\"approveMode\" value=\"2\"><!--当前节点办理方式--><!--默认为2：单人-->\r\n<input type=hidden name=saveCheckFn id=\"saveCheckFn\" value=\"");
                  out.print(saveCheckFn);
                  out.write("\">\r\n<input type=hidden name=formName id=\"formName\" value=\"");
                  out.print(formName);
                  out.write("\">\r\n\r\n<input type=\"hidden\" name=\"sendMsgToInitiator\" id=\"sendMsgToInitiator\" value=\"0\"> <!-- 是否给发起人发送提醒 -->\r\n<input type=\"hidden\" name=\"sendMsgToDealDone\" id=\"sendMsgToDealDone\" value=\"0\"> <!-- 是否给已办人员发送提醒 -->\r\n\r\n<input type=hidden name=sendContinue id=\"sendContinue\" value=\"0\"><!-- 是否发送继续，默认否 -->\r\n<input type=hidden name=sendContinueUrl id=\"sendContinueUrl\" >\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\ndocument.all.sendContinueUrl.value=window.location;\r\n//-->\r\n</SCRIPT>\r\n<input type=\"hidden\" name=\"subProcess\" id=\"subProcess\" value=\"");
                  out.print("1".equals(request.getParameter("subProcess"))?"1":"0");
                  out.write("\"><!-- 是否是子流程发起页面 -->\r\n\r\n<input type=\"hidden\" name=\"changeDeadLineTime\" id=\"changeDeadLineTime\" value=\"-1\">\r\n");
                  out.write("\r\n<!--阅件参数-->\r\n<input type=hidden name=\"mainNeedPassRound\" id=\"mainNeedPassRound\" value=\"1\">\r\n<input type=hidden name=\"mainPassRoundUserType\" id=\"mainPassRoundUserType\" value=100>\r\n<input type=hidden name=\"passRoundId\" id=\"passRoundId\">\r\n<input type=hidden name=\"passRoundName\" id=\"passRoundName\">\r\n\r\n  <table align=\"center\" width=\"100%\" style=\"display:none\">\r\n        <tr>\r\n            <td height=\"40\" colspan=\"2\" id=\"include_td1\">\r\n                <table border=\"0\" align=\"center\" cellpadding=\"1\" cellspacing=\"1\">\r\n                    <tr>\r\n                        <td>\r\n                            <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                                <tr>\r\n                                    <td>\r\n                                    <button class=\"btnButton4font\" onclick=\"javascript:");
                  out.print("1".equals(request.getParameter("moduleId"))?"if(beforeSubmit()){":"");
                  out.write("include_nextStep();");
                  out.print("1".equals(request.getParameter("moduleId"))?"}":"");
                  out.write("\">下一步骤</button>\r\n                                    </td>\r\n                                </tr>\r\n                            </table>\r\n                        </td>\r\n                        ");

                        if(button != null && button.length > 0){
                            for(int i = 0; i < button.length; i++){
                            //String btnStyle = "btnButton4font";
                            //if (button[i][0].toString().length <= 4)
                            //btnStyle = "btnButton2font";
                                
                  out.write("\r\n                                <td>\r\n                                    <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                                        <tr>\r\n                                            <td><button class=\"btnButton4font\" onclick=\"javascript:");
                  out.print(button[i][1]);
                  out.write(';');
                  out.write('"');
                  out.write('>');
                  out.print(button[i][0]);
                  out.write("</button></td>\r\n                                        </tr>\r\n                                    </table>\r\n                                </td>\r\n                                ");

                            }
                        }
                  out.write("\r\n                        <td>\r\n                            <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                                <tr>\r\n                                    <td>\r\n                                        <button class=\"btnButton2font\" onclick=\"javascript:window.location.reload();\">重置</button>\r\n                                    </td>\r\n                                </tr>\r\n                            </table>\r\n                        </td>\r\n                        <td>\r\n                            <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n                                <tr>\r\n                                    <td>\r\n                                    <button class=\"btnButton2font\" onclick =\"javascript:window.close();\">退出</button>\r\n                                    </td>\r\n                                </tr>\r\n                            </table>\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </td>\r\n        </tr>\r\n        ");
//if(com.js.system.util.SysSetupReader.getInstance().hasEzWorkFlow(session.getAttribute("domainId").toString())){
                  out.write("\r\n        <!--\r\n        <tr>\r\n            <td colspan=\"2\" align=\"center\">\r\n                <iframe height=\"500\" width=\"90%\" src=\"/jsoa/jsflow/jsflow_view.jsp?processId=");
                  out.print(request.getParameter("processId"));
                  out.write("&table=");
                  out.print(request.getParameter("table"));
                  out.write("&record=");
                  out.print(request.getParameter("record"));
                  out.write("&CurActivityID=&ActivityIDStr=\"></iframe>\r\n            </td>\r\n        </tr>-->\r\n        ");
//}
                  out.write("\r\n    </table>\r\n\r\n<iframe width=\"0\" height=\"0\" id=\"include_iframe\" name=\"include_iframe\" style=\"display:none\"></iframe>\r\n<script language=\"javascript\">\r\n<!--\r\n");
if(!"0".equals(request.getParameter("processType"))){
                  out.write("\r\nvar include_td1HTML = document.all.include_td1.innerHTML;\r\n");
}
                  out.write("\r\n\r\n//取消显示退回信息\r\nfunction include_backCacnel(){\r\n    document.all.include_td1.innerHTML = include_td1HTML;\r\n}\r\n//国资委 收文保存草稿功能  专用\r\nfunction include_save_receivefile_gzw(){\r\n\tif(");
                  out.print(saveCheckFn);
                  out.write("){\r\n\t\tvar editId = document.getElementById(\"editId\");\r\n\t\tvar frm=document.getElementsByName(\"");
                  out.print(formName);
                  out.write("\")[0];\r\n\t\t//frm.target = \"myIframe\";\r\n\t\tfrm.action = \"/jsoa/TjgzwAction.do?type=save_gzw_receivfile&editId=\"+editId.value+\"");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("\";\r\n\t\t//alert(frm.action);\r\n\t    //setTimeout(\"window.close();\",2000);\r\n\t\tfrm.submit();\r\n\r\n\t}\r\n\t\r\n}\r\n\r\n//保存\r\nfunction include_save(){\r\n//alert(\"firstHidden:\"+\"include_save\");\r\n    if(include_checkUser()){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n        \tvar _userType=document.all.userType.value;\r\n        \t//alert(_userType);\r\n        \tif(_userType==\"10\"){\r\n        \t\t//选择方式是部门领导的，已经将领导empId,empName 取出，按照用户处理\r\n        \t\t_userType=\"100\";\r\n        \t}\r\n        \t\r\n            switch (parseInt(_userType)) {\r\n\t\t\t\tcase 100:\r\n                    //新节点\r\n                    var empId = \"\";\r\n                    var orgId = \"\";\r\n                    var groupId = \"\";\r\n                    var idstr = document.all.operId.value;\r\n                    //alert(idstr);\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i,nextPos+1);\r\n                            if(flagCode == \"$\"){\r\n                                empId = empId + str;\r\n                            }else if(flagCode == \"*\"){\r\n                                orgId = orgId + str;\r\n");
                  out.write("                            }else{\r\n                                groupId = groupId + str;\r\n                            }\r\n                            i = nextPos;\r\n                        }\r\n                    }\r\n\t\t\t\t\t//alert(empId+ \"\\n\" +orgId+ \"\\n\" +groupId);\r\n\t\t\t\t\t//alert(include_checkUserStatus);\r\n                    workflowSync.getUserStatusByEmpOrgGrp(empId, orgId, groupId, include_checkUserStatus);\r\n                    break;\r\n                case 0:\r\n                    //流程发起人的上级领导\r\n                    var userIds = \"\";\r\n                    if(document.all.candidateUser.length){\r\n                        for(i = 0; i < document.all.candidateUser.length; i ++ ){\r\n                            if(document.all.candidateUser[i].checked){\r\n                                userIds += document.all.candidateUser[i].value + \",\";\r\n                            }\r\n                        }\r\n                    }else{\r\n                        userIds = document.all.candidateUser.value;\r\n                    }\r\n                    workflowSync.getUserStatusByEmpIdStr(userIds, include_checkUserStatus);\r\n");
                  out.write("                    break;\r\n                case 1:\r\n                    //由上一节点参与者从所有用户中选择\r\n                    var empId = \"\";\r\n                    var orgId = \"\";\r\n                    var groupId = \"\";\r\n                    var idstr = document.all.operProcUser.value;\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i,nextPos+1);\r\n                            if(flagCode == \"$\"){\r\n                                empId = empId + str;\r\n                            }else if(flagCode == \"*\"){\r\n                                orgId = orgId + str;\r\n                            }else{\r\n                                groupId = groupId + str;\r\n                            }\r\n                            i = nextPos;\r\n                        }\r\n                    }\r\n                    workflowSync.getUserStatusByEmpOrgGrp(empId, orgId, groupId, include_checkUserStatus);\r\n");
                  out.write("                    break;\r\n                case 2:\r\n                    //从候选人员中指定candidateUser\r\n                    var userIds = \"\";\r\n                    if(document.all.candidateUser.length){\r\n                        for(i = 0; i < document.all.candidateUser.length; i ++ ){\r\n                            if(document.all.candidateUser[i].checked){\r\n                                userIds += document.all.candidateUser[i].value + \",\";\r\n                            }\r\n                        }\r\n                    }else{\r\n                        userIds = document.all.candidateUser.value;\r\n                    }\r\n                    workflowSync.getUserStatusByEmpIdStr(userIds, include_checkUserStatus);\r\n                    break;\r\n                case 3:\r\n                    //指定全部办理人\r\n                    var userIds = \"\";\r\n                    if(document.all.allUser.length){\r\n                        for(i = 0; i < document.all.allUser.length; i ++ ){\r\n                            userIds += document.all.allUser[i].value + \",\";\r\n");
                  out.write("                        }\r\n                    }else{\r\n                        userIds = document.all.allUser.value;\r\n                    }\r\n                    workflowSync.getUserStatusByEmpIdStr(userIds, include_checkUserStatus);\r\n                    break;\r\n                case 5:\r\n                    //流程发起人\r\n                    workflowSync.getUserStatus(\"");
                  out.print(session.getAttribute("userId"));
                  out.write("\", include_checkUserStatus);\r\n                    break;\r\n                case 6:\r\n                    //角色用户\r\n                    workflowSync.getUserStatusByRole(document.all.partRole.value, \"");
                  out.print(session.getAttribute("userId"));
                  out.write("\", include_checkUserStatus);\r\n                    break;\r\n\t\t\t\t\r\n\t\t\t\tcase 10:\r\n                    //组织领导\r\n                    var orgId = \"\";\r\n                    var idstr = document.all.operId.value;\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i+1,nextPos);\r\n                            if(flagCode == \"*\"){\r\n                                orgId = orgId + str + \",\";\r\n                            }\r\n                            i = nextPos;\r\n                        }\r\n                    }\r\n\t\t\t\t\torgId = orgId.substring(0,orgId.length-1);\r\n\t\t\t\t\tdocument.all.operId.value = orgId;\r\n                    workflowSync.getLeaderByOrgId(orgId, include_checkUserStatus);\r\n                    break;\r\n\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\n");
                  out.write("\r\nfunction include_branch_save(){    \r\n    if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n    \tif(confirm(\"您确定提交吗？\")){\r\n    \t\tvar editId =document.getElementById(\"editId\").value;\r\n\t\t\t");
                  out.print(formName);
                  out.write(".target = \"myIframe\";\r\n\t\t\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=save");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("&resubmitWorkId=\"+editId;\r\n\t\t\t\r\n\t\t\t");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\t");
if(BrowserJudge.isFirefox(request)){
                  out.write("\r\n\t\t\tsetTimeout(\"window.close()\",1200);\r\n\t\t\t");
}
                  out.write("\r\n\t\t\tpullXMenuDisabledAllMenu();\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t}\r\n    }\r\n    \r\n}\r\n//保存至草稿\r\nfunction include_saveToDraft(){\r\n\tif(include_checkUser()){\r\n        //");
                  out.print(saveCheckFn);
                  out.write(";\r\n        \t");
                  out.print(formName);
                  out.write(".target = \"myIframe\";\r\n\t\t\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=saveToDraft&savefirst=1");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("\";\r\n\t\t\t");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\tpullXMenuDisabledAllMenu();\r\n\t\t\r\n\t}\r\n}\r\n\r\n//保存至草稿\r\nfunction include_saveFirstComp(){\r\n\tif(include_checkUser()){\r\n        ");
                  out.print(saveCheckFn);
                  out.write(";\r\n        \t");
                  out.print(formName);
                  out.write(".target = \"myIframe\";\r\n\t\t\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=saveFirstComp&savefirst=1");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("\";\r\n\t\t\t");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\tpullXMenuDisabledAllMenu();\r\n\t\t\r\n\t}\r\n}\r\n//保存第一步\r\nfunction include_saveFirst(){\r\n    if(include_checkUser()){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n            switch (parseInt(document.all.userType.value)) {\r\n\t\t\t\tcase 100:\r\n                    //新节点\r\n                    var empId = \"\";\r\n                    var orgId = \"\";\r\n                    var groupId = \"\";\r\n                    var idstr = document.all.operId.value;\r\n                    if(idstr != \"\"){\r\n                        for( var i = 0; i < idstr.length; i ++ ){\r\n                            flagCode = idstr.charAt(i);\r\n                            nextPos = idstr.indexOf(flagCode,i + 1);\r\n                            str = idstr.substring(i,nextPos+1);\r\n                            if(flagCode == \"$\"){\r\n                                empId = empId + str;\r\n                            }else if(flagCode == \"*\"){\r\n                                orgId = orgId + str;\r\n                            }else{\r\n                                groupId = groupId + str;\r\n                            }\r\n                            i = nextPos;\r\n                        }\r\n                    }\r\n\t\t\t\t\t//alert(empId+ \"\\n\" +orgId+ \"\\n\" +groupId);\r\n");
                  out.write("                    ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n\t\t\t\t\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=save&savefirst=1");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("\";\r\n\t\t\t\t\t");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\t\t\tpullXMenuDisabledAllMenu();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    \r\n}\r\n\r\n\r\nfunction include_checkUserStatus(s) {\r\n    var editId =document.getElementById(\"editId\").value;\r\n\tif(s==\"noleader\"){\r\n\t\t//组织领导不存在\r\n\t\talert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includenoleader"));
                  out.write("\");\r\n\t\treturn;\r\n\t}\r\n\t");
if("0".equals(request.getParameter("processType"))){
                  out.write("\r\n\t\t\r\n\t");
} else{
                  out.write("\r\n\t\t//业务流程\r\n\t\tif(s == \"\"){\r\n\t\t\t\r\n\t\t\tvar frm=document.getElementsByName(\"");
                  out.print(formName);
                  out.write("\")[0];\r\n\t\t\tfrm.target = \"myIframe\";\r\n\t\t\tfrm.action = \"/jsoa/WorkflowButtonAction.do?flag=save");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("&resubmitWorkId=\"+editId;\r\n\t\t\tfrm.submit();\r\n\t\t\tdocument.getElementById(\"sendContinue\").value=\"0\";//继续发送为“否”\r\n\t\t\t//");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\t//提示“已提交给XX[XX]”");
if(BrowserJudge.isFirefox(request)){
                  out.write("\r\n\t\t\tif(confirm(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includehassuccessturnto"));
                  out.write("\"+document.all.operName.value+\"[\"+document.all.activityName.value+\"]\")){\r\n\t\t\t\twindow.close();}else{window.close();}");
}else{
                  out.write("\r\n\t\t\talert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includehassuccessturnto"));
                  out.write("\"+document.all.operName.value+\"[\"+document.all.activityName.value+\"]\");\r\n\t\t\t");
}
                  out.write("\r\n\t\t} else {\r\n\t\t//下一办理人：XX ，您确定要提交办理吗？\r\n\t\t\tif(confirm(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includenextuser"));
                  out.write("：\" + s + \"，");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includeconfirmturntodeal"));
                  out.write("\")){\r\n\t\t\t\t");
                  out.print(formName);
                  out.write(".target = \"myIframe\";\r\n\t\t\t\t");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowButtonAction.do?flag=save");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("&resubmitWorkId=\"+editId;\r\n\t\t\t\t\r\n\t\t\t\t");
                  out.print(formName);
                  out.write(".submit();\r\n\t\t\t\t//提示“已提交给XX[XX]”\r\n\t\t\t\talert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includehassuccessturnto"));
                  out.write("\"+document.all.operName.value+\"[\"+document.all.activityName.value+\"]\");\r\n\t\t\t\t");
if(BrowserJudge.isFirefox(request)){
                  out.write("\r\n\t\t\t\tsetTimeout(\"window.close()\",1200);\r\n\t\t\t\t");
}
                  out.write("\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t//pullXMenuDisabledAllMenu();\r\n\t");
}
                  out.write("\r\n}\r\n\r\n\r\n//检验办理用户\r\nfunction include_checkUser(){\r\n    if(document.all.randomProcUser){\r\n        if(document.all.randomProcUser.value == \"\"){\r\n            alert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includeseldealuser"));
                  out.write("\");\r\n            return false;\r\n        }\r\n    }\r\n    if(document.all.candidateUser){\r\n        var i = 0;\r\n        if(document.all.candidateUser.length){\r\n            for(var j = 0; j < document.all.candidateUser.length; j ++){\r\n                if(document.all.candidateUser[j].checked){\r\n                    i = 1;\r\n                    break;\r\n                }\r\n            }\r\n        }else{\r\n            if(document.all.candidateUser.checked){\r\n                i = 1;\r\n            }\r\n        }\r\n        if(i == 0){\r\n            alert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includeseldealuser"));
                  out.write("\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    if(document.all.operProcUserName){\r\n        if(document.all.operProcUserName.value == \"\"){\r\n            alert(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includeseldealuser"));
                  out.write("\");\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\n//选择全部办理/阅件用户\r\nfunction selectAll(name,obj){\r\n\tif(eval(\"document.all.\"+name)){\r\n\t\tif(eval(\"document.all.\"+name+\".length\")){\r\n\t\t\tfor(i=0;i<eval(\"document.all.\"+name+\".length\");i++){\r\n\t\t\t\tif(obj.checked){\r\n\t\t\t\t\teval(\"document.all.\"+name)[i].checked = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\teval(\"document.all.\"+name)[i].checked = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tif(obj.checked){\r\n\t\t\t\teval(\"document.all.\"+name).checked = true;\r\n\t\t\t}else{\r\n\t\t\t\teval(\"document.all.\"+name).checked = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//保存继续\r\nfunction include_continue(){\r\n    if(include_checkUser()){\r\n        if(");
                  out.print(saveCheckFn);
                  out.write("){\r\n            document.all.include_td1.style.display = \"none\";\r\n            ");
                  out.print(formName);
                  out.write(".target = \"_self\";\r\n            ");
                  out.print(formName);
                  out.write(".action = \"/jsoa/WorkflowCommonAction.do?flag=save");
                  out.print(request.getParameter("subProc")==null?"":"&subProc=1");
                  out.write("&continue=1\";\r\n            ");
                  out.print(formName);
                  out.write(".submit();\r\n            pullXMenuDisabledAllMenu();\r\n        }\r\n    }\r\n}\r\n\r\n//-->\r\n</script>\r\n");
}
                  out.write("\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\n//关闭\r\nfunction include_close(){\r\n    if(confirm(\"");
                  out.print(Resource.getValue(localhi,"workflow","workflow.includeconfirmclosewindow"));
                  out.write("\")){\r\n        window.opener=null;\r\n        window.close();\r\n    }\r\n}\r\nfunction editOffices(field,fileType,template,showSign){\r\n\t//alert(\"开始打开\");\r\n\tvar recordId = eval(\"document.all.\"+field+\".value\");\r\n\tvar userName = document.all.user_Name.value;\r\n\t\r\n\twindow.open(\"/jsoa/iWebOfficeSign/DocumentEdit.jsp?RecordID=\"+recordId+\"&EditType=1&UserName=\"+userName+\r\n\t\t\t\"&ShowSign=\"+showSign+\"&CanSave=1&moduleType=information&saveHtmlImage=0&saveDocFile=0&field=\"+field+\r\n\t\t\t\"&FileType=.\"+fileType+\"&showEditButton=1&showSignButton=1&Template=\"+template, \r\n\t\t\t\"\", \"status=no,menubar=no,scrollbars=yes,resizable=yes,width=500,Height=400,left=0,top=0\");\r\n}\r\nfunction checkYijianBlur(obj){\r\n\tvar yijian = obj.value;\r\n\tif(yijian.indexOf(\"'\")>=0 || yijian.indexOf(\"\\\"\")>=0){\r\n\t\talert(\"意见中不能有英文状态下的单引号或双引号\");\r\n\t\tobj.focus();\r\n\t}\r\n\t\r\n}\r\n//-->\r\n</SCRIPT>");

						  		}
						  		
                  out.write("\r\n\t\t\t\t\t\t  \t</td>\r\n\t\t\t\t\t\t</tr>\t\t\t \r\n\t\t\t\t\t</table>            \r\n\t\t\t\t</div>\r\n\t\t\t\t<div id=\"docinfo1\" style=\"display:none\">\t\t\t\t\t   \r\n\t\t\t\t\t<TABLE width=\"100%\" border=\"0\">\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td valign=\"top\" align=\"center\">\r\n\t\t\t\t\t\t\t\t<iframe id=\"ifrmPhoto\" name=\"ifrmPhoto\" src=\"\" frameborder=0 style=\"width:100%;height:550px;\" border=0 align=\"right\"></iframe>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</TABLE>     \r\n\t\t\t\t</div>\r\n\t\t\t\t<div id=\"docinfo2\" style=\"display:none;\">\r\n\t\t\t\t\t");

					java.util.List alist=new java.util.ArrayList();
					if(request.getParameter("record")!=null){
						alist = new com.js.oa.jsflow.service.WorkFlowButtonBD().getAllDealWithLog(read_processId,read_tableId,read_recordId);
					}									  									  
					
                  out.write("\r\n\t\t\t\t\t<table width=\"98%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"flowRecordTable\">\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td colspan=\"5\" align=\"left\" valign=\"middle\" class=\"flowRecordTitle\"><b>&nbsp;流程记录</b></td>    \r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t");

						if(alist!=null&&alist.size()>0){
							for(int i=0;i<alist.size();i++){
								Object dealObj[]=(Object[])alist.get(i);
								
                  out.write("\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td width=\"5%\" nowrap align=\"left\" valign=\"middle\" class=\"flowRecordBorder\">");
                  out.print((i+1));
                  out.write("</td>\r\n\t\t\t\t\t\t\t\t\t<td width=\"10%\" nowrap align=\"left\" valign=\"middle\" class=\"flowRecordBorder\">");
                  out.print(dealObj[0]);
                  out.write("</td>\r\n\t\t\t\t\t\t\t\t\t<td width=\"30%\" nowrap align=\"left\" valign=\"middle\" class=\"flowRecordBorder\">");
                  out.print(dealObj[1]);
                  out.write("</td>\r\n\t\t\t\t\t\t\t\t\t<td width=\"45%\" nowrap align=\"left\" valign=\"middle\" class=\"flowRecordBorder\">\r\n\t\t\t\t\t\t\t\t\t");

										    if("shandongjiguanshiwuju".equals(com.js.util.config.SystemCommon.getCustomerName())){
										    	String tempNodeName = (String)dealObj[2];
										    	if(tempNodeName.indexOf("签收")>0){
										    		tempNodeName=tempNodeName.substring(0, tempNodeName.indexOf("签收"))+"收阅";
										    	}
										    	out.print(tempNodeName);
										    }else{
										    	out.print(dealObj[2]);
										    }
										    
                  out.write("\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td width=\"10%\" nowrap align=\"center\" valign=\"middle\" class=\"flowRecordBorder\">");
                  out.print(dealObj[3]);
                  out.write(" </td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t");

							} 											  
						}
						
                  out.write("\t  \r\n\t\t\t\t\t</table>\r\n\t\t\t\t</div>\r\n\t\t\t</td>\r\n\t\t</tr>\r\n\t</table>\r\n</div>\r\n\r\n");
                  int evalDoAfterBody = _jspx_th_html_005fform_005f0.doAfterBody();
                  if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
                    break;
                } while (true);
              }
              if (_jspx_th_html_005fform_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
                return;
              }
              _005fjspx_005ftagPool_005fhtml_005fform_0026_005fmethod_005faction.reuse(_jspx_th_html_005fform_005f0);
              _jspx_th_html_005fform_005f0_reused = true;
            } finally {
              org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fform_005f0, _jsp_getInstanceManager(), _jspx_th_html_005fform_005f0_reused);
            }
            out.write("\r\n</body>\r\n<form name=\"gdform\" method=\"POST\" action=\"/jsoa/doc/doc/sendfile_gd.jsp?gd=1\">\r\n    <input type=\"hidden\" name=\"pageContent\">\r\n    <input type=\"hidden\" name=\"fileTitle\">\r\n    <input type=\"hidden\" name=\"fileId\">\r\n\t<input type=\"hidden\" name=\"createdEmp\" value=\"");
            out.print(request.getParameter("submitPersonId"));
            out.write("\">\r\n</form>\r\n<script language=\"javascript\">\r\nfunction gd(){\r\n    gdform.pageContent.value = document.body.innerHTML;\r\n    gdform.fileTitle.value = GovSendFileActionForm.documentSendFileTitle.value;\r\n    gdform.fileId.value = GovSendFileActionForm.editId.value;\r\n    gdform.submit();\r\n}\r\n");
if(request.getParameter("gd") != null){
            out.write("\r\ngd();\r\n");
}
            out.write("\r\n</script>\r\n<table width=\"90%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n       <tr style=\"display:none\">\r\n      <td width=\"0\" height=\"0\">\r\n          <iframe id=\"ifrm\" name=\"ifrm\" src=\"\" style=\"display:none\"></iframe><iframe id=\"ifrm1\" name=\"ifrm1\" src=\"\" style=\"display:none\"></iframe>\r\n      </td>\r\n  </tr>\r\n  <tr style=\"display:none\">\r\n   <td>\r\n   <input type=\"hidden\" name=\"judgeChannelName\" value=\"-1\">\r\n   <iframe name=\"judgeNameFrame\" src=\"\"></iframe>\r\n   </td>\r\n </tr>\r\n</table>\r\n<script>\r\nfunction  setInitTitle(){\r\n\tdocument.all.oldTitle.value=document.all.documentSendFileTitle.value;\r\n\tdocument.all.oldToPerson1.value=\"\";\r\n\tdocument.all.oldToPerson2.value=\"\";\r\n\tdocument.all.oldToInnner.value=\"\";\r\n}\r\nsetInitTitle();\r\n//电子签章\r\nvar wnd;\r\n//作用：进行甲方签章\r\nfunction include_signature() {\r\n\tif( wnd != undefined ){\r\n\t\tvar results = wnd.split(\";\");\r\n\t\tdocument.all.SignatureControl.CharSetName = results[0];\t\t//多语言集\r\n\t\tdocument.all.SignatureControl.WebAutoSign = results[1];\t\t//自动数字签名\r\n\t\tdocument.all.SignatureControl.WebCancelOrder = results[2];\t\t//撤消顺序\r\n");
            out.write("\t\tdocument.all.SignatureControl.PassWord = results[3];\t\t\t//签章密码\r\n\t\tvar tmp = document.all.SignatureControl.WebSetFontOther((results[4]==\"1\"?true:false),results[5],results[6],results[7],results[8],results[9],(results[10]==\"1\"?true:false));\t\t\t\t//设置签章附加文字格式\r\n\t\tdocument.all.SignatureControl.WebIsProtect=results[11];\t\t//保护表单数据， 0不保护  1保护表单数据，可操作  2保存表单数据，并不能操作  默认值1\r\n    }else{\r\n\t\tdocument.all.SignatureControl.WebIsProtect=1;\t\t\t    //保护表单数据， 0不保护  1保护表单数据，可操作  2保存表单数据，并不能操作  默认值1\r\n\t}\r\n\t//document.all.SignatureControl.FieldsList=\"test\"       //所保护字段\r\n\tdocument.all.SignatureControl.FieldsList=\"submitPerson=\"+document.getElementById(\"submitPerson\");\r\n\tdocument.all.SignatureControl.DivId=\"signPosi_");
            out.print(inc_divId+"0000");
            out.write("\";                     //签章所在的层\r\n\tdocument.all.SignatureControl.Position(100,0);                     //签章位置\r\n\tdocument.all.SignatureControl.SaveHistory=\"False\";                    //是否自动保存历史记录,true保存  false不保存  默认值false\r\n\tdocument.all.SignatureControl.UserName=\"lyj\";                         //文件版签章用户\r\n\tdocument.all.SignatureControl.WebCancelOrder=1;\t\t\t    //签章撤消原则设置, 0无顺序 1先进后出  2先进先出  默认值0\r\n\tdocument.all.SignatureControl.RunSignature();                          //执行签章操作\r\n}\r\n\r\n//作用：进行手写签名\r\nfunction include_signature2() {\r\n\tdocument.all.SignatureControl.FieldsList=\"\"       //所保护字段\r\n\tif( wnd != undefined ){\r\n\t\tvar results = wnd.split(\";\");\r\n\t\tdocument.all.SignatureControl.CharSetName = results[0];\t\t//多语言集\r\n\t\tdocument.all.SignatureControl.WebAutoSign = results[1];\t\t//自动数字签名\r\n\t\tdocument.all.SignatureControl.WebCancelOrder = results[2];\t\t//撤消顺序\r\n\t\tdocument.all.SignatureControl.PassWord = results[3];\t\t\t//签章密码\r\n\t\tdocument.all.SignatureControl.WebIsProtect=results[11];\t\t//保护表单数据， 0不保护  1保护表单数据，可操作  2保存表单数据，并不能操作  默认值1\r\n");
            out.write("\t}else {\r\n        document.all.SignatureControl.WebCancelOrder=0;\t\t\t            //签章撤消原则设置, 0无顺序 1先进后出  2先进先出  默认值0\r\n\t\tdocument.all.SignatureControl.WebIsProtect=1;\t\t\t    //保护表单数据， 0不保护  1保护表单数据，可操作  2保存表单数据，并不能操作  默认值1\r\n\t}\r\n\tdocument.all.SignatureControl.FieldsList=\"test\"       //所保护字段\r\n\tdocument.all.SignatureControl.DivId=\"signPosi_");
            out.print(inc_divId+"0000");
            out.write("\";                   //签章所在的层\r\n\tdocument.all.SignatureControl.Position(0,0);                       //手写签名位置\r\n\t\r\n\t//document.all.SignatureControl.SaveHistory=\"false\";                   //是否自动保存历史记录,true保存  false不保存  默认值false\r\n\tdocument.all.SignatureControl.RunHandWrite();                          //执行手写签名\r\n}\r\n");
if(signatureInUse){
            out.write("\r\nwindow.attachEvent(\"onload\",function(){\t\r\n\ttry{\r\n\t\tdocument.all.SignatureControl.ShowSignature('");
            out.print(request.getParameter("table"));
            out.write('-');
            out.print(request.getParameter("record"));
            out.write("');\r\n\t}catch(e){\r\n\t}\r\n});\r\n");
}
            out.write("\r\nfunction changeCommentType(flag){\r\n\tif(flag==0){\r\n\t\tdocument.getElementById(\"signTb1\").style.display=\"\";\r\n\t\tdocument.getElementById(\"signTb2\").style.display=\"none\";\r\n\t}else{\r\n\t\tdocument.getElementById(\"signTb1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"signTb2\").style.display=\"\";\r\n\t}\r\n\tdocument.all.commentSignType.value = flag;\r\n}\r\n</script>\t\r\n");
            int evalDoAfterBody = _jspx_th_html_005fhtml_005f0.doAfterBody();
            if (evalDoAfterBody != javax.servlet.jsp.tagext.BodyTag.EVAL_BODY_AGAIN)
              break;
          } while (true);
        }
        if (_jspx_th_html_005fhtml_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
          return;
        }
        _005fjspx_005ftagPool_005fhtml_005fhtml.reuse(_jspx_th_html_005fhtml_005f0);
        _jspx_th_html_005fhtml_005f0_reused = true;
      } finally {
        org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhtml_005f0, _jsp_getInstanceManager(), _jspx_th_html_005fhtml_005f0_reused);
      }
      out.write("\r\n<script src=\"");
      out.print(basePath );
      out.write("js/util.js\"></script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }

  private boolean _jspx_meth_html_005fhidden_005f0(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f0 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f0_reused = false;
    try {
      _jspx_th_html_005fhidden_005f0.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f0.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1193,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f0.setProperty("sendFileLink");
      int _jspx_eval_html_005fhidden_005f0 = _jspx_th_html_005fhidden_005f0.doStartTag();
      if (_jspx_th_html_005fhidden_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f0);
      _jspx_th_html_005fhidden_005f0_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f0, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f0_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f1(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f1 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f1_reused = false;
    try {
      _jspx_th_html_005fhidden_005f1.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f1.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1204,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f1.setProperty("sendFilePoNumId");
      int _jspx_eval_html_005fhidden_005f1 = _jspx_th_html_005fhidden_005f1.doStartTag();
      if (_jspx_th_html_005fhidden_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f1);
      _jspx_th_html_005fhidden_005f1_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f1, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f1_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f2(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f2 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f2_reused = false;
    try {
      _jspx_th_html_005fhidden_005f2.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f2.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1205,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f2.setProperty("templateId");
      int _jspx_eval_html_005fhidden_005f2 = _jspx_th_html_005fhidden_005f2.doStartTag();
      if (_jspx_th_html_005fhidden_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f2);
      _jspx_th_html_005fhidden_005f2_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f2, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f2_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f3(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f3 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f3_reused = false;
    try {
      _jspx_th_html_005fhidden_005f3.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f3.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1206,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f3.setProperty("zjkyWordId");
      int _jspx_eval_html_005fhidden_005f3 = _jspx_th_html_005fhidden_005f3.doStartTag();
      if (_jspx_th_html_005fhidden_005f3.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f3);
      _jspx_th_html_005fhidden_005f3_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f3, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f3_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f4(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f4 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f4_reused = false;
    try {
      _jspx_th_html_005fhidden_005f4.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f4.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1207,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f4.setProperty("field1");
      int _jspx_eval_html_005fhidden_005f4 = _jspx_th_html_005fhidden_005f4.doStartTag();
      if (_jspx_th_html_005fhidden_005f4.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f4);
      _jspx_th_html_005fhidden_005f4_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f4, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f4_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f5(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f5 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f5_reused = false;
    try {
      _jspx_th_html_005fhidden_005f5.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f5.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1208,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f5.setProperty("field2");
      int _jspx_eval_html_005fhidden_005f5 = _jspx_th_html_005fhidden_005f5.doStartTag();
      if (_jspx_th_html_005fhidden_005f5.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f5);
      _jspx_th_html_005fhidden_005f5_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f5, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f5_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f6(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f6 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f6_reused = false;
    try {
      _jspx_th_html_005fhidden_005f6.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f6.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1209,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f6.setProperty("field6");
      int _jspx_eval_html_005fhidden_005f6 = _jspx_th_html_005fhidden_005f6.doStartTag();
      if (_jspx_th_html_005fhidden_005f6.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f6);
      _jspx_th_html_005fhidden_005f6_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f6, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f6_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f7(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f7 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f7_reused = false;
    try {
      _jspx_th_html_005fhidden_005f7.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f7.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1210,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f7.setProperty("toPerson1Id");
      int _jspx_eval_html_005fhidden_005f7 = _jspx_th_html_005fhidden_005f7.doStartTag();
      if (_jspx_th_html_005fhidden_005f7.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f7);
      _jspx_th_html_005fhidden_005f7_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f7, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f7_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f8(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f8 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f8_reused = false;
    try {
      _jspx_th_html_005fhidden_005f8.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f8.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1211,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f8.setProperty("toPerson2Id");
      int _jspx_eval_html_005fhidden_005f8 = _jspx_th_html_005fhidden_005f8.doStartTag();
      if (_jspx_th_html_005fhidden_005f8.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f8);
      _jspx_th_html_005fhidden_005f8_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f8, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f8_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f9(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f9 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f9_reused = false;
    try {
      _jspx_th_html_005fhidden_005f9.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f9.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1212,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f9.setProperty("toPersonInnerId");
      int _jspx_eval_html_005fhidden_005f9 = _jspx_th_html_005fhidden_005f9.doStartTag();
      if (_jspx_th_html_005fhidden_005f9.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f9);
      _jspx_th_html_005fhidden_005f9_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f9, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f9_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f10(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f10 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f10_reused = false;
    try {
      _jspx_th_html_005fhidden_005f10.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f10.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1213,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f10.setProperty("toPersonBaoId");
      int _jspx_eval_html_005fhidden_005f10 = _jspx_th_html_005fhidden_005f10.doStartTag();
      if (_jspx_th_html_005fhidden_005f10.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f10);
      _jspx_th_html_005fhidden_005f10_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f10, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f10_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f11(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f11 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f11_reused = false;
    try {
      _jspx_th_html_005fhidden_005f11.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f11.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1214,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f11.setProperty("toPerson3");
      int _jspx_eval_html_005fhidden_005f11 = _jspx_th_html_005fhidden_005f11.doStartTag();
      if (_jspx_th_html_005fhidden_005f11.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f11);
      _jspx_th_html_005fhidden_005f11_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f11, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f11_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f12(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f12 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f12_reused = false;
    try {
      _jspx_th_html_005fhidden_005f12.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f12.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1215,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f12.setProperty("toPerson4");
      int _jspx_eval_html_005fhidden_005f12 = _jspx_th_html_005fhidden_005f12.doStartTag();
      if (_jspx_th_html_005fhidden_005f12.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f12);
      _jspx_th_html_005fhidden_005f12_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f12, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f12_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f13(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f13 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f13_reused = false;
    try {
      _jspx_th_html_005fhidden_005f13.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f13.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1216,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f13.setProperty("toPerson5");
      int _jspx_eval_html_005fhidden_005f13 = _jspx_th_html_005fhidden_005f13.doStartTag();
      if (_jspx_th_html_005fhidden_005f13.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f13);
      _jspx_th_html_005fhidden_005f13_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f13, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f13_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f14(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f14 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f14_reused = false;
    try {
      _jspx_th_html_005fhidden_005f14.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f14.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1217,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f14.setProperty("toPerson6");
      int _jspx_eval_html_005fhidden_005f14 = _jspx_th_html_005fhidden_005f14.doStartTag();
      if (_jspx_th_html_005fhidden_005f14.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f14);
      _jspx_th_html_005fhidden_005f14_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f14, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f14_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f15(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f15 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f15_reused = false;
    try {
      _jspx_th_html_005fhidden_005f15.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f15.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1218,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f15.setProperty("oid");
      int _jspx_eval_html_005fhidden_005f15 = _jspx_th_html_005fhidden_005f15.doStartTag();
      if (_jspx_th_html_005fhidden_005f15.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f15);
      _jspx_th_html_005fhidden_005f15_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f15, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f15_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f16(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f16 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f16_reused = false;
    try {
      _jspx_th_html_005fhidden_005f16.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f16.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1219,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f16.setProperty("submitFileType");
      int _jspx_eval_html_005fhidden_005f16 = _jspx_th_html_005fhidden_005f16.doStartTag();
      if (_jspx_th_html_005fhidden_005f16.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f16);
      _jspx_th_html_005fhidden_005f16_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f16, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f16_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f17(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f17 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f17_reused = false;
    try {
      _jspx_th_html_005fhidden_005f17.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f17.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1220,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f17.setProperty("sendFileRedHeadId");
      int _jspx_eval_html_005fhidden_005f17 = _jspx_th_html_005fhidden_005f17.doStartTag();
      if (_jspx_th_html_005fhidden_005f17.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f17);
      _jspx_th_html_005fhidden_005f17_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f17, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f17_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f18(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f18 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fvalue_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f18_reused = false;
    try {
      _jspx_th_html_005fhidden_005f18.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f18.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1221,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f18.setProperty("documentSendFileHead");
      // /doc/doc/sendfile_modi_temp.jsp(1221,0) name = value type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f18.setValue("-1");
      int _jspx_eval_html_005fhidden_005f18 = _jspx_th_html_005fhidden_005f18.doStartTag();
      if (_jspx_th_html_005fhidden_005f18.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fvalue_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f18);
      _jspx_th_html_005fhidden_005f18_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f18, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f18_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f19(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f19 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fstyleId_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f19_reused = false;
    try {
      _jspx_th_html_005fhidden_005f19.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f19.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1222,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f19.setProperty("field3");
      // /doc/doc/sendfile_modi_temp.jsp(1222,0) name = styleId type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f19.setStyleId("field3");
      int _jspx_eval_html_005fhidden_005f19 = _jspx_th_html_005fhidden_005f19.doStartTag();
      if (_jspx_th_html_005fhidden_005f19.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fstyleId_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f19);
      _jspx_th_html_005fhidden_005f19_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f19, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f19_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f20(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f20 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f20_reused = false;
    try {
      _jspx_th_html_005fhidden_005f20.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f20.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1224,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f20.setProperty("documentWordType");
      int _jspx_eval_html_005fhidden_005f20 = _jspx_th_html_005fhidden_005f20.doStartTag();
      if (_jspx_th_html_005fhidden_005f20.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f20);
      _jspx_th_html_005fhidden_005f20_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f20, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f20_reused);
    }
    return false;
  }

  private boolean _jspx_meth_html_005fhidden_005f21(javax.servlet.jsp.tagext.JspTag _jspx_th_html_005fform_005f0, javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  html:hidden
    org.apache.struts.taglib.html.HiddenTag _jspx_th_html_005fhidden_005f21 = (org.apache.struts.taglib.html.HiddenTag) _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.get(org.apache.struts.taglib.html.HiddenTag.class);
    boolean _jspx_th_html_005fhidden_005f21_reused = false;
    try {
      _jspx_th_html_005fhidden_005f21.setPageContext(_jspx_page_context);
      _jspx_th_html_005fhidden_005f21.setParent((javax.servlet.jsp.tagext.Tag) _jspx_th_html_005fform_005f0);
      // /doc/doc/sendfile_modi_temp.jsp(1262,0) name = property type = null reqTime = true required = true fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_html_005fhidden_005f21.setProperty("receiveFileIsFlowMode");
      int _jspx_eval_html_005fhidden_005f21 = _jspx_th_html_005fhidden_005f21.doStartTag();
      if (_jspx_th_html_005fhidden_005f21.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fhtml_005fhidden_0026_005fproperty_005fnobody.reuse(_jspx_th_html_005fhidden_005f21);
      _jspx_th_html_005fhidden_005f21_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_html_005fhidden_005f21, _jsp_getInstanceManager(), _jspx_th_html_005fhidden_005f21_reused);
    }
    return false;
  }
}
