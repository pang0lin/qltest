/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 10:02:19 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.iWebRevision_jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.io.*;
import java.text.*;
import java.util.*;
import java.sql.*;
import DBstep.iDBManager2000.*;

public final class DocumentEdit_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {


  DBstep.iDBManager2000 ObjConnBean = new DBstep.iDBManager2000();
  String SendOut_Enabled = "",Consult_Enabled = "";
  String RecordID,DocNo,UserName,Security,Draft,Check;
  String Title,CopyTo,Subject,Copies,DateTime;

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("java.sql");
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.text");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("java.io");
    _jspx_imports_packages.add("DBstep.iDBManager2000");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = null;
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=gb2312");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n");
      out.write('\r');
      out.write('\n');

  String mScriptName = "/DocumentEdit.jsp";
  String mServerName="/iWebServer.jsp";
  String mHttpUrlName=request.getRequestURI();
  String mServerUrl="http://"+request.getServerName()+":"+request.getServerPort()+mHttpUrlName.substring(0,mHttpUrlName.lastIndexOf(mScriptName))+mServerName;
  RecordID = "";
  RecordID = request.getParameter("RecordID");
  String EditType = new String(request.getParameter("EditType").getBytes("8859_1"));
  String UserName = new String(request.getParameter("UserName").getBytes("8859_1"));
  String mNew = "0";

  //处理编号为空
  if (RecordID==null) {
    RecordID = "";
  }

  //取得模式
  if (EditType==null && EditType.equalsIgnoreCase("null")) {
    EditType = "1";		// 0 显示  1 会签 2 审核
  }
  if (EditType.equalsIgnoreCase("0")) {
     SendOut_Enabled = "0";
     Consult_Enabled = "0";
  }
  if (EditType.equalsIgnoreCase("1")) {
       SendOut_Enabled = "1";
       Consult_Enabled = "0";
  }
  if (EditType.equalsIgnoreCase("2")) {
     SendOut_Enabled = "0";
     Consult_Enabled = "1";
  }
  if (EditType.equalsIgnoreCase("3")) {
      SendOut_Enabled = "1";
      Consult_Enabled = "1";
  }

  //取得用户名
  if (UserName==null && UserName.equalsIgnoreCase("null")) {
    UserName = "测试用户";
  }

if (ObjConnBean.OpenConnection()) {
  String Sql="Select * From Document Where RecordID='"+ RecordID + "'";
  ResultSet rs = null;
  rs = ObjConnBean.ExecuteQuery(Sql);
  if (rs.next()) {
    RecordID = rs.getString("RecordID");
    DocNo = rs.getString("DocNo");
    Security = rs.getString("Security");
    Draft = rs.getString("Draft");
    Check = rs.getString("Check");
    Title = rs.getString("Title");
    CopyTo = rs.getString("CopyTo");
    Subject = rs.getString("Subject");
    Copies = rs.getString("Copies");
    DateTime = rs.getString("DateTime");
  }else {
    mNew = "1";
    //取得唯一值(mRecordID)
    java.util.Date dt=new java.util.Date();
    long lg=dt.getTime();
    Long ld=new Long(lg);
    RecordID=ld.toString();
    System.out.println(RecordID);
    DocNo = "NC-2009-X";
    Security = "一般";
    Draft = "已起草完成!";
    Check = "处理中...";
    Title = "关于XXX的决定";
    CopyTo = "策划部、市场部";
    Subject = "决定";
    Copies = "10份";
    DateTime = ObjConnBean.GetDateAsStr();
  }
  rs.close();
  ObjConnBean.CloseConnection();
}

      out.write("\r\n\r\n<html>\r\n<head>\r\n<title>iWebRevision 网页签批中间件</title>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"> \r\n<meta HTTP-EQUIV=\"Pragma\" CONTENT=\"no-cache\">\r\n<link REL=\"stylesheet\" href=\"Test.css\" type=\"text/css\">\r\n<script language=\"javascript\" for=SendOut event=\"OnMenuClick(vIndex,vCaption)\">\r\n  if (vIndex==10){  //自定义菜单事件\r\n    alert(\"这里是“签发”控件自定义菜单演示：清除所有签章、签批信息\");\r\n    SendOut.ClearAll();\r\n    SendOutStatusMsg(\"清除所有签章、签批信息成功。\");\r\n  }\r\n</script>\r\n<script language=\"javascript\" for=Consult event=\"OnMenuClick(vIndex,vCaption)\">\r\n  if (vIndex==1){  //自定义菜单事件\r\n    alert(\"这里是“会签”控件自定义右键菜单点击事件。\");\r\n  }\r\n</script>\r\n\r\n<script language=javascript>\r\n//作用：显示Consult操作状态\r\nfunction ConsultStatusMsg(mString){\r\n  iConsultStatusBar.innerText=\" \"+mString;\r\n}\r\n\r\n//作用：显示SendOut操作状态\r\nfunction SendOutStatusMsg(mString){\r\n  iSendOutStatusBar.innerText=\" \"+mString;\r\n}\r\n\r\n//初始化名称为Consult的控件对象\r\nfunction initializtion(){\r\n  DivID.insertAdjacentElement(\"beforeBegin\",DocForm.Consult);\r\n  DocForm.Consult.WebUrl = \"");
      out.print(mServerUrl);
      out.write("\";           //WebUrl:系统服务器路径，与服务器交互操作，如打开签章信息\r\n  DocForm.Consult.RecordID = \"");
      out.print(RecordID);
      out.write("\";           //RecordID:本文档记录编号\r\n  DocForm.Consult.FieldName = \"Consult\";                //FieldName:签章窗体可以根据实际情况再增加，只需要修改控件属性 FieldName 的值就可以\r\n  DocForm.Consult.UserName = \"");
      out.print(UserName);
      out.write("\";           //UserName:签名用户名称\r\n  DocForm.Consult.Enabled = \"");
      out.print(Consult_Enabled);
      out.write("\";     //Enabled:是否允许修改，0:不允许 1:允许  默认值:1 \r\n  DocForm.Consult.PenColor = \"#FF0066\";                 //PenColor:笔的颜色，采用网页色彩值  默认值:#000000 \r\n  DocForm.Consult.BorderStyle = \"0\";                    //BorderStyle:边框，0:无边框 1:有边框  默认值:1 \r\n  DocForm.Consult.EditType = \"0\";                       //EditType:默认签章类型，0:签名 1:文字  默认值:0 \r\n  DocForm.Consult.ShowPage = \"0\";                       //ShowPage:设置默认显示页面，0:电子印章,1:网页签批,2:文字批注  默认值:0 \r\n  DocForm.Consult.InputText = \"\";                       //InputText:设置署名信息，  为空字符串则默认信息[用户名+时间]内容 \r\n  DocForm.Consult.PenWidth = \"3\";                       //PenWidth:笔的宽度，值:1 2 3 4 5   默认值:2 \r\n  DocForm.Consult.FontSize = \"14\";                      //FontSize:文字大小，默认值:11\r\n  DocForm.Consult.SignatureType = \"0\";                  //SignatureType:签章来源类型，0表示从服务器数据库中读取签章，1表示从硬件密钥盘中读取签章，2表示从本地读取签章，并与ImageName(本地签章路径)属性相结合使用  默认值:0}\r\n  DocForm.Consult.InputList = \"同意\\r\\n不同意\\r\\n请上级批示\\r\\n已阅\"; //InputList:设置文字批注信息列表 \r\n  DocForm.Consult.Width = \"100%\";\r\n  DocForm.Consult.Height = \"100%\";\r\n  DocForm.Consult.style.display=\"block\";\r\n");
      out.write("}\r\n\r\n//作用：调入签章数据信息\r\nfunction LoadSignature(){\r\n  DocForm.SendOut.AppendMenu(\"9\",\"-\");                  //“签发”控件自定义右键菜单\r\n  DocForm.SendOut.AppendMenu(\"10\",\"[自定义]清除所有签批\");  //“签发”控件自定义右键菜单\r\n\r\n  initializtion();                                      //js方式设置控件属性\r\n  DocForm.Consult.AppendMenu(\"1\",\"自定义的右键菜单项\"); //“会签”控件自定义右键菜单\r\n  DocForm.Consult.DisableMenu(\"签名盖章...,文字批注...,撤消签章...\");     //“会签”控件禁止某些右键菜单\r\n\r\n  if(\"");
      out.print(mNew);
      out.write("\"!=\"1\"){\r\n    \r\n    DocForm.SendOut.LoadSignature();                      //调用“签发”签章数据信息\r\n    SendOutStatusMsg(DocForm.SendOut.Status);\r\n    DocForm.Consult.LoadSignature();                      //调用“会签”签章数据信息\r\n    ConsultStatusMsg(DocForm.Consult.Status);\r\n  }else{\r\n    SendOutStatusMsg(\"当前“签发”区域为新建的空白内容\");\r\n    ConsultStatusMsg(\"当前“会签”区域为新建的空白内容\");\r\n  }\r\n}\r\n\r\n//作用：保存签章数据信息  \r\n//保存流程：先保存签章数据信息，成功后再提交到DocumentSave，保存表单基本信息\r\nfunction SaveSignature(){\r\n  if (DocForm.Consult.Modify){                    //判断签章数据信息是否有改动\r\n    if (!DocForm.Consult.SaveSignature()){        //保存签章数据信息\r\n      alert(\"保存会签签批内容失败！\");\r\n      return false;\r\n    }\r\n  }\r\n  if (DocForm.SendOut.Modify){                    //判断签章数据信息是否有改动\r\n    if (!DocForm.SendOut.SaveSignature()){        //保存签章数据信息\r\n      alert(\"保存签发签批内容失败！\");\r\n      return false;  \r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n//作用：SendOut控件切换读取签章的来源方式 （*高级版本提供该功能）\r\nfunction chgReadSignatureType(){\r\n  if (DocForm.SendOut.SignatureType==\"1\"){\r\n    DocForm.SendOut.SignatureType=\"0\";\r\n    alert(\"签发：签章来源从数据库中读取！\");\r\n");
      out.write("  }else{\r\n    DocForm.SendOut.SignatureType=\"1\";\r\n    alert(\"签发：签章来源从智能钥匙盘中读取！\");\r\n  }\r\n}\r\n\r\n//作用：SendOut控件打开签章窗口\r\nfunction SendOutOpenSignature(){\r\n  DocForm.SendOut.ShowDate(\"\",2);\r\n  if(DocForm.SendOut.OpenSignature()){\r\n    SendOutStatusMsg(\"签章、签批成功。\");\r\n  }else{\r\n    SendOutStatusMsg(DocForm.SendOut.Status);\r\n  }\r\n}\r\n\r\n//作用：SendOut控件打开签章窗口\r\nfunction SendEditTypeChange(){\r\n  if (DocForm.SendOut.EditType==0){\r\n    DocForm.SendOut.EditType=1;\r\n    SendOutStatusMsg(\"当前为文字签批状态。\");\r\n  }\r\n  else{\r\n    DocForm.SendOut.EditType=0;\r\n    SendOutStatusMsg(\"当前为手写签批状态。\");\r\n  }\r\n}\r\n\r\n//作用：打印页\r\nfunction PrintPage() { \r\n  var pwin=window.open(\"\",\"print\"); \r\n  pwin.document.write(Page.innerHTML); \r\n  pwin.print(); \r\n  //pwin.close();\r\n}\r\n\r\n//作用：Consult控件客户端和服务器端信息信息交互\r\nfunction WebSendInformation(){\r\n  var info = window.prompt(\"请输入要传到服务器处理页面上的内容:\",\"参数内容\");\r\n  if (info==null){return false}\r\n\r\n  DocForm.Consult.WebSetMsgByName(\"COMMAND\",\"SELFINFO\");    //设置变量COMMAND=\"SELFINFO\"，用来在服务器端做判断，以进入处理自定义参数传递的代码。\r\n  DocForm.Consult.WebSetMsgByName(\"TESTINFO\",info);         //自定义的一个参数\"TESTINFO\"，将info变量的信息设置到信息包中，以便传到后台。\r\n");
      out.write("  if (DocForm.Consult.WebSendMessage()){                    //向后台发信息包。交互iWebServer的OPTION=\"SENDMESSAGE\"。\r\n    info = DocForm.Consult.WebGetMsgByName(\"RETURNINFO\");   //如果交互成功，接受服务器端返回的信息。\r\n    ConsultStatusMsg(\"信息交互成功。\");\r\n\talert(info);\r\n  }\r\n  else{\r\n    ConsultStatusMsg(DocForm.Consult.Status);\r\n  }\r\n}\r\n\r\n//作用：Consult控件打开签章窗口\r\nfunction ConsultOpenSignature(){\r\n  if(DocForm.Consult.OpenSignature()){\r\n    ConsultStatusMsg(\"签章、签批成功。\");\r\n  }else{\r\n    ConsultStatusMsg(DocForm.Consult.Status);\r\n  }\r\n}\r\n\r\n//作用：控制Consult控件弹出窗口打开哪些TAB\r\nfunction ConsultInvisiblePages(mIndex){\r\n  var mShowPage = DocForm.Consult.ShowPage;\r\n\r\n  if(mIndex==0){\r\n    DocForm.Consult.ShowPage = \"0\";\r\n    DocForm.Consult.InvisiblePages('1,2,');\r\n  }\r\n  else if(mIndex==1){\r\n    DocForm.Consult.ShowPage = \"1\";\r\n    DocForm.Consult.InvisiblePages('0,2,');\r\n  }\r\n  else if(mIndex==2){\r\n    DocForm.Consult.ShowPage = \"2\";\r\n    DocForm.Consult.InvisiblePages('0,1,');\r\n  }\r\n  var mMsg = DocForm.Consult.Status;\r\n  if(mMsg==\"\"){mMsg = \"签章、签批成功。\";}\r\n  ConsultStatusMsg(mMsg);\r\n");
      out.write("  DocForm.Consult.ShowPage = mShowPage;\r\n}\r\n\r\n//作用：将Consult控件中的签批信息保存为gif图片\r\nfunction ConsultSaveGif(){\r\n  if(DocForm.Consult.SaveAsGif('C:/abcd.gif')){\r\n    ConsultStatusMsg('已成功保存在“C:/abcd.gif”！');\r\n  }else{\r\n    ConsultStatusMsg('输出图片失败！');\r\n  }\r\n}\r\n\r\n//作用：将Consult控件中的本次签批信息清除\r\nfunction ConsultClear(){\r\n  if (!(DocForm.Consult.Enabled)) {\r\n    alert('该签章已被锁定，无权编辑！');\r\n  } \r\n  else{\r\n    DocForm.Consult.Clear();\r\n    ConsultStatusMsg(\"已经取消了本次签批的内容。\");\r\n  }\r\n}\r\n\r\n//作用：将Consult控件中的签批信息清除\r\nfunction ConsultClearAll(){\r\n  if (!(DocForm.Consult.Enabled)) {\r\n    alert('该签章已被锁定，无权编辑！');\r\n  } \r\n  else{\r\n    DocForm.Consult.ClearAll();\r\n    ConsultStatusMsg(\"已经清除了所有签批的内容。\");\r\n  }\r\n}\r\n\r\n//作用：为Consult控件设置颜色提示\r\nfunction ConsultStartShowInfo(){\r\n  DocForm.Consult.StartShowInfo(\"#FF0000\");         //开启颜色提示\r\n  ConsultStatusMsg(\"颜色提示中……\");\r\n  setTimeout(\"DocForm.Consult.EndShowInfo();ConsultStatusMsg('颜色提示结束。');\",1000); //一秒后关闭颜色提示\r\n}\r\n\r\n//作用：Consult控件进行全屏签批\r\nfunction ConsultShowZoomInHandWrite(){\r\n  if(!DocForm.Consult.ShowZoomInHandWrite()){       //全屏签批 \r\n");
      out.write("    ConsultStatusMsg(\"放弃全屏签批。\");\r\n  }\r\n}\r\n\r\n//作用：Consult控件中使用迷你盖章窗口盖章\r\nfunction ConsultOpenMiniSignature(){\r\n  if(!DocForm.Consult.OpenMiniSignature()){\r\n    ConsultStatusMsg(\"放弃盖章。\");\r\n  }else{\r\n    ConsultStatusMsg(\"盖章成功。\");\r\n  }\r\n}\r\n\r\n//作用：Consult控件中判断某个用户是否进行了签批\r\nfunction ConsultIsJuggled(){\r\n  if(DocForm.Consult.IsJuggled(\"");
      out.print(UserName);
      out.write("\")){\r\n    alert(\"用户“");
      out.print(UserName);
      out.write("”已经进行过签批操作。\");\r\n  }else{\r\n    alert(\"用户“");
      out.print(UserName);
      out.write("”尚未进行过签批操作。\");\r\n  }\r\n}\r\n\r\n//作用：向Consult控件中载入远程图片\r\nfunction ConsultLoadPicture(){\r\n  if(DocForm.Consult.LoadPicture(10,10,'http://www.goldgrid.com/Images/GoldGridLogo.jpg')){\r\n    ConsultStatusMsg(\"载入图片成功。\");\r\n  }\r\n  else{\r\n    ConsultStatusMsg(\"载入图片失败。\");\r\n  }\r\n}\r\n\r\n//作用：向Consult控件中设置文本内容\r\nfunction ConsultInputValue(){\r\n  DocForm.Consult.WriteName(\"拟同意！发公司领导审批！\");\r\n}\r\n\r\n</script>\r\n\r\n</head>\r\n<body  onload=\"LoadSignature()\" topmargin=\"10\" bgcolor=\"c0c0c0\">\r\n<form name=\"DocForm\" method=\"post\" action=\"DocumentSave.jsp\" onSubmit=\"return SaveSignature();\">\r\n<input type=hidden name=UserName value=\"");
      out.print(UserName);
      out.write("\">\r\n<input type=hidden name=RecordID value=\"");
      out.print(RecordID);
      out.write("\">\r\n<script src=\"iWebRevision.js\"></script><!--调用iWebRevision，注意版本号，可用于升级。此处用js文件方式是为了处理“点击以激活控件”的问题-->\r\n<table width=760 border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" bgcolor=\"000000\">\r\n<tr>\r\n  <td colspan=2 bgcolor=\"#c0c0c0\" height=32>\r\n    <input type=submit value=\"  保存文档  \">&nbsp;\r\n    <input type=button value=\"  打印输出  \" onClick=\"javascript:PrintPage();\">&nbsp;\r\n    <input type=button value=\"  返回列表  \" onClick=\"javascript:history.back();\"><br>\r\n    本页为普通页面，用户可根据自己的需求更改。注意：签章密码为<font color=\"red\">0000</font>。<br>\r\n    控件采用加密处理技术，支持各种开发和应用环境，可靠性好，扩展性强，适用于政府、企业和软件<br>\r\n    开发商办公软件的应用集成。\r\n  </td>\r\n</tr>\r\n<tr>\r\n  <td id=Page>\r\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"> \r\n    <link REL=\"stylesheet\" href=\"Test.css\" type=\"text/css\">\r\n    <table width=\"758\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" bgcolor=\"ffffff\">\r\n\t<tr><td height=\"80\" align=\"center\" valign=\"bottom\"><font color=\"red\" size=\"6\"><b>金格网络科技公司发文稿纸<b></font></td></tr>\r\n\t<tr><td height=\"10\">&nbsp;</td></tr>\r\n");
      out.write("\t<tr>\r\n\t\t<td>\r\n\t\t\t<table width=\"600\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" >\t\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style=\"border-bottom:1px solid; border-color:#FF0000\" nowrap>\r\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" >\t\r\n\t\t\t\t\t\t   <tr>\r\n\t\t\t\t\t\t      <td width=64><font color=\"red\">&nbsp;编号：</font></td>\r\n\t\t\t\t\t\t      <td ><input type=\"text\" name=DocNo class=inputcss value=");
      out.print(DocNo);
      out.write("></td>\r\n\t\t\t\t\t\t      <td width=64><font color=\"red\">&nbsp;密级：</font></td>\r\n                              <td width=64><input type=\"text\" name=Security class=inputcss value=");
      out.print(Security);
      out.write("></td>\r\n\t\t\t\t\t\t   </tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\t\t\t\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td height=\"260\">\r\n\t\t\t\t\t\t <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\t\r\n\t\t\t\t\t\t   <tr>\r\n\t\t\t\t\t\t      <td width=\"55%\" height=\"240\" style=\"border-bottom:2px solid; border-color:#ff0000\">\r\n\t\t\t\t\t\t          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\t\r\n\t\t\t\t\t\t            <tr>\r\n\t\t\t\t\t\t              <td height=\"24\" width=\"60\" nowrap><font color=\"red\" >&nbsp;签发：</font></td>\r\n\t\t\t\t\t\t              <td>\r\n                                        <a class=\"LinkButton\" onClick=\"SendOutOpenSignature()\">[打开签章]</a>\r\n\t\t\t\t\t\t              \t<a class=\"LinkButton\" onClick=\"SendEditTypeChange()\">[文字签批]</a>\r\n\t\t\t\t\t\t              \t<a class=\"LinkButton\" onClick=\"SendOut.ShowSignature();\">[签章验证]</a> \r\n                                      </td>\r\n\t\t\t\t\t\t            </tr>\r\n\t\t\t\t\t\t            <tr>\r\n\t\t\t\t\t\t              <td height=\"100%\" colspan=\"2\" style=\"border-bottom:1px dashed;border-color:#999999; border-top:1px dashed;border-color:#999999\">\r\n");
      out.write("                                        <OBJECT name=\"SendOut\" classid=\"clsid:2294689C-9EDF-40BC-86AE-0438112CA439\" codebase=\"iWebRevision.cab#version=6,0,0,0\" width=100% height=100%>\r\n                                          <param name=\"WebUrl\" value=\"");
      out.print(mServerUrl);
      out.write("\">    <!-- WebUrl:系统服务器路径，与服务器交互操作，如打开签章信息 -->\r\n                                          <param name=\"RecordID\" value=\"");
      out.print(RecordID);
      out.write("\">    <!-- RecordID:本文档记录编号 -->\r\n                                          <param name=\"FieldName\" value=\"SendOut\">         <!-- FieldName:签章窗体可以根据实际情况再增加，只需要修改控件属性 FieldName 的值就可以 -->\r\n                                          <param name=\"UserName\" value=\"");
      out.print(UserName);
      out.write("\">    <!-- UserName:签名用户名称 -->\r\n                                          <param name=\"Enabled\" value=\"");
      out.print(SendOut_Enabled);
      out.write("\">  <!-- Enabled:是否允许修改，0:不允许 1:允许  默认值:1  -->\r\n                                          <param name=\"PenColor\" value=\"#0099FF\">     <!-- PenColor:笔的颜色，采用网页色彩值  默认值:#000000  -->\r\n                                          <param name=\"BorderStyle\" value=\"0\">    <!-- BorderStyle:边框，0:无边框 1:有边框  默认值:1  -->\r\n                                          <param name=\"EditType\" value=\"0\">    <!-- EditType:默认签章类型，0:签名 1:文字  默认值:0  -->\r\n                                          <param name=\"ShowPage\" value=\"0\">    <!-- ShowPage:设置默认显示页面，0:电子印章,1:网页签批,2:文字批注  默认值:0  -->\r\n                                          <param name=\"InputText\" value=\"\">    <!-- InputText:设置署名信息，  为空字符串则默认信息[用户名+时间]内容  -->\r\n                                          <param name=\"PenWidth\" value=\"2\">     <!-- PenWidth:笔的宽度，值:1 2 3 4 5   默认值:2  -->\r\n                                          <param name=\"FontSize\" value=\"11\">    <!-- FontSize:文字大小，默认值:11 -->\r\n                                          <param name=\"SignatureType\" value=\"0\">    <!-- SignatureType:签章来源类型，0表示从服务器数据库中读取签章，1表示从硬件密钥盘中读取签章，2表示从本地读取签章，并与ImageName(本地签章路径)属性相结合使用  默认值:0 -->\r\n");
      out.write("                                          <param name=\"InputList\" value=\"同意\\r\\n不同意\\r\\n请上级批示\\r\\n请速办理\">    <!-- InputList:设置文字批注信息列表  -->\r\n                                        </OBJECT>\r\n                                      </td>\r\n\t\t\t\t\t\t            </tr>\r\n                                    <tr>\r\n                                      <td height=\"26\" align=\"right\" class=\"StatusLine\" style=\"color:#0000ff\">状态信息：</td>\r\n                                      <td align=\"left\" class=\"StatusLine\" id=\"iSendOutStatusBar\" nowrap>&nbsp;</td>\r\n                                    </tr>\r\n\t\t\t\t\t\t          </table>\r\n\t\t\t\t\t\t      </td>\r\n\t\t\t\t\t\t      <td width=\"45%\"  style=\"border-bottom:2px solid; border-color:#ff0000\">\r\n\t\t\t\t\t\t\t    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\t\r\n\t\t\t\t\t\t            <tr>\r\n\t\t\t\t\t\t              <td width=4 height=\"120\">&nbsp;</td>\r\n\t\t\t\t\t\t              <td width=80 align=\"center\" style=\"border-left:1px dashed; border-color:#ff0000;border-bottom:1px solid; border-color:#ff0000\"><font color=\"red\" >拟稿：</font></td>\r\n");
      out.write("\t\t\t\t\t\t              <td style=\"border-bottom:1px solid; border-color:#ff0000\"><input type=\"text\" name=Draft class=inputcss  value=");
      out.print(Draft);
      out.write("></td>\r\n\t\t\t\t\t\t            </tr>\r\n\t\t\t\t\t\t            <tr>\r\n\t\t\t\t\t\t              <td width=4 height=\"120\">&nbsp;</td>\r\n\t\t\t\t\t\t              <td width=80 align=\"center\" style=\"border-left:1px dashed; border-color:#ff0000;\"><font color=\"red\" >核稿：</font></td>\r\n\t\t\t\t\t\t              <td ><input type=\"text\" name=Check class=inputcss  value=");
      out.print(Check);
      out.write("></td>\r\n\t\t\t\t\t\t            </tr>\r\n\t\t\t\t\t\t          </table>\r\n\t\t\t\t\t\t      </td>\t\r\n\t\t\t\t\t\t   </tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n                  <td style=\"border-bottom:2px solid;border-color:#ff0000;\" height=\"320\" nowrap >\r\n                    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\t\r\n                      <tr>\r\n                        <td width=\"60\" height=\"24\" nowrap><font color=\"red\" >&nbsp;会签：</font></td>\r\n                        <td colspan=\"2\">\r\n                          <a class=\"LinkButton\" onClick=\"Consult.EditType=1;ConsultStatusMsg('当前为文字签批状态。');\">[文字签批]</a>\r\n                          <a class=\"LinkButton\" onClick=\"Consult.EditType=0;ConsultStatusMsg('当前为手写签批状态。');\">[手写签批]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultShowZoomInHandWrite()\">[全屏签批]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultOpenMiniSignature()\">[迷你盖章]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultClear();\">[取消修改]</a>\r\n");
      out.write("                          <a class=\"LinkButton\" onClick=\"ConsultClearAll()\">[清空全部]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultIsJuggled()\">[是否签批]</a>\r\n                          <a class=\"LinkButton\" onClick=\"Consult.ShowSignature();\">[签章验证]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultSaveGif();\">[输出图片]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultLoadPicture();\">[载入图片]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultStartShowInfo()\">[颜色提示]</a>\r\n                          <a class=\"LinkButton\" onClick=\"Consult.WriteName('署名：");
      out.print(UserName);
      out.write("')\">[自动署名]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultInputValue()\">[常用短语]</a>\r\n                          <a class=\"LinkButton\" onClick=\"WebSendInformation()\">[信息交互]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultOpenSignature()\">[打开完整签章窗口]</a>\r\n                        </td>\r\n                      </tr>\r\n                      <tr>\r\n                        <td height=\"100%\" colspan=\"3\" style=\"border-bottom:1px dashed;border-color:#999999; border-top:1px dashed;border-color:#999999\">\r\n                          <div id=\"DivID\"></div>                        </td>\r\n                      </tr>\r\n                      <tr>\r\n                        <td height=\"26\" align=\"right\" class=\"StatusLine\" style=\"color:#0000ff\" nowrap>状态信息：</td>\r\n                        <td width=\"260\" align=\"left\" class=\"StatusLine\" id=\"iConsultStatusBar\" nowrap>&nbsp;</td>\r\n                        <td align=\"right\" nowrap>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultInvisiblePages(0)\">[电子签章窗口]</a>\r\n");
      out.write("                          <a class=\"LinkButton\" onClick=\"ConsultInvisiblePages(1)\">[手写签名窗口]</a>\r\n                          <a class=\"LinkButton\" onClick=\"ConsultInvisiblePages(2)\">[文字签批窗口]</a>\r\n                        </td>\r\n                      </tr>\r\n                    </table>\r\n                  </td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style=\"border-bottom:1px solid; border-color:#ff0000\" height=\"50\" nowrap >\r\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\r\n\t\t\t\t\t\t   <tr>\r\n\t\t\t\t\t\t      <td width=\"100\"><font color=\"red\">&nbsp;标题：</font></td>\r\n\t\t\t\t\t\t      <td><input type=\"text\" name=Title class=inputcss value=");
      out.print(Title);
      out.write("></td>\r\n\t\t\t\t\t\t   </tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\t\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style=\"border-bottom:1px solid; border-color:#ff0000\" height=\"50\" nowrap  >\r\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\" >\t\r\n\t\t\t\t\t\t   <tr>\r\n\t\t\t\t\t\t      <td width=\"100\" ><font color=\"red\">&nbsp;抄送：</font></td>\r\n\t\t\t\t\t\t      <td><input type=\"text\" name=CopyTo class=inputcss  value=");
      out.print(CopyTo);
      out.write("></td>\r\n\t\t\t\t\t\t   </tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\t\t\t\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style=\"border-bottom:1px solid; border-color:#ff0000\" height=\"50\" nowrap >\r\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\t\r\n\t\t\t\t\t\t   <tr>\r\n\t\t\t\t\t\t      <td width=\"100\" ><font color=\"red\">&nbsp;主题词：</font></td>\r\n\t\t\t\t\t\t      <td><input type=\"text\" name=Subject class=inputcss  value=");
      out.print(Subject);
      out.write("></td>\r\n\t\t\t\t\t\t   </tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\t\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style=\"border-bottom:1px solid; border-color:#ff0000\" height=\"40\" nowrap >\r\n\t\t\t\t\t\t<table width=\"100%\"  border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" height=\"100%\">\t\r\n\t\t\t\t\t\t   <tr>\r\n\t\t\t\t\t\t      <td width=\"100\"  ><font color=\"red\">&nbsp;印刷份数：</font></td>\r\n\t\t\t\t\t\t      <td style=\"border-right:1px solid red\" width=\"200\"><input type=\"text\" name=Copies class=inputcss value=");
      out.print(Copies);
      out.write("></td>\r\n\t\t\t\t\t\t      <td width=\"100\"  ><font color=\"red\">&nbsp;发文日期：</font></td>\r\n\t\t\t\t\t\t      <td><input type=\"text\" name=DateTime readonly class=inputcss value=");
      out.print(DateTime);
      out.write("></td>\r\n\t\t\t\t\t\t   </tr>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style=\"border-bottom:1px solid; border-color:#ff0000\" height=\"1\" nowrap >\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr><td height=\"60\">&nbsp;</td></tr>\r\n    </table>\r\n  </td>\r\n  <td width=2></td>\r\n</tr>\r\n<tr>\r\n  <td height=2></td>\r\n  <td></td>\r\n</tr>\r\n</table>\r\n</form>\r\n</body>\r\n</html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
