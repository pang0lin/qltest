/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 09:38:29 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.util.*;
import com.js.oa.scheme.event.vo.EventVO;
import com.js.oa.netdisk.po.NetDiskPO;
import com.js.oa.scheme.taskcenter.po.TaskPO;
import com.js.oa.scheme.worklog.po.WorkLogPO;
import com.js.oa.online.po.ChatPO;
import com.js.util.util.DateHelper;

public final class relation_005femp_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.oa.online.po.ChatPO");
    _jspx_imports_classes.add("com.js.oa.scheme.event.vo.EventVO");
    _jspx_imports_classes.add("com.js.util.util.DateHelper");
    _jspx_imports_classes.add("com.js.oa.netdisk.po.NetDiskPO");
    _jspx_imports_classes.add("com.js.oa.scheme.worklog.po.WorkLogPO");
    _jspx_imports_classes.add("com.js.oa.scheme.taskcenter.po.TaskPO");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

response.setHeader("Cache-Control","no-store");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", 0);

Map relationMap=(Map)request.getAttribute("relationMap");

List cooList=(List)relationMap.get("cooList");
List docList=(List)relationMap.get("docList");
List reportList=(List)relationMap.get("reportList");
List taskList=(List)relationMap.get("taskList");
List msgList=(List)relationMap.get("msgList");
List empInfoList=(List)relationMap.get("empInfoList");
List eventList=(List)request.getAttribute("eventList");
List underEmpList=(List)request.getAttribute("underEmpList");

String empId=request.getParameter("empId");
//1:上级；2：下级；3：相关人员
String type=request.getParameter("type");
//System.out.println("-----type----->>>>"+type);
String empName="",empEmail="",GWei="",ZWu="",Mobile="",orgName="",Phone="";
if(empInfoList!=null&&empInfoList.size()>0){
  Object[] obj=(Object[])empInfoList.get(0);
  empName=obj[0].toString();
  orgName=obj[1].toString();
  ZWu=String.valueOf(obj[2]);
  GWei=String.valueOf(obj[3]);
  Mobile=String.valueOf(obj[4]);
  Phone=String.valueOf(obj[5]);
  empEmail=String.valueOf(obj[6]);
}


      out.write("\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n<title>无标题文档</title>\r\n<link href=\"/jsoa/relproject/index.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<link href=\"/jsoa/skin/blue/style.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<link rel=stylesheet type=\"text/css\" href=\"public/date_picker/DateObject1.css\" />\r\n</head>\r\n\r\n<body>\r\n<table width=\"100%\"  height=\"67\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" id=\"top_tu\" style=\"background-repeat: no-repeat;\">\r\n  <tr>\r\n    <td width=\"40%\">    \r\n\t    <img src=\"/jsoa/relproject/images/gulxt.png\"/>\r\n    <span id=\"topbiaot\">");
      out.print(empName);
      out.write("</span></td>\r\n    <td><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"font-size:12px\">\r\n      <tr>\r\n        <td height=\"20\" align=\"right\">部门：</td>\r\n        <td>");
      out.print(orgName.equals("null")?"&nbsp;":orgName);
      out.write("</td>\r\n        <td align=\"right\">电话：</td>\r\n        <td>");
      out.print(Phone.equals("null")?"&nbsp;&nbsp;&nbsp;&nbsp;":Phone);
      out.write("</td>\r\n        <td rowspan=\"3\" style=\"line-height:14px;\">\r\n           <span style=\"cursor:pointer;color:1e5494;text-decoration:underline\" onclick=\"openNewCoop('");
      out.print(empId);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(empName);
      out.write("')\">给");
      out.print(empName);
      out.write("发协同</span><br />\r\n           <span style=\"cursor:pointer;color:1e5494;text-decoration:underline\" onclick=\"openNewMsg('");
      out.print(empId);
      out.write("')\">给");
      out.print(empName);
      out.write("发在线消息</span><br />\r\n           ");
if(type.equals("null")||type.equals("2")){ 
           	//type：1为上级；2为下级；3为相关人
           
      out.write("\r\n           <span style=\"cursor:pointer;color:1e5494;text-decoration:underline\" onclick=\"openNewTask()\">给");
      out.print(empName);
      out.write("安排工作</span></td>\r\n      \t\t");
} 
      out.write("\r\n      </tr>\r\n      <tr>\r\n        <td height=\"20\" align=\"right\">职务：</td>\r\n        <td>");
      out.print(ZWu.equals("null")?"&nbsp;":ZWu);
      out.write("</td>\r\n        <td align=\"right\">手机：</td>\r\n        <td>\r\n         ");
if(!Mobile.equals("null")){ 
      out.write("\r\n           <span style=\"cursor:pointer;color:1e5494;text-decoration:underline\" onclick=\"openNewShortMsg('");
      out.print(Mobile);
      out.write("')\">");
      out.print(Mobile);
      out.write("</span>\r\n         ");
}else{
      out.write("\r\n            &nbsp;\r\n         ");
} 
      out.write("\r\n        </td>\r\n        </tr>\r\n      <tr>\r\n        <td height=\"20\" align=\"right\">岗位：</td>\r\n        <td>");
      out.print(GWei.equals("null")?"&nbsp;":GWei );
      out.write("</td>\r\n        <td align=\"right\">邮箱：</td>\r\n        <td>\r\n        ");
if(!empEmail.equals("null")){ 
      out.write("\r\n           <span style=\"cursor:pointer;color:1e5494;text-decoration:underline\" onclick=\"openNewEmail('");
      out.print(empEmail);
      out.write("')\">");
      out.print(empEmail);
      out.write("</span>\r\n        ");
}else{
      out.write("\r\n            &nbsp;\r\n         ");
} 
      out.write("\r\n        </td>\r\n        </tr>\r\n    </table></td>\r\n  </tr>\r\n</table>\r\n\r\n<table width=\"100%\" border=\"0\" cellspacing=\"6\" cellpadding=\"0\">\r\n  <tr>\r\n ");
      out.write("\r\n    <td align=\"left\" valign=\"top\" width=\"50%\" height=\"210\" ><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"boder_bottom\">\r\n      <tr>\r\n        <td class=\"table_left\">&nbsp;</td>\r\n        <td class=\"table_cenr\">共享给我的日程</td>\r\n        <td class=\"table_right\">&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"boder_left\">&nbsp;</td>\r\n        <td>\r\n          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          ");

           if(eventList!=null&&eventList.size()>0){
            for(int i=0;i<eventList.size();i++){
              EventVO ep=(EventVO)eventList.get(i);
              String evtitle=ep.getEventTitle();
              if(evtitle.length()>23){
            	  evtitle=evtitle.substring(0,23)+"...";
              }
              //处理时间，如果时间为空的话，只输出空格不做截取
              String dateTime="";
              if(ep.getEventBeginDateFormat()!=null&&!ep.getEventBeginDateFormat().equals("")){
            	  dateTime=ep.getEventBeginDateFormat().substring(5,ep.getEventBeginDateFormat().length());
              }else{
            	  dateTime="&nbsp;";
              }
          
      out.write("\r\n            <tr>\r\n              <td valign=\"middle\" class=\"left_xt\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\"><a style=\"cursor:pointer\" onclick=\"openEvent(");
      out.print(ep.getEventId());
      out.write(')');
      out.write('"');
      out.write('>');
      out.print(evtitle);
      out.write("</a></td>\r\n              <td align=\"right\" valign=\"middle\" nowrap=\"nowrap\" class=\"border_bm\">");
      out.print(dateTime );
      out.write("</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}if(eventList==null||7-eventList.size()!=0){
                for(int i=0;i<7-eventList.size();i++){
            
      out.write("\r\n           <tr>\r\n              <td valign=\"middle\" class=\"left_xt_\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\">&nbsp;</td>\r\n              <td valign=\"middle\" class=\"color_h\">&nbsp;</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n           ");
}}
      out.write("\r\n           ");
if(eventList!=null&&eventList.size()>6){
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" onclick=\"openAll('event');\">更多</a></td>\r\n            </tr>\r\n            ");
}else{ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\"\">&nbsp;</a></td>\r\n            </tr>\r\n            ");
} 
      out.write("\r\n          </table>\r\n        </td>\r\n        <td class=\"boder_right\">&nbsp;</td>\r\n      </tr>\r\n    </table>\r\n    </td>\r\n    ");
      out.write("\r\n    <td align=\"left\" valign=\"top\" width=\"50%\" >\r\n     <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"boder_bottom\">\r\n      <tr>\r\n        <td class=\"table_left\">&nbsp;</td>\r\n        <td class=\"table_cenr\">发给我的协同</td>\r\n        <td class=\"table_right\">&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"boder_left\">&nbsp;</td>\r\n        <td>\r\n          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          ");

           if(cooList!=null&&cooList.size()>0){
            for(int i=0;i<cooList.size();i++){
              Object[] bp=(Object[])cooList.get(i);
              String cooTitle=bp[1].toString();
              if(cooTitle.length()>23)cooTitle=cooTitle.substring(0,23)+"...";
          
      out.write("\r\n            <tr>\r\n              <td valign=\"middle\" class=\"left_xt\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\"><a style=\"cursor:pointer\" onclick=\"openCoop('");
      out.print(bp[0]);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(bp[6]);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(bp[7]);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(bp[5] );
      out.write("')\">");
      out.print(cooTitle);
      out.write("</a></td>\r\n              <td align=\"right\" valign=\"middle\" nowrap=\"nowrap\" class=\"border_bm\">");
      out.print(DateHelper.date2String((Date)bp[2],null).substring(5,11) );
      out.write("</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}if(cooList==null||7-cooList.size()!=0){
                for(int i=0;i<7-cooList.size();i++){
            
      out.write("\r\n             <tr>\r\n              <td valign=\"middle\" class=\"left_xt_\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\">&nbsp;</td>\r\n              <td valign=\"middle\" class=\"color_h\">&nbsp;</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}
      out.write("\r\n              ");
if(cooList!=null&&cooList.size()>6){ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" onclick=\"openAll('coop');\">更多</a></td>\r\n            </tr>\r\n            ");
}else{
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" >&nbsp;</a></td>\r\n            </tr>\r\n            ");
} 
      out.write("\r\n          </table>\r\n       </td>\r\n        <td class=\"boder_right\">&nbsp;</td>\r\n      </tr>\r\n    </table>\r\n    </td>\r\n  </tr>\r\n  ");
      out.write("\r\n  <tr>\r\n    <td align=\"left\" valign=\"top\" width=\"50%\" height=\"210\" ><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"boder_bottom\">\r\n      <tr>\r\n        <td class=\"table_left\">&nbsp;</td>\r\n        <td class=\"table_cenr\">共享给我的文件</td>\r\n        <td class=\"table_right\">&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"boder_left\">&nbsp;</td>\r\n        <td>\r\n          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          ");

           if(docList!=null&&docList.size()>0){
            for(int i=0;i<docList.size();i++){
              NetDiskPO nd=(NetDiskPO)docList.get(i);
              String fileName=nd.getFileSaveName();
              if(fileName.length()>23)fileName=fileName.substring(0,23)+"...";
          
      out.write("\r\n            <tr>\r\n              <td valign=\"middle\" class=\"left_xt\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\"><a style=\"cursor:pointer\" onclick=\"openDoc('");
      out.print(nd.getFileId());
      out.write("','')\">");
      out.print(fileName);
      out.write("</a></td>\r\n              <td align=\"right\" valign=\"middle\" nowrap=\"nowrap\" class=\"border_bm\">");
      out.print(DateHelper.date2String(nd.getFileCreatedTime(),null).substring(5,11) );
      out.write("</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}if(docList==null||7-docList.size()!=0){
                for(int i=0;i<7-docList.size();i++){
            
      out.write("\r\n             <tr>\r\n              <td valign=\"middle\" class=\"left_xt_\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\">&nbsp;</td>\r\n              <td valign=\"middle\" class=\"color_h\">&nbsp;</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n                \r\n            ");
}} 
      out.write("\r\n            ");
if(docList!=null&&docList.size()>6){ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" onclick=\"openAll('netdisk');\">更多</a></td>\r\n            </tr>\r\n            ");
}else{ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\">&nbsp;</a></td>\r\n            </tr>\r\n            ");
} 
      out.write("\r\n          </table>\r\n           </td>\r\n        <td class=\"boder_right\">&nbsp;</td>\r\n      </tr>\r\n    </table>\r\n    </td>\r\n    ");
      out.write("\r\n    <td align=\"left\" valign=\"top\" width=\"50%\" ><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"boder_bottom\">\r\n      <tr>\r\n        <td class=\"table_left\">&nbsp;</td>\r\n        <td class=\"table_cenr\">安排给");
      out.print(empName);
      out.write("的任务</td>\r\n        <td class=\"table_right\">&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"boder_left\">&nbsp;</td>\r\n        <td>\r\n          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          ");

           if(taskList!=null&&taskList.size()>0){
            for(int i=0;i<taskList.size();i++){
              TaskPO tp=(TaskPO)taskList.get(i);
              String key=new com.js.util.util.MD5().toMD5("key-md5"+tp.getTaskId());
              String taskTitle=tp.getTaskTitle();
              if(taskTitle.length()>23)taskTitle=taskTitle.substring(0,23)+"...";
          
      out.write("\r\n            <tr>\r\n              <td valign=\"middle\" class=\"left_xt\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\"><a style=\"cursor:pointer\" onclick=\"openTask('");
      out.print(tp.getTaskId());
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(tp.getIsArranged());
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(key);
      out.write("')\">");
      out.print(taskTitle);
      out.write("</a></td>\r\n              <td align=\"right\" valign=\"middle\" nowrap=\"nowrap\" class=\"border_bm\">");
      out.print(DateHelper.date2String(tp.getTaskCreatedTime(),null).substring(5,11) );
      out.write("</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}if(taskList==null||7-taskList.size()!=0){
                for(int i=0;i<7-taskList.size();i++){
            
      out.write("\r\n             <tr>\r\n              <td valign=\"middle\" class=\"left_xt_\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\">&nbsp;</td>\r\n              <td valign=\"middle\" class=\"color_h\">&nbsp;</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n           ");
}}
      out.write("\r\n           ");
if(taskList!=null&&taskList.size()>6){
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" onclick=\"openAll('task');\">更多</a></td>\r\n            </tr>\r\n            ");
} else{
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" >&nbsp;</a></td>\r\n            </tr>\r\n            ");
} 
      out.write("\r\n          </table>\r\n        </td>\r\n        <td class=\"boder_right\">&nbsp;</td>\r\n      </tr>\r\n    </table>\r\n    </td>\r\n  </tr>\r\n  ");
      out.write("\r\n  <tr>\r\n    <td align=\"left\" valign=\"top\" width=\"50%\" height=\"210\" ><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"boder_bottom\">\r\n      <tr>\r\n        <td class=\"table_left\">&nbsp;</td>\r\n        <td class=\"table_cenr\">发给我的汇报</td>\r\n        <td class=\"table_right\">&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"boder_left\">&nbsp;</td>\r\n        <td>\r\n          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          ");

          if(!type.equals("null")&&type.equals("2")){
           if(reportList!=null&&reportList.size()>0){
            for(int i=0;i<reportList.size();i++){
              Object[] tp=(Object[])reportList.get(i);
              WorkLogPO wp=(WorkLogPO)tp[0];
               String logContent = wp.getLogContent();
				if(logContent != null && logContent.length()>23){
                 logContent = logContent.substring(0,23)+"...";
				}
          
      out.write("\r\n            <tr>\r\n              <td valign=\"middle\" class=\"left_xt\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\"><a style=\"cursor:pointer\" onclick=\"openReport('");
      out.print(wp.getLogId());
      out.write("')\">");
      out.print(logContent);
      out.write("</a></td>\r\n              <td align=\"right\" valign=\"middle\" nowrap=\"nowrap\" class=\"border_bm\">");
      out.print(DateHelper.date2String(wp.getLogWriteDate(),null).substring(5,11) );
      out.write("</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}} if(reportList!=null||7-reportList.size()!=0){
            	int num=0;
            	if(!type.equals("null")&&(type.equals("1")||type.equals("3")))num=0;
            	if(!type.equals("null")&&type.equals("2"))num=reportList.size();
                for(int i=0;i<7-num;i++){
            
      out.write("\r\n             <tr>\r\n              <td valign=\"middle\" class=\"left_xt_\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\">&nbsp;</td>\r\n              <td valign=\"middle\" class=\"color_h\">&nbsp;</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}}
      out.write("\r\n            ");
if(reportList!=null&&reportList.size()>6){ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" onclick=\"openAll('worklog');\">更多</a></td>\r\n            </tr>\r\n            ");
}else{ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\">&nbsp;</a></td>\r\n            </tr>\r\n            ");
} 
      out.write("\r\n          </table>\r\n        </td>\r\n        <td class=\"boder_right\">&nbsp;</td>\r\n      </tr>\r\n    </table>\r\n    </td>\r\n    ");
      out.write("\r\n    <td align=\"left\" valign=\"top\" width=\"50%\" ><table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" class=\"boder_bottom\">\r\n      <tr>\r\n        <td class=\"table_left\">&nbsp;</td>\r\n        <td class=\"table_cenr\">发给我的消息</td>\r\n        <td class=\"table_right\">&nbsp;</td>\r\n      </tr>\r\n      <tr>\r\n        <td class=\"boder_left\">&nbsp;</td>\r\n        <td>\r\n          <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n          ");

           if(msgList!=null&&msgList.size()>0){
        	   Object[] obj;
        	   String content,chatTime,chatId,isRead;
            for(int i=0;i<msgList.size();i++){
            	if(i>6){
            		break;
            	}
               obj=(Object[])msgList.get(i);
               chatId=obj[0].toString();               
               content = obj[1]==null?"":obj[1].toString();
               isRead=obj[5]==null?"0":obj[5].toString();
				if(content != null && content.length()>23){
                 content = content.substring(0,23)+"...";
				}
				chatTime=obj[2]==null?"":obj[2].toString();
				if(chatTime.lastIndexOf(":")>0){
					chatTime=chatTime.substring(0,chatTime.lastIndexOf(":"));
				}
				
          
      out.write("\r\n            <tr>\r\n              <td valign=\"middle\" class=\"left_xt\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\"><a style=\"cursor:pointer\" onclick=\"showChat('");
      out.print(chatId);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(isRead);
      out.write("')\">");
      out.print(content);
      out.write("</a></td>\r\n              <td align=\"right\" valign=\"middle\" nowrap=\"nowrap\" class=\"border_bm\">");
      out.print(chatTime);
      out.write("</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>\r\n            ");
}
            } 
          if(msgList!=null||7-msgList.size()!=0){
                for(int i=0;i<7-msgList.size();i++){
            
      out.write("\r\n             <tr>\r\n              <td valign=\"middle\" class=\"left_xt_\">&nbsp;</td>\r\n              <td valign=\"bottom\" class=\"border_bm\">&nbsp;</td>\r\n              <td valign=\"middle\" class=\"color_h\">&nbsp;</td>\r\n              <td align=\"right\" valign=\"middle\" class=\"color_right\">&nbsp;</td>\r\n            </tr>              \r\n            ");
}}
      out.write("\r\n            ");
if(msgList!=null&&msgList.size()>7){
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\" onclick=\"goChatList('");
      out.print(empName );
      out.write("');\">更多</a></td>\r\n            </tr>\r\n            ");
}else{ 
      out.write("\r\n            <tr>\r\n              <td colspan=\"4\" align=\"right\" valign=\"middle\" class=\"height_gd\"><a  style=\"cursor:pointer;\">&nbsp;</a></td>\r\n            </tr>\r\n            ");
} 
      out.write("\r\n          </table>\r\n        </td>\r\n        <td class=\"boder_right\">&nbsp;</td>\r\n      </tr>\r\n    </table>\r\n    </td>\r\n  </tr>\r\n</table>\r\n</body>\r\n</html>\r\n\r\n<script language=\"JavaScript\">\r\nfunction openEvent(obj){\r\n\tJSMainWinOpen('/jsoa/eventAction.do?action=selectSingleEvent&eventId='+obj);\r\n}\r\nfunction openCoop(bodyId,memberId,nodeId,status){\r\n \tJSMainWinOpen('/jsoa/BodyAction.do?flag=toDealwith&bodyId='+bodyId+'&nodeId='+nodeId+'&memberId='+memberId+'&status='+status,'','');\r\n}\r\n\r\nfunction openDoc(fatherid,ishared){\r\n\tJSMainWinOpen(\"/jsoa/NetdiskAction.do?action=listshared&currentid=\"+fatherid+\"&ishared=\"+ishared+\"\");\r\n}\r\nfunction openTask(taskId,isArranged,key){\r\n\tJSMainWinOpen('/jsoa/taskAction.do?action=selectSingleTask&cansees=1&taskId='+taskId+'&isArranged='+isArranged+'key='+key);\r\n}\r\nfunction openReport(id){\r\n\tJSMainWinOpen('workLogAction.do?action=updateWorkLog&logId='+id);\r\n}\r\n");

Date date=new Date();
String year=(date.getYear()+1900)+"";
String month=(date.getMonth()+1)+"";
String day=date.getDay()+"";

      out.write("\r\nfunction openAll(type){\r\n\tif(type=='coop'){\r\n\t   JSMainWinOpen('/jsoa/CoItemAction.do?status=10&toUserId=");
      out.print(empId );
      out.write("');\r\n\t}if(type=='event'){\r\n\t   JSMainWinOpen('/jsoa/eventAction.do?action=selectAllEvent&toUserId=");
      out.print(empId );
      out.write("&Year=");
      out.print(year);
      out.write("&Month=");
      out.print(month);
      out.write("&Day=");
      out.print(day);
      out.write("');\r\n\t}if(type=='netdisk'){\r\n\t   JSMainWinOpen('/jsoa/NetdiskAction.do?action=sharedlist&id=320&toUserId=");
      out.print(empId );
      out.write("');\r\n\t}if(type=='task'){\r\n\t   JSMainWinOpen('/jsoa/taskAction.do?action=selectPrincipalTask&toUserId=");
      out.print(empId );
      out.write("');\r\n\t}if(type=='worklog'){\r\n\t   JSMainWinOpen('/jsoa/workLogAction.do?action=selectSelfWorkLog&type=list&toUserId=");
      out.print(empId );
      out.write("');\r\n\t}if(type=='msg'){\r\n\t   JSMainWinOpen('/jsoa/getChat.do?action=getAll&str=all');\r\n\t}\r\n}\r\nfunction goChatList(name){\r\n\tJSMainWinOpen('/jsoa/ChatAction.do?action=list&sortFlag=all&senderName='+name);\r\n}\r\nfunction openNewCoop(id,name){\r\n  JSMainWinOpen('/jsoa/BodyAction.do?flag=add&id='+id+'&name='+name);\r\n}\r\n\r\nfunction openNewMsg(id){\r\n\tvar wid=428;\r\n\tvar heigh=283;\r\n\tvar popwin=JSMainWinOpen2('/jsoa/chat/chat.jsp?id='+id,'','',445,283)\r\n}\r\nfunction openNewEmail(mail){\r\n\tJSMainWinOpen('/jsoa/webMail.do?method=goWriteMail&mailUrlw='+mail+',');\r\n}\r\nfunction openNewTask(){\r\n\tJSMainWinOpen('/jsoa/taskAction.do?action=addTaskSettleView');\r\n}\r\n\r\nfunction openNewShortMsg(mobile){\r\n  JSMainWinOpen('/jsoa/MessageAction.do?action=openAddMsg&usermod='+mobile);\r\n}\r\n\r\nfunction showChat(id,isRead){   \t\t    \r\n\tvar wid=620;\r\n\tvar heigh=465;\t\r\n\tJSMainWinOpen2('/jsoa/chat/showChat.jsp?id='+id+'&isRead='+isRead,'','',wid,heigh);\r\n}\t\t\t\r\n</script>\r\n<script src=\"/jsoa/js/imenu.js\"></script>\r\n<script src=\"/jsoa/js/util.js\"></script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
