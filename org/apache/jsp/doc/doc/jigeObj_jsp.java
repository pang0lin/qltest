/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 10:05:46 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.doc.doc;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.util.util.*;
import com.js.util.config.SystemCommon;
import java.io.*;
import java.text.*;
import java.util.*;
import java.sql.*;
import java.text.SimpleDateFormat;
import java.text.DateFormat;
import java.util.Date;
import javax.servlet.*;
import javax.servlet.http.*;
import DBstep.iDBManager2000.*;

public final class jigeObj_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {


  /**
   * 功能或作用：格式化日期时间
   * @param DateValue 输入日期或时间
   * @param DateType 格式化 EEEE是星期, yyyy是年, MM是月, dd是日, HH是小时, mm是分钟,  ss是秒
   * @return 输出字符串
   */
  public String FormatDate(String DateValue,String DateType)
  {
    String Result;
    SimpleDateFormat formatter = new SimpleDateFormat(DateType);
    try{
      Date mDateTime = formatter.parse(DateValue);
      Result = formatter.format(mDateTime);
    }catch(Exception ex){
      Result = ex.getMessage();
    }
    if (Result.equalsIgnoreCase("1900-01-01")){
      Result = "";
    }
    return Result;
  }

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(6);
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-nested.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-tiles.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-logic.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-html.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-template.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-bean.tld", Long.valueOf(1499751390000L));
  }

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("java.sql");
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.text");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("java.io");
    _jspx_imports_packages.add("com.js.util.util");
    _jspx_imports_packages.add("DBstep.iDBManager2000");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("java.util.Date");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("java.text.SimpleDateFormat");
    _jspx_imports_classes.add("java.text.DateFormat");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=gb2312");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

request.setCharacterEncoding("gb2312");//处理中文乱码

      out.write('\r');
      out.write('\n');

 String mRecordID=request.getParameter("RecordID"); 
  String mTemplate=request.getParameter("Template");
  String mFileType=request.getParameter("FileType");
  String mEditType=request.getParameter("EditType");
  
  if(!ParameterFilter.isNumber(mRecordID) || !ParameterFilter.checkParameter(mEditType)){
			response.sendRedirect(request.getContextPath()+"/public/jsp/inputerror.jsp");
		}
  
  String mUserName="";
  if(session.getAttribute("userName")!=null)
  mUserName=session.getAttribute("userName")+"";

   String showEditButton=request.getParameter("showEditButton")==null?"0":request.getParameter("showEditButton");//显示编辑按


      out.write("\r\n\r\n\r\n");
      out.write('\r');
      out.write('\n');

  ResultSet result=null;
  String mSubject=null;
  String mStatus=null;
  String mAuthor=null;
  String mFileName=null;
  String mFileDate=null;
  String mHTMLPath="";
  String mDisabled="";
  String mWord="";
  String mExcel="";

  //自动获取OfficeServer和OCX文件完整URL路径
  String mHttpUrlName=request.getRequestURI();
  String mScriptName=request.getServletPath();
  String mServerName="iWebOfficeSign/OfficeServer.jsp";
  String mClientName="iWebOfficeSign/iWebOffice2003.ocx#version=8,2,4,0";
  String objClassId="23739A7E-5741-4D1C-88D5-D50B18F7C347";
  
  if("2009".equals(SystemCommon.getiWebOfficeVersion())){
	  mClientName="iWebOfficeSign/iWebOffice2009.cab#version=10,8,6,2";
	  objClassId="8B23EA28-2009-402F-92C4-59BE0E063499";
  }

  String appScheme=request.getScheme();

  String mServerUrl=appScheme+"://"+request.getServerName()+":"+request.getServerPort()+mHttpUrlName.substring(0,mHttpUrlName.lastIndexOf(mScriptName))+"/"+mServerName;//取得OfficeServer文件的完整URL
  String mClientUrl=appScheme+"://"+request.getServerName()+":"+request.getServerPort()+mHttpUrlName.substring(0,mHttpUrlName.lastIndexOf(mScriptName))+"/"+mClientName;//取得OCX下载的完整URL
  String mHttpUrl=appScheme+"://"+request.getServerName()+":"+request.getServerPort()+mHttpUrlName.substring(0,mHttpUrlName.lastIndexOf(mScriptName))+"/";
 
  //取得编号
  if ( mRecordID==null)
  {
     mRecordID="";	//编号为空
  }
  //取得模式
  if ( mEditType==null)
  {
    mEditType="1";		// 0 显示  1 起草 2 批改 3 审核
  }
  //取得类型
  if ( mFileType==null)
  {
    mFileType=".doc";	// 默认为.doc文档
  }
  //取得用户名
  if (mUserName==null)
  {
    mUserName="金格科技";
  }

  //取得模板
  if ( mTemplate==null)
  {
    mTemplate="";	// 默认没有模板
  }

  //打开数据库
DBstep.iDBManager2000 DbaObj=new DBstep.iDBManager2000();
  if (DbaObj.OpenConnection())
  {
    String mSql="Select * From Document Where RecordID='"+ mRecordID + "'";
    try
    {
      result=DbaObj.ExecuteQuery(mSql);
      if (result.next())
      {
        mRecordID=result.getString("RecordID");
        mTemplate=result.getString("Template");
        mSubject=result.getString("Subject");
        mAuthor=result.getString("Author");
        mFileDate=result.getString("FileDate");
        mStatus=result.getString("Status");
        mFileType=result.getString("FileType");
        mHTMLPath=result.getString("HTMLPath");
      }
      else
      {
	//取得唯一值(mRecordID)
        java.util.Date dt=new java.util.Date();
        long lg=dt.getTime();
        Long ld=new Long(lg);
	//初始化值
        mRecordID=ld.toString();//保存的是文档的编号，通过该编号，可以在里找到所有属于这条纪录的文档
        mTemplate=mTemplate;
        mSubject="请输入主题";
        mAuthor=mUserName;
        mFileDate=DbaObj.GetDateTime();
        mStatus="DERF";
        mFileType=mFileType;
        mHTMLPath="";
      }
      result.close();
    }
    catch(SQLException e)
    {
      System.out.println(e.toString());
    }
    DbaObj.CloseConnection() ;
  }

  if ( mEditType.compareTo("0")==0)
  {
     mDisabled="disabled";
  }
  else
  {
     mDisabled="";
  }
  mFileName=mRecordID + mFileType;  //取得完整的文档名称
  if (mFileType.compareTo(".doc")==0){
     mWord="";
     mExcel="disabled";
  }
  else
  {
     mWord="disabled";
     mExcel="";
  }
  String filenameStr=mFileName.replace(".","_wh.");
  String namestr=mRecordID+"_wh";
  String saveUrl=mHttpUrl+"upload/govdocumentmanager/"+mFileName.replace(".","_wh.");
  String moduleCode="govdocumentmanager";

      out.write("\r\n<html>\r\n<head>\r\n<title>");
if("1".equals(request.getParameter("showReceiveFile"))){
      out.write("收文查阅");
}else{
      out.write("发文查阅");
}
      out.write("</title>\r\n<link rel='stylesheet' type='text/css' href='test.css'>\r\n<link href=\"/jsoa/style/cssmain.css\" rel=\"stylesheet\" type=\"text/css\">\r\n<link href=\"/jsoa/skin/");
      out.print(session.getAttribute("skin"));
      out.write("/style-");
      out.print(session.getAttribute("browserVersion"));
      out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<SCRIPT language=\"javascript\" src=\"/jsoa/js/openEndow.js\"></SCRIPT>\r\n<script src=\"/jsoa/js/util.js\"></script>\r\n<script language=\"javascript\" for=WebOffice event=\"OnMenuClick(vIndex,vCaption)\">\r\nif (vIndex==1){  //打印文档\r\n\tWebOpenPrint();\r\n}\r\nif(vIndex==2){\r\n     window.open(\"/jsoa/download_s.jsp?");
      out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+filenameStr+"&name="+filenameStr+"&moduleCode=doc_sendfile_showReceiveFile&path=govdocumentmanager"));
      out.write("\", \"myIframe\");\r\n}\r\n</script>\r\n\r\n<script language=javascript for=WebOffice event=OnToolsClick(vIndex,vCaption)>\r\n\r\n\tif (vIndex==1){  //打印文档\r\n\tWebOpenPrint();\r\n\t}\r\n\tif (vIndex==105){WebOpenPrint();}\r\n\tif (vIndex==108){WebExportText();}\r\n\r\n\tif(vIndex==-1&&vCaption=='全屏'){\r\n\tdocument.all.panel3.style.display=\"\";\r\n\t}\r\n\tif (vIndex==-1 && vCaption=='返回'){\r\n\twebform.WebOffice.WebObject.Saved = true;\r\n\tdocument.all.panel3.style.display=\"none\";\r\n\t}\r\n</script>\r\n\r\n<script language=javascript>\r\n/*\r\nform表单名称:webform\r\niWebOffice名称:WebOffice\r\nWebObject文档对象接口，相当于：\r\n如果是Word  文件，WebObject 是Word  VBA的ActiveDocument对象\r\n如果是Excel 文件，WebObject 是Excel VBA的ActiveSheet对象\r\n\r\n如：webform.WebOffice.WebObject\r\n*/\r\n\r\n\r\n//作用：显示操作状态\r\nfunction StatusMsg(mString){\r\n  //StatusBar.innerText=mString;\r\n}\r\n\r\n//作用：载入iWebOffice\r\nfunction Load(){\r\n  //以下属性必须设置，实始化iWebOffice\r\n // opener.window.location.reload();\r\n  webform.WebOffice.WebUrl=\"");
      out.print(mServerUrl);
      out.write("\";    //WebUrl:系统服务器路径，与服务器文件交互操作，如保存、打开文档，重要文件\r\n  webform.WebOffice.RecordID=\"");
      out.print(mRecordID);
      out.write("\";   //RecordID:本文档记录编号\r\n  webform.WebOffice.Template=\"");
      out.print(mTemplate);
      out.write("\";   //Template:模板编号\r\n  webform.WebOffice.FileName=\"");
      out.print(mFileName);
      out.write("\";   //FileName:文档名称\r\n  webform.WebOffice.FileType=\"");
      out.print(mFileType);
      out.write("\";   //FileType:文档类型  .doc  .xls  .wps\r\n  webform.WebOffice.EditType=\"-1,1,0,0,0,0,1\";   //EditType:编辑类型  方式一、方式二  <参考技术文档>\r\n  webform.WebOffice.UserName=\"");
      out.print(mUserName);
      out.write("\";   //UserName:操作用户名，痕迹保留需要\r\n  \r\n    webform.WebOffice.AppendMenu(\"1\",\"打印文档\");\r\n  \twebform.WebOffice.AppendMenu(\"2\",\"下载到本地(&S)\");\r\n  \twebform.WebOffice.WebOpen();  \t //打开该文档    交互OfficeServer  调出文档OPTION=\"LOADFILE\"    调出模板OPTION=\"LOADTEMPLATE\"     <参考技术文档>\r\n //以下属性可以不要\r\n //添加\"1\".equals(SystemCommon.getOfficeopenMyDoc())语句，控制正文预览还是下载\r\n  ");
if(true){
      out.write("\r\n\twebform.WebOffice.ShowMenu=\"1\";//当正文为可下载时显示，显示编辑按钮\r\n  ");
} else{
      out.write("\r\n\twebform.WebOffice.ShowMenu=\"0\";//当正文为预览时，隐藏编辑按钮\r\n\tWebToolsVisible('Standard',false);\r\n\tWebToolsVisible('Formatting',false);\r\n  ");
}
      out.write("\r\n\r\n  //webform.WebOffice.AppendTools(\"105\",\"打印\",2);\r\n  //webform.WebOffice.AppendTools(\"108\",\"导出TEXT\",5);\r\n\r\n\t  //隐藏按钮\r\n  webform.WebOffice.VisibleTools(\"新建文件\",false); //隐藏“新建文件”功能按钮\r\n  webform.WebOffice.VisibleTools(\"打开文件\",false); //隐藏“打开文件”功能按钮\r\n  webform.WebOffice.VisibleTools(\"保存文件\",false);\r\n  webform.WebOffice.VisibleTools(\"文字批注\",false);\r\n  webform.WebOffice.VisibleTools(\"手写批注\",false);\r\n  webform.WebOffice.VisibleTools(\"文档清稿\",false);\r\n  webform.WebOffice.VisibleTools(\"重新批注\",false);\r\n  webform.WebOffice.VisibleTools(\"新建文件;打开文件;保存文件;文字批注;手写批注;文档清稿;重新批注;全屏\",false); //隐藏“新建文件”等功能按钮\r\n  document.all.panel3.style.display=\"\";\r\n}\r\n\r\n//作用：退出iWebOffice\r\nfunction UnLoad(){\r\n  try{\r\n  if (!webform.WebOffice.WebClose()){\r\n     StatusMsg(webform.WebOffice.Status);\r\n  }else{\r\n     StatusMsg(\"关闭文档...\");\r\n  }\r\n  }catch(e){}\r\n}\r\n\r\n//作用：打开文档\r\nfunction LoadDocument(){\r\n  StatusMsg(\"正在打开文档...\");\r\n  if (!webform.WebOffice.WebOpen()){  \t//打开该文档    交互OfficeServer的OPTION=\"LOADFILE\"\r\n     StatusMsg(webform.WebOffice.Status);\r\n  }else{\r\n");
      out.write("     StatusMsg(webform.WebOffice.Status);\r\n  }\r\n}\r\n\r\n\r\n//作用：保存文档（同时生成两份文档，一份为原WORD文档，一份为PGF全文批注文档，用于领导批注使用）\r\nfunction SaveDocument(){\r\n  //webform.WebOffice.WebSetMsgByName(\"MyDefine1\",\"自定义变量值1\");  //设置变量MyDefine1=\"自定义变量值1\"，变量可以设置多个  在WebSave()时，一起提交到OfficeServer中\r\n  if (!webform.WebOffice.WebSave()){    //交互OfficeServer的OPTION=\"SAVEFILE\"\r\n     StatusMsg(webform.WebOffice.Status);\r\n     return false;\r\n  }else{\r\n     if (webform.WebOffice.FileType==\".doc\"){\r\n       webform.WebOffice.WebSavePage();    //交互OfficeServer的OPTION=\"SAVPAGE\"   生成全文批注PGF格式文档，存放服务器目录Document中，文件名RecordID+.pgf 如：3937725762429.pgf\r\n     }\r\n     StatusMsg(webform.WebOffice.Status);\r\n     return true;\r\n  }\r\n}\r\n\r\n//作用：显示或隐藏痕迹  true表示隐藏痕迹  false表示显示痕迹\r\nfunction ShowRevision(mValue){\r\n  if (mValue){\r\n     webform.WebOffice.WebShow(true);\r\n     StatusMsg(\"显示痕迹...\");\r\n  }else{\r\n     webform.WebOffice.WebShow(false);\r\n     StatusMsg(\"隐藏痕迹...\");\r\n  }\r\n}\r\n\r\n\r\n//作用：获取痕迹\r\nfunction WebGetRevisions(){\r\n  var i;\r\n  var Text=\"\";\r\n  for (i = 1;i <= webform.WebOffice.WebObject.Revisions.Count;i++){\r\n");
      out.write("    Text=Text + webform.WebOffice.WebObject.Revisions.Item(i).Author;\r\n    if (webform.WebOffice.WebObject.Revisions.Item(i).Type==\"1\"){\r\n    Text=Text + '插入:'+webform.WebOffice.WebObject.Revisions.Item(i).Range.Text+\"\\r\\n\";\r\n    }else{\r\n    Text=Text + '删除:'+webform.WebOffice.WebObject.Revisions.Item(i).Range.Text+\"\\r\\n\";\r\n    }\r\n  }\r\n  alert(\"痕迹内容：\\r\\n\"+Text);\r\n}\r\n\r\n//作用：刷新文档\r\nfunction WebReFresh(){\r\n  webform.WebOffice.WebReFresh();\r\n  StatusMsg(\"文档已刷新...\");\r\n}\r\n\r\n//作用：打开版本\r\nfunction WebOpenVersion(){\r\n  webform.WebOffice.WebOpenVersion();  \t//交互OfficeServer  列出版本OPTION=\"LISTVERSION\"     调出版本OPTION=\"LOADVERSION\"   <参考技术文档>\r\n  StatusMsg(webform.WebOffice.Status);\r\n}\r\n\r\n//作用：保存版本\r\nfunction WebSaveVersion(){\r\n  webform.WebOffice.WebSaveVersion();  \t//交互OfficeServer的OPTION=\"SAVEVERSION\"\r\n  StatusMsg(webform.WebOffice.Status);\r\n\r\n}\r\n\r\n//作用：保存当前版本\r\nfunction WebSaveVersionByFileID(){\r\n  var mText=window.prompt(\"请输入版本说明:\",\"版本号:V\");\r\n  if (mText==null){\r\n     mText=\"已修改版本.\";\r\n  }\r\n  webform.WebOffice.WebSaveVersionByFileID(mText);  \t//交互OfficeServer的OPTION=\"SAVEVERSION\"  同时带FileID值   <参考技术文档>\r\n");
      out.write("  StatusMsg(webform.WebOffice.Status);\r\n}\r\n\r\n\r\n//作用：填充模板\r\nfunction LoadBookmarks(){\r\n  StatusMsg(\"正在填充模扳...\");\r\n  if (!webform.WebOffice.WebLoadBookmarks()){  \t//交互OfficeServer的OPTION=\"LOADBOOKMARKS\"\r\n     StatusMsg(webform.WebOffice.Status);\r\n  }else{\r\n     StatusMsg(webform.WebOffice.Status);\r\n }\r\n\r\n}\r\n\r\n//作用：标签管理\r\nfunction WebOpenBookMarks(){\r\n  try{\r\n    webform.WebOffice.WebOpenBookmarks();  \t//交互OfficeServer的OPTION=\"LISTBOOKMARKS\"\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：设置书签值  vbmName:标签名称，vbmValue:标签值   标签名称注意大小写\r\nfunction SetBookmarks(vbmName,vbmValue){\r\n  if (!webform.WebOffice.WebSetBookmarks(vbmName,vbmValue)){\r\n     StatusMsg(webform.WebOffice.Status);\r\n  }else{\r\n     StatusMsg(webform.WebOffice.Status);\r\n  }\r\n}\r\n\r\n//作用：根据标签名称获取标签值  vbmName:标签名称\r\nfunction GetBookmarks(vbmName){\r\n  var vbmValue;\r\n  vbmValue=webform.WebOffice.WebGetBookmarks(vbmName);\r\n  return vbmValue;\r\n}\r\n\r\n//作用：打印文档\r\nfunction WebOpenPrint(){\r\n  try{\r\n    webform.WebOffice.WebOpenPrint();\r\n    StatusMsg(webform.WebOffice.Status);\r\n");
      out.write("  }catch(e){}\r\n}\r\n\r\n\r\n//作用：导出Text\r\nfunction WebExportText(){\r\n    var mText=webform.WebOffice.WebObject.Content.Text;\r\n    webform.WebOffice.WebSetMsgByName(\"COMMAND\",\"EXPORTTEXT\");  //设置变量COMMAND=\"EXPORTTEXT\"，在WebSendMessage()时，一起提交到OfficeServer中\r\n    webform.WebOffice.WebSetMsgByName(\"CONTENT\",mText);         //设置变量CONTENT=\"mText\"，在WebSendMessage()时，一起提交到OfficeServer中，可用于实现全文检索功能，对WORD的TEXT内容进行检索\r\n    if (webform.WebOffice.WebSendMessage()){                    //交互OfficeServer的OPTION=\"SENDMESSAGE\"\r\n      alert(\"导出文本成功\");\r\n\t  JSMainWinOpen(\"/jsoa/download.jsp?");
      out.print(com.js.util.util.BASE64.BASE64EncoderNoBR("FileName="+mRecordID+".txt&name="+mRecordID+".txt&moduleCode=doc_sendfile_showReceiveFile&path=govdocumentmanager"));
      out.write("\", \"send\", 'menubar=0,scrollbars=0,locations=0,width=500,height=400,resizable=no,location=no,status=no');    }\r\n    StatusMsg(webform.WebOffice.Status);\r\n}\r\n\r\n//作用：页面设置\r\nfunction WebOpenPageSetup(){\r\n   try{\r\n\tif (webform.WebOffice.FileType==\".doc\"){\r\n\twebform.WebOffice.WebObject.Application.Dialogs(178).Show();\r\n\t}\r\n\tif(webform.WebOffice.FileType==\".xls\"){\r\n\twebform.WebOffice.WebObject.Application.Dialogs(7).Show();\r\n\t}\r\n   }catch(e){}\r\n}\r\n\r\n//作用：插入图片\r\nfunction WebOpenPicture(){\r\n  try{\r\n    webform.WebOffice.WebOpenPicture();\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：签名印章\r\nfunction WebOpenSignature(){\r\n  alert(\"如果您要签章,建议采用iSignature电子签章软件进行签章:\\r\\n下载地址http://www.goldgrid.com/iSignature/Download.asp\\r\\n该软件是支持CA证书和数字签名技术的,\\r\\n是通过了国家公安部认证的电子签章产品!\");\r\n  try{\r\n    webform.WebOffice.WebOpenSignature();  \t//交互OfficeServer的 A签章列表OPTION=\"LOADMARKLIST\"    B签章调出OPTION=\"LOADMARKIMAGE\"    C确定签章OPTION=\"SAVESIGNATURE\"    <参考技术文档>\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：验证印章A\r\n");
      out.write("function WebShowSignature(){\r\n  try{\r\n    webform.WebOffice.WebShowSignature();  \t//交互OfficeServer的OPTION=\"LOADSIGNATURE\"\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：验证印章B\r\nfunction WebCheckSignature(){\r\n  try{\r\n    var i=webform.WebOffice.WebCheckSignature();  \t//交互OfficeServer的OPTION=\"LOADSIGNATURE\"\r\n    alert(\"检测结果：\"+i+\"\\r\\n 注释: (=-1 有非法印章) (=0 没有任何印章) (>=1 有多个合法印章)\");\r\n    StatusMsg(i);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：存为本地文件\r\nfunction WebSaveLocal(){\r\n  try{\r\n   var mFileNames=\"");
      out.print(mFileName.replace(".","_wh."));
      out.write("\";\r\n   webform.WebOffice.FileName=mFileNames;   //FileName:文档名称\r\n   webform.WebOffice.WebSaveLocal();\r\n   document.execCommand('Saveas',false,\"");
      out.print(saveUrl);
      out.write("\");\r\n   StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){\r\n  \talert(e);\r\n  }\r\n}\r\n\r\n//作用：打开本地文件\r\nfunction WebOpenLocal(){\r\n  try{\r\n    webform.WebOffice.WebOpenLocal();\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：保存为HTML文档\r\nfunction WebSaveAsHtml(){\r\n  try{\r\n    if (webform.WebOffice.WebSaveAsHtml())  \t//交互OfficeServer的OPTION=\"SAVEASHTML\"\r\n    {\r\n      webform.HTMLPath.value=\"HTML/");
      out.print(mRecordID);
      out.write(".htm\";\r\n      JSMainWinOpen(\"");
      out.print(mHttpUrl);
      out.write("\"+ webform.HTMLPath.value);\r\n    }\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n\r\n//作用：保存为文档图片\r\nfunction WebSaveAsPage(){\r\n  try{\r\n    if (webform.WebOffice.WebSaveImage())  \t//交互OfficeServer的OPTION=\"SAVEIMAGE\"\r\n    {\r\n      webform.HTMLPath.value=\"HTMLIMAGE/");
      out.print(mRecordID);
      out.write(".htm\";\r\n      JSMainWinOpen(\"");
      out.print(mHttpUrl);
      out.write("\"+ webform.HTMLPath.value);\r\n    }\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n\r\n//作用：关闭或显示工具 参数1表示工具条名称  参数2为false时，表示关闭  （名称均可查找VBA帮助）\r\n//参数2为true时，表示显示\r\nfunction WebToolsVisible(ToolName,Visible){\r\n  try{\r\n    webform.WebOffice.WebToolsVisible(ToolName,Visible);\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n\r\n//作用：禁止或启用工具 参数1表示工具条名称  参数2表示工具条铵钮的编号  （名称和编号均可查找VBA帮助）\r\n//参数3为false时，表示禁止  参数3为true时，表示启用\r\nfunction WebToolsEnable(ToolName,ToolIndex,Enable){\r\n  try{\r\n    webform.WebOffice.WebToolsEnable(ToolName,ToolIndex,Enable);\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：保护与解除  参数1为true表示保护文档  false表示解除保护\r\nfunction WebProtect(value){\r\n  try{\r\n    webform.WebOffice.WebSetProtect(value,\"\");  //\"\"表示密码为空\r\n  }catch(e){}\r\n}\r\n\r\n//作用：允许与禁止拷贝功能  参数1为true表示允许拷贝  false表示禁止拷贝\r\nfunction WebEnableCopy(value){\r\n  try{\r\n    webform.WebOffice.CopyType=value;\r\n  }catch(e){}\r\n}\r\n\r\n\r\n//作用：插入远程服务器图片\r\nfunction WebInsertImage(){\r\n  try{\r\n    webform.WebOffice.WebInsertImage('Image','GoldgridLogo.jpg',true,4);   //交互OfficeServer的OPTION=\"INSERTIMAGE\"  参数1表示标签名称  参数2表示图片文件名  参数3为true透明  false表示不透明  参数4为4表示浮于文字上方  5表示衬于文字下方\r\n");
      out.write("    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n}\r\n\r\n\r\n//作用：下载服务器文件到本地\r\nfunction WebGetFile(){\r\n  if (webform.WebOffice.WebGetFile(\"c:\\\\WebGetFile.doc\",\"DownLoad.doc\")){   //交互OfficeServer的OPTION=\"GETFILE\"  参数1表示本地路径  参数2表示服务器文件名称\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }else{\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }\r\n  alert(webform.WebOffice.Status+\"\\r\\n\"+\"文件放在c:\\\\WebGetFile.doc\");\r\n}\r\n\r\n\r\n//作用：上传本地文件到服务器\r\nfunction WebPutFile(){\r\n  var mLocalFile=webform.WebOffice.WebOpenLocalDialog();\r\n  if (mLocalFile!=\"\"){\r\n    alert(mLocalFile);\r\n    if (webform.WebOffice.WebPutFile(mLocalFile,\"Test.doc\")){   //交互OfficeServer的OPTION=\"PUTFILE\"  参数1表示本地路径，可以任何格式文件  参数2表示服务器文件名称\r\n      StatusMsg(webform.WebOffice.Status);\r\n    }else{\r\n      StatusMsg(webform.WebOffice.Status);\r\n    }\r\n    alert(webform.WebOffice.Status);\r\n  }\r\n}\r\n\r\n\r\n//作用：打开远程文件\r\nfunction WebDownLoadFile(){\r\n  mResult=webform.WebOffice.WebDownLoadFile(\"http://www.goldgrid.com/Images/abc.doc\",\"c:\\\\abc.doc\");\r\n  if (mResult){\r\n    webform.WebOffice.WebOpenLocalFile(\"c:\\\\abc.doc\");\r\n");
      out.write("    alert(\"成功\");\r\n  }else{\r\n    alert(\"失败\");\r\n  }\r\n}\r\n\r\n//作用：表格生成及填充\r\nfunction WebSetWordTable(){\r\n  var mText=\"\",mName=\"\",iColumns,iCells,iTable;\r\n  //设置COMMAND为WORDTABLE\r\n  webform.WebOffice.WebSetMsgByName(\"COMMAND\",\"WORDTABLE\");   //设置变量COMMAND=\"WORDTABLE\"，在WebSendMessage()时，一起提交到OfficeServer中\r\n  //发送到服务器上\r\n  //如果没有错误\r\n  if (webform.WebOffice.WebSendMessage()){                //交互OfficeServer的OPTION=\"SENDMESSAGE\"\r\n\tiColumns = webform.WebOffice.WebGetMsgByName(\"COLUMNS\");  //取得列\r\n\tiCells = webform.WebOffice.WebGetMsgByName(\"CELLS\");      //取得行\r\n\tiTable=webform.WebOffice.WebObject.Tables.Add(webform.WebOffice.WebObject.Application.Selection.Range,iCells,iColumns);   //生成表格\r\n\tfor (var i=1; i<=iColumns; i++)\r\n\t{\r\n   \t  for (var j=1; j<=iCells; j++)\r\n\t  {\r\n\t\tmName=i.toString()+j.toString();\r\n\t\tmText=webform.WebOffice.WebGetMsgByName(mName);\t //取得OfficeServer中的表格内容\r\n\t\tiTable.Columns(i).Cells(j).Range.Text=mText;   \t//填充单元值\r\n\t   }\r\n\t}\r\n   }\r\n   StatusMsg(webform.WebOffice.Status);\r\n}\r\n\r\n\r\n//作用：获取文档Txt正文\r\nfunction WebGetWordContent(){\r\n");
      out.write("  try{\r\n    alert(webform.WebOffice.WebObject.Content.Text);\r\n  }catch(e){}\r\n}\r\n\r\n//作用：写Word内容\r\nfunction WebSetWordContent(){\r\n  var mText=window.prompt(\"请输入内容:\",\"测试内容\");\r\n  if (mText==null){\r\n     return (false);\r\n  }\r\n  else\r\n  {\r\n     //下面为显示选中的文本\r\n     //alert(webform.WebOffice.WebObject.Application.Selection.Range.Text);\r\n     //下面为在当前光标出插入文本\r\n     webform.WebOffice.WebObject.Application.Selection.Range.Text= mText+\"\\n\";\r\n     //下面为在第一段后插入文本\r\n     //webform.WebOffice.WebObject.Application.ActiveDocument.Range(1).Text=(mText);\r\n  }\r\n}\r\n\r\n\r\n//作用：打印黑白文档\r\nfunction WebWordPrintBlackAndWhile(){\r\n   var i,n;\r\n\r\n   //图片变黑白\r\n   i=0;\r\n   n=webform.WebOffice.WebObject.Shapes.Count;\r\n   for (var i=1; i<=n; i++)\r\n   {\r\n      webform.WebOffice.WebObject.Shapes.Item(i).PictureFormat.ColorType=3;\r\n   }\r\n   i=0;\r\n   n=webform.WebOffice.WebObject.InlineShapes.Count;\r\n   for (var i=1; i<=n; i++)\r\n   {\r\n      webform.WebOffice.WebObject.InlineShapes.Item(i).PictureFormat.ColorType=3;\r\n   }\r\n\r\n   //文字变黑白\r\n   webform.WebOffice.WebObject.Application.Selection.WholeStory();\r\n");
      out.write("   webform.WebOffice.WebObject.Application.Selection.Range.Font.Color = 0;\r\n}\r\n\r\n//作用：用Excel求和\r\nfunction WebGetExcelContent(){\r\n    webform.WebOffice.WebObject.Application.Sheets(1).Select;\r\n    webform.WebOffice.WebObject.Application.Range(\"C5\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"126\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C6\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"446\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C7\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"556\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C5:C8\").Select;\r\n    webform.WebOffice.WebObject.Application.Range(\"C8\").Activate;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"=SUM(R[-3]C:R[-1]C)\";\r\n    webform.WebOffice.WebObject.Application.Range(\"D8\").Select;\r\n    alert(webform.WebOffice.WebObject.Application.Range(\"C8\").Text);\r\n}\r\n\r\n\r\n//作用：保护工作表单元\r\nfunction WebSheetsLock(){\r\n");
      out.write("    webform.WebOffice.WebObject.Application.Sheets(1).Select;\r\n\r\n    webform.WebOffice.WebObject.Application.Range(\"A1\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"产品\";\r\n    webform.WebOffice.WebObject.Application.Range(\"B1\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"价格\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C1\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"详细说明\";\r\n    webform.WebOffice.WebObject.Application.Range(\"D1\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"库存\";\r\n    webform.WebOffice.WebObject.Application.Range(\"A2\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"书签\";\r\n    webform.WebOffice.WebObject.Application.Range(\"A3\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"毛笔\";\r\n    webform.WebOffice.WebObject.Application.Range(\"A4\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"钢笔\";\r\n");
      out.write("    webform.WebOffice.WebObject.Application.Range(\"A5\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"尺子\";\r\n\r\n    webform.WebOffice.WebObject.Application.Range(\"B2\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"0.5\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C2\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"樱花\";\r\n    webform.WebOffice.WebObject.Application.Range(\"D2\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"300\";\r\n\r\n    webform.WebOffice.WebObject.Application.Range(\"B3\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"2\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C3\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"狼毫\";\r\n    webform.WebOffice.WebObject.Application.Range(\"D3\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"50\";\r\n\r\n    webform.WebOffice.WebObject.Application.Range(\"B4\").Select;\r\n");
      out.write("    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"3\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C4\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"蓝色\";\r\n    webform.WebOffice.WebObject.Application.Range(\"D4\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"90\";\r\n\r\n    webform.WebOffice.WebObject.Application.Range(\"B5\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"1\";\r\n    webform.WebOffice.WebObject.Application.Range(\"C5\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"20cm\";\r\n    webform.WebOffice.WebObject.Application.Range(\"D5\").Select;\r\n    webform.WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = \"40\";\r\n\r\n    //保护工作表\r\n    webform.WebOffice.WebObject.Application.Range(\"B2:D5\").Select;\r\n    webform.WebOffice.WebObject.Application.Selection.Locked = false;\r\n    webform.WebOffice.WebObject.Application.Selection.FormulaHidden = false;\r\n    webform.WebOffice.WebObject.Application.ActiveSheet.Protect(true,true,true);\r\n");
      out.write("\r\n    alert(\"已经保护工作表，只有B2-D5单元格可以修改。\");\r\n}\r\n\r\n//作用：VBA套红\r\nfunction WebInsertVBA(){\r\n\r\n\t//画线\r\n\tvar object=webform.WebOffice.WebObject;\r\n\tvar myl=object.Shapes.AddLine(100,60,305,60)\r\n\tmyl.Line.ForeColor=255;\r\n\tmyl.Line.Weight=2;\r\n\tvar myl1=object.Shapes.AddLine(326,60,520,60)\r\n\tmyl1.Line.ForeColor=255;\r\n\tmyl1.Line.Weight=2;\r\n\r\n\t//object.Shapes.AddLine(200,200,450,200).Line.ForeColor=6;\r\n   \tvar myRange=webform.WebOffice.WebObject.Range(0,0);\r\n\tmyRange.Select();\r\n\r\n\tvar mtext=\"★\";\r\n\twebform.WebOffice.WebObject.Application.Selection.Range.InsertAfter (mtext+\"\\n\");\r\n   \tvar myRange=webform.WebOffice.WebObject.Paragraphs(1).Range;\r\n   \tmyRange.ParagraphFormat.LineSpacingRule =1.5;\r\n   \tmyRange.font.ColorIndex=6;\r\n   \tmyRange.ParagraphFormat.Alignment=1;\r\n   \tmyRange=webform.WebOffice.WebObject.Range(0,0);\r\n\tmyRange.Select();\r\n\tmtext=\"金格发[２００３]１５４号\";\r\n\twebform.WebOffice.WebObject.Application.Selection.Range.InsertAfter (mtext+\"\\n\");\r\n\tmyRange=webform.WebOffice.WebObject.Paragraphs(1).Range;\r\n\tmyRange.ParagraphFormat.LineSpacingRule =1.5;\r\n");
      out.write("\tmyRange.ParagraphFormat.Alignment=1;\r\n\tmyRange.font.ColorIndex=1;\r\n\r\n\tmtext=\"金格电子政务文件\";\r\n\twebform.WebOffice.WebObject.Application.Selection.Range.InsertAfter (mtext+\"\\n\");\r\n\tmyRange=webform.WebOffice.WebObject.Paragraphs(1).Range;\r\n\tmyRange.ParagraphFormat.LineSpacingRule =1.5;\r\n\r\n\t//myRange.Select();\r\n\tmyRange.Font.ColorIndex=6;\r\n\tmyRange.Font.Name=\"仿宋_GB2312\";\r\n\tmyRange.font.Bold=true;\r\n\tmyRange.Font.Size=50;\r\n\tmyRange.ParagraphFormat.Alignment=1;\r\n\r\n\t//myRange=myRange=webform.WebOffice.WebObject.Paragraphs(1).Range;\r\n\twebform.WebOffice.WebObject.PageSetup.LeftMargin=70;\r\n\twebform.WebOffice.WebObject.PageSetup.RightMargin=70;\r\n\twebform.WebOffice.WebObject.PageSetup.TopMargin=70;\r\n\twebform.WebOffice.WebObject.PageSetup.BottomMargin=70;\r\n}\r\n\r\n//作用：套用模版定稿\r\nfunction WebInsertFile(){\r\n\tvar mDialogUrl = \"Template/TemplateForm.jsp\";\r\n  var mObject = new Object();\r\n  mObject.Template = \"\";\r\n  window.showModalDialog(mDialogUrl, mObject, \"dialogHeight:200px; dialogWidth:360px;center:yes;scroll:no;status:no;\");\r\n\r\n  //判断用户是否选择模板\r\n");
      out.write("  if (mObject.Template==\"\"){\r\n    StatusMsg(\"取消套用模\");\r\n    return false;\r\n  }else{\r\n    SaveDocument();    //保存当前编辑的文档\r\n    webform.WebOffice.WebSetMsgByName(\"COMMAND\",\"INSERTFILE\");   //设置变量COMMAND=\"INSERTFILE\"，在WebLoadTemplate()时，一起提交到OfficeServer中     <参考技术文档>\r\n    webform.WebOffice.Template=mObject.Template;                 //全局变量Template赋值，此示例读取服务器目录中模板，如读取数据库中模板，Template值为数据库中的模板编号，则上句代码不需要，如Template=\"1050560363767\"，模板名称为“Word公文模板”，注：模板中有要标签Content，区分大小写，可以自行修改\r\n    if (webform.WebOffice.WebLoadTemplate()){                    //交互OfficeServer的OPTION=\"LOADTEMPLATE\"\r\n       //SetBookmarks(\"Title\",\"关于中间件研发工作会议通知\");     //填充模板其它基本信息，如标题，主题词，文号，主送机关等\r\n       if (webform.WebOffice.WebInsertFile()){                   //填充公文正文   交互OfficeServer的OPTION=\"INSERTFILE\"\r\n         StatusMsg(webform.WebOffice.Status);\r\n       }else{\r\n         StatusMsg(webform.WebOffice.Status);\r\n       }\r\n    }else{\r\n       StatusMsg(webform.WebOffice.Status);\r\n    }\r\n  }\r\n}\r\n\r\n//作用：保存定稿文件\r\nfunction WebUpdateFile(){\r\n  if (webform.WebOffice.WebUpdateFile()){                //交互OfficeServer的OPTION=\"UPDATEFILE\"，类似WebSave()或WebSaveVersion()方法\r\n");
      out.write("     StatusMsg(webform.WebOffice.Status);\r\n  }else{\r\n     StatusMsg(webform.WebOffice.Status);\r\n  }\r\n}\r\n\r\n//作用：导入Text\r\nfunction WebInportText(){\r\n\r\n    var mText;\r\n    webform.WebOffice.WebSetMsgByName(\"COMMAND\",\"INPORTTEXT\");  //设置变量COMMAND=\"INPORTTEXT\"，在WebSendMessage()时，一起提交到OfficeServer中\r\n    if (webform.WebOffice.WebSendMessage()){                    //交互OfficeServer的OPTION=\"SENDMESSAGE\"\r\n      mText=webform.WebOffice.WebGetMsgByName(\"CONTENT\");       //取得OfficeServer传递的变量CONTENT值\r\n      webform.WebOffice.WebObject.Application.Selection.Range.Text=mText;\r\n      alert(\"导入文本成功\");\r\n    }\r\n    StatusMsg(webform.WebOffice.Status);\r\n}\r\n\r\n\r\n\r\n//作用：获取文档页数\r\nfunction WebDocumentPageCount(){\r\n    if (webform.WebOffice.FileType==\".doc\"){\r\n\tvar intPageTotal;\r\n\tintPageTotal = webform.WebOffice.WebObject.Application.ActiveDocument.BuiltInDocumentProperties(14);\r\n\talert(\"文档页总数：\"+intPageTotal);\r\n    }\r\n    if (webform.WebOffice.FileType==\".wps\"){\r\n\tvar intPageTotal;\r\n\tintPageTotal = webform.WebOffice.WebObject.PagesCount();\r\n");
      out.write("\talert(\"文档页总数：\"+intPageTotal);\r\n    }\r\n}\r\n\r\n//作用：签章锁定文件功能\r\nfunction WebSignatureAtReadonly(){\r\n  webform.WebOffice.WebSetProtect(false,\"\");                  //解除文档保护\r\n  webform.WebOffice.WebSetRevision(false,false,false,false);  //设置文档痕迹保留的状态  参数1:不显示痕迹  参数2:不保留痕迹  参数3:不打印时有痕迹  参数4:不显痕迹处理工具\r\n  try{\r\n    webform.WebOffice.WebOpenSignature();                     //交互OfficeServer的 A签章列表OPTION=\"LOADMARKLIST\"    B签章调出OPTION=\"LOADMARKIMAGE\"    C确定签章OPTION=\"SAVESIGNATURE\"    <参考技术文档>    文档中要定义标签Manager，可以自行修改标签名称\r\n    StatusMsg(webform.WebOffice.Status);\r\n  }catch(e){}\r\n  webform.WebOffice.WebSetProtect(true,\"\");                   //锁定文档\r\n\r\n}\r\n\r\n//self.moveTo(0,0);\r\n//self.resizeTo(screen.availWidth,screen.availHeight);\r\n\r\n</script>\r\n\r\n\r\n</head>\r\n<body bgcolor=\"#ffffff\" onLoad=\"Load();\"  onunload=\"UnLoad()\" >  <!--引导和退出iWebOffice-->\r\n\r\n  <form name=\"webform\" method=\"post\" action=\"\" >  <!--保存iWebOffice后提交表单信息-->\r\n    <input type=\"hidden\" name=\"RecordID\" value=\"");
      out.print(mRecordID);
      out.write("\">\r\n    <input type=\"hidden\" name=\"Template\" value=\"");
      out.print(mTemplate);
      out.write("\">\r\n    <input type=\"hidden\" name=\"FileType\" value=\"");
      out.print(mFileType);
      out.write("\">\r\n    <input type=\"hidden\" name=\"EditType\" value=\"");
      out.print(mEditType);
      out.write("\">\r\n    <input type=\"hidden\" name=\"HTMLPath\" value=\"");
      out.print(mHTMLPath);
      out.write("\">\r\n<!-- <button onclick=\"WebSaveLocal();\">保存正文</button>&nbsp;<button onclick=\"WebOpenPrint();\">打印正文</button> -->\r\n<table width=\"100%\" height=\"95%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n   <tr>\r\n    <td valign=\"top\" width=\"100%\" height=\"100%\">\r\n\t<div id=\"panelFrame\" align=\"center\"  style=\"height:100%;width:100%;\">\r\n    <table border=0  cellspacing='0' cellpadding='0' width=\"100%\" height=\"100%\" align=\"center\" class=\"TBStyle\">\r\n      \r\n      <tr>        \r\n        <td class=\"TDStyle\" height=95% width=\"100%\">\r\n           <table border=0 cellspacing='0' cellpadding='0' width='100%' height='100%' align=\"center\" >\r\n             <tr>\r\n                <td bgcolor=menu width=\"100%\" height=\"100%\"><!--调用iWebOffice，注意版本号，可用于升级-->\r\n                  \r\n                <div  id=\"panel3\" style=\"height:100%;width:100%;\">\r\n                <OBJECT id=\"WebOffice\" width=\"100%\" height=\"100%\" classid=\"clsid:");
      out.print(objClassId );
      out.write("\" codebase=\"");
      out.print(mClientUrl);
      out.write("\" >\r\n                  </OBJECT>\r\n                </div>\r\n                </td>\r\n             </tr>             \r\n           </table>\r\n        </td>\r\n      </tr>\r\n\t  </table>\r\n    </div>\r\n    </td>\r\n   </tr>\r\n</table>\r\n</form>\r\n\r\n<iframe name=\"myIframe\" id=\"myIframe\" style=\"display:none;\"></iframe>\r\n</body>\r\n</html>\r\n<script src=\"/jsoa/js/util.js\"></script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
