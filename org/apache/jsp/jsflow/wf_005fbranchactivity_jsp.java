/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 10:08:00 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.jsflow;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.oa.jsflow.util.ProcessStep;
import com.js.util.config.SystemCommon;
import com.js.util.util.BrowserJudge;
import com.js.lang.Resource;
import java.sql.*;

public final class wf_005fbranchactivity_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {


/**
  * 得到中间节点的办理人情况
  * executor[0]: 选定的用户ID
  * executor[1]: 选定的用户名
  * executor[2]: 执行人类型
  * executor[3]: 执行人从表单中字段选择的时候，指定的字段名
  * executor[4]: 从范围中选择的时候 指定的范围
  */  
private String[] getActivityExecutor(
		String tableId,String recordId,String activityId,String curActivityId,
		String userId,String orgId,String orgIdString,
		String submitPersonId,String standForUserId,String tranFromPersonId
		){
	String[] executor={"","","","",""};
	com.js.oa.jsflow.service.WorkFlowButtonBD workFlowButtonBD = new com.js.oa.jsflow.service.WorkFlowButtonBD();
	com.js.oa.jsflow.service.WorkFlowBD workFlowBD = new com.js.oa.jsflow.service.WorkFlowBD();
	String[] nextUser = workFlowBD.getProcActiUser(tableId,recordId,activityId);
	int participantType=-1;
	String participantUserField="";
	String selectUser = "";//待选人员
	String selectUserName = "";//待选人员
	String range="",show="";
	
	Connection conn=null;
	Statement stmt=null;
	ResultSet rs=null;
	
	try{
		conn=new com.js.util.util.DataSourceBase().getDataSource().getConnection();
		stmt=conn.createStatement();
		
		if(nextUser[0]!=null){
			participantType=Integer.parseInt(nextUser[0]);
			java.util.List candidate;
			java.util.List leaderList = null;
			Object[] tmp;
			switch(participantType){
			case 3:
				//指定全部办理人
				candidate = workFlowBD.getCandidateSeq(nextUser[1],nextUser[3]);
				for(int i=0;i<candidate.size();i++){
					tmp = (Object[])candidate.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
		
			case 2:
				//从候选人中指定
				candidate = workFlowBD.getCandidateSeq(nextUser[1],nextUser[3]);
				for(int i=0;i<candidate.size();i++){
					tmp = (Object[])candidate.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
		
			case 4:
				//由表单中的某个字段值决定
				participantUserField = nextUser[4];
				participantUserField = workFlowButtonBD.getFieldInfoByFieldId(participantUserField);		
				break;
		
			case 8:
				//从指定范围中选定
				range = nextUser[22].toString();
				show="user";
				
				if(range != null && !range.equals("") && range.indexOf("@") >= 0){
					show+="group";
				}
				if(range != null && !range.equals("") && range.indexOf("*") >= 0){
					show+="org";
				}
				break;
		
			case 9:
				//由上一节点参与者从所在组织中选择
				//range = "*"+session.getAttribute("orgId")+"*";
				String sidelineOrg = workFlowButtonBD.getUserSideLineOrgId(userId)==null?"":workFlowButtonBD.getUserSideLineOrgId(userId);
			    range = "*"+orgId+"*"+sidelineOrg;
		
				show += "user";
				break;
		
			case 10:
				//组织领导
				range = "*"+orgId+"*";
				show += "org";
				break;
				
			case 1:
				//由上一节点参与者从所有用户中选择
				// show += "user";
				// 与指定范围相同的处理（范围为全部*0*）   从指定范围中选定
				range = "*0*";
				show="userorggroup";
					
				break;
		
			/*case 11:
				//上一节点所有参与者
				vo.setProcessId(Long.valueOf(processId));
				vo.setTableId(Long.valueOf(tableId));
				vo.setRecordId(Long.valueOf(recordId));
				vo.setActivity(Long.valueOf(curActivityId));
		
				candidate = workFlowButtonBD.getFrontActivityOper(vo);
				for(int i=0;i<candidate.size();i++){
					tmp = (Object[])candidate.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;*/
		
			case 7:
				//上一节点办理人的上级领导
				//确定当前办理人，如果有待办或转办应该以最初制定的执行人为准
				if(standForUserId==null || "null".equals(standForUserId) || "0".equals(standForUserId)){
					if(tranFromPersonId!=null && !"null".equals(tranFromPersonId) && !"".equals(tranFromPersonId) && !"-1".equals(tranFromPersonId)){
				        
						//判断转办人是否还有转办人
						String tranFromPersonIdTemp=tranFromPersonId;
				        while(!"".equals(tranFromPersonId)){                	
				        	rs=stmt.executeQuery("select tranfrompersonid from jsf_work where wf_curemployee_id="+tranFromPersonId+" and initactivity="+curActivityId+" and workrecord_id="+recordId+" and worktable_id="+tableId);
				        	if(rs.next()){
				        		tranFromPersonId=rs.getString(1);
				        	}
				        	rs.close();
				        	
				        	if(tranFromPersonId==null || "null".equals(tranFromPersonId)){
				        		tranFromPersonId="";
				        	}else{
				        		tranFromPersonIdTemp=tranFromPersonId;
				        	}                	
				        }
				        
				        tranFromPersonId=tranFromPersonIdTemp;    
					}
					
					//转办判断
					if(!"".equals(tranFromPersonId)){
						leaderList = workFlowBD.getLeaderList(tranFromPersonId);
					}else{
						leaderList = workFlowBD.getLeaderList(userId);
					}
				} else{
					//有代办人的情况
					leaderList = workFlowBD.getLeaderList(standForUserId);
				}
				for(int i=0;i<leaderList.size();i++){
					tmp = (Object[])leaderList.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
		
			case 0:
				//流程发起人的上级领导 
				leaderList = workFlowBD.getLeaderList(submitPersonId);
		
				for(int i=0;i<leaderList.size();i++){
					tmp = (Object[])leaderList.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
		
			case 5:
				//流程发起人
				selectUser = submitPersonId;
				selectUserName = new com.js.system.service.usermanager.UserBD().getUserNameById(submitPersonId);
				break;
		
			case 6:
				//从角色中指定 		
				//确定当前办理人，如果有待办或转办应该以最初制定的执行人为准
				String currentUserId=userId;
				
				if(standForUserId==null || "null".equals(standForUserId) || "0".equals(standForUserId)){
					
					if(tranFromPersonId!=null && !"null".equals(tranFromPersonId) && !"".equals(tranFromPersonId) && !"-1".equals(tranFromPersonId)){
				        
						//判断转办人是否还有转办人
						String tranFromPersonIdTemp=tranFromPersonId;
				        while(!"".equals(tranFromPersonId)){                	
				        	rs=stmt.executeQuery("select tranfrompersonid from jsf_work where wf_curemployee_id="+tranFromPersonId+" and initactivity="+curActivityId+" and workrecord_id="+recordId+" and worktable_id="+tableId);
				        	if(rs.next()){
				        		tranFromPersonId=rs.getString(1);
				        	}
				        	rs.close();
				        	
				        	if(tranFromPersonId==null || "null".equals(tranFromPersonId)){
				        		tranFromPersonId="";
				        	}else{
				        		tranFromPersonIdTemp=tranFromPersonId;
				        	}                	
				        }
				        
				        tranFromPersonId=tranFromPersonIdTemp;
					}
					
					//转办判断
					if(!"".equals(tranFromPersonId)){
						currentUserId = tranFromPersonId;
					}
				} else{
					//有代办人的情况
					currentUserId=standForUserId;
				}
				
				candidate = workFlowBD.getRoleUserIDAndName(nextUser[18], submitPersonId+";"+currentUserId);
				for(int i=0;i<candidate.size();i++){
					tmp = (Object[])candidate.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
			case 15:
				//从岗位中指定 
				//确定当前办理人，如果有待办或转办应该以最初制定的执行人为准
				currentUserId=userId;
				
				if(standForUserId==null || "null".equals(standForUserId) || "0".equals(standForUserId)){
					
					if(tranFromPersonId!=null && !"null".equals(tranFromPersonId) && !"".equals(tranFromPersonId) && !"-1".equals(tranFromPersonId)){
				        				
						//判断转办人是否还有转办人
						String tranFromPersonIdTemp=tranFromPersonId;
				        while(!"".equals(tranFromPersonId)){                	
				        	rs=stmt.executeQuery("select tranfrompersonid from jsf_work where wf_curemployee_id="+tranFromPersonId+" and initactivity="+curActivityId+" and workrecord_id="+recordId+" and worktable_id="+tableId);
				        	if(rs.next()){
				        		tranFromPersonId=rs.getString(1);
				        	}
				        	rs.close();
				        	
				        	if(tranFromPersonId==null || "null".equals(tranFromPersonId)){
				        		tranFromPersonId="";
				        	}else{
				        		tranFromPersonIdTemp=tranFromPersonId;
				        	}                	
				        }
				        
				        tranFromPersonId=tranFromPersonIdTemp;
					}
					
					//转办判断
					if(!"".equals(tranFromPersonId)){
						currentUserId = tranFromPersonId;
					}
				} else{
					//有代办人的情况
					currentUserId=standForUserId;
				}
				candidate = workFlowBD.getPositionUserIDAndName(nextUser[18], submitPersonId+";"+currentUserId);
				for(int i=0;i<candidate.size();i++){
					tmp = (Object[])candidate.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
		
			case 14:
				//流程发起人上级组织 并且 职务级别
				candidate = workFlowButtonBD.getLeaderByDutyLevelAndOrg(submitPersonId,nextUser[18]);
				for(int i=0;i<candidate.size();i++){
					tmp = (Object[])candidate.get(i); 
					selectUser += tmp[0]+",";
					selectUserName += tmp[1]+",";
					range+="$"+tmp[0]+"$";
				}
				if(selectUser.indexOf(",")!=-1){
					selectUser = selectUser.substring(0,selectUser.length()-1);
					selectUserName = selectUserName.substring(0,selectUserName.length()-1);
				}
				break;
			}//end switch
		}
		stmt.close();
		conn.close();
	}catch(Exception ex){
		if(conn!=null){
			try{
				conn.close();
			}catch(Exception err){
				err.printStackTrace();
			}
		}
	}
	executor[0]=selectUser;
	executor[1]=selectUserName;
	executor[2]=String.valueOf(participantType);
	executor[3]=participantUserField;
	executor[4]=range;
	return executor;
}

/**
 * 得到开始节点的办理人情况
 */  
private String[] getFirstActivityExecutor(String activityId,String userId,String userName,String orgId,String orgIdString){
	String[] executor={"","","","",""};
	com.js.oa.jsflow.service.WorkFlowButtonBD workFlowButtonBD = new com.js.oa.jsflow.service.WorkFlowButtonBD();
	com.js.oa.jsflow.service.WorkFlowBD workFlowBD = new com.js.oa.jsflow.service.WorkFlowBD();
	com.js.oa.jsflow.vo.ActivityVO activityVO =workFlowBD.getFirstProcActiVO(activityId);
	int participantType = activityVO.getParticipantType();
		
	//表单字段参数
	String participantUserField = "";//表单中的某个字段名
	
	String selectUser = "";//待选人员
	String selectUserName = "";//待选人员
	String range="",show="";
	
	Connection conn=null;
	Statement stmt=null;
	ResultSet rs=null;
	
	try{
		conn=new com.js.util.util.DataSourceBase().getDataSource().getConnection();
		stmt=conn.createStatement();
		
		java.util.List candidate;
		java.util.List leaderList = null;
		Object[] tmp;
				
		switch(participantType){
		case 3:
			//指定全部办理人
			candidate = activityVO.getParticipantUser();
			for(int i=0;i<candidate.size();i++){
				tmp = (Object[])candidate.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			break;
		case 2:
			//从候选人中指定
			candidate = activityVO.getParticipantUser();
			for(int i=0;i<candidate.size();i++){
				tmp = (Object[])candidate.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			
			break;
		case 4:
			//由表单中的某个字段值决定
			participantUserField = activityVO.getParticipantUserField();
			participantUserField = workFlowButtonBD.getFieldInfoByFieldId(participantUserField);
			break;
		case 8:
			//从指定范围中选定
			range = activityVO.getParticipantGivenOrg();
			
			show="user";
			if(range != null && !range.equals("") && range.indexOf("@") >= 0){
				show+="group";
			}
			if(range != null && !range.equals("") && range.indexOf("*") >= 0){
				show+="org";
			}
			break;
		case 9:
			//由上一节点参与者从所在组织中选择
			String sidelineOrg = workFlowButtonBD.getUserSideLineOrgId(userId)==null?
					"":workFlowButtonBD.getUserSideLineOrgId(userId);
			range = "*"+orgId+"*"+sidelineOrg;
			show += "user";
			break;
		case 10:
			//组织领导
			range = "*"+orgId+"*";
			show += "org";
			break;		
		case 1:
			//由上一节点参与者从所有用户中选择
			// show += "user";
			// 与指定范围相同的处理（范围为全部*0*）   从指定范围中选定
			range = "*0*";
			show="userorggroup";
			break;
		case 11:
			//上一节点所有参与者 
			selectUser = userId;
			selectUserName = userName;
			break;
		case 7:
			//上一节点办理人的上级领导
			leaderList = new com.js.oa.jsflow.service.WorkFlowBD().getLeaderList(userId);

			for(int i=0;i<leaderList.size();i++){
				tmp = (Object[])leaderList.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			break;
		case 0:
			//流程发起人的上级领导 
			leaderList = new com.js.oa.jsflow.service.WorkFlowBD().getLeaderList(userId);

			for(int i=0;i<leaderList.size();i++){
				tmp = (Object[])leaderList.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			break;
		case 5:
			//流程发起人
			selectUser = userId;
			selectUserName = userName;
			break;
		case 6:
			//从角色中指定 
			candidate = workFlowBD.getRoleUserIDAndName(activityVO.getPartRole(), userId);
			for(int i=0;i<candidate.size();i++){
				tmp = (Object[])candidate.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			break;
		case 15:
			//从岗位中指定 
			candidate = workFlowBD.getPositionUserIDAndName(activityVO.getPartRole(), userId);
			for(int i=0;i<candidate.size();i++){
				tmp = (Object[])candidate.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			break;
		case 14:
			//流程发起人上级组织 并且 职务级别
			candidate = workFlowButtonBD.getLeaderByDutyLevelAndOrg(userId,activityVO.getPartRole());
			for(int i=0;i<candidate.size();i++){
				tmp = (Object[])candidate.get(i); 
				selectUser += tmp[0]+",";
				selectUserName += tmp[1]+",";
				range+="$"+tmp[0]+"$";
			}
			if(selectUser.indexOf(",")!=-1){
				selectUser = selectUser.substring(0,selectUser.length()-1);
				selectUserName = selectUserName.substring(0,selectUserName.length()-1);
			}
			break;
		}//end switch
		
		stmt.close();
		conn.close();
	}catch(Exception ex){
		if(conn!=null){
			try{
				conn.close();
			}catch(Exception err){
				err.printStackTrace();
			}
		}
	}
	executor[0]=selectUser;
	executor[1]=selectUserName;
	executor[2]=String.valueOf(participantType);
	executor[3]=participantUserField;
	executor[4]=range;
	return executor;
}

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-bean.tld", Long.valueOf(1499751390000L));
  }

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("java.sql");
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.oa.jsflow.util.ProcessStep");
    _jspx_imports_classes.add("com.js.lang.Resource");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("com.js.util.util.BrowserJudge");
  }

  private org.apache.jasper.runtime.TagHandlerPool _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody;

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
    _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody = org.apache.jasper.runtime.TagHandlerPool.getTagHandlerPool(getServletConfig());
  }

  public void _jspDestroy() {
    _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.release();
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n");
      out.write('\r');
      out.write('\n');

String local = session.getAttribute("org.apache.struts.action.LOCALE").toString();
//System.out.println("---------------------");
request.setCharacterEncoding("GBK");

response.setHeader("Cache-Control","no-store");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", 0);

//流程类型(业务流程1，随机流程0)
String processType = request.getParameter("processType");

//参数信息
String type = request.getParameter("type");//是否开始节点
String submitPersonId = request.getParameter("submitPersonId");
String moduleId = request.getParameter("moduleId");
String processId = request.getParameter("processId");
String tableId = request.getParameter("tableId");
String recordId = request.getParameter("recordId");
String curActivityId = request.getParameter("activityId");//当前节点
if(!"0".equals(request.getParameter("workPrarllelCurActId"))){
	curActivityId=request.getParameter("workPrarllelCurActId");
}
String activityId = "0";//用户选择的节点后继
String msgFrom = request.getParameter("msgFrom");

String activityIds = request.getParameter("activityIds")!=null&&request.getParameter("activityIds").length()>0
				?request.getParameter("activityIds").substring(1):"";
//System.out.println("-------------------"+activityIds);

String standForUserId = request.getParameter("standForUserId");//代办人ID
String standForUserName = request.getParameter("standForUserName");//代办人
String tranFromPersonId = request.getParameter("tranFromPersonId");//转办人


com.js.oa.jsflow.service.WorkFlowBD workFlowBD = new com.js.oa.jsflow.service.WorkFlowBD();
com.js.oa.jsflow.service.WorkFlowButtonBD workFlowButtonBD = new com.js.oa.jsflow.service.WorkFlowButtonBD();

//默认选择用户
java.util.List selectUser = new java.util.ArrayList();

//表单字段参数
String participantUserField = "";//表单中的某个字段名

//显示短信
boolean showSmsRemind = false;

ProcessStep processStep = new ProcessStep();
//后继节点
com.js.oa.jsflow.vo.ActivityVO activityVO = null;
long firstActivityId=-1;
java.util.List activityList = new java.util.ArrayList();
if(!"0".equals(processType)){
 if("getFirstActivity".equals(type)){
	/*开始节点 第一个虚拟节点后的所有节点*/	   
	activityList = workFlowBD.getFirstAllNextActivity(request.getParameter("activityIds"));
  }else{
	    /*中间节点*/
	    
	    //下一节点的选择类型（用户决定还是流程决定）
        String stepType = workFlowBD.getActivityType(curActivityId,tableId,recordId);
	    
	    //2010-05-13 取得下一个节点的类型，判断是否虚拟节点
	    String activityClass=workFlowBD.getNextActivityClass(curActivityId,tableId,recordId,"");
	    if(!activityClass.equals("0")){
	    	//虚拟节点 activityClass不为0时即下一个节点的activityId
	    	//activityVO = new com.js.oa.jsflow.util.ProcessStep().getProceedNextActi(activityClass, tableId, recordId, request);
	    	if(!"".equals(activityIds)){
				activityVO = processStep.getProceedNextActi(moduleId, processId, activityIds, tableId, recordId, activityClass);
			}
			if(activityVO==null){
			
      out.write("\r\n\t\t\t<SCRIPT LANGUAGE=\"JavaScript\">\r\n\t\t\t<!--\r\n\t\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.nosuitnextactivity"));
      out.write("\");\r\n\t\t\twindow.close();\r\n\t\t\t//-->\r\n\t\t\t</SCRIPT>\r\n\t\t\t");

			} else{
				activityVO.setBeginEnd(activityVO.getActivityBeginEnd());
				activityList.add(activityVO);
			}
	    }else if(stepType.equals("0")){	    	
	    	//流程决定走向	    	
			//activityVO = new com.js.oa.jsflow.util.ProcessStep().getProceedNextActi(curActivityId, tableId, recordId, request);
			if(!"".equals(activityIds)){
				activityVO = processStep.getProceedNextActi(moduleId, processId, activityIds, tableId, recordId, activityClass);
			}
	    	if(activityVO==null){
			
      out.write("\r\n\t\t\t<SCRIPT LANGUAGE=\"JavaScript\">\r\n\t\t\t<!--\r\n\t\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.nosuitnextactivity"));
      out.write("\");\r\n\t\t\twindow.close();\r\n\t\t\t//-->\r\n\t\t\t</SCRIPT>\r\n\t\t\t");

			} else{
				activityVO.setBeginEnd(activityVO.getActivityBeginEnd());
				activityList.add(activityVO);
			}
	    }else{
	    	//用户决定走向
	    	if(!"".equals(activityIds)){
				activityVO = processStep.getProceedNextActi(moduleId, processId, activityIds, tableId, recordId, activityClass);
				activityList.add(activityVO);
			}else{
				activityList = workFlowBD.getAllNextActivity(tableId, recordId, curActivityId);
				if(activityList.size()==0){
				
      out.write("\r\n\t\t\t\t<SCRIPT LANGUAGE=\"JavaScript\">\r\n\t\t\t\t<!--\r\n\t\t\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.nosetupnextactivity"));
      out.write("\");\r\n\t\t\t\twindow.close();\r\n\t\t\t\t//-->\r\n\t\t\t\t</SCRIPT>\r\n\t\t\t\t");

				}
			}
	    }    
		
  }
}


//默认选择用户
com.js.oa.jsflow.service.WorkFlowButtonBD wfbbd = new com.js.oa.jsflow.service.WorkFlowButtonBD();

String selectUserId="";
String selectUserName="";


      out.write("\r\n\r\n<html>\r\n<head>\r\n\r\n<title>");
      out.print(Resource.getValue(local,"filetransact","file.send"));
      out.write("</title>\r\n<link href=\"/jsoa/skin/");
      out.print(session.getAttribute("skin"));
      out.write("/style-");
      out.print(session.getAttribute("browserVersion"));
      out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<script src=\"/jsoa/js/js.js\" language=\"javascript\"></script>\r\n<SCRIPT language=\"javascript\" src=\"/jsoa/js/openEndow.js\"></SCRIPT>\r\n<link rel=stylesheet type=\"text/css\" href=\"/jsoa/public/date_picker/DateObject2.css\">\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/DateObject.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/DatePicker.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/editlib.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/tree.js\"></SCRIPT>\r\n<base target=\"_self\">\r\n</head>\r\n<body scroll=\"no\" onLoad=\"resizeWin(580,540);init();\">\r\n<table width=\"100%\"  id=\"pup_main\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"height:8%;\">\r\n  <tr valign=\"bottom\">\r\n    <td nowrap><span id=\"Panle0\" onClick=\"changePanle(0);\" style=\"color:red;cursor:pointer;padding-left:15px;\">选择节点</span>\r\n\t</td>\r\n  </tr>  \r\n</table>\r\n\r\n\r\n<div id=\"docinfo0\" style=\"display:;\">\r\n\r\n<table valign=\"top\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#E6EFF8;padding-left:5px;padding-right:3px;width:100%;");
if(!"0".equals(processType)){ 
      out.write("height:92%;");
}else{ 
      out.write("height:100%;");
} 
      out.write("\">\r\n  \r\n  ");

  String activityName,activityNameTitle;
  long tmpActivityId;
  for(int j = 0; j < activityList.size(); j ++){
		activityVO = (com.js.oa.jsflow.vo.ActivityVO) activityList.get(j);
		if(activityVO.getBeginEnd() == 2){
			//可选择的节点中包含结束节点
			activityVO.setId(Long.parseLong("2"));
			activityVO.setName("结束节点");
		}
		
		tmpActivityId=activityVO.getId();
		activityName=activityVO.getName()==null?"":activityVO.getName();
		activityNameTitle=activityName;
		if(activityName.length()>10){
			activityName=activityName.substring(0,8)+"..";
		}
		String[] executors;
		if("getFirstActivity".equals(type)){
			executors=getFirstActivityExecutor(String.valueOf(tmpActivityId),
					session.getAttribute("userId").toString(),
					session.getAttribute("userName").toString(),
					session.getAttribute("orgId").toString(),
					session.getAttribute("orgIdString").toString()
					);
		}else{
			executors=getActivityExecutor(		
				tableId,recordId,String.valueOf(tmpActivityId),curActivityId,
				session.getAttribute("userId").toString(),session.getAttribute("orgId").toString(),session.getAttribute("orgIdString").toString(),
				submitPersonId,standForUserId,tranFromPersonId
				);
		}
		
      out.write("\r\n\t\t<tr height=\"40\">\r\n\t\t  \t<td align=\"right\" valign=\"middle\" width=\"30\"><input type=\"checkbox\" name=\"actId\" checked value=\"");
      out.print(tmpActivityId );
      out.write("\"></td>\r\n\t\t    <td align=\"left\" valign=\"middle\" width=\"10%\" nowrap=\"nowrap\">");
      out.print(activityName );
      out.write("&nbsp;</td>\r\n\t\t    <td align=\"left\" valign=\"middle\">\r\n\t\t    <input type=\"text\" style=\"width:90%;\" name=\"nextOperName");
      out.print(tmpActivityId);
      out.write("\" id=\"nextOperName");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(executors[1]);
      out.write("\" readonly onfocus=\"this.blur();\" onclick=\"selectUserBranch('");
      out.print(tmpActivityId);
      out.write("');\">\r\n\t\t    <input type=\"hidden\" name=\"nextOperId");
      out.print(tmpActivityId);
      out.write("\" id=\"nextOperId");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(executors[0]);
      out.write("\">\r\n\t\t    <input type=\"hidden\" name=\"actName");
      out.print(tmpActivityId);
      out.write("\" id=\"actName");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(activityName);
      out.write("\" >\r\n\t\t    <input type=\"hidden\" name=\"transActType");
      out.print(tmpActivityId);
      out.write("\" id=\"transActType");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(activityVO.getTransactType());
      out.write("\" >\r\n\t\t    <input type=\"hidden\" name=\"actParticipantType");
      out.print(tmpActivityId);
      out.write("\" id=\"actParticipantType");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(executors[2]);
      out.write("\" >\r\n\t\t    <input type=\"hidden\" name=\"actParticipantField");
      out.print(tmpActivityId);
      out.write("\" id=\"actParticipantField");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(executors[3]);
      out.write("\" >\r\n\t\t    <input type=\"hidden\" name=\"selectRange");
      out.print(tmpActivityId);
      out.write("\" id=\"selectRange");
      out.print(tmpActivityId);
      out.write("\" value=\"");
      out.print(executors[4]);
      out.write("\" >\r\n\t\t    </td>\r\n\t\t</tr>\r\n\t\t\r\n\t");
}
  
      out.write("\r\n  \r\n  <tr>\r\n    <td colspan=3 valign=\"bottom\" align=\"right\" height=\"40\">    \r\n\t\t<input type=\"button\" name=\"send\" value=\"发送\" class=\"btnButton4font\" onClick=\"branchSend();\"/>\r\n\t\t\t\r\n\t\t<input type=\"button\" name=\"Cancel\" value=\"");
      if (_jspx_meth_bean_005fmessage_005f0(_jspx_page_context))
        return;
      out.write("\" class=\"btnButton4font\" onClick=\"window.close();\" />\r\n\t\t&nbsp;\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n     <td>&nbsp;</td>\r\n  </tr>\r\n</table>\r\n</form>\r\n</div>\r\n\r\n\r\n</body>\r\n</html>\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\nfunction init(){\r\n\t");
/*if(!"".equals(participantUserField) && !"0-".equals(participantUserField) && !"-1-".equals(participantUserField) && !"-2-".equals(participantUserField) && !"-3-".equals(participantUserField)){
      out.write("\r\n\t\t//alert('");
      out.print(participantUserField);
      out.write("');\r\n\t\tvar vv = window.opener.document.getElementById('");
      out.print(participantUserField);
      out.write("').innerHTML;\r\n\t\tfrm0.tempDiv.innerHTML = vv;\r\n\t");
}*/
      out.write("\r\n\t//如果是从表单中的字段中作为办理人\r\n\tvar ckIds=document.getElementsByName(\"actId\");\r\n\tvar ind=0;\r\n\tvar actId;\r\n\tvar participantType,participantField;\r\n\tvar actExecutorId,actExecutorName;\r\n\tfor(var i=0;i<ckIds.length;i++){\r\n\t\tactId=ckIds[i].value;\r\n\t\tparticipantType=document.getElementById(\"actParticipantType\"+actId).value;\r\n\t\tif(participantType==4){\r\n\t\t\tparticipantField=document.getElementById(\"actParticipantField\"+actId).value;\r\n\t\t\t\r\n\t\t\tactExecutorId=opener.document.getElementById(participantField+\"_Id\").value;\r\n\t\t\tactExecutorName=opener.document.getElementById(participantField+\"_Name\").value;\r\n\t\t\t\r\n\t\t\tif(actExecutorId.length>0){\r\n\t\t\t\tif(actExecutorId.charAt(0)==\"$\"){\r\n\t\t\t\t\tactExecutorId=actExecutorId.substring(1,actExecutorId.length-1);\r\n\t\t\t\t\tactExecutorId=actExecutorId.replace(\"$$\",\",\");\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdocument.getElementById(\"nextOperId\"+actId).value=actExecutorId;\r\n\t\t\tdocument.getElementById(\"nextOperName\"+actId).value=actExecutorName;\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n/*\r\n\t//办理期限是否选中\r\n\tif(window.opener.document.all.chkLimitTime && window.opener.document.all.chkLimitTime.checked){\r\n");
      out.write("\t\tfrm1.needProcessDeadlineDate.click();\r\n\t}\r\n\r\n\t//判断是否是子流程\r\n\tif(window.opener.document.all.subProcess && window.opener.document.all.subProcess.value=='1'){\r\n\t\tfrm1.sendContinue.style.display=\"none\";\r\n\t\tfrm2.sendContinue.style.display=\"none\";\r\n\t}\r\n\tvar sendMsgToInitiator = window.opener.document.getElementById(\"sendMsgToInitiator\").value;\r\n\tif(sendMsgToInitiator==\"1\"){\r\n\t\tdocument.getElementById(\"sendMsgToInit\").checked=true;\r\n\t}\r\n*/\r\n}\r\n\r\nfunction sendMsgToInitSet(){\r\n\tif(document.getElementById(\"sendMsgToInit\").checked){\r\n\t\twindow.opener.document.getElementById(\"sendMsgToInitiator\").value=\"1\";\r\n\t}else{\r\n\t\twindow.opener.document.getElementById(\"sendMsgToInitiator\").value=\"0\";\r\n\t}\r\n}\r\n//显示办理期限\r\nfunction showProcessDeadlineDate(){\r\n\tif(document.getElementById(\"needProcessDeadlineDate\").checked){\r\n\t\tdocument.getElementById(\"pdTD\").style.display = \"\";\r\n\t} else{\r\n\t\tdocument.getElementById(\"pdTD\").style.display = \"none\";\r\n\t}\r\n}\r\n\r\n\r\n//显示办理提示\r\nfunction showDealTips(){\r\n\tif(frm1.dealTipsTR.style.display==\"none\"){\r\n\t\tfrm1.dealTipsTR.style.display = \"\";\r\n");
      out.write("\t\tfrm1.smsContentTR.style.display = \"none\";\r\n\t} else{\r\n\t\tfrm1.dealTipsTR.style.display = \"none\";\r\n\t}\r\n}\r\n\r\n//显示短信内容\r\nfunction showSmsContent(){\r\n\tif(frm1.smsContentTR.style.display==\"none\"){\r\n\t\tfrm1.smsContentTR.style.display = \"\";\r\n\t\tfrm1.dealTipsTR.style.display = \"none\";\r\n\t} else{\r\n\t\tfrm1.smsContentTR.style.display = \"none\";\r\n\t}\r\n}\r\n\r\n//显示短信内容链接\r\nfunction showSmsContentHref(){\r\n\tif(frm1.r1.checked){\r\n\t\tfrm1.smsHrefLabel.style.display = \"\";\r\n\t} else{\r\n\t\tfrm1.smsHrefLabel.style.display = \"none\";\r\n\t\tfrm1.smsContentTR.style.display = \"none\";\r\n\t}\r\n}\r\n\r\n\r\nfunction delOptions(){\r\n\tvar oSelect=frm1.selectObject;\r\n\tvar nLen =oSelect.length;\r\n\tvar sel;\r\n\tfor(i=0;i<nLen;i++){\r\n\t\tvar optObj = oSelect.options[i];\r\n\t\tif(optObj.selected){\r\n\t\t\tsel = i;\r\n\t\t}\r\n\t}\r\n\t//删除\r\n\tif(sel != null){\r\n\t\toSelect.remove(sel);\r\n\t} else{\r\n\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.selectdeleteperson"));
      out.write("\");\r\n\t}\r\n}\r\n\r\nfunction dropNameDiv(id,selectId){\r\n\tvar allNameDiv = document.getElementById(\"showNames\");\r\n\tvar nameDiv = document.getElementById(id);\r\n\tallNameDiv.removeChild(nameDiv);\r\n\t\r\n\tvar oSelect=frm1.selectObject;\r\n\tvar nLen =oSelect.length;\r\n\tvar sel;\r\n\tfor(i=0;i<nLen;i++){\r\n\t\tvar optObj = oSelect.options[i];\r\n\t\tif(optObj.value==selectId){\r\n\t\t\tsel = i;\r\n\t\t}\r\n\t}\r\n\t\r\n\t//删除\r\n\tif(sel != null){\r\n\t\toSelect.remove(sel);\r\n\t} else{\r\n\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.selectdeleteperson"));
      out.write("\");\r\n\t}\r\n}\r\nfunction dropAllDiv(){\r\n\tvar allNameDiv = document.getElementById(\"showNames\");\r\n\tallNameDiv.innerHTML = \"\";\r\n\tdelAllOptions();\r\n}\r\n\r\n\r\nfunction delAllOptions(){\r\n\tvar oSelect=frm1.selectObject;\r\n\tvar nLen =oSelect.length;\r\n\tfor(j=0;j<nLen;j++){\r\n\t\t//删除\r\n\t\toSelect.remove(0);\r\n\t}\r\n}\r\n\r\n\r\n//添加所有选项\r\nfunction addAllOptions(){\r\n    if(document.frm1.participantType.value==\"2\"){\r\n    \torgifm.openMainFrameAll();\r\n    }else{\r\n        alert(\"候选人中存在组织或组时不能使用全选！\");\r\n    }\r\n}\r\n\r\n//添加所有选项-阅件\r\nfunction addAllOptions2(){\r\n\tvar participantType = document.frm2.participantType.value;\r\n\t// 0：流程发起人的上级；2：候选人；3：指定全部执行人；4：表单中的字段值；5：流程发起人；6：角色中指定；7：上节点执行人的上级；11：上节点所有执行人；14：流程发起人上级部门并指定职务级别；15：岗位中指定\r\n\tif(participantType==0 || participantType==2 || participantType==3 || participantType==4 || participantType==5 \r\n\t\t\t|| participantType==6 || participantType==7 || participantType==11 || participantType==14 || participantType==15){\r\n    \torgifm2.openMainFrameAll();\r\n    }else{\r\n        alert(\"候选人中存在组织或组时不能使用全选！\");\r\n    }\r\n}\r\n\r\n//发送继续\r\n");
      out.write("function include_savecontinue(processType,isComp,isFirst){\r\n\t//判断父窗口存在否\r\n\tif(window.opener.closed){\r\n\t\twindow.close();\r\n\t\treturn;\r\n\t}\r\n\twindow.opener.document.all.sendContinue.value=\"1\";\r\n\tinclude_save(processType,isComp,isFirst);\r\n}\r\n\r\n\r\n//新保存\r\nfunction include_save(processType,isComp,isFirst){\r\n\t//判断父窗口存在否\r\n\tif(window.opener.closed){\r\n\t\twindow.close();\r\n\t\treturn;\r\n\t}\r\n\t// 阅件\r\n\tinclude_save2();\t\r\n\t\r\n\tvar participantType=frm1.participantType.value;\r\n\t//var oo = new Object();\r\n\tvar stepName=document.frm1.step.value;\r\n\tvar approveMode=document.frm1.approveMode.value;\r\n\tif(stepName.split(\",\")[0]==\"2\"){\r\n\t\t//window.opener.document.all.activityId.value='2';\r\n\t\tif(isFirst!='getFirstActivity'){\r\n\t\t\twindow.close();\r\n\t\t\twindow.opener.include_comp();\r\n\t\t}else{\r\n\t\t\t//开始节点即结束\r\n\t\t\twindow.close();\r\n\t\t\twindow.opener.include_comp();\r\n\t\t}\r\n\t}else{\t\r\n\t\r\n\t\t//办理提示验证\r\n\t\tif(frm1.dealTips.value.indexOf(\"'\") >= 0){\r\n\t\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.dealtipsnosinglequote"));
      out.write("\");\r\n\t\t\tfrm1.dealTips.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(frm1.dealTips.value.indexOf(\"\\\"\") >= 0){\r\n\t\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.dealtipsnodbquote"));
      out.write("\");\r\n\t\t\tfrm1.dealTips.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(frm1.dealTips.value.length >400){\r\n\t\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.dealtipstoolong"));
      out.write("\");\r\n\t\t\tfrm1.dealTips.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tif(processType!='0'){\r\n\t\t//alert(\"processType\"+processType);\t  \r\n\t\t\tif(isFirst!='getFirstActivity'){\r\n\t\t\t//中间节点\r\n\t\t\twindow.opener.document.all.mainNextActivityId.value=stepName.split(\",\")[0];\r\n\t\t\twindow.opener.document.all.mainNextActivityName.value=stepName.split(\",\")[1];\r\n\t\r\n\t\t\t//节点其他属性\r\n\t\t\twindow.opener.document.all.mainAllowStandFor.value = stepName.split(\",\")[2];\r\n\t\t\twindow.opener.document.all.mainAllowCancel.value = stepName.split(\",\")[3];\r\n\t\t\twindow.opener.document.all.mainPressType.value = stepName.split(\",\")[4];\r\n\t\t\twindow.opener.document.all.mainDeadLineTime.value = stepName.split(\",\")[5];\r\n\t\t\twindow.opener.document.all.mainPressMotionTime.value = stepName.split(\",\")[6];\r\n\t\t\twindow.opener.document.all.mainAllowTransition.value = stepName.split(\",\")[7];\r\n\t\t\t//发送页面获取属性\r\n\t\t\twindow.opener.document.all.approveMode.value=approveMode;\r\n\t\t\twindow.opener.document.all.emergence.value=document.frm1.emergence.value;//缓急\r\n\t\t\t\t\t\t\r\n\t\t\t//短信\r\n\t\t\tif(document.getElementById(\"smsDiv1\").style.display==\"\"){\r\n");
      out.write("\t\t\t\tif(document.frm1.needSendMsg && document.frm1.needSendMsg.checked){\r\n\t\t\t\t\twindow.opener.document.all.needSendMsg.value=document.frm1.needSendMsg.checked;//短信\r\n\t\t\t\t\twindow.opener.document.all.smsContent.value=document.frm1.smsContent.value;//短信\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\r\n\t\t\t//tips\r\n\t\t\twindow.opener.document.all.dealTips.value=document.frm1.dealTips.value;//tips内容\r\n\t\r\n\t\t\twindow.opener.document.all.operId.value = '';\r\n\t\t\twindow.opener.document.all.operName.value = '';\r\n\t\r\n\t\t\tif(participantType==\"1\" || participantType==\"8\" || participantType==\"2\" || participantType==\"4\" || participantType==\"9\" || participantType==\"10\" || participantType==\"6\" || participantType==\"13\" || participantType==\"0\" || participantType==\"7\" || participantType==\"11\" || participantType==\"14\" || participantType==\"15\"){\r\n\t\t\t\tvar oSelect=frm1.selectObject;\r\n\t\t\t\tvar nLen =oSelect.length;\r\n\t\t\t\tfor(i=0;i<nLen;i++){\r\n\t\t\t\t\twindow.opener.document.all.operId.value += oSelect.options[i].value ;\r\n\t\t\t\t\twindow.opener.document.all.operName.value += oSelect.options[i].text + \",\";\r\n");
      out.write("\t\t\t\t}\r\n\t\t\t\tif(participantType==\"10\"){\r\n\t\t\t\t\twindow.opener.document.all.mainUserType.value = \"10\";\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\twindow.opener.document.all.operId.value=frm1.selectedTxtId.value;\r\n\t\t\t\twindow.opener.document.all.operName.value=frm1.selectedTxt.value;\r\n\t\t\t}\r\n\t\r\n\t\t\t//alert(oo.selectUser + \"\\n\" + oo.selectUserName);\r\n\t\t\tif(window.opener.document.all.mainNextActivityId.value=='2'){\r\n\t\t\t\t//结束流程\r\n\t\t\t\twindow.close();\r\n\t\t\t\twindow.opener.include_comp();\r\n\t\t\t} else{\r\n\t\t\t\tif(window.opener.document.all.operId.value == ''){\r\n\t\t\t\t\tvar step = document.getElementById(\"step\").value;\r\n\t\t\t\t\tif(step==\"\"){\r\n\t\t\t\t\t\talert(\"请选择下一节点！\");\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\talert('");
      out.print(Resource.getValue(local,"filetransact","file.plselectran"));
      out.write("');\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tif(window.opener.document.all.operName.value.indexOf(\",\",window.opener.document.all.operName.value.length-1)!=-1){\r\n\t\t\t\t\t\twindow.opener.document.all.operName.value = window.opener.document.all.operName.value.substring(0,window.opener.document.all.operName.value.length-1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(approveMode == '2' && window.opener.document.all.operName.value.indexOf(\",\")!=-1){\r\n\t\t\t\t\t\talert('");
      out.print(Resource.getValue(local,"filetransact","file.approvenotmoreonsingle"));
      out.write("');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\twindow.close();\r\n\t\t\t\t\twindow.opener.include_sub();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t } else{\r\n\t\t   //开始节点\r\n\t\t\twindow.opener.document.all.activityId.value=stepName.split(\",\")[0];\r\n\t\t\twindow.opener.document.all.activityName.value=stepName.split(\",\")[1];\r\n\t\r\n\t\t\t//节点其他属性\r\n\t\t\twindow.opener.document.all.allowStandFor.value = stepName.split(\",\")[2];\r\n\t\t\twindow.opener.document.all.allowCancel.value = stepName.split(\",\")[3];\r\n\t\t\twindow.opener.document.all.pressType.value = stepName.split(\",\")[4];\r\n\t\t\twindow.opener.document.all.deadLineTime.value = stepName.split(\",\")[5];\r\n\t\t\twindow.opener.document.all.pressMotionTime.value = stepName.split(\",\")[6];\r\n\t\t\t//发送页面获取属性\r\n\t\t\twindow.opener.document.all.approveMode.value=approveMode;\r\n\t\t\twindow.opener.document.all.emergence.value=document.frm1.emergence.value;//缓急\r\n\t\t\t//短信\r\n\t\t\tif(document.getElementById(\"smsDiv1\").style.display==\"\"){\r\n\t\t\t\r\n\t\t\t\tif(document.frm1.needSendMsg && document.frm1.needSendMsg.checked){\r\n\t\t\t\t\twindow.opener.document.all.needSendMsg.value=document.frm1.needSendMsg.checked;//短信\r\n");
      out.write("\t\t\t\t\twindow.opener.document.all.smsContent.value=document.frm1.smsContent.value;//短信\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//tips\r\n\t\t\twindow.opener.document.all.dealTips.value=document.frm1.dealTips.value;//tips内容\r\n\t\r\n\t\t\t//流程办理期限\r\n\t\t\tif(frm1.needProcessDeadlineDate.checked){\r\n\t\t\t\twindow.opener.document.all.processDeadlineDate.value=frm1.processDeadlineDate.value;\r\n\t\t\t} else{\r\n\t\t\t\twindow.opener.document.all.processDeadlineDate.value=\"0\";\r\n\t\t\t}\r\n\t\r\n\t\t\twindow.opener.document.all.operId.value = '';\r\n\t\t\twindow.opener.document.all.operName.value = '';\r\n\t\r\n\t\t\tif(participantType==\"1\" || participantType==\"8\" || participantType==\"2\" || participantType==\"4\" || participantType==\"9\" || participantType==\"10\" || participantType==\"6\" || participantType==\"13\" || participantType==\"0\" || participantType==\"7\" || participantType==\"11\" || participantType==\"14\" || participantType==\"15\"){\r\n\t\t\t\tvar oSelect=frm1.selectObject;\r\n\t\t\t\tvar nLen =oSelect.length;\r\n\t\t\t\tfor(i=0;i<nLen;i++){\r\n\t\t\t\t\twindow.opener.document.all.operId.value += oSelect.options[i].value ;\r\n");
      out.write("\t\t\t\t\twindow.opener.document.all.operName.value += oSelect.options[i].text + \",\";\r\n\t\t\t\t}\r\n\t\t\t\tif(participantType==\"10\"){\r\n\t\t\t\t\twindow.opener.document.all.userType.value = \"10\";\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\twindow.opener.document.all.operId.value=frm1.selectedTxtId.value;\r\n\t\t\t\twindow.opener.document.all.operName.value=frm1.selectedTxt.value;\r\n\t\t\t}\r\n\t\r\n\t\t\t//alert(oo.selectUser + \"\\n\" + oo.selectUserName);\r\n\t\t\tif(window.opener.document.all.activityId.value=='2'){\r\n\t\t\t\t//结束流程\r\n\t\t\t\twindow.close();\r\n\t\t\t\twindow.opener.include_comp();\r\n\t\t\t} else{\r\n\t\t\t\tif(window.opener.document.all.operId.value == ''){\r\n\t\t\t\t\talert('");
      out.print(Resource.getValue(local,"filetransact","file.plselectran"));
      out.write("');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tif(window.opener.document.all.operName.value.indexOf(\",\",window.opener.document.all.operName.value.length-1)!=-1){\r\n\t\t\t\t\t\twindow.opener.document.all.operName.value = window.opener.document.all.operName.value.substring(0,window.opener.document.all.operName.value.length-1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(approveMode == '2' && window.opener.document.all.operName.value.indexOf(\",\")!=-1){\r\n\t\t\t\t\t\talert('");
      out.print(Resource.getValue(local,"filetransact","file.approvenotmoreonsingle"));
      out.write("');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\twindow.close();\r\n\t\t\t\t\twindow.opener.include_save();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t }\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//如果节点为结束节点\r\nfunction disableControl(stepName){\r\n\tif(stepName.split(\",\")[0]=='2'){\r\n\t\tfrm1.approveMode.disabled = true;\r\n\t\tfrm1.orgifm.src = \"\";\r\n\t\tfrm1.ctObject.disabled = true;\r\n\t\tfrm1.emergence.disabled = true;\r\n\t\tfrm1.send.value = \"");
      if (_jspx_meth_bean_005fmessage_005f1(_jspx_page_context))
        return;
      out.write("\";\r\n\t\tfrm1.send.className = \"btnButton4font\";\r\n\t\tdocument.getElementById(\"selTextarea1\").style.display='none';\r\n\t\tdocument.getElementById(\"middleTR1\").style.display='';\r\n\t\t//document.all.middleTR.style.display = \"none\"; \r\n\t\t//window.dialogHeight = \"150px\";\r\n\t} else{\r\n\t\tfrm1.approveMode.disabled = false;\r\n\t\tfrm1.selectObject.disabled = false;\r\n\t\tfrm1.emergence.disabled = false;\r\n\t\tfrm1.send.value = \"");
      if (_jspx_meth_bean_005fmessage_005f2(_jspx_page_context))
        return;
      out.write("\";\r\n\t\tfrm1.send.className = \"btnButton2font\";\r\n\t\t//document.all.middleTR.style.display = \"\"; \r\n\t\t//window.dialogHeight = \"400px\";\r\n\t}\r\n}\r\n\r\nfunction openSelUserWIN(){\r\n\tvar type=frm1.participantType.value;\r\n\tvar range = frm1.selRange.value;\r\n\tif(type==\"12\"){\r\n\t\ttype=\"org\";\r\n\t}else if(type==\"8\"){\r\n\t\tif(range != null && range!=\"\" && range.indexOf(\"@\") < 0 && range.indexOf(\"*\") < 0){\r\n\t\t\ttype = \"user\";\r\n\t\t}else if(range != null && range!=\"\" && range.indexOf(\"@\") < 0){\r\n\t\t\ttype = \"userorg\";\r\n\t\t}else if(range != null && range!=\"\" && range.indexOf(\"*\") < 0){\r\n\t\t\ttype = \"usergroup\";\r\n\t\t} else{\r\n\t\t\ttype = \"usergrouporg\";\r\n\t\t}\r\n\t} else if(type==\"13\"){\r\n\t\ttype = \"usergroup\";\r\n\t} else{\r\n\t\ttype=\"usergroup\";\r\n\t}\r\n\t//openEndow('selectedTxtId','selectedTxt',document.all.selectedTxtId.value,document.all.selectedTxt.value,type,'no',type,document.all.selRange.value)\r\n\topenFromParentEndow('selectedTxtId','selectedTxt',frm1.selectedTxtId.value,frm1.selectedTxt.value,type,'");
      out.print(!"0".equals(processType)?"no":"yes");
      out.write("',type,frm1.selRange.value,'1','1')\r\n}\r\n//-->\r\n</SCRIPT>\r\n\r\n\r\n<!-- 阅件 -->\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\n//显示短信内容\r\nfunction showSmsContent2(){\r\n\tif(frm2.smsContentTR.style.display==\"none\"){\r\n\t\tfrm2.smsContentTR.style.display = \"\";\r\n\t} else{\r\n\t\tfrm2.smsContentTR.style.display = \"none\";\r\n\t}\r\n}\r\n\r\n//显示短信内容链接\r\nfunction showSmsContentHref2(){\r\n\tif(frm2.r1.checked){\r\n\t\tfrm2.smsHrefLabel.style.display = \"\";\r\n\t} else{\r\n\t\tfrm2.smsHrefLabel.style.display = \"none\";\r\n\t\tfrm2.smsContentTR.style.display = \"none\";\r\n\t}\r\n}\r\n\r\n//选择发送类型\r\nfunction clickSendType(obj){\r\n\tif(obj.value=='1' && obj.checked){\r\n\t\t//补发\r\n\t\tdelAllOptions();\r\n\t\tfrm2.selectedTxtId.value=\"\";\r\n\t\tfrm2.selectedTxt.value=\"\";\r\n\t} else if(obj.value=='0' && obj.checked){\r\n\t\t//重发\r\n\t\twindow.location.reload();\r\n\t}\r\n\t\r\n}\r\n\r\n\r\nfunction delOptions2(){\r\n\tvar oSelect=frm2.selectObject;\r\n\tvar nLen =oSelect.length;\r\n\tvar sel;\r\n\tfor(i=0;i<nLen;i++){\r\n\t\tvar optObj = oSelect.options[i];\r\n\t\tif(optObj.selected){\r\n\t\t\tsel = i;\r\n\t\t}\r\n\t}\r\n\t//删除\r\n\tif(sel != null){\r\n\t\toSelect.remove(sel);\r\n");
      out.write("\t} else{\r\n\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.selectdeleteperson"));
      out.write("\");\r\n\t}\r\n}\r\nfunction dropNameDiv2(id,selectId){\r\n\tvar allNameDiv = document.getElementById(\"showNames2\");\r\n\tvar nameDiv = document.getElementById(id);\r\n\tallNameDiv.removeChild(nameDiv);\r\n\t\r\n\tvar oSelect=frm2.selectObject;\r\n\tvar nLen =oSelect.length;\r\n\tvar sel;\r\n\tfor(i=0;i<nLen;i++){\r\n\t\tvar optObj = oSelect.options[i];\r\n\t\tif(optObj.value==selectId){\r\n\t\t\tsel = i;\r\n\t\t}\r\n\t}\r\n\t\r\n\t//删除\r\n\tif(sel != null){\r\n\t\toSelect.remove(sel);\r\n\t} else{\r\n\t\talert(\"");
      out.print(Resource.getValue(local,"filetransact","file.selectdeleteperson"));
      out.write("\");\r\n\t}\r\n}\r\nfunction delAllOptions2(){\r\n\tvar oSelect=frm2.selectObject;\r\n\tvar nLen =oSelect.length;\r\n\tfor(j=0;j<nLen;j++){\r\n\t\t//删除\r\n\t\toSelect.remove(0);\r\n\t}\r\n}\r\nfunction dropAllDiv2(){\r\n\tvar allNameDiv = document.getElementById(\"showNames2\");\r\n\tallNameDiv.innerHTML = \"\";\r\n\tdelAllOptions2();\r\n}\r\n\r\n//保存\r\n//$:userId\r\n//*:orgId\r\n//@:groupId\r\nfunction include_save2(){\r\n//alert(\"save\");\r\n\tvar participantType=frm2.participantType.value;\r\n\t\r\n\twindow.opener.document.all.passRoundId.value = '';\r\n\twindow.opener.document.all.passRoundName.value = '';\r\n\tif(participantType==\"1\" || participantType==\"8\" || participantType==\"2\" || participantType==\"9\" || participantType==\"10\" || participantType==\"6\" || participantType==\"13\" || participantType==\"0\" || participantType==\"7\" || participantType==\"11\" || participantType==\"15\"){\r\n\t\tvar oSelect=frm2.selectObject;\r\n\t\tvar nLen =oSelect.length;\r\n\t\tfor(i=0;i<nLen;i++){\r\n\t\t\twindow.opener.document.all.passRoundId.value += oSelect.options[i].value ;\r\n\t\t\twindow.opener.document.all.passRoundName.value += oSelect.options[i].text + \",\";\r\n");
      out.write("\t\t}\r\n\t\tif(participantType==\"10\"){\r\n\t\t\twindow.opener.document.all.mainPassRoundUserType.value = \"10\";\r\n\t\t}\r\n\t}else{\r\n\t\twindow.opener.document.all.passRoundId.value=frm2.selectedTxtId2.value;\r\n\t\twindow.opener.document.all.passRoundName.value=frm2.selectedTxt2.value;\r\n\t}\r\n\r\n\r\n\tif(window.opener.document.all.passRoundName.value.indexOf(\",\",window.opener.document.all.passRoundName.value.length-1)!=-1){\r\n\t\twindow.opener.document.all.passRoundName.value = window.opener.document.all.passRoundName.value.substring(0,window.opener.document.all.passRoundName.value.length-1);\r\n\t}\r\n}\r\n\r\nfunction openSelUserWIN2(){\r\n\tvar type=frm2.participantType.value;\r\n\tvar range = frm2.selRange.value;\r\n\tif(type==\"12\"){\r\n\t\ttype=\"org\";\r\n\t}else if(type==\"8\"){\r\n\t\tif(range != null && range!=\"\" && range.indexOf(\"@\") < 0 && range.indexOf(\"*\") < 0){\r\n\t\t\ttype = \"user\";\r\n\t\t}else if(range != null && range!=\"\" && range.indexOf(\"@\") < 0){\r\n\t\t\ttype = \"userorg\";\r\n\t\t}else if(range != null && range!=\"\" && range.indexOf(\"*\") < 0){\r\n\t\t\ttype = \"usergroup\";\r\n\t\t} else{\r\n");
      out.write("\t\t\ttype = \"usergrouporg\";\r\n\t\t}\r\n\t} else if(type==\"13\"){\r\n\t\ttype = \"usergroup\";\r\n\t} else{\r\n\t\ttype=\"usergroup\";\r\n\t}\r\n\topenEndow('selectedTxtId2','selectedTxt2',frm2.selectedTxtId2.value,frm2.selectedTxt2.value,type,'no',type,frm2.selRange.value)\r\n}\r\n//-->\r\n</SCRIPT>\r\n\r\n<!-- 分支处理 -->\r\n<SCRIPT LANGUAGE=\"JavaScript\">\r\n<!--\r\nfunction changeSendSMS(obj){\r\n\tif(window.opener.document.getElementById(\"sendSMS\")!=null){\r\n\t\tif(obj.checked){\r\n\t\t\twindow.opener.document.getElementById(\"sendSMS\").value=\"1\";\r\n\t\t}else{\r\n\t\t\twindow.opener.document.getElementById(\"sendSMS\").value=\"0\";\r\n\t\t}\r\n\t}\r\n\t//alert(window.opener.document.getElementById(\"sendSMS\").value);\r\n}\r\n//初始化是否发送短信\r\nif(window.opener.document.getElementById(\"sendSMS\")==null){\r\n\tif(document.getElementById(\"sendSMS\")!=null){\r\n\t\tdocument.getElementById(\"sendSMS\").checked=false;\r\n\t}\r\n}else{\r\n\tif(document.getElementById(\"sendSMS\")!=null){\r\n\t\tif(window.opener.document.getElementById(\"sendSMS\").value==\"1\"){\r\n\t\t\tdocument.getElementById(\"sendSMS\").checked=true;\r\n\t\t}else{\r\n\t\t\tdocument.getElementById(\"sendSMS\").checked=false;\r\n");
      out.write("\t\t}\r\n\t}\r\n}\r\nfunction getActIdValue(){\r\n\tvar res=\"\";\r\n\tvar ckIds=document.getElementsByName(\"actId\");\r\n\tvar ind=0;\r\n\tfor(var i=0;i<ckIds.length;i++){\r\n\t\tif(ckIds[i].checked){\r\n\t\t\tif(ind==0){\r\n\t\t\t\tres+=ckIds[i].value+\";;\";\r\n\t\t\t}else{\r\n\t\t\t\tres+=\";;;;\"+ckIds[i].value+\";;\";\r\n\t\t\t}\t\t\t\r\n\t\t\tres+=document.getElementById(\"actName\"+ckIds[i].value).value+\";;\";\r\n\t\t\t\r\n\t\t\tvar operId=document.getElementById(\"nextOperId\"+ckIds[i].value).value;\r\n\t\t\tif(operId==\"\"){\t\t\t\t\r\n\t\t\t\treturn \"-1\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\twhile(operId.indexOf(\"$$\")>0){\r\n\t\t\t\toperId=operId.replace(\"$$\",\",\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(operId.length>1){\r\n\t\t\t\tif(\"$\"==operId.substring(0,1)){\r\n\t\t\t\t\toperId=operId.substring(1,operId.length-1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tres+=operId+\";;\";\r\n\t\t\t\r\n\t\t\tres+=document.getElementById(\"transActType\"+ckIds[i].value).value;\r\n\t\t\tind++;\r\n\t\t}\r\n\t}\t\r\n\treturn res;\r\n}\r\n//发送\r\nfunction branchSend(){\r\n\tvar res=getActIdValue();\t\r\n\tif(res==\"\"){\r\n\t\talert(\"请选择后续节点！\");\r\n\t}else if(res==\"-1\"){\r\n\t\talert(\"请选择节点办理人！\");\r\n\t}else{\t\r\n\t\twindow.opener.document.getElementById(\"branchActInfo\").value=res;\t\t\r\n");
      out.write("\t\t");
if("getFirstActivity".equals(type)){
      out.write("\r\n\t\twindow.opener.include_branch_save();\r\n\t\t");
}else{
      out.write("\r\n\t\twindow.opener.include_branch_sub();\r\n\t\t");
}
      out.write("\r\n\t\twindow.close();\r\n\t}\r\n}\r\nfunction selectUserBranch(activityId){\r\n\t\r\n\tvar selectName=\"nextOperName\"+activityId;\r\n\tvar selectId=\"nextOperId\"+activityId;\r\n\tvar range=document.getElementById(\"selectRange\"+activityId).value;\t\r\n\topenEndow(selectId,selectName,document.getElementById(selectId).value,document.getElementById(selectName).value,\"user\",\"no\",\"user\",range);\r\n}\r\n//-->\r\n</SCRIPT>\r\n<script src=\"/jsoa/js/util.js\"></script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }

  private boolean _jspx_meth_bean_005fmessage_005f0(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  bean:message
    org.apache.struts.taglib.bean.MessageTag _jspx_th_bean_005fmessage_005f0 = (org.apache.struts.taglib.bean.MessageTag) _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.get(org.apache.struts.taglib.bean.MessageTag.class);
    boolean _jspx_th_bean_005fmessage_005f0_reused = false;
    try {
      _jspx_th_bean_005fmessage_005f0.setPageContext(_jspx_page_context);
      _jspx_th_bean_005fmessage_005f0.setParent(null);
      // /jsflow/wf_branchactivity.jsp(753,44) name = bundle type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_bean_005fmessage_005f0.setBundle("common");
      // /jsflow/wf_branchactivity.jsp(753,44) name = key type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_bean_005fmessage_005f0.setKey("comm.cancel");
      int _jspx_eval_bean_005fmessage_005f0 = _jspx_th_bean_005fmessage_005f0.doStartTag();
      if (_jspx_th_bean_005fmessage_005f0.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.reuse(_jspx_th_bean_005fmessage_005f0);
      _jspx_th_bean_005fmessage_005f0_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_bean_005fmessage_005f0, _jsp_getInstanceManager(), _jspx_th_bean_005fmessage_005f0_reused);
    }
    return false;
  }

  private boolean _jspx_meth_bean_005fmessage_005f1(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  bean:message
    org.apache.struts.taglib.bean.MessageTag _jspx_th_bean_005fmessage_005f1 = (org.apache.struts.taglib.bean.MessageTag) _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.get(org.apache.struts.taglib.bean.MessageTag.class);
    boolean _jspx_th_bean_005fmessage_005f1_reused = false;
    try {
      _jspx_th_bean_005fmessage_005f1.setPageContext(_jspx_page_context);
      _jspx_th_bean_005fmessage_005f1.setParent(null);
      // /jsflow/wf_branchactivity.jsp(1158,21) name = bundle type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_bean_005fmessage_005f1.setBundle("filetransact");
      // /jsflow/wf_branchactivity.jsp(1158,21) name = key type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_bean_005fmessage_005f1.setKey("file.endflow");
      int _jspx_eval_bean_005fmessage_005f1 = _jspx_th_bean_005fmessage_005f1.doStartTag();
      if (_jspx_th_bean_005fmessage_005f1.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.reuse(_jspx_th_bean_005fmessage_005f1);
      _jspx_th_bean_005fmessage_005f1_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_bean_005fmessage_005f1, _jsp_getInstanceManager(), _jspx_th_bean_005fmessage_005f1_reused);
    }
    return false;
  }

  private boolean _jspx_meth_bean_005fmessage_005f2(javax.servlet.jsp.PageContext _jspx_page_context)
          throws java.lang.Throwable {
    javax.servlet.jsp.PageContext pageContext = _jspx_page_context;
    javax.servlet.jsp.JspWriter out = _jspx_page_context.getOut();
    //  bean:message
    org.apache.struts.taglib.bean.MessageTag _jspx_th_bean_005fmessage_005f2 = (org.apache.struts.taglib.bean.MessageTag) _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.get(org.apache.struts.taglib.bean.MessageTag.class);
    boolean _jspx_th_bean_005fmessage_005f2_reused = false;
    try {
      _jspx_th_bean_005fmessage_005f2.setPageContext(_jspx_page_context);
      _jspx_th_bean_005fmessage_005f2.setParent(null);
      // /jsflow/wf_branchactivity.jsp(1168,21) name = bundle type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_bean_005fmessage_005f2.setBundle("filetransact");
      // /jsflow/wf_branchactivity.jsp(1168,21) name = key type = null reqTime = true required = false fragment = false deferredValue = false expectedTypeName = null deferredMethod = false methodSignature = null
      _jspx_th_bean_005fmessage_005f2.setKey("file.send");
      int _jspx_eval_bean_005fmessage_005f2 = _jspx_th_bean_005fmessage_005f2.doStartTag();
      if (_jspx_th_bean_005fmessage_005f2.doEndTag() == javax.servlet.jsp.tagext.Tag.SKIP_PAGE) {
        return true;
      }
      _005fjspx_005ftagPool_005fbean_005fmessage_0026_005fkey_005fbundle_005fnobody.reuse(_jspx_th_bean_005fmessage_005f2);
      _jspx_th_bean_005fmessage_005f2_reused = true;
    } finally {
      org.apache.jasper.runtime.JspRuntimeLibrary.releaseTag(_jspx_th_bean_005fmessage_005f2, _jsp_getInstanceManager(), _jspx_th_bean_005fmessage_005f2_reused);
    }
    return false;
  }
}
