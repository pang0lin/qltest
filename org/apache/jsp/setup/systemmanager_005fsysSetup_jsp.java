/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 09:50:47 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.setup;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.system.util.*;
import java.util.List;
import com.js.system.service.mailmanager.MailBD;
import com.js.system.vo.mailmanager.MailVO;
import com.js.util.config.SystemCommon;
import com.js.oa.audit.bean.AuditMsRemindEJBBean;
import com.js.oa.audit.util.AuditSetupReader;

public final class systemmanager_005fsysSetup_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("com.js.system.util");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("java.util.List");
    _jspx_imports_classes.add("com.js.system.vo.mailmanager.MailVO");
    _jspx_imports_classes.add("com.js.oa.audit.bean.AuditMsRemindEJBBean");
    _jspx_imports_classes.add("com.js.system.service.mailmanager.MailBD");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("com.js.oa.audit.util.AuditSetupReader");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

response.setHeader("Cache-Control","no-store");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", 0);
String action=request.getParameter("action");
String options=null;

String domainId=session.getAttribute("domainId").toString();
String accessoryEncrypt="0";
long limitSize=0;
String initPanel=request.getParameter("initPanel");
if(initPanel==null||initPanel.equals("")||initPanel.equals("null")){
	initPanel="0";
}
String mainURL= "";
if(1!=SystemCommon.getAudit()||(1==SystemCommon.getAudit()&&1==SystemCommon.getAutoAudit())){//如果未开启审计功能
    mainURL = "/jsoa/setup/systemmanager_sysSetup.jsp";
}
if(1==SystemCommon.getAudit()&&0==SystemCommon.getAutoAudit()){//如果开启了审计功能则插入审计数据，并且关闭了自动审计功能
    mainURL = "/jsoa/audit/audittemmanager_sysSetup.jsp";
}
MailBD mb=new MailBD();
 List mailList=mb.getMailList();

if(action!=null){
	String clickPanel=request.getParameter("clickPanel");
	StringBuffer optionBuffer=new StringBuffer();
	optionBuffer.append(request.getParameter("attach"))
		.append(request.getParameter("sign"))
		.append(request.getParameter("messageReceive"))
		.append(request.getParameter("potoflow"))
		.append(request.getParameter("rtx"))
		.append(request.getParameter("word"))
		.append(request.getParameter("website"))
		.append(request.getParameter("signature"))
		.append(request.getParameter("messageSend"));
		
		//记录日志情况
		java.sql.Connection conn=null;
	  java.sql.Statement stmt=null;
	  String moduleName,moduleSerial,moduleLog;
	  try{
	     conn=new com.js.util.util.DataSourceBase().getDataSource().getConnection();
	     stmt=conn.createStatement();
	     java.sql.ResultSet rs=stmt.executeQuery("select module_serial from sec_log_module where module_level=0 order by module_id");
	     while(rs.next()){
	        moduleSerial=rs.getString(1);		        
	        optionBuffer.append(",").append(request.getParameter(moduleSerial)).append(moduleSerial);
	     }
	     rs.close();
	     stmt.close();
	     conn.close();
	  }catch(Exception ex){
	  		if(conn!=null){
	  		  conn.close();
	  		}
	  		ex.printStackTrace();
	  }    
	options=optionBuffer.toString();	
	String limitSizeStr=request.getParameter("attachLimitSize");
	String limitSizeFilter=request.getParameter("filterLimitSize");
	
	if(limitSizeStr!=null && !"null".equals(limitSizeStr) && !"".equals(limitSizeStr)){
	    limitSize=Integer.parseInt(limitSizeStr)*1024*1024l;
	    
	}
	String isUserEmail=request.getParameter("email");
	String emailCount=request.getParameter("emailCount");
	String markPWD=request.getParameter("markPWD");
	String pwdImage=request.getParameter("pwdImage");
	String useRss=request.getParameter("useRss");
	String pwdStart=request.getParameter("pwdStart");
	String pwdEnd=request.getParameter("pwdEnd");
	String pwdStrongType=request.getParameter("pwdStrongType");
	String pwdStrong=request.getParameter("pwdStrong");
	String pwd_strong="0";
	

	
	if(pwdStrong.equals("1"))//启用密码强度开关
	{
		StringBuffer sb=new StringBuffer();
		if((pwdStart!=null||pwdStart.length()>0)&&(pwdEnd!=null||pwdEnd.length()>0))
		{
			sb.append("$");
			sb.append(pwdStart);
			sb.append("$");
			sb.append("$");
			sb.append(pwdEnd);
			sb.append("$");
			if(pwdStrongType!=null)
			{
				sb.append("$");
				sb.append("1");
				sb.append("$");
			}
			else
			{
				sb.append("$");
				sb.append("0");
				sb.append("$");
			}
			pwd_strong=sb.toString();
		}
	}
	String pwdErrorNum=request.getParameter("pwdErrorNumInput");
	String pwdErrorMin=request.getParameter("pwdErrorMinInput");
	String pwdSecurity=request.getParameter("pwdError");//登录失败次数开关
	String pwdError="0";
	if(pwdSecurity.equals("1"))//启用登录失败次数
	{
		StringBuffer sb=new StringBuffer();
		if((pwdErrorNum!=null||pwdErrorNum.length()>0)&&(pwdErrorNum!=null||pwdErrorNum.length()>0))
		{
			sb.append("$");
			sb.append(pwdErrorNum);
			sb.append("$");
			sb.append("$");
			sb.append(pwdErrorMin);
			sb.append("$");
			pwdError=sb.toString();
		}
	}
	String pwdDate=request.getParameter("pwdDate");
	String pwd_date="0";//密码过期天数默认为0未开启
	if(pwdDate.equals("1"))//如果启用密码过期天数
		pwd_date=request.getParameter("pwdDateInput");
	String pwdInit=request.getParameter("pwdChange");
	String pwd_init="0";//初始密码更改开关默认为0未开启
	if(pwdInit.equals("1"))//如果启用初始密码更改
		pwd_init=pwdInit;
	String pwdKey=request.getParameter("pwdKey");	
	SysSetupReader.getInstance().updateSystemOption(domainId,options,request.getParameter("worklog"),request.getParameter("mailBoxSize"),request.getParameter("netDiskSize"),request.getParameter("attachLimit"),String.valueOf(limitSize),isUserEmail,emailCount,markPWD,useRss,request.getParameter("exportInner"),request.getParameter("kq"),pwd_strong,pwd_init,pwd_date,pwdError,pwdImage,request.getParameter("linkmanScope"),pwdKey,request.getParameter("filterLimit"),limitSizeFilter.toString());
	accessoryEncrypt=request.getParameter("accessoryEncrypt");
	SysSetupReader.setAccessoryEncrypt(accessoryEncrypt, domainId);
	
	if(1==SystemCommon.getAudit()&&1==SystemCommon.getAutoAudit()){//如果开启了审计功能,并且开启了自动审计功能
		String logId = AuditSetupReader.getInstance("0").insertLog(session.getAttribute("userId").toString(),
		           session.getAttribute("userName").toString(),session.getAttribute("orgId").toString(),"1");
		AuditSetupReader.getInstance(logId).updateSystemOption(domainId,options,request.getParameter("worklog"),
		           request.getParameter("mailBoxSize"),request.getParameter("netDiskSize"),request.getParameter("attachLimit"),
		           String.valueOf(limitSize),isUserEmail,emailCount,markPWD,useRss,request.getParameter("exportInner"),
		           request.getParameter("kq"),pwd_strong,pwd_init,pwd_date,pwdError,pwdImage,request.getParameter("linkmanScope"),
		           pwdKey,limitSizeFilter,request.getParameter("filterLimit"));
	}
	com.js.oa.security.log.service.LogBD logBD = new com.js.oa.security.log.service.LogBD();
	java.util.Date date = new java.util.Date();
	logBD.log(session.getAttribute("userId").toString(), session.getAttribute("userName").toString(), session.getAttribute("orgName").toString(), "system_sys", "系统管理",date, date, "2", "系统设置",session.getAttribute("userIP").toString(), domainId);

	
      out.write("\r\n\t<script language=\"javascript\">\r\n\t\t");
if(com.js.util.config.SystemCommon.getAudit()==0){ 
      out.write("\r\n\t\t\talert(\"保存成功！\");\r\n\t\t");
}
      out.write("\r\n        window.location.href = \"");
      out.print(mainURL );
      out.write("?initPanel=");
      out.print(clickPanel);
      out.write("\";\r\n\t</script>\r\n\t");

}
SysSetupReader sysRed = SysSetupReader.getInstance();
options=sysRed.getSystemOption(domainId);
String kqflag=sysRed.getKq(domainId);
String workLog = sysRed.getWorkLog(domainId);
String mailBoxSize=sysRed.getMailBoxSize(domainId);
String netDiskSize=sysRed.getNetDiskSize(domainId);
String attachLimitSize=sysRed.getAttachLimit(domainId);
String filterLimitSize=sysRed.getFilterLimit(domainId);
String exportInnerflag=sysRed.getExportInner(domainId);
String email=sysRed.getEmail(domainId);
String mailState=email.split(";")[0];
String mailID=email.split(";")[1];
accessoryEncrypt=sysRed.getAccessoryEncrypt(domainId);

String pwd_date=sysRed.getPwdDate(domainId);
String pwd_init=sysRed.getPwdInit(domainId);
String pwdStrongConfig=sysRed.getPwdStrongConfig(domainId);//密码强度
String minLength="";//最小长度
String maxLength="";//最大长度
String filterLimit="";
boolean isContainNumAndLetter=false;
if(!pwdStrongConfig.equals("0"))//0为未开启,开启后的格式为"$minLength$$maxLength$$isContainNumAndLettert(0,1)$"
{
	String[] parameters=pwdStrongConfig.split(";");
	minLength=parameters[0];
	maxLength=parameters[1];
	isContainNumAndLetter=parameters[2].equals("1")?true:false;
}
if(attachLimitSize!=null && !"null".equals(attachLimitSize) && !"".equals(attachLimitSize)){
    limitSize=Long.parseLong(attachLimitSize.substring(1))/(1024*1024);
}

if(filterLimitSize!=null && !"null".equals(filterLimitSize) && !"".equals(filterLimitSize))
{
    filterLimit=filterLimitSize.substring(1);
}
else
{
	filterLimit="";
}

workLog = workLog==null?"0":workLog;


/*//判断是否使用了RTX
com.js.system.util.SysSetupReader ssReader=com.js.system.util.SysSetupReader.getInstance();
boolean rtxIsUsed=ssReader.rtxIsUsed();*/

//判断是否使用即时通讯工具
//com.js.message.RealTimeUtil util=new com.js.message.RealTimeUtil();
boolean used=false;
String browserVersion=session.getAttribute("browserVersion")==null?"":session.getAttribute("browserVersion").toString();

if("IE11And360".equals(browserVersion)){
	browserVersion="IE11360";
}

      out.write("\r\n<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\">\r\n<link href=\"/jsoa/skin/");
      out.print(session.getAttribute("skin"));
      out.write("/style-");
      out.print(browserVersion);
      out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<SCRIPT language=javascript src=\"/jsoa/js/openEndow.js\"></SCRIPT>\r\n<style type=\"text/css\">\r\n<!--\r\n.input{height:16px;line-height:9px;vertical-align:middle;padding-top:2px;}\r\n-->\r\n</style>\r\n<script language=\"javascript\">\r\nfunction changePanle(flag){\r\n document.getElementById(\"clickPanel\").value=flag;\r\n\tif(flag=='0'){\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel0\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"none\";\r\n\t}if(flag=='1'){\r\n\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanel\";\r\n");
      out.write("\t\tdocument.getElementById(\"Panel0\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"none\";\r\n\t}if(flag=='2'){\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel0\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"none\";\r\n\t}if(flag=='3'){\r\n\t\tdocument.getElementById(\"PanleDIV3\").className=\"tabPanelSelected\";\r\n\t\tdocument.getElementById(\"Panel3\").style.display=\"\";\r\n\t\tdocument.getElementById(\"PanleDIV0\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel0\").style.display=\"none\";\r\n");
      out.write("\t\tdocument.getElementById(\"PanleDIV1\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel1\").style.display=\"none\";\r\n\t\tdocument.getElementById(\"PanleDIV2\").className=\"tabPanel\";\r\n\t\tdocument.getElementById(\"Panel2\").style.display=\"none\";\r\n\t}\r\n}\r\n\r\nfunction init(){\r\n\tchangePanle('");
      out.print(initPanel);
      out.write("');\r\n}\r\n</script>\r\n<title>相关人员</title>\r\n\r\n</head>\r\n<body  class=\"MainFrameBox\" onLoad=\"init()\">\r\n<table width=\"100%\" border=0 cellpadding=\"0\" cellspacing=\"0\">\r\n<tr>\r\n<td>\r\n<table width=\"100%\" height=\"25\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"inlineBottomLine\">\r\n  <tr>\r\n    <td>\r\n\t    <div id=\"PanleDIV0\" class=\"tabPanelSelected\" onClick=\"changePanle('0');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">系统开关</div>\r\n        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n\t  \r\n\t    <div class=\"btnBQspace AlignLeft\"></div>\r\n\t    \r\n\t    <div id=\"PanleDIV1\" class=\"tabPanel\" onClick=\"changePanle('1');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">系统日志</div>\r\n        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n      \r\n      <div class=\"btnBQspace AlignLeft\"></div>\r\n\t    \r\n\t    <div id=\"PanleDIV2\" class=\"tabPanel\" onClick=\"changePanle('2');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">密码策略</div>\r\n");
      out.write("        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n      \r\n      <div class=\"btnBQspace AlignLeft\"></div>\r\n\t    \r\n\t    <div id=\"PanleDIV3\" class=\"tabPanel\" onClick=\"changePanle('3');\">\r\n        <div class=\"tabPanelLeft\"></div>\r\n        <div class=\"tabPanelCenter\">容量设置</div>\r\n        <div class=\"tabPanelRight\"></div>      \r\n      </div>\r\n     </td>\r\n  </tr>\r\n</table>\r\n\r\n<table width=\"100%\" border=\"0\" cellpadding=\"10\" cellspacing=\"0\" class=\"docBox\">\r\n <tr>\r\n    <td valign=\"top\">\r\n    <form form name=\"frm\" method=\"post\" action=\"");
      out.print(mainURL );
      out.write("?action=update\">\r\n    \t<input type=\"hidden\" name=\"clickPanel\" id=\"clickPanel\">\r\n\t   <table id=\"Panel0\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15px;\">\t\r\n\t\t  <tr style=\"display:none;\" >\r\n\t\t\t<td width=\"110\">附件存储</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t\t<input type=\"radio\" value=\"1\" name=\"attach\" ");
if(options.charAt(0)=='1'){
      out.write("checked");
}
      out.write(">本地&nbsp;&nbsp;&nbsp;<input type=\"radio\" value=\"0\" name=\"attach\" ");
if(options.charAt(0)=='0'){
      out.write("checked");
}
      out.write(">文件服务器\r\n\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td width=\"110\">附件大小</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t\t<input type=\"radio\" value=\"0\" name=\"attachLimit\" checked onClick=\"showAttachSize();\">无限制 <input type=\"radio\" value=\"1\" name=\"attachLimit\" onclick=\"showAttachSize();\" ");
if(attachLimitSize.startsWith("1")){
      out.write("checked");
}
      out.write(">限制\r\n\t\t\t\t<span id=\"attachSizeSpan\" ");
if(attachLimitSize.startsWith("1")){}else{
      out.write("style=\"display:none\"");
}
      out.write("><input type=\"text\" name=\"attachLimitSize\" class=\"inputText\" style=\"width:40px; height:16px;\" value=\"");
      out.print(limitSize);
      out.write("\" maxlength=\"6\">&nbsp;M</span></td>\r\n\t\t  </tr>\r\n\t\t   <tr style=\"display:none;\">\r\n\t\t\t<td width=\"110\">附件加密</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"accessoryEncrypt\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if("1".equals(accessoryEncrypt)){
      out.write("checked");
}
      out.write(" name=\"accessoryEncrypt\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr ");
if(!SystemCommon.getHandWrite()){out.print("style=\"display:none;\"");}
      out.write(">\r\n\t\t\t<td>手写意见</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"sign\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(1)=='1'){
      out.write("checked");
}
      out.write(" name=\"sign\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr ");
if(!SystemCommon.getISignature()){out.print("style=\"display:none;\"");}
      out.write(">\r\n\t\t\t<td>电子签章</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"signature\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(7)=='1'){
      out.write("checked");
}
      out.write(" name=\"signature\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr >\r\n\t\t\t<td>接收短信范围控制</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"messageReceive\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(2)=='1'){
      out.write("checked");
}
      out.write(" name=\"messageReceive\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr >\r\n\t\t\t<td>发送短信权限控制</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"messageSend\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(8)=='1'){
      out.write("checked");
}
      out.write(" name=\"messageSend\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:none\">\r\n\t\t\t<td>图形工作流</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"potoflow\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(3)=='1'){
      out.write("checked");
}
      out.write(" name=\"potoflow\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr ");
if(!used){
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t<td>在线感知</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"rtx\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(4)=='1'){
      out.write("checked");
}
      out.write(" name=\"rtx\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:none\">\r\n\t\t\t<td>WORD编辑</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"word\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.charAt(5)=='1'){
      out.write("checked");
}
      out.write(" name=\"word\">使用</td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:");
      out.print(SystemCommon.getIfShowWebsite()==1?"":"none" );
      out.write(";\">\r\n\t\t\t<td>与网站结合</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"website\" checked>否&nbsp;<input type=\"radio\" value=\"1\" ");
if(options.length() > 6 && options.charAt(6)=='1'){
      out.write("checked");
}
      out.write(" name=\"website\">是</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>日报修改删除</td>\r\n\t\t\t<td><input type=\"radio\" value=\"0\" name=\"worklog_rad\" ");
      out.print(workLog.equals("0")?"checked='checked'":"");
      out.write(" onClick=\"wkCk(0);\">不允许&nbsp;<input type=\"radio\" value=\"1\" name=\"worklog_rad\" onClick=\"wkCk(1);\" ");
      out.print(workLog.equals("0")?"":"checked='checked'");
      out.write(">允许\r\n                            <span id=\"worklog_sp1\" style=\"");
      out.print(workLog.equals("0")?"display:none":"");
      out.write("\"><input type=\"text\" name=\"worklog\" class=\"inputText\" style=\"width:40px; height:16px;\" value=\"");
      out.print(workLog);
      out.write("\" maxlength=\"3\"> 天之内删除</span></td>\r\n\t\t  </tr>\r\n\t\t   ");
 
		  com.js.system.util.SysSetupReader ssReader=com.js.system.util.SysSetupReader.getInstance();
		  String flag=ssReader.getMarkPWD(domainId).split(";")[0];
		  String rssFlag=ssReader.getUseRss(domainId);
		  String pwdImage=ssReader.getPwdPolicyByImage();
		  String pwdError=ssReader.getPwdPolicyByError();
		  String pwdKey=ssReader.getPwdPolicyByKey();
		  String pwdStrong=ssReader.getPwdPolicyByStrong();
		  String linkmanScope=ssReader.getLinkmanScope(domainId);
		  String errorNum="";
		  String errorMin="";
		  if(!pwdError.equals("0"))
		  {
		  	String errorConfig=pwdError.substring(1,pwdError.length()-1).replaceAll("\\$\\$", ";");
		  	String[] parameters=errorConfig.split(";");
		  	errorNum=parameters[0];
		  	errorMin=parameters[1];
		  }
		  
      out.write("\r\n\t\t <tr>\r\n\t\t\t<td>邮件提醒</td>\r\n\t\t\t<td>\r\n\t\t\t\t<input type=\"radio\" value=\"0\" name=\"email\" checked onClick=\"showEmail();\">不使用\r\n\t\t\t\t<input type=\"radio\" value=\"1\" name=\"email\" onclick=\"showEmail();\" \r\n\t\t\t\t");
if(mailState.equals("1")&&mailList.size()>0){
      out.write("checked");
}
      out.write(">使用\r\n\t\t\t\t<span id=\"emailSpan\" ");
if(mailState.equals("1")&&mailList.size()>0){}else{
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t\t  <select name=\"emailCount\" id=\"emailCount\">\r\n\t\t\t\t    <option value=\"-1\">--请选择--</option>\r\n\t\t\t\t    ");

					 if(mailList!=null){
					    for(int i=0;i<mailList.size();i++){
					     MailVO mv=(MailVO)mailList.get(i);
					     //if(mailID!=null&&!mailID.equals("")){
					        int mailCount=Integer.parseInt(mailID);
					
      out.write("\r\n\t\t\t\t\t\r\n\t\t\t\t     <option ");
if(mailCount==mv.getMailId()){
      out.write("selected");
}
      out.write(" value=\"");
      out.print(mv.getMailId());
      out.write('"');
      out.write('>');
      out.print(mv.getFromUser());
      out.write("</option>\r\n\t\t\t\t\t");
}}//}
      out.write("\r\n\t\t\t\t  </select>\r\n\t\t\t\t</span>\t\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t   <tr>\r\n\t\t    <td>启用RSS</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"useRss\" value=\"0\" ");
if(rssFlag.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"useRss\" value=\"1\" ");
if(rssFlag.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t    <td>记住登陆密码</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"markPWD\" value=\"0\" ");
if(flag.equals("0")) {
      out.write("checked");
}
      out.write("/>不使用\r\n\t\t\t <input type=\"radio\" name=\"markPWD\" value=\"1\" ");
if(flag.equals("1")) {
      out.write("checked");
}
      out.write("/>使用\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t    <td>导出通讯录</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"exportInner\" value=\"0\" ");
if(exportInnerflag.equals("0")) {
      out.write("checked");
}
      out.write("/>不允许\r\n\t\t\t <input type=\"radio\" name=\"exportInner\" value=\"1\" ");
if(exportInnerflag.equals("1")) {
      out.write("checked");
}
      out.write("/>允许\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t  <td>查看联系人范围</td>\r\n\t\t  \t <td>\r\n\t\t  \t \t<input type=\"radio\" name=\"linkmanScope\" value=\"0\" ");
if(linkmanScope.equals("0")){
      out.write("checked");
} 
      out.write("/>全部&nbsp;&nbsp;\r\n\t\t  \t \t<input type=\"radio\" name=\"linkmanScope\" value=\"2\" ");
if(linkmanScope.equals("2")){
      out.write("checked");
} 
      out.write("/>本单位&nbsp;&nbsp;\r\n\t\t  \t \t<input type=\"radio\" name=\"linkmanScope\" value=\"1\" ");
if(linkmanScope.equals("1")){
      out.write("checked");
} 
      out.write("/>权限范围内\r\n\t\t  \t \t\r\n\t\t  \t </td>\r\n\t\t  </tr>\r\n\t\t  <tr style=\"display:none;\">\r\n\t\t\t<td width=\"110\">是否使用拦截器</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t\t<input type=\"radio\" value=\"0\" name=\"filterLimit\" checked onClick=\"showFilterSize();\">不使用\r\n\t\t\t\t<input type=\"radio\" value=\"1\" name=\"filterLimit\" onclick=\"showFilterSize();\" ");
if(filterLimitSize.startsWith("1")){
      out.write("checked");
}
      out.write(">使用\r\n\t\t\t\t<span id=\"filterSizeSpan\" ");
if(filterLimitSize.startsWith("1")){}else{
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t\t<input type=\"text\" name=\"filterLimitSize\" title=\"填写所要拦截文件的后缀名以分号隔开\" class=\"inputText\" style=\"width:200px; height:16px;\" value=\"");
      out.print(filterLimit);
      out.write("\" maxlength=\"10000\">&nbsp;\r\n\t\t\t\t</span>\r\n\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t \r\n\t\t  \r\n\t\t  <tr style=\"display:none\">\r\n\t\t    <td>考勤模块</td>\r\n\t\t\t<td>\r\n\t\t\t <input type=\"radio\" name=\"kq\" value=\"0\" ");
if(kqflag.equals("0")) {
      out.write("checked");
}
      out.write("/>不使用\r\n\t\t\t <input type=\"radio\" name=\"kq\" value=\"1\" ");
if(kqflag.equals("1")) {
      out.write("checked");
}
      out.write("/>使用\t\t\t</td>\r\n\t\t  </tr>\r\n\t\t  \r\n                  <script language=\"javascript\">\r\n                  function wkCk(flag){\r\n                      var worklog = ");
      out.print(workLog);
      out.write(";\r\n                      if(flag == 0){\r\n                          document.all.worklog_sp1.style.display = \"none\";\r\n                          document.all.worklog.value = 0;\r\n                      }else{\r\n                          document.all.worklog_sp1.style.display = \"\";\r\n                          if(worklog == 0){\r\n                              document.all.worklog.value = 3;\r\n                          }else{\r\n                              document.all.worklog.value = worklog;\r\n                          }\r\n\r\n                      }\r\n                  }\r\n                  </script>\r\n\t   </table>\r\n\t   <table id=\"Panel1\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15px;\">\r\n\t   \t\t");

		  java.sql.Connection conn=null;
		  java.sql.Statement stmt=null;
		  String moduleName,moduleSerial,moduleLog;
		  try{
		     conn=new com.js.util.util.DataSourceBase().getDataSource().getConnection();
		     stmt=conn.createStatement();
		     java.sql.ResultSet rs=stmt.executeQuery("select module_name,module_serial,module_log from sec_log_module where module_level=0 order by module_id");
		     while(rs.next()){
		        moduleName=rs.getString(1);
		        moduleSerial=rs.getString(2);
		        moduleLog=rs.getString(3);
		        
      out.write("\r\n\t\t        <tr>\r\n\t\t\t\t<td width=\"110\">");
      out.print(moduleName);
      out.write("</td>\r\n\t\t\t\t<td><input type=\"radio\" value=\"0\" name=\"");
      out.print(moduleSerial);
      out.write("\" checked>不使用&nbsp;<input type=\"radio\" value=\"1\" ");
if("1".equals(moduleLog)){
      out.write("checked");
}
      out.write(" name=\"");
      out.print(moduleSerial);
      out.write("\">使用</td>\r\n\t\t\t\t</tr>\r\n\t\t        ");

		     }
		     rs.close();
		     stmt.close();
		     conn.close();
		  }catch(Exception ex){
		  		if(conn!=null){
		  		  conn.close();
		  		}
		  }    
		  
      out.write("\r\n\t   </table>\r\n\t   \r\n\t   <table id=\"Panel2\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15\">\r\n\t   \t\t<tr>\r\n\t\t\t<td width=\"110\">初始密码更改</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdChange\" value=\"0\" ");
if(pwd_init.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdChange\" value=\"1\" ");
if(pwd_init.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>图形验证码</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdImage\" value=\"0\" ");
if(pwdImage.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdImage\" value=\"1\" ");
if(pwdImage.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>USBKey</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdKey\" value=\"0\"  ");
if(pwdKey.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdKey\" value=\"1\" ");
if(pwdKey.equals("1")) {
      out.write("checked");
}
      out.write("/>启用\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  \r\n\t\t  <tr>\r\n\t\t\t<td>密码过期</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdDate\" value=\"0\"  onclick=\"showPwdDate()\" ");
if(pwd_date.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdDate\" value=\"1\"  onclick=\"showPwdDate()\" ");
if(!pwd_date.equals("0")) {
      out.write("checked");
}
      out.write("/>启用&nbsp;&nbsp;\r\n\t\t\t <span ");
if(!pwd_date.equals("0")){}else{
      out.write("style=\"display:none\"");
}
      out.write(" id=\"pwdDateInputSpan\">密码有效期&nbsp;<input id=\"pwd_date_input\" type=\"text\" name=\"pwdDateInput\"  class=\"inputText\" style=\"width:40px; height:16px;\" size=\"2\" value=\"");
      out.print(pwd_date);
      out.write("\">&nbsp;天</span>\t\t\t </td>\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t\t<td>登录失败次数</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdError\" value=\"0\"  onclick=\"showPwdError()\" ");
if(pwdError.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdError\" value=\"1\" onClick=\"showPwdError()\" ");
if(!pwdError.equals("0")) {
      out.write("checked");
}
      out.write("/>启用&nbsp;&nbsp;\r\n\t\t\t <span ");
if(!pwdError.equals("0")){}else{
      out.write("style=\"display:none\"");
}
      out.write(" id=\"pwdErrorInputSpan\">\r\n\t\t\t   连续登录失败&nbsp;<input type=\"text\" name=\"pwdErrorNumInput\" value=\"");
      out.print(errorNum );
      out.write("\" class=\"inputText\" style=\"width:40px; height:16px;\" size=\"2\">&nbsp;次后\r\n\t\t\t   &nbsp;<input type=\"text\" name=\"pwdErrorMinInput\" value=\"");
      out.print(errorMin );
      out.write("\" class=\"inputText\" style=\"width:40px; height:16px;\" size=\"2\">&nbsp;分钟内禁止再次登录</span></td>\r\n\t\t  </tr>\r\n\t\t  \r\n\t\t  <tr>\r\n\t\t\t<td>密码强度</td>\r\n\t\t\t<td colspan=\"2\">\r\n\t\t\t <input type=\"radio\" name=\"pwdStrong\" value=\"0\"  onclick=\"showPwdStrong()\" ");
if(pwdStrongConfig.equals("0")) {
      out.write("checked");
}
      out.write("/>不启用\r\n\t\t\t <input type=\"radio\" name=\"pwdStrong\" value=\"1\" onClick=\"showPwdStrong()\" ");
if(pwdStrongConfig.length()>1) {
      out.write("checked");
}
      out.write("/>启用&nbsp;&nbsp;\r\n\t\t\t <span id=\"pwdStrongInputSpan\" ");
if(pwdStrongConfig.length()>1){}else{
      out.write("style=\"display:none\"");
}
      out.write(">\r\n\t\t\t   密码长度&nbsp;<input type=\"text\" name=\"pwdStart\" class=\"inputText\" style=\"width:40px; height:16px;\" size=\"2\" value=\"");
      out.print(minLength );
      out.write("\">&nbsp;-\r\n\t\t\t   &nbsp;<input type=\"text\" name=\"pwdEnd\" size=\"2\" class=\"inputText\" style=\"width:40px; height:16px;\" value=\"");
      out.print(maxLength );
      out.write("\">&nbsp;位\r\n\t\t\t   <input type=\"checkbox\" name=\"pwdStrongType\" ");
if(isContainNumAndLetter){
      out.write("checked");
}
      out.write(">密码必须同时包含字母和数字</span></td>\r\n\t\t  </tr>\r\n\t   </table>\r\n\t   \r\n\t   <table id=\"Panel3\" width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" style=\"display:none; margin-left:15px;\">\r\n\t   \t\t<tr style=\"display:none\">\r\n\t   \t\t<td>邮箱容量</td>\r\n\t\t\t<td colspan=\"2\"><input type=\"text\" name=\"mailBoxSize\" class=\"inputText\" style=\"width:40px; height:16px;\"  size=5 maxlength=\"6\" value=\"");
      out.print(mailBoxSize);
      out.write("\"> M&nbsp;&nbsp;</td>\t\t\r\n\t\t  </tr>\r\n\t\t  <tr>\r\n\t\t  \t<td width=\"110\">个人文档默认值</td>\r\n\t\t\t<td colspan=\"2\"><input type=\"text\" name=\"netDiskSize\" id=\"netDiskSize\" class=\"inputText\" style=\"width:40px; height:16px;\"  size=5 maxlength=\"6\" value=\"");
      out.print(netDiskSize);
      out.write("\"> MB</td>\r\n\t\t\t\r\n\t\t  </tr>\r\n\t   </table>\r\n\t</form>\r\n\t<br>\r\n\t<table style=\"margin-left:13px;\">\r\n\t\t<tr>\r\n\t\t\t<td><button style=\"cursor:pointer;\" class=\"btnButton2font\" onClick=\"javascript:save();\">保存配置</button>\t</td>\r\n\t\t\t<td colspan=\"2\"></td>\r\n\t\t</tr>\r\n\t</table>\r\n</tr>\r\n\r\n</table>\r\n\r\n</td>\r\n</tr>\r\n</table>\r\n</body>\r\n<script type=\"text/javascript\" src=\"/jsoa/js/util.js\"></script>\r\n</html>\r\n<script language=\"javascript\">\r\nfunction save() {\r\n    if(document.all.worklog_rad[1].checked && isNaN(document.all.worklog.value)){\r\n        alert(\"删除天数请输入数字！\");\r\n        document.all.worklog.focus();\r\n        return ;\r\n    }\r\n    if(document.all.worklog_rad[1].checked && parseInt(document.all.worklog.value) < 0){\r\n        alert(\"删除天数不能是负数！\");\r\n        document.all.worklog.focus();\r\n        return ;\r\n    }\r\n\tif(isNaN(document.all.mailBoxSize.value) || parseInt(document.all.mailBoxSize.value)<0){\r\n\t\talert(\"容量必须为正整数！\");\r\n\t\treturn;\r\n\t}\r\n\tif(isNaN(document.all.netDiskSize.value) || parseInt(document.all.netDiskSize.value)<0){\r\n\t\talert(\"容量必须为正整数！\");\r\n");
      out.write("\t\treturn;\r\n\t}\r\n\tif(document.all.attachLimit[1].checked){\r\n\t\tif(isNaN(document.all.attachLimitSize.value)){\r\n\t\t\talert(\"限制大小必须为正整数\");\r\n\t\t\tdocument.all.attachLimitSize.select();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar re= /^[1-9]+[0-9]*]*$/;\r\n\t\tif (!re.test(document.all.attachLimitSize.value)){\r\n\t\t\talert(\"限制大小必须为正整数\");\r\n\t\t\tdocument.all.attachLimitSize.select();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t}else{\r\n\t\tdocument.all.attachLimitSize.value=\"0\";\r\n\t}\r\n\t//使用拦截器应用填写拦截的文档格式的书写格式必须以分号隔开\r\n\t\r\n\tif(document.all.filterLimit[1].checked)\r\n\t{\r\n\t\tvar textValue=document.all.filterLimitSize.value;\r\n\t\tif(textValue!=null && textValue!=\"\")\r\n\t\t{\r\n\t\t\tif(textValue.indexOf(\";\")<=0)\r\n\t\t\t{\r\n\t\t\t\talert(\"所填的拦截文档格式的后缀名请以英文的分号结束\");\r\n\t\t\t\tdocument.all.filterLimitSize.select();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(document.all.email[1].checked){\r\n\t   if(document.getElementById(\"emailCount\").value==-1){\r\n\t      alert(\"请选择邮箱!\");\r\n\t\t  return;\r\n\t   }\r\n\t}\r\n\t//密码过期开关验证\r\n\tif(document.all.pwdDate[1].checked)\r\n\t{\r\n\t\t\r\n\t\tvar regExp=/^[1-9]\\d*$/;\r\n\t\tif(!regExp.test(document.all.pwdDateInput.value))\r\n");
      out.write("\t\t{\r\n\t\t\talert(\"请输入正确的天数!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t//登录失败次数开关验证\r\n\tif(document.all.pwdError[1].checked)\r\n\t{\r\n\t\tvar regExp=/^[1-9]\\d*$/;\r\n\t\tif(!regExp.test(document.all.pwdErrorNumInput.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的登录失败次数!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse if(!regExp.test(document.all.pwdErrorMinInput.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的禁用分钟数!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t//密码强度开关验证\r\n\tif(document.all.pwdStrong[1].checked)\r\n\t{\r\n\t\tvar regExp=/^[1-9]\\d*$/;\r\n\t\tif(!regExp.test(document.all.pwdStart.value))\r\n\t\t{\r\n\t\t\talert(\"请输入正确的密码最小长度!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse if(!regExp.test(document.all.pwdEnd.value)||parseInt(document.all.pwdEnd.value)>32)\r\n\t\t{\r\n\t\t\talert(\"请输入正确的密码最大长度,最大长度不能大于32位!\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse if(parseInt(document.all.pwdEnd.value)<=parseInt(document.all.pwdStart.value))\r\n\t\t{\r\n\t\t\talert(\"密码最小长度应小于最大长度!\")\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t\r\n\t");
if(com.js.util.config.SystemCommon.getAudit()!=0&&com.js.util.config.SystemCommon.getAutoAudit()!=1){ 
      out.write("\r\n\t   alert(\"数据已提交审计管理员审核！\");\r\n\t");
}
      out.write("\r\n    document.frm.submit();\r\n}\r\nfunction showAttachSize(){\r\n\tif(document.all.attachLimit[1].checked){\r\n\t\tdocument.all.attachSizeSpan.style.display='';\r\n\t}else{\r\n\t\tdocument.all.attachSizeSpan.style.display='none';\r\n\t}\r\n}\r\n//拦截器的限制\r\nfunction showFilterSize()\r\n{\r\n\tif(document.all.filterLimit[1].checked)\r\n\t{\r\n\t\tdocument.all.filterSizeSpan.style.display='';\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdocument.all.filterSizeSpan.style.display='none';\r\n\t}\r\n}\r\nfunction showEmail(){\r\n\tif(document.all.email[1].checked){\r\n\t   if(");
      out.print(mailList.size());
      out.write("<=0){\r\n\t      alert(\"请选添加web邮箱账户!\");\r\n\t      document.all.email[0].checked=true;\r\n\t\t  return;\r\n\t   }else{\r\n\t     document.all.emailSpan.style.display='';\r\n\t   }\r\n\t}else{\r\n\t\tdocument.all.emailSpan.style.display='none';\r\n\t}\r\n}\r\n\r\nfunction showPwdDate(){\r\n\tif(document.all.pwdDate[1].checked){\r\n\t\tdocument.all.pwdDateInputSpan.style.display='';\r\n\t\tdocument.getElementById(\"pwd_date_input\").value=\"\";\r\n\t}else{\r\n\t\tdocument.all.pwdDateInputSpan.style.display='none';\r\n\t}\r\n}\r\n\r\nfunction showPwdError(){\r\n\tif(document.all.pwdError[1].checked){\r\n\t\tdocument.all.pwdErrorInputSpan.style.display='';\r\n\t}else{\r\n\t\tdocument.all.pwdErrorInputSpan.style.display='none';\r\n\t}\r\n}\r\nfunction showPwdStrong(){\r\n\tif(document.all.pwdStrong[1].checked){\r\n\t\tdocument.all.pwdStrongInputSpan.style.display='';\r\n\t}else{\r\n\t\tdocument.all.pwdStrongInputSpan.style.display='none';\r\n\t}\r\n}\r\n\r\nfunction pwdCheck(){\r\n    if(document.all.pwdDate[1].checked && isNaN(document.all.pwdDateInput.value)){\r\n        alert(\"密码过期天数必须是数字！\");\r\n        document.all.pwdDateInput.focus();\r\n");
      out.write("        return ;\r\n    }\r\n    if(document.all.pwdDate[1].checked && parseInt(document.all.pwdDateInput.value) < 0){\r\n        alert(\"密码过期天数不能是负数！\");\r\n        document.all.pwdDateInput.focus();\r\n        return ;\r\n    }\r\n\tif(isNaN(document.all.pwdDateInput.value) || parseInt(document.all.pwdDateInput.value)<0){\r\n\t\talert(\"容量必须为正整数！\");\r\n\t\tdocument.all.pwdDateInput.focus();\r\n\t\treturn ;\r\n\t}\r\n  \r\n}\r\n</script>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
