/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 09:38:43 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.util.config.SystemCommon;
import java.util.*;
import com.js.system.menu.service.MenuBD;
import com.js.util.util.ReadActiveXml;
import com.js.system.service.usermanager.UserBD;
import com.js.system.service.logomanager.LogoManager;
import com.js.system.util.*;
import com.js.oa.menu.service.ShortCutBD;
import com.js.system.vo.logomanager.LogoVO;
import com.js.system.service.logomanager.LogoBD;
import com.js.util.util.BrowserJudge;
import com.js.oa.search.client.SearchService;
import com.js.oa.hntdxy.DataService;

public final class desktop_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("com.js.system.util");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.util.util.ReadActiveXml");
    _jspx_imports_classes.add("com.js.oa.search.client.SearchService");
    _jspx_imports_classes.add("com.js.oa.menu.service.ShortCutBD");
    _jspx_imports_classes.add("com.js.oa.hntdxy.DataService");
    _jspx_imports_classes.add("com.js.system.vo.logomanager.LogoVO");
    _jspx_imports_classes.add("com.js.system.service.logomanager.LogoBD");
    _jspx_imports_classes.add("com.js.system.service.logomanager.LogoManager");
    _jspx_imports_classes.add("com.js.util.config.SystemCommon");
    _jspx_imports_classes.add("com.js.system.menu.service.MenuBD");
    _jspx_imports_classes.add("com.js.util.util.BrowserJudge");
    _jspx_imports_classes.add("com.js.system.service.usermanager.UserBD");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

	response.setHeader("Cache-Control", "no-store");
	response.setHeader("Pragma", "no-cache");
	response.setDateHeader("Expires", 0);
	Locale loc = new Locale("zh_cn");
	session.setAttribute("org.apache.struts.action.LOCALE", loc);
	
	System.out.println("session:"+session.getAttribute("sessionCode_"));
    LogoManager.init();
    String logoPath="imges/i think.gif";
    String webapp=request.getContextPath();
    //String logoFile=LogoManager.getLogo("2");
    LogoVO logoVO=new LogoBD().getLogo(session.getAttribute("corpId").toString());
    String logoFile=logoVO.getLogoPath();
    if(logoFile!=null&&!logoFile.equals("")){
     logoPath=webapp+logoFile;
     String str =logoFile.substring(logoFile.lastIndexOf("/"), logoFile.length()).substring(4, 5);
     String stryear=logoFile.substring(logoFile.lastIndexOf("/"), logoFile.length()).substring(1, 4);
     if(com.js.util.config.SystemCommon.getUseClusterServer()==1){
		 logoPath=com.js.util.config.SystemCommon.getClusterServerUrl()+logoFile;
	 }
	 if("_".equals(str)){
    	 logoPath=logoPath.replace("upload/logo", "upload/"+stryear+"/logo");
     }else{
    	logoPath=logoPath.replace("upload/logo", "upload/0000/logo");
     }
    }
    
    
	String local = "zh_cn";
	String domainId = session.getAttribute("domainId") == null ? "0": session.getAttribute("domainId").toString();
	String userId = session.getAttribute("userId").toString();
	String orgId = session.getAttribute("orgId").toString();
	String orgIdString = session.getAttribute("orgIdString").toString();	
	String userIP=session.getAttribute("userIP").toString();
	
	Object[] menuObjXiala = null;
	MenuBD bd = new MenuBD();
	int i;
	List list = bd.getAllUserTopMenu(session.getAttribute("userId").toString(), orgIdString, domainId);
	Object[] obj;
	Object[] obj1;
	com.js.oa.portal.service.CustomDesktopBD customDesktopBD=new com.js.oa.portal.service.CustomDesktopBD();
	List portalList=customDesktopBD.getPersonalDesktopList(session.getAttribute("userId").toString(),session.getAttribute("orgIdString").toString(),domainId);
	//获得用户默认门户id
	ShortCutBD shortCutBD=new ShortCutBD();
	String portalId=shortCutBD.getPortalByUserId(userId);
	
	String personal_portal=null;
	String personal_isUrl=null;
	String personal_url=null;
	
					
	if(portalList!=null && portalList.size()>0){
	    obj1=(Object[])portalList.get(0); 
	    personal_portal=String.valueOf(obj1[0]);
	    personal_isUrl= obj1[4]==null?"":obj1[4].toString();
	    personal_url=obj1[5]==null?"":obj1[5].toString();
	}
	
	if (portalList!=null && portalList.size()>0&&portalId!=null) {
		
		String oen_portal;
		String oen_id;
	
		for (i = 0; i < portalList.size(); i++) {
			obj = (Object[]) portalList.get(i);
			oen_portal = String.valueOf(obj[0]);
			oen_id = String.valueOf(obj[3]);
			if(portalId!=null&&oen_id.equals(portalId)){//取出用户设置的默认门户
				personal_portal=oen_portal;
				personal_isUrl= obj[4]==null?"":obj[4].toString();
			    personal_url=obj[5]==null?"":obj[5].toString();
			}
		}
	}
	
	List dlist=new com.js.oa.portal.bean.CustomDesktopEJBBean().getPersonalDesktopDefaultList(userId,orgIdString,domainId);
	if(dlist!=null && dlist.size()>0){
	   for(int s=0;s<dlist.size();s++){
	       Object[] obj2=(Object[])dlist.get(s);
		    portalId=String.valueOf(obj2[3]);
		    personal_portal=String.valueOf(obj2[0]);
		    personal_isUrl= obj2[4]==null?"":obj2[4].toString();
		    personal_url=obj2[5]==null?"":obj2[5].toString();
		    String id=String.valueOf(obj2[3]);
		    if(id!=null&&!"".equals(id)){
		       s=dlist.size();
		    }
	   }
	}
	
	String userPassword=(String) request.getSession().getAttribute("userPassword"); 
	
	String usd=ReadActiveXml.getReadActive().getUse();
	String servertcpport=ReadActiveXml.getReadActive().getServertcpport();
	String serverudpport=ReadActiveXml.getReadActive().getServerudpport();
	
	String basePath = request.getScheme()+"://"+request.getServerName()+":";
	String servip=ReadActiveXml.getReadActive().getIp();
	String rtxlogins="0";
	if("iactive".equals(usd)){
	   
	   	UserBD userBD=new UserBD();
		rtxlogins=userBD.findUserRTXloginById(Long.parseLong(session.getAttribute("userId").toString()));
		if(null==rtxlogins||"".equals(rtxlogins)||"null".equals(rtxlogins))
		{
			rtxlogins="0";
		}
	}
	  String other=(String)request.getAttribute("other");
	  String tan=(String)request.getAttribute("tan");
	  
	  String userAccount = session.getAttribute("userAccount").toString();
	  
	  SysSetupReader sysRed = SysSetupReader.getInstance();
	  String kqflag=sysRed.getKq(domainId);
	/*  HashMap<String,String> logoConfig=StaticParam.getSysLogoConfig(domainId); 
	  String fontColor=logoConfig.get("company_color");
	  String companyName=logoConfig.get("company_name");
	  if(null==companyName)companyName="";
	  String isDisplayCompanyName=logoConfig.get("isdisplay_company_name");
	  isDisplayCompanyName="1".equals(isDisplayCompanyName)?"inline":"none";
	  String isDisplayLogo=logoConfig.get("isdisplay_logo");
	  isDisplayLogo="1".equals(isDisplayLogo)?"inline":"none";
	     */
	  String fontColor=logoVO.getCompanyColor();//logoConfig.get("company_color");
	  String companyName=logoVO.getCompanyName();//logoConfig.get("company_name");
	  if(null==companyName)companyName="";
	  String isDisplayCompanyName=logoVO.getIsdisplayCompanyName();//logoConfig.get("isdisplay_company_name");
	  isDisplayCompanyName="1".equals(isDisplayCompanyName)?"inline":"none";
	  String isDisplayLogo=logoVO.getIsdisplayLogo();//logoConfig.get("isdisplay_logo");
	  isDisplayLogo="1".equals(isDisplayLogo)?"inline":"none";
	 
	 String showTypeForVB=request.getAttribute("showTypeForVB")==null?"":request.getAttribute("showTypeForVB").toString();  
	 
	 String TransferUrl=(String)request.getAttribute("TransferUrl");
	 if(TransferUrl==null){
	 	TransferUrl=request.getParameter("TransferUrl");
	 }
	 String customName=com.js.util.config.SystemCommon.getCustomerName();
	 String operate=request.getAttribute("operate")==null?"":request.getAttribute("operate").toString();
	//湖南铁道学院从门户直接打开公告或者新闻页面或者待办事项页面
	 String urltemp="/jsoa/FileDealWithAction.do?workStatus=0";
	 if("hntdxy".equals(customName) && "dbdp".equals(operate)){
		 response.sendRedirect(urltemp);
	 }
	 String username=session.getAttribute("userName").toString();
	 String orgname=session.getAttribute("orgName").toString();
	
      out.write("\t\r\n<style type=\"text/css\">\r\n <!--\r\n body {\r\n \tmargin: 0px;\r\n\t font-family: \"宋体\";\r\n\t font-size: 12px;\r\n\t overflow:hidden;\r\n }\r\n\r\ntable {\r\n\tmargin: 0px;\r\n\tfont-family: \"宋体\";\r\n\tfont-size: 12px;\r\n}\r\n.width5 {\r\n\twidth: 5px;\r\n}\r\n\r\n#Layer1 {\r\n\tposition: absolute;\r\n\twidth: 285px;\r\n\tz-index: 1;\r\n\tleft: 529px;\r\n\ttop: 62px;\r\n\tborder: 1px solid #476EA7;\r\n\tbackground-color: #FFF;\r\n}\r\n\r\n#remindContent {\r\n\tbackground-repeat: repeat-x;\r\n\tbackground-image: url(/jsoa/imges/xok.gif);\r\n\tbackground-position: bottom;\r\n}\r\n.portalXiala{\r\n\tbackground-color:#92b7e1;\r\n\tcolor:#000;\r\n\twidth:150px;\r\n\tcursor:pointer;\r\n}\r\n.portalXialaEvel{\r\n\tbackground-color:#709CC7;\r\n\tcolor:#000;\r\n\twidth:100px;\r\n\tcursor:pointer;\r\n\ta:link;  \r\n\ta:visited ;\r\n\tcolor: white;\r\n\tdisplay: block;\r\n\tbackground: url(/jsoa/imges/menu3.gif);\r\n\tpadding: 2px 0 0 10px;\r\n}\r\n.portalXialaSanJiao{\r\n\tbackground-image:url(/jsoa/imges/0301.png);\r\n\tcolor:#000;\r\n\twidth:3px;\r\n\tcursor:pointer;\r\n}\r\n.portalXialaSanJiaoEvel{\r\n\tcolor:#6B99DB;\r\n\twidth:2px;\r\n\tcursor:pointer;\r\n}\r\n\r\n.portalXiaLaFocus{\r\n");
      out.write("\tbackground-image:url(/jsoa/imges/0201.gif);\r\n\tcolor:#000;\r\n\twidth:150px;\r\n\tcursor:pointer;\r\n}\r\n.float {\r\n\tfloat: left;\r\n}\r\n\r\n.remindWin {\r\n\toverflow-y: auto;\r\n\twidth: 253px;\r\n\theight: 161px;\r\n\tpadding-top: 8px;\r\n}\r\n.scrollbarcss{\r\n\toverflow-x:hidden;\r\n}\r\n-->\r\n</style>\r\n\r\n\r\n\r\n<html>\r\n\t<head>\r\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" />\r\n\t\t<title>");
      out.print(session.getAttribute("userName"));
      out.write(",九思协同办公系统iThink欢迎您!</title>\r\n\t\t<link href=\"/jsoa/css/menustyle.css\" rel=\"stylesheet\" type=\"text/css\" />\r\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/jsoa/js/win/skin/qq/ymPrompt.css\"/>\r\n        <!--[if IE 6]>\r\n\t\t\t<script type=\"text/javascript\" src=\"js/DD_belatedPNG.js\"></script>\r\n\t\t\t<script type=\"text/javascript\">\r\n\t\t\t\tDD_belatedPNG.fix('.IE6PNG');\r\n\t\t\t</script>\r\n\t\t<![endif]-->\r\n\t\r\n");
 if("iactive".equals(usd)) {
      out.write("\r\n<object classid=\"clsid:79B13EA1-83FB-49FD-A0D0-3F10C447DF75\" id=\"ACStart\" width=\"0\" height=\"0\"></object>\r\n\r\n<OBJECT classid=\"clsid:CB8E25A9-8FC3-49BC-81D8-AB42DA60D39D\" id=ACDownload style=\"LEFT: 0px; TOP: 0px\" codebase=\"acdownload.ocx#version=1,0,0,6\">\r\n    <PARAM NAME=\"_Version\" VALUE=\"65536\">\r\n    <PARAM NAME=\"_ExtentX\" VALUE=\"0\">\r\n    <PARAM NAME=\"_ExtentY\" VALUE=\"0\">\r\n    <PARAM NAME=\"_StockProps\" VALUE=\"0\">\r\n    <PARAM NAME=\"bForceFullVer\" VALUE=\"0\">\r\n    <PARAM NAME=\"nVerID\" VALUE=\"83886080\">\r\n    <PARAM NAME=\"strUpdataURL\" VALUE=\"\">\r\n    <PARAM NAME=\"strFullVerURL\" VALUE=\"");
      out.print(basePath );
      out.print(serverudpport);
      out.write("/downloads/e-UC_Client_CHS.exe\">\r\n    <PARAM NAME=\"strRegKey\" VALUE=\"SOFTWARE\\iActive\\ACPlayer\">\r\n    <PARAM NAME=\"strDestIniFile\" VALUE=\"ACClt.dat\">\r\n    <PARAM NAME=\"strTitle\" VALUE=\"正在下载安装客户端...;正在对客户端进行自动升级...\">\r\n</OBJECT>\r\n");
} 
      out.write("\r\n<script type=\"text/javascript\">\r\nfunction remindDivSet(){\r\n\tvar Laye22 = document.getElementById(\"Laye22\");\r\n\tLaye22.style.left=(document.body.clientWidth-256)+\"px\";\r\n\tLaye22.style.top = (document.body.clientHeight-185)+\"px\";\r\n}\r\n\r\n</script>\r\n\t</head>\r\n\t\r\n\t<body id=\"mainbody\" onload=\"TransferUrl();");
if((TransferUrl==null || "null".equals(TransferUrl) || "".equals(TransferUrl)) && portalList!=null && portalList.size()>0){ 
      out.write("gotoPortal(document.all.portal1,'");
      out.print(personal_portal);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(personal_isUrl );
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(personal_url);
      out.write('\'');
      out.write(')');
      out.write(';');
} 
      out.write("loadRemind();otherload();hiddenInput();loadclientWidth();\" onunload=\"deleteOnlineUser('");
      out.print(userId);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(userAccount);
      out.write("');\" onresize=\"loadclientWidth();remindDivSet();\" scroll=\"no\">\r\n\t\t<table width=\"100%\" height=\"100%\" border=\"0\" cellspacing=\"0\"\r\n\t\t\tcellpadding=\"0\" style=\"margin: 0px;\">\r\n\t\t\t<tr valign=\"top\" height=\"50\">\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"table-layout:fixed;\">\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td height=\"70px\" style=\"background-image:url(imges/01.gif)\" >\r\n\t\t\t\t\t\t\t\t<div style=\"padding-left:10px;\">\r\n\t\t\t\t\t\t\t\t\t<div style=\"display:inline;\">\r\n\t\t\t\t\t\t\t\t\t\t<img id=\"img_logo\" src=\"");
      out.print(logoPath);
      out.write("\" style=\"display:");
      out.print(isDisplayLogo );
      out.write(";vertical-align:middle;\" class=\"IE6PNG\"/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<span style=\"padding-top:10px;line-height:55px;height:55px;vertical-align:middle;font-weight:bold;font-family:Verdana, Geneva, sans-serif;padding-left:20px;color:");
      out.print(fontColor);
      out.write(";font-size:24px;display:");
      out.print(isDisplayCompanyName);
      out.write('"');
      out.write('>');
      out.print(companyName);
      out.write("</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t<td width=\"510px\" align=\"right\" valign=\"bottom\"\r\n\t\t\t\t\t\t\t\tstyle=\"background-image: url(imges/04.gif);\">\r\n\t\t\t\t\t\t\t\t<table width=\"100%\" height=\"5\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"padding-right: 12px; padding-bottom: 12px;\">\r\n\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t<td style=\"color: #FFF;\" nowrap>&nbsp;\r\n\t\t\t\t\t\t\t\t\t\t");
if("ynnt".equals(customName)){
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t<span style=\"color:#fff;font-weight:bold;line-height:20px;\">");
      out.print(username );
      out.write("</span>\r\n\t\t\t\t\t\t\t\t\t\t");

										}
										List sidelineList=(List)session.getAttribute("sidelineList");
										if(com.js.util.config.SystemCommon.getMultiDepart()==1 && sidelineList!=null && sidelineList.size()>0){
										
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t所属单位：\r\n\t\t\t\t\t\t\t\t\t\t\t<select id=\"changeOrg\" name=\"changeORg\" onchange=\"javascript:changeCurrentOrg(this);\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t");

												for(int si=0;si<sidelineList.size();si++){
													Object[] tmpObj=(Object[])sidelineList.get(si);
												
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"");
      out.print(tmpObj[0]);
      out.write('"');
      out.write(' ');
if(session.getAttribute("orgId").toString().equals(tmpObj[0].toString())){out.print("selected");}
      out.write(' ');
      out.write('>');
      out.print(tmpObj[1] );
      out.write("</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t");
} 
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t</select><iframe id=\"changeOrgIframe\" name=\"changeOrgIframe\" style=\"display:none;width:0px;height:0px;\" src=\"\"></iframe>\r\n\t\t\t\t\t\t\t\t\t\t");
}else{
											if("ynnt".equals(customName)){
											if(orgname.length()>20){
										
      out.write("\t\r\n\t\t\t\t\t\t\t\t\t\t</br><span style=\"color:#fff;font-weight:bold;\">");
      out.print(orgname );
      out.write("</span>\r\n\t\t\t\t\t\t\t\t\t\t\t");
}else{
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t<span style=\"color:#fff;font-weight:bold;\">");
      out.print(orgname );
      out.write("</span>\r\n\t\t\t\t\t\t\t\t\t\t");
}}}
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t");

											String projectType = session.getServletContext().getInitParameter("projectType");
											if(projectType!=null&&"tjgzw".equals(projectType)){//是天津国资委项目 增加 返回门户页的链接
											
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t<td align=\"right\"  valign=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"javascript:window.opener=null;window.open('', '_self', '');window.close();window.location.href='/jsoa/tjgzw/index_gzw.jsp'\">返回首页</a>\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t");
} 
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t");
if(!com.js.util.config.SystemCommon.getCustomerName().equals("chinaLife")){
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<td  width=\"32\" align=\"right\"  valign=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t");

										if(!"ynnt".equals(customName)){
										
      out.write("\t\r\n\t\t\t\t\t\t\t\t\t\t<img id=\"imginfo\" src=\"images/versioninfo.gif\" style=\"cursor:pointer;\" onClick=\"showVersionInfo()\" title=\"关于\"/>\r\n\t\t\t\t\t\t\t\t\t\t");
} 
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td width=\"32\" align=\"right\" valign=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"imges/back.gif\" style=\"cursor:pointer;\" onClick=\"history.back();\" title=\"后退\"/>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td width=\"32\" align=\"right\" valign=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"imges/forward.gif\" style=\"cursor:pointer;\" onClick=\"history.forward(1);\" title=\"前进\"/>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td width=\"32\" align=\"right\" valign=\"center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"imges/refresh.gif\" style=\"cursor:pointer;\" onClick=\"myRefresh();\" title=\"刷新\"/>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t");
} 
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t");

											 if(projectType==null||!"tjgzw".equals(projectType)){//是天津国资委项目 不能使用oa中退出 只能使用国资委门户上的注销功能
										    
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td width=\"32\" align=\"right\" valign=\"center\" >\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"imges/close.gif\" style=\"cursor:pointer;\" onClick=\"logOut(1);\" title=\"退出\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t");

											}
											 
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t</table>\r\n\r\n\t\t\t\t\t\t\t\t<table height=\"25\" border=\"0\" cellpadding=\"0\" cellspacing=\"1\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"background-repeat: no-repeat; color: #454545;\">\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<td align=\"right\">\r\n\t\t\t\t\t\t\t\t<div style=\"width: 65px; cursor: pointer;\"\r\n\t\t\t\t\t\t\t\t\tonclick=\"openOnlineUser();\">\r\n\t\t\t\t\t\t\t\t\t<div style=\"float: left; padding: 3px 3px 0 0;\">\r\n\t\t\t\t\t\t\t\t\t\t<img src=\"/jsoa/images/la_ba.gif\" title=\"发送即时消息\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div id=\"onlineUserNum\" style=\"color: red; float: left; padding-top:4px;\">\r\n\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div style=\"float: left;  padding-top:4px;\">\r\n\t\t\t\t\t\t\t\t\t\t人\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t");

										int index=0;
										if (portalList != null) {
											
											String oen_portal;
											String oen_portalName;
											String oen_id;
											String isUrl;
											String url;
											for (i = 0; i < portalList.size(); i++) {
												obj = (Object[]) portalList.get(i);
												oen_portal = String.valueOf(obj[0]);
												oen_id = String.valueOf(obj[3]);
												if(portalId!=null&&oen_id.equals(portalId)){
												index=i;
												oen_portalName = String.valueOf(obj[1]);
												String oen_portalName1=oen_portalName;
												isUrl = obj[4]==null?"":obj[4].toString();
								                url = obj[5]==null?"":obj[5].toString();
												if(oen_portalName.length()>4){
												    oen_portalName1=oen_portalName.substring(0,4)+"...";
												}
												
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td id=\"portal1\" align=\"center\" valign=\"middle\" title=");
      out.print(oen_portalName );
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"portalFocus\" height=\"25\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"gotoPortal(this,'");
      out.print(oen_portal);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(isUrl);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(url);
      out.write("')\">");
      out.print(oen_portalName1);
      out.write("</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t");

												}
											}			
										}
										int limit=5;//如果用户没有设置默认门户，那么在页面上再显示5个
										int limitTemp=limit;
										if(null!=portalId&&!"".equals(portalId)){
											limitTemp -= 1;//如果用户设置了默认门户，那么在页面上再显示4个
										}
										
										if (portalList != null) {
												
												String oen_portal;
												String oen_portalName;
												String oen_id;
												String isUrl;
												String url;

												for (i = 0; i < portalList.size()&&i<limitTemp; i++) {
													
													obj = (Object[]) portalList.get(i);
													oen_portal = String.valueOf(obj[0]);
													oen_id = String.valueOf(obj[3]);
													if(portalId==null||!oen_id.equals(portalId)){
													oen_portalName = String.valueOf(obj[1]);
													String oen_portalName1=oen_portalName;
													isUrl = obj[4]==null?"":obj[4].toString();
									                url = obj[5]==null?"":obj[5].toString();
													if(oen_portalName.length()>4){
													    oen_portalName1=oen_portalName.substring(0,4)+"...";
													}
										
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t<td ");
if(index>i){ 
      out.write("id=\"portal");
      out.print(i+2 );
      out.write('"');
}else if(index<=i||index==0){ 
      out.write("id=\"portal");
      out.print(i+1 );
      out.write('"');
}
      out.write(" align=\"center\" valign=\"middle\" title=");
      out.print(oen_portalName );
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"portalFocus\" height=\"25\"\r\n\t\t\t\t\t\t\t\t\t\t\tonclick=\"gotoPortal(this,'");
      out.print(oen_portal);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(isUrl);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(url);
      out.write("')\">");
      out.print(oen_portalName1);
      out.write("</td>\r\n\r\n\t\t\t\t\t\t\t\t\t\t");
}else{
											limitTemp=limitTemp+1;
										  }
											} 
										if(portalList.size()>limitTemp){
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t<td align=\"center\" valign=\"middle\"  width=\"3\" class=\"portalXialaSanJiao\" height=\"25\" onclick=\"clickXiala()\">\r\n\t\t\t\t\t\t\t\t\t\t\t<table  height=\"25\"  width=\"5\"><tr><td style=\"padding-top:3\"><img src=\"imges/daosanjiao.png\" /></td></tr></table>\r\n\t\t\t\t\t\t\t\t\t\t\t<div id=\"menu1\" class=\"scrollbarcss\" style=\"position:absolute;right:0px;z-index:20000;visibility:hidden;overflow-y:auto;height:500\" onmouseover=\"over()\" onmouseout=\"out()\">\r\n\t\t\t\t\t\t\t\t\t\t\t<table id=\"tabxiala\" border=\"0\" width=\"150\" cellpadding=\"0\" cellspacing=\"1\">\r\n\t\t\t\t\t\t\t\t\t\t\t    ");
	
														for (i =limitTemp; i < portalList.size(); i++) {
																obj = (Object[]) portalList.get(i);
																oen_portal = String.valueOf(obj[0]);
																oen_id = String.valueOf(obj[3]);
																if(portalId==null||!oen_id.equals(portalId)){
																oen_portalName = String.valueOf(obj[1]);
																String oen_portalName1=oen_portalName;
																isUrl = obj[4]==null?"":obj[4].toString();
												                url = obj[5]==null?"":obj[5].toString();
																if(oen_portalName.length()>4){
																    oen_portalName1=oen_portalName.substring(0,4)+"...";
																}
													
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr ><td ");
if(index>i){ 
      out.write("id=\"portal");
      out.print(i+2 );
      out.write('"');
}else if(index<=i||index==0){ 
      out.write("id=\"portal");
      out.print(i+1 );
      out.write('"');
}
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t valign=\"middle\" title=");
      out.print(oen_portalName );
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"portalXiala\" height=\"25\"  align=\"left\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonclick=\"gotoPortal(this,'");
      out.print(oen_portal);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(isUrl);
      out.write('\'');
      out.write(',');
      out.write('\'');
      out.print(url);
      out.write("')\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
      out.print(oen_portalName1);
      out.write("</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t");
}
													}
      out.write("\t\r\n\t\t\t\t\t\t\t\t\t\t\t   </table>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t");
}	
											}
										
      out.write("\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t\t");

						Calendar cal = Calendar.getInstance();
						int wday = cal.get(Calendar.DAY_OF_WEEK);
						Object[] menuObj = null;
						String day = "一";
						switch (wday) {
						case 1:
							day = "日";
							break;
						case 2:
							day = "一";
							break;
						case 3:
							day = "二";
							break;
						case 4:
							day = "三";
							break;
						case 5:
							day = "四";
							break;
						case 6:
							day = "五";
							break;
						case 7:
							day = "六";
							break;
						}
					
      out.write("\r\n<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"line-height: 22px; background-image: url(imges/002.gif); border-bottom: 1px solid #A5CDE5; color: #FFF;\">\r\n\t<tr>\r\n\t\t<td>\r\n\t\t\t<div id=\"menuOrderId\"  >\r\n\t\t\t\t    \t\r\n\t\t\t</div>\r\n\t\t</td>\r\n    ");
if(!"admin".equals(userAccount)&&!"audit-admin".equals(userAccount)){ 
      out.write("\r\n    <td width=\"200\" align=\"right\" valign=\"middle\">\r\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\r\n    \t<tr>\r\n        \t<td width=\"94\" align=\"right\" id=\"selectTD\">\r\n\t\t\t\t\t\t\t\t<select name=\"selectName\" id=\"selectName\" onChange=\"showInput()\">\r\n\t\t\t\t\t\t\t\t  <option value=\"\">请选择</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"Liucheng\">流程</option>\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"XieTong\">协同</option>\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"CuiBan\">催办</option>\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"XinWen\">新闻</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"GongGao\">公告</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"TaoLun\">讨论</option>\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"ZhiShi\">知识</option>\r\n\t\t\t\t\t\t\t\t  ");
if(!com.js.util.config.SystemCommon.getCustomerName().equals("chinaLife")){
      out.write("\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"RenYuan\">人员</option>\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"WBuYouJian\">外部邮件</option>\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"XRiBao\">下属日报</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"XZhouBao\">下属周报</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"XYueBao\">下属月报</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"XRiCheng\">下属日程</option>\r\n\t\t\t\t\t\t\t\t  ");
} 
      out.write("\r\n\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t  <option value=\"NBuLianXiRen\">内部联系人</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"GRenLianXiRen\">个人联系人</option>\r\n\t\t\t\t\t\t\t\t  <option value=\"GGongLianXiRen\">公共联系人</option>\r\n\t\t\t\t\t\t\t\t  ");

								  	String iSearchSwitch=SearchService.getInstance().getiSearchSwitch();
									if(null!=iSearchSwitch&&!"".equals(iSearchSwitch)&&"1".equals(iSearchSwitch)){//是否需要全文检索 
      out.write("\r\n\t\t\t\t\t\t\t\t  <option value=\"QuanWenJianSuo\">全文检索</option>\r\n\t\t\t\t\t\t\t\t  ");
}
      out.write("\r\n\t\t\t\t\t\t\t\t</select>\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t    <td width=\"80\" id=\"conditionContent\" style=\"display:none\">\r\n\t\t\t\t\t\t\t  <input  type=\"text\" size=\"10\" name=\"content\" id=\"content\"  onkeypress=\"enterkey()\" />\t\t\t\t\t\t  \r\n\t\t\t\t\t\t    </td>\r\n                            <td width=\"22\" align=\"left\" valign=\"middle\">\r\n                              <img src=\"/jsoa/images/toolbar/viewtext.gif\" width=\"19\" heigth=\"19\" style=\"cursor:pointer\" title=\"快速查询\" onClick=\"doQuery()\">                            </td>\r\n    \t</tr>\r\n    </table>\r\n    </td>\r\n     ");
} 
      out.write("\r\n  </tr>\r\n</table>\r\n\r\n                    \r\n\t  <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td style=\"background-image: url(imges/001.gif);\"></td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\r\n\t\t\t<tr>\r\n\t\t\t\t<td>\r\n\r\n\r\n\r\n\t\t\t\t\t<table width=\"100%\" height=\"100%\" border=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\tcellpadding=\"0\" style=\"margin-botoom: 1px\">\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<!-- start menu and toolbar -->\r\n\t\t\t\t\t\t\t<td id=\"leftMenuTD\" width=\"140\" height=\"100%\" style=\"display:\">\r\n\t\t\t\t\t\t\t\t<table height=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"float: left; background-image: url(imges/left-cent.gif); height: 100%; color: #003366;\">\r\n\t\t\t\t\t\t\t\t\t<tr height=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t<td id=\"leftMenuLeftTD\" height=\"100%\">\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<table height=\"100%\" width=\"132\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t");

												String button_url="/jsoa/menu/left_bottom.jsp";
												String left_url="/jsoa/menu/left_top.jsp";
												String main_url="about:blank";
												if("admin".equals(userAccount)){
												    button_url="/jsoa/menu/left_bottom_set.jsp";
												    left_url="/jsoa/menu/setup.jsp";
												    main_url="/jsoa/setup/systemmanager_sysSetup.jsp";
												  }
												if("audit-admin".equals(userAccount)){
													button_url="/jsoa/menu/left_bottom_audit_set.jsp";
												    left_url="/jsoa/menu/auditSetup.jsp";
												    main_url="/jsoa/AuditLogAction.do?action=daiShenHeList";
												}
												
      out.write("\r\n\t\t\t\t\t\t\t\t\t\t\t\t<tr valign=\"top\" id=\"TR_MenuTop_ORT\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<iframe id=\"menuTop\" name=\"menuTop\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"");
      out.print(left_url );
      out.write("\" frameborder=\"0\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"100%\" height=\"100%\" scrolling=\"no\"></iframe>\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<tr valign=\"top\" style=\"display:none\" id=\"TR_MenuTop_NEW\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<iframe id=\"menuTop_1001\" name=\"menuTop_1001\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"");
      out.print(left_url );
      out.write("\" frameborder=\"0\" border=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"100%\" height=\"100%\" scrolling=\"no\"></iframe>\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<tr id=\"leftBottomTR\" valign=\"bottom\"> \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td valign=\"bottom\"  height=\"177\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<iframe id=\"menuBotoom\" name=\"menuBotoom\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"");
      out.print(button_url);
      out.write("\" frameborder=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tborder=\"0\" width=\"100%\" height=\"100%\" scrolling=\"no\"></iframe>\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t<td style=\"background-image:url(/jsoa/imges/cent.gif)\">\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<a><img src=\"/jsoa/imges/hide.gif\" title=\"收起左面板\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"cursor: pointer\" onClick=\"openMenu(this);\" /> \r\n\t\t\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t </td>\r\n\t\t\t\t\t\t\t<!-- end of menu and toolbar -->\r\n\t\t\t\t\t\t\t<!-- start mainFrame -->\r\n\t\t\t\t\t\t  <td height=\"100%\"><table width=\"100%\" height=\"100%\" border=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\t\t\t\t\tcellpadding=\"0\" style=\"margin: 1px;\">\r\n                            <tr id=\"content1\" width=\"100%\" height=\"100%\" valign=\"top\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"display: \">\r\n                              <td width=\"150\" height=\"100%\" id=\"content2\"\r\n\t\t\t\t\t\t\t\t\t\t\tstyle=\"display: none\"><iframe id=\"leftFrame\" name=\"leftFrame\" src=\"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tframeborder=\"0\" border=\"0\" width=\"100%\" height=\"100%\"\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\t\tscrolling=\"yes\"></iframe></td>\r\n                              <td><div style=\"width: 100%; height: 100%; display: inline;\">\r\n                              ");
boolean bflag=true;
                              if(BrowserJudge.isFirefox(request)||BrowserJudge.isMSIE10(request)){
                              bflag=false;
      out.write(" \r\n                              <iframe id=\"MainDesktop\" name=\"MainDesktop\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"");
      out.print(main_url );
      out.write("\" frameborder=\"0\" border=\"0\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"100%\"></iframe>\r\n\t\t\t\t\t\t\t\t<script type=\"text/javascript\">\r\n\t\t\t\t\t\t\t\t    var h=0;\r\n\t\t\t\t\t\t\t\t    var w=0;\r\n\t\t\t\t\t\t\t\t\tsetInterval(\"showScrollBar ()\",200);\r\n\t\t\t\t\t\t\t\t\tfunction showScrollBar () {\r\n\t\t\t\t\t\t\t\t\t\tif(w!=document.body.clientWidth||h!=document.body.clientHeight){\r\n\t\t\t\t\t\t\t\t\t    \th=document.body.clientHeight;\r\n\t\t\t\t\t\t\t\t\t    \tw=document.body.clientWidth;\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"menuShow\").style.height=h-363;\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById(\"MainDesktop\").style.width=w-140;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\t\t\r\n\t\t\t\t\t\t\t\t</script>\r\n                              ");
}else{ 
      out.write("\r\n                                  <iframe id=\"MainDesktop\" name=\"MainDesktop\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"");
      out.print(main_url );
      out.write("\" frameborder=\"0\" border=\"0\" width=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"100%\"></iframe>");
} 
      out.write("\r\n                              </div>                              </td>\r\n                            </tr>\r\n                          </table></td>\r\n\t\t\t\t\t\t\t<!-- end of mainFrame -->\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr style=\"display:none\">\r\n\t\t\t\t\t\t   <td>\r\n\t\t\t\t\t\t   <iframe id=\"deskIframe\" src=\"\"></iframe>\r\n\t\t\t\t\t\t   <iframe id=\"recordIframe\" src=\"\"></iframe>\r\n\t\t\t\t\t\t   \r\n\t\t\t\t\t\t   </td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t</table>\r\n\t\t\t<div id=\"remindDIV\" style=\"display: none\">\r\n\t\t\t<div id=\"Laye22\" style=\"display: none; position: absolute; width: 255px; z-index: 1; right: 10px; top: 20px; border: 1px solid #476EA7; background-color: #FFF;\">\r\n\t\t\t\t<table width=\"100%\" height=\"100%\" border=\"0\" cellspacing=\"0\"\r\n\t\t\t\t\tcellpadding=\"0\">\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td height=\"22\" width=\"253\" align=\"left\" valign=\"middle\"\r\n\t\t\t\t\t\t\tstyle=\"background-image: url(/jsoa/imges/sad.gif); background-repeat: repeat-x;\">\r\n\t\t\t\t\t\t\t<div class=\"float\"\r\n\t\t\t\t\t\t\t\tstyle=\"width: 58px; padding-left: 2px; color: #FFF; align: right;\">\r\n\t\t\t\t\t\t\t\t督办提醒\r\n\t\t\t\t\t\t\t</div>\r\n");
      out.write("\t\t\t\t\t\t\t<div class=\"float\" style=\"color: red; width: 25px; align: left;\"\r\n\t\t\t\t\t\t\t\tid=\"remindWinNum\">\r\n\t\t\t\t\t\t\t\t0\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div id=\"divTitle\" class=\"float\"\r\n\t\t\t\t\t\t\t\tstyle=\"width: 150px; cursor: pointer;\"\r\n\t\t\t\t\t\t\t\tondblclick=\"document.all.remindWinImg.onclick();\"></div>\r\n\t\t\t\t\t\t\t<div class=\"float\" style=\"width: 15px; padding-top: 1px;float:right;\">\r\n\t\t\t\t\t\t\t\t<img id=\"remindWinImg\" src=\"/jsoa/imges/xiaohua.gif\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"cursor: pointer;\" onClick=\"showRemindBar(this);\" />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr id=\"remindTR\" style=\"display: none\">\r\n\t\t\t\t\t\t<td height=\"161\" valign=\"top\" width=\"253\" id=\"remindContent\"></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t\t<div style=\"display:none\">\r\n\t\t\t <BGSOUND src=\"\" autostart=\"false\" loop=\"1\" id=\"newmessage\" name=\"newmessage\">\t\t\t \r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\r\n\t<div style=\"display:none;\" >\r\n\t<!-- ithink 精灵使用字段 -->\r\n\t<input type=\"button\" name=\"msgForVB\" id=\"msgForVB\" value=\"nihao\"  onclick=\"msgShow(this)\"/>\r\n\t<input type=\"hidden\" name=\"userAccountForVB\" id=\"userAccountForVB\" value=\"");
      out.print(userAccount);
      out.write("\" />\r\n\t<input type=\"hidden\" name=\"showTypeForVB\" id=\"showTypeForVB\" value=\"");
      out.print(showTypeForVB);
      out.write("\" />\r\n\t</div>\r\n\t<input type=\"hidden\" name=\"multiSelectItem\" id=\"multiSelectItem\" value=\"\" />\r\n\t</body>\r\n</html>\r\n<script>\r\nfunction TransferUrl(){\r\n");

if(TransferUrl!=null&&!"".equals(TransferUrl)){
	if(request.getAttribute("urlTarget")!=null&&"newPage".equals(request.getAttribute("urlTarget")+"")){ 
      out.write("\r\n\twindow.open(\"");
      out.print(TransferUrl );
      out.write("\");\r\n\t");
}else{
		if("weekreport".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/WorkReportAction.do?action=list&reportType=1\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/ModuleMenuAction.do?menuid=1586\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t");

		}else if("workflow".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/FlowListAction.do?moduleId=1\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/menu/workflow.jsp\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t");

		}else if("bbs".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/ForumClassAction.do?action=listAll\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/menu/public.jsp\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t\r\n\t\t\t");

		}else if("calendar".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/eventAction.do?action=getEventByDay\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/menu/scheme.jsp\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t\r\n\t\t\t");

		}else if("personaldoc".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/NetdiskAction.do?action=list&id=320\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/ChannelMenuAction.do?channelType=0&userChannelName=知识管理\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t\r\n\t\t\t");

		}else if("mysendflow".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/FileDealWithAction.do?workStatus=1\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/menu/left_top.jsp\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t\r\n\t\t\t");

		}else if("waitdealwith".equals(TransferUrl)){
			
      out.write("\r\n\t\t\tMainDesktop.location.href=\"/jsoa/FileDealWithAction.do?workStatus=0\";\r\n\t\t\tdocument.all.menuTop.src=\"/jsoa/menu/left_top.jsp\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t\t\t\r\n\t\t\t");

		}else{
		
      out.write("\t\r\n\t\t\tMainDesktop.location.href=\"");
      out.print(TransferUrl );
      out.write("\";\r\n\t\t\tcontent1.style.display='';\r\n\t\t\tcontent2.style.display='none';\r\n\t  ");
}
	  }
	} 
      out.write("\r\n}\r\n\r\n\r\n");
Object[] menuObjMeau = null;
 int indexValue=0;

      out.write("\r\n\r\nfunction loadclientWidth() \r\n{          \r\n   var username=\"");
      out.print(userAccount);
      out.write("\"; // 用户名\t\r\n   var indexValue=0;\r\n   var aryMenu= new Array();\r\n   var aryOrder= new Array(); \r\n   var rigthSize=getRightSize();\r\n   var orderMenuSize=getOrderMenuSize();\r\n   aryMenu=arrayList();\r\n  \r\n   var tableHtml=\"\";\r\n   var days=[\"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\"];\r\n   var date =new Date();\r\n   tableHtml+=\"<table width='80%' border='0' cellspacing='0' cellpadding='0' style='line-height: 22px; background-image: url(imges/002.gif); color: #FFF;'>\";\r\n   tableHtml+=\"<tr>\";\r\n   tableHtml+=\"<td width='140' nowrap='nowrap' align='center' valign='middle' style='width: 140px;'>\";\r\n   tableHtml+=\"&nbsp;\"+(date.getMonth()+1)+\"月\"+date.getDate()+\"日&nbsp;\"+days[date.getDay()]+\"</td>\";\r\n   tableHtml+= \"<td width='5' align='left' valign='middle' class='width5' style='padding-top:5px;'>\";\r\n   tableHtml+= \"<img src='imges/003.gif' /> </td>\"\t;\r\n   \r\n   for(var j=0;j<aryMenu.length && j<orderMenuSize;j++)\r\n   {\r\n\t  aryOrder=aryMenu[j].split(\"#$#\");\r\n\t   if (\"admin\"!=username && \"audit-admin\"!=username) \r\n\t\t{\r\n\t\t   if(aryOrder[0].indexOf(\"ZZZZZGRS\")==0){\r\n");
      out.write("\t\t\t   var menuNameTemp=aryOrder[0].substring(8);\r\n\t\t\t    tableHtml+=\"<td width='44' nowrap='nowrap' align='center' valign='middle' class='topMenuNormal' id='topMenuTD\"+j+\"' \";\r\n\t\t\t\ttableHtml+=\"onclick=jumpNewWindow(this,'\"+aryOrder[1]+\"','\"+orderMenuSize+\"',1);>\"+menuNameTemp+\"</td>\";\r\n\t\t\t\ttableHtml+=\"<td width='17' nowrap='nowrap' align='center' valign='middle' class='width5' style='padding-top:5px;'>\";\r\n\t\t\t\ttableHtml+=\"<input type='hidden' name='topMenuLeftURL' value=''>\";\r\n\t\t\t\ttableHtml+=\"<img src='imges/003.gif' />\t\";\r\n\t\t\t\ttableHtml+=\"</td>\";\r\n\t\t   }else if(aryOrder[0].indexOf(\"ZZZZMAIN\")==0){\r\n\t\t\t   var menuNameTemp=aryOrder[0].substring(8);\r\n\t\t\t    tableHtml+=\"<td width='44' nowrap='nowrap' align='center' valign='middle' class='topMenuNormal' id='topMenuTD\"+j+\"' \";\r\n\t\t\t\ttableHtml+=\"onclick=jumpNewWindow(this,'\"+aryOrder[1]+\"','\"+orderMenuSize+\"',3);>\"+menuNameTemp+\"</td>\";\r\n\t\t\t\ttableHtml+=\"<td width='17' nowrap='nowrap' align='center' valign='middle' class='width5' style='padding-top:5px;'>\";\r\n\t\t\t\ttableHtml+=\"<input type='hidden' name='topMenuLeftURL' value=''>\";\r\n");
      out.write("\t\t\t\ttableHtml+=\"<img src='imges/003.gif' />\t\";\r\n\t\t\t\ttableHtml+=\"</td>\";\r\n\t\t   }else if(aryOrder[0].indexOf(\"ZGRSZZZZ\")==0){\t\t   \r\n\t\t\t   var menuNameTemp=aryOrder[0].substring(8);\r\n\t\t\t    tableHtml+=\"<td width='44' nowrap='nowrap' align='center' valign='middle' class='topMenuNormal' id='topMenuTD\"+j+\"' \";\r\n\t\t\t\ttableHtml+=\"onclick=jumpNewWindow(this,'\"+aryOrder[1]+\"','\"+orderMenuSize+\"',2);>\"+menuNameTemp+\"</td>\";\r\n\t\t\t\ttableHtml+=\"<td width='17' nowrap='nowrap' align='center' valign='middle' class='width5' style='padding-top:5px;'>\";\r\n\t\t\t\ttableHtml+=\"<input type='hidden' name='topMenuLeftURL' value=''>\";\r\n\t\t\t\ttableHtml+=\"<img src='imges/003.gif' />\t\";\r\n\t\t\t\ttableHtml+=\"</td>\";\r\n\t\t   }\r\n\t\t   else if (1==aryOrder[3] && \"undefined\"!=aryOrder[3]) \r\n\t\t\t{ \r\n\t\t\t\ttableHtml+=\"<td width='44' nowrap='nowrap' align='center' valign='middle' class='topMenuNormal' id='topMenuTD\"+j+\"' \";\r\n\t\t\t\ttableHtml+=\"onclick=jump(this,'\"+aryOrder[1]+\"','\"+aryOrder[2]+\"','\"+orderMenuSize+\"');>\"+aryOrder[0]+\"</td>\";\r\n\t\t\t\ttableHtml+=\"<td width='17' nowrap='nowrap' align='center' valign='middle' class='width5' style='padding-top:5px;'>\";\r\n");
      out.write("\t\t\t\ttableHtml+=\"<input type='hidden' name='topMenuLeftURL' value='\"+aryOrder[1]+\"'>\";\r\n\t\t\t\ttableHtml+=\"<img src='imges/003.gif' />\t\";\r\n\t\t\t\ttableHtml+=\"</td>\";\r\n\t\t\t}\r\n\t\t\telse if(\"undefined\"!=aryOrder[3])\r\n\t\t\t{\r\n\t\t\t\t\r\n\t\t\t\ttableHtml+=\"<td width='44' nowrap='nowrap' align='center' valign='middle' class='topMenuNormal' id='topMenuTD\"+j+\"' \";\r\n\t\t\t\ttableHtml+=\"onclick=jump(this,'\"+aryOrder[1]+\"','/jsoa/module/jump_link.jsp?menuid=\"+aryOrder[4]+\"&flag=1','\"+orderMenuSize+\"');>\"+aryOrder[0]+\"</td>\";\r\n\t\t\t\ttableHtml+=\"<td width='17' nowrap='nowrap' align='center' valign='middle' class='width5' style='padding-top:5px;'>\"\r\n\t\t\t\ttableHtml+=\"<input type='hidden' name='topMenuLeftURL' \";\r\n\t\t\t\ttableHtml+=\t\"value='\"+aryOrder[1]+\"'>\";\r\n\t\t\t\ttableHtml+=\"<img src='imges/003.gif' />\";\r\n\t\t\t\ttableHtml+=\"</td>\";\r\n\t\t\t}\r\n\t\t}\t\r\n   }\r\n   if(aryMenu.length>orderMenuSize)\r\n   {\r\n\t   var aryOrderXiala=new Array();\r\n\t   tableHtml+=\"<td align='center' valign='middle'  width='3' class='portalXialaSanJiaoEvel' height='20'  onclick='clickXialaEvel()'>\";\r\n");
      out.write("\t   tableHtml+=\"<table height='20' width='5'><tr><td style='padding-top:3'><img src='imges/daosanjiao.png' /></td></tr></table>\";\r\n\t   tableHtml+=\"<div id='menuEvel' class='scrollbarcss' style='display:none;position:absolute;right:'\"+rigthSize+\"'px;\"+\r\n\t   \t\t\t\t\t\"z-index:60000;visibility:hidden;overflow-y:auto;height:500' onmouseover='overEvel();' onmouseout='outEvel()'>\";\r\n\t   tableHtml+=\"<table  id='tabxiala' border='0' width='100' cellpadding='0' cellspacing='0'>\";\r\n\t   \r\n\t   for(var j=orderMenuSize;j<aryMenu.length ;j++)\r\n\t   {\r\n\t\t   aryOrderXiala=aryMenu[j].split(\"#$#\");\r\n\t\t   if (\"admin\"!=username&&\"audit-admin\"!=username) \r\n\t\t\t{\r\n\t\t\t   if(aryOrderXiala[0].indexOf(\"ZGRSZZZZ\")==0){\r\n\t\t\t\t   var indexId=Number(0);\r\n\t\t\t\t\tif(Number(indexValue)>j)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindexId=Number(j)+2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(Number(indexValue)<=Number(j)||Number(indexValue)==0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindexId=Number(j)+1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t   var menuNameTemp=aryOrderXiala[0].substring(8);\r\n\t\t\t\t    tableHtml+= \"<tr align='center'> \" ;\r\n\t\t\t\t\ttableHtml+= \"<td id=topMenuTD\"+indexId+\"   align='center'  class='portalXialaEvel' height='25'   \"; \r\n");
      out.write("\t\t\t\t\ttableHtml+=\t\"onclick=jumpNewWindow(this,'\"+aryOrderXiala[1]+\"','\"+orderMenuSize+\"',1); title=\"+aryOrderXiala[0]+\">\"+aryOrderXiala[0]+\" \" ;\r\n\t\t\t\t\ttableHtml+= \"<input type='hidden' name='topMenuLeftURL'\";\r\n\t\t\t\t\ttableHtml+=\t\"value='\"+aryOrderXiala[1]+\"'>\";\r\n\t\t\t\t\ttableHtml+=\t\"</td>\";\r\n\t\t\t\t\ttableHtml+= \"</tr>\";\r\n\t\t\t   }\r\n\t\t\t   else if (\"1\"==aryOrderXiala[3]) \r\n\t\t\t\t{ \r\n\t\t\t\t\tvar indexId=Number(0);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(Number(indexValue)>j)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindexId=Number(j)+2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(Number(indexValue)<=Number(j)||Number(indexValue)==0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindexId=Number(j)+1;\r\n\t\t\t\t\t}\r\n                   \t\t\t\t\t\t\t\r\n\t\t\t\t\ttableHtml+= \"<tr align='center'> \" ;\r\n\t\t\t\t\ttableHtml+= \"<td id=topMenuTD\"+indexId+\"   align='center'  class='portalXialaEvel' height='25'   \"; \r\n\t\t\t\t\ttableHtml+=\t\"onclick=jump(this,'\"+aryOrderXiala[1]+\"','\"+aryOrderXiala[2]+\"','\"+orderMenuSize+\"'); title=\"+aryOrderXiala[0]+\">\"+aryOrderXiala[0]+\" \" ;\r\n\t\t\t\t\ttableHtml+= \"<input type='hidden' name='topMenuLeftURL'\";\r\n\t\t\t\t\ttableHtml+=\t\"value='\"+aryOrderXiala[1]+\"'>\";\r\n");
      out.write("\t\t\t\t\ttableHtml+=\t\"</td>\";\r\n\t\t\t\t\ttableHtml+= \"</tr>\";\r\n\t\t\t\t }\r\n\t\t\t\t else\r\n\t\t\t\t {\r\n\t\t\t\t\tvar indexId=Number(0);\r\n\t\t\t\t\tif(Number(indexValue)>j)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindexId=Number(j)+2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(Number(indexValue)<=Number(j)||Number(indexValue)==0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindexId=Number(j)+1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t \r\n\t\t\t\t   tableHtml+=  \"<tr >\";\r\n\t\t\t\t   tableHtml+=  \"<td  id=topMenuTD\"+indexId+\" width='100%' align='center' \";\r\n\t\t\t\t   tableHtml+=\t\"class='portalXialaEvel' height='25'  \";\r\n\t\t\t\t   tableHtml+=\t\"onclick=jump(this,'\"+aryOrderXiala[1]+\"','/jsoa/module/jump_link.jsp?menuid=\"+aryOrderXiala[4]+\"&flag=1','\"+orderMenuSize+\"');title=\"+aryOrderXiala[0]+\">\"+aryOrderXiala[0]+\" \";\r\n\t\t\t\t   tableHtml+=\t\"<input type='hidden' name='topMenuLeftURL' value=\"+aryOrderXiala[1]+\">\";\r\n\t\t\t\t   tableHtml+=\t\"</td></tr>\";\r\n                  }\r\n\t        }\t\r\n\t\t\t\t\r\n      }\r\n\t  tableHtml+=\"</table> </div> </td>\";\r\n   }\r\n   \r\n   tableHtml+=\"<td>&nbsp;</td>\";\r\n   tableHtml+=\"</tr></table>\";\r\n   \r\n   document.getElementById(\"menuOrderId\").innerHTML=tableHtml;\r\n");
      out.write("}\r\n//获取菜单list 数组并且相应的封装转换成js 字符串\r\nfunction arrayList()\r\n{\r\n\t var ary=new Array();\r\n\t");
if(com.js.util.config.SystemCommon.getCustomerName().equals("chinaLife")){
      out.write("\r\n\tary[ary.length]='ZZZZZGRS公文流转#$#/oa/servlet/com.zotn.screens.HomeProxyServlet';\r\n\tary[ary.length]='ZZZZZGRS内部邮箱#$#/domino/redirect.nsf/redire?openform';\r\n\tary[ary.length]= '新闻通告#$#/jsoa/menu/public.jsp#$#/jsoa/info/publicInfo.jsp#$#1#$#1000';\r\n\t");
if(userIP.endsWith("32.136") || userIP.endsWith("32.137")){ 
      out.write("\r\n\tary[ary.length]= 'ZZZZMAIN投资信息#$#/jsoa/portal2/transitionMain.jsp?filemain=layout20140829191131.xml';\r\n\t");
}
      out.write('\r');
      out.write('\n');
      out.write('	');
}
      out.write("\r\n\t\r\n\t");
 for(int k=0 ; k<list.size(); k++)
	{
		menuObjMeau = (Object[]) list.get(k);
	
      out.write("\r\n\t  ary[ary.length]= '");
      out.print(menuObjMeau[0]+"#$#"+menuObjMeau[1]+"#$#"+menuObjMeau[2]+"#$#"+menuObjMeau[3]+"#$#"+menuObjMeau[4]);
      out.write("';\r\n\t");
}
      out.write('\r');
      out.write('\n');
      out.write('	');
if(com.js.util.config.SystemCommon.getCustomerName().equals("chinaLife")){
      out.write("\r\n\tary[ary.length]='ZGRSZZZZ常用应用#$#/jsoa/chinaLife/ssoMenu.jsp';\r\n\t");
}
      out.write("\r\n\t\r\n\treturn ary;\r\n\t\r\n}\r\n//根据浏览器的长度宽度获取相应的菜单的个数\r\nfunction getOrderMenuSize()\r\n{\r\n\t   var clientWidth = document.body.clientWidth ;\r\n\t   var limitOrderMenuSize;\r\n\t   //alert(clientWidth);\r\n\t   if(Number(clientWidth)>450  )\r\n\t   {\r\n\t\t   limitOrderMenuSize=clientWidth/100;\r\n\t   }\r\n\t   else if( Number(clientWidth)>250 && Number(clientWidth)<450)\r\n\t   {\r\n\t\t   limitOrderMenuSize=2;\r\n\t   }\r\n\t   else if( Number(clientWidth)<=250)\r\n\t   {\r\n\t\t   limitOrderMenuSize=1;\r\n\t   }\r\n\t   \r\n\t   if(Number(clientWidth)>=500 && Number(clientWidth)<=560)\r\n\t   {\r\n\t\t   limitOrderMenuSize=4;\r\n\t   }\r\n\t   if(Number(clientWidth)>=450 && Number(clientWidth)<500)\r\n\t   {\r\n\t\t   limitOrderMenuSize=3;\r\n\t   }\r\n\t   \r\n\t   \r\n\t return Number(limitOrderMenuSize).toFixed(0);\r\n\t\r\n}\r\n//获取相应的下拉列表所处的位置以及相应的宽度\r\nfunction getRightSize()\r\n{\r\n\tvar clientWidth = document.body.clientWidth ;\r\n    var  rightSize=Number(145);\r\n    rightSize= Number(clientWidth)*0.99;\r\n     \r\n    return rightSize;\r\n\r\n}\r\n\r\n//当窗口获得焦点后，停止标题滚动--开始\r\nvar stopTitleScroll=function(){\r\n\tif(1!=titleScrollStope){\r\n");
      out.write("\t\ttitleScrollStope=1;\r\n\t}\r\n}\r\n");
if(!BrowserJudge.isMSIE(request)){ 
      out.write("\r\n\twindow.onclick=stopTitleScroll;\r\n");
}else{
      out.write("\r\n\twindow.onfocus=stopTitleScroll;\r\n");
}
      out.write("\r\n//当窗口获得焦点后，停止标题滚动--结束\r\n\r\nvar modiImgHeight=new function()\r\n{\r\n\tvar img=document.getElementById(\"img_logo\");\r\n\tif(img.height>55)\r\n\t{\r\n\t\timg.style.height=55+\"px\";\r\n\t}\r\n\telse\r\n\t\timg.style.height=\"auto\";\r\n}\r\n// start drag\r\nvar posX; \r\nvar posY;    \r\n\r\nfdiv = document.getElementById(\"Laye22\");\r\nfunction RegDrag(dragId,moveId){    \r\n    var drag=document.getElementById(dragId);//拖动的目标，即鼠标按下时的区域。    \r\n    var target=document.getElementById(moveId);//移动的目标，即拖动时移动的区域。    \r\n    target.style.position=\"absolute\";//position属性设置为absulute才可正常移动。    \r\n    var canMove=false;//是否处于可以拖动的状态。    \r\n    var mouseDownX=0,mouseDownY=0;//记录鼠标按下时位置。    \r\n    var mouseDownLeft=0,mouseDownY=0;//记录鼠标按下时移动目标的位置。    \r\n   \r\n    var DragConfig={};//创建一个对象用来管理事件。    \r\n\tDragConfig.startMove=function(){    \r\n\t    drag.setCapture();//使得drag可以捕获全屏幕内的所有事件。    \r\n\t   \t/*记录鼠标按下时的状态。*/   \r\n\t    mouseDownX=event.screenX;    \r\n\t    mouseDownY=event.screenY;    \r\n\t    mouseDownLeft=target.offsetLeft;    \r\n\t    mouseDownTop=target.offsetTop;    \r\n\t    canMove=true;//是否可以移动标识为true，使doMove方法有效。    \r\n");
      out.write("     }    \r\n     DragConfig.doMove=function(){    \r\n        if(canMove){/*如果可以移动，则改变target的位置。*/   \r\n         var imgr=document.getElementById(\"remindWinImg\");\r\n       \r\n        if(imgr.src.indexOf(\"xiaohua.gif\")>=0)\r\n        {\r\n        \r\n        if(mouseDownTop+(event.screenY-mouseDownY)>0&&document.body.clientHeight-(mouseDownTop+(event.screenY-mouseDownY))>25)\r\n         {\r\n             target.style.top=mouseDownTop+(event.screenY-mouseDownY);\r\n         }    \r\n         \r\n            \r\n        }else\r\n        {\r\n        \r\n        if(mouseDownTop+(event.screenY-mouseDownY)>0&&document.body.clientHeight-(mouseDownTop+(event.screenY-mouseDownY))>185)\r\n         {\r\n             target.style.top=mouseDownTop+(event.screenY-mouseDownY);\r\n         }   \r\n        \r\n        }\r\n        \r\n        \r\n         if(mouseDownLeft+(event.screenX-mouseDownX)>0&& document.body.clientWidth-(mouseDownLeft+(event.screenX-mouseDownX))>255)\r\n         {\r\n            \r\n             target.style.left=mouseDownLeft+(event.screenX-mouseDownX);    \r\n");
      out.write("         }       \r\n        \r\n        \r\n        \r\n         }    \r\n     }    \r\n     DragConfig.endMove=function(){\r\n         drag.releaseCapture();//释放drag的事件捕获。    \r\n         canMove=false;//是束可以移动标识为false,doMove方法无效。    \r\n     }    \r\n   \r\n     drag.onmousedown=DragConfig.startMove;//将startMove方法绑定到onmousedown    \r\n     drag.onmousemove=DragConfig.doMove;//将doMove方法绑定到onmousemove    \r\n     drag.onmouseup=DragConfig.endMove;//将endMove方法绑定到onmouseup    \r\n}   \r\n ");
if("1".equals(kqflag)) {
      out.write("\r\n var MyInterval1=setInterval(getRecord,60000,null);\r\n\r\nfunction getRecord(){ \r\n   //document.all.recordIframe.src=\"/jsoa/public/jsp/record.jsp\";\r\n  \r\n}\r\n");
}
      out.write("\r\nfunction loadRemind(){\r\n   \r\n   var checkBrow=\"\";\r\n   if(navigator.userAgent.indexOf(\"Trident/7.0\")>=0 && navigator.userAgent.indexOf(\"MSIE\")>=0){\r\n      checkBrow =\"IE11360\";\r\n   }else if(navigator.userAgent.indexOf(\"Trident/7.0\")>=0 && navigator.userAgent.indexOf(\"MSIE\")<0){\r\n      checkBrow=\"IE11\"; \r\n   }\r\n    \r\n\ttry{\r\n\t\tif(self.frameElement.tagName==\"IFRAME\"){\t\t\t\r\n\t\t\twindow.parent.location.href=\"/jsoa/desktop.jsp\";\r\n\t\t}\r\n\t}catch(e){\r\n\t\t//alert(e);\r\n\t}\r\n\r\n");
if("1".equals(kqflag)) {
      out.write("\r\n getRecord();\r\n");
}
      out.write("\r\n \r\n  //判断是否有节日贺卡等提醒\r\n  document.all.deskIframe.src=\"/jsoa/public/jsp/getfestival.jsp?checkBrow=\"+checkBrow;\r\n  fdiv.style.display='';\r\n  var winTop=window.screenTop;\r\n  var winLeft=window.screenLeft; \r\n  \r\n  var bodyOffsetHeight=document.body.offsetHeight;\r\n  var bodyOffsetWidth=document.body.offsetWidth;  \r\n    \r\n  fdiv.style.left=(winLeft+bodyOffsetWidth-260)+\"px\";\r\n  fdiv.style.top=(winTop+bodyOffsetHeight-132)+\"px\";  \r\n  RegDrag(\"divTitle\",\"Laye22\");//注册拖动。 \r\n  setTimeout(\"getMessage()\",900);  \r\n}\r\n\r\nvar oldWinTop,oldWinLeft;\r\n\r\nfunction showRemindBar(obj){\r\n\t\r\nvar winTop=window.screenTop;\r\nvar winLeft=window.screenLeft;  \r\n\r\nif(winTop<0){  \t\r\n\twinTop=oldWinTop;\r\n\twinLeft=oldWinLeft;\r\n}else{\r\n oldWinTop=winTop;\r\n oldWinLeft=winLeft;\r\n}\r\n \r\n// var bodyOffsetHeight=document.body.offsetHeight;\r\n// var bodyOffsetWidth=document.body.offsetWidth;\r\nif(obj.src.indexOf(\"xiaohua.gif\")>=0){\r\n  fdiv.style.top=(document.body.clientHeight-185)+\"px\";  \r\n  document.all.remindTR.style.display='';\r\n  obj.src=\"/jsoa/imges/dahua.gif\";\r\n");
      out.write("}else{\r\n  fdiv.style.top=(document.body.clientHeight-25)+\"px\";  \r\n  document.all.remindTR.style.display='none';\r\n  obj.src=\"/jsoa/imges/xiaohua.gif\";\r\n}\r\n}\r\n//end drag\r\n\r\nfunction showChat(id){\t\t    \r\n\tvar wid=600;\r\n\tvar heigh=550;\r\n\tvar popwin=window.open('/jsoa/chat/showChat.jsp?id='+id+'', 'newWin', 'height='+heigh+', width='+wid+', top=200, left=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no')\r\n}\r\n\r\nfunction chat(id){\t\t    \r\n\tvar wid=428;\r\n\tvar heigh=283;\t\t\t\r\n\tvar popwin=window.open('/jsoa/chat/chat.jsp?id='+id+'', 'newWin', 'height='+heigh+', width='+wid+', top=200, left=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no')\t   \r\n\r\n}\r\n\r\nfunction init(xmlFile){\r\n\tMainDesktop.location.href=\"portal2/transitionMain.jsp?filemain=\"+xmlFile;\r\n\tcontent1.style.display='';\r\n\tcontent2.style.display='none';\r\n}\r\n\r\nfunction jump(obj,leftURL,rightURL,meaulmitSize)\r\n{\r\n  ");
if(com.js.util.config.SystemCommon.getCustomerName().equals("chinaLife")){
      out.write("\r\n  var menuSize=");
      out.print((list.size()+5));
      out.write(";\r\n  ");
}else{
      out.write("\r\n  var menuSize=");
      out.print(list.size());
      out.write(";\r\n  ");
}
      out.write("\r\n\r\n   for(i=0;i<menuSize+1;i++)\r\n   {  \r\n\t      var z='topMenuTD'+i;\r\n\t      \r\n\t      if(document.getElementById(z))\r\n\t      {\r\n\t\t      if(Number(i)<Number(meaulmitSize))\r\n\t\t      {   \r\n\t\t\t   \tdocument.getElementById(z).className=\"topMenuNormal\";\r\n\t\t   \t    obj.className=\"topMenuFocus\";\r\n\t\t      }\r\n\t\t      else\r\n\t\t      {\r\n\t\t          document.getElementById(z).className=\"portalXialaEvel\";\r\n\t\t      }\r\n        }\r\n   }\r\n   var str=obj.id;\r\n   \r\n   \r\n  \r\n   if(Number(str.substr(9))>Number(meaulmitSize))\r\n   {  \r\n      obj.className=\"portalXiaLaFocus\";\r\n   }\r\n   else\r\n   {\r\n\t   obj.className=\"topMenuFocus\";\r\n   }\r\n\r\n   document.getElementById(\"TR_MenuTop_ORT\").style.display='none';\r\n   document.getElementById(\"TR_MenuTop_NEW\").style.display='';\r\n   \r\n   document.all.menuTop_1001.src=(window.location.href).substring(0,window.location.href.indexOf(\"/jsoa\"))+leftURL;\r\n   document.all.MainDesktop.src=(window.location.href).substring(0,window.location.href.indexOf(\"/jsoa\"))+rightURL;\r\n   document.all.content2.style.display='none';   \r\n");
      out.write("}\r\nfunction jumpNewWindow(obj,url,meaulmitSize,openFlag)\r\n{\r\n\t ");
if(com.js.util.config.SystemCommon.getCustomerName().equals("chinaLife")){
      out.write("\r\n\t  var menuSize=");
      out.print((list.size()+5));
      out.write(";\r\n\t  ");
}else{
      out.write("\r\n\t  var menuSize=");
      out.print(list.size());
      out.write(";\r\n\t  ");
}
      out.write("\r\n   for(i=0;i<menuSize+1;i++)\r\n   {  \r\n\t      var z='topMenuTD'+i;\r\n\t      \r\n\t      if(document.getElementById(z))\r\n\t      {\r\n\t\t      if(Number(i)<Number(meaulmitSize))\r\n\t\t      {   \r\n\t\t\t   \tdocument.getElementById(z).className=\"topMenuNormal\";\r\n\t\t   \t    obj.className=\"topMenuFocus\";\r\n\t\t      }\r\n\t\t      else\r\n\t\t      {\r\n\t\t          document.getElementById(z).className=\"portalXialaEvel\";\r\n\t\t      }\r\n        }\r\n   }\r\n   var str=obj.id;\r\n  \r\n   if(Number(str.substr(9))>Number(meaulmitSize))\r\n   {  \r\n      obj.className=\"portalXiaLaFocus\";\r\n   }\r\n   else\r\n   {\r\n\t   obj.className=\"topMenuFocus\";\r\n   }\r\n   if(openFlag==1){\r\n\t   window.open(url,\"\",\"\");\r\n   }else if(openFlag==2){\r\n\t   document.getElementById(\"TR_MenuTop_ORT\").style.display='none';\r\n\t   document.getElementById(\"TR_MenuTop_NEW\").style.display='';\r\n\t   \r\n\t   document.all.menuTop_1001.src=url;\r\n   }else{\r\n\t   document.all.MainDesktop.src=url;\r\n   }\r\n\t\r\n}\r\n\r\nfunction jumpShot(obj){\r\n   var i=0;\r\n   while(document.all.topMenuTD[i]){\r\n       document.all.topMenuTD[i].className=\"topMenuNormal\";\r\n");
      out.write("       i++;\r\n   }\r\n   obj.className=\"topMenuFocus\";\r\n   document.all.menuTop.src=\"/jsoa/menu/left_top.jsp\";\r\n   document.all.content2.style.display='none';\r\n}\r\n\r\nfunction openMenu(obj){\r\n  if(document.all.leftMenuLeftTD.style.display!='none'){\r\n\t  document.all.leftMenuTD.width=\"1px;\";\r\n\t  document.all.leftMenuLeftTD.style.display='none';\r\n\t  obj.src=\"imges/show.gif\";\r\n\t  ");
if(!bflag){
      out.write("document.getElementById(\"MainDesktop\").style.width=document.body.clientWidth-10;");
}
      out.write("\r\n\t  obj.title=\"显示左面板\";\r\n  }else{\r\n  \t  document.all.leftMenuTD.width=\"140px;\";\r\n\t  document.all.leftMenuLeftTD.style.display='';\r\n\t  obj.src=\"imges/hide.gif\";\r\n\t  ");
if(!bflag){
      out.write("document.getElementById(\"MainDesktop\").style.width=document.body.clientWidth-140;");
}
      out.write("\r\n\t  obj.title=\"收起左面板\";\r\n  }  \r\n}\r\n\r\nfunction gotoPortal(obj,xmlfile,isUrl,url){\r\n\tif(isUrl==\"2\"){\r\n\t\tinit(xmlfile);\r\n\t}else{\r\n\t\t  var p=");
      out.print(portalList.size());
      out.write(";\r\n\t\t  for(i=1;i<p+1;i++)\r\n\t\t  {\r\n\t\t     var z='portal'+i;\r\n\t\t     if(document.getElementById(z)){\r\n\t\t\t     if(i<=");
      out.print((limit));
      out.write("){\r\n\t\t\t     \tdocument.getElementById(z).className=\"portalNormal\";\r\n\t\t\t     }else{\r\n\t\t\t     \tdocument.getElementById(z).className=\"portalXiala\";\r\n\t\t\t     }\r\n\t\t     }\r\n\t\t  }\r\n\t\t  var str=obj.id;\r\n\t\t  \r\n\t\t  if(str.substr(6)>");
      out.print(limit );
      out.write("){//如果长度大于6，则设置成下拉的样式\r\n\t\t  \tobj.className=\"portalXiaLaFocus\";\r\n\t\t  }else{\r\n\t\t  \tobj.className=\"portalFocus\";\r\n\t\t  }\r\n\t\t  if(isUrl=='1'){//如果使用了url,转向指定的url\r\n\t\t\t  document.getElementById(\"MainDesktop\").src=url;\r\n\t\t\t  content1.style.display='';\r\n\t\t\t  content2.style.display='none';\r\n\t\t  }else{\r\n\t\t    init(xmlfile);\r\n\t\t  }\r\n\t}  \r\n}\r\n\r\n\r\nfunction logOut(flag){\r\n\t");
//如果开启了统一认证，则先从统一认证退出，再从本地退出
	if("1".equals(com.js.util.config.SystemCommon.getUnitCertifySwitch())
			&&session.getAttribute("ssoType")!=null&&"sso".equals(session.getAttribute("ssoType")+"")){
		//String ip=request.getServerName();
		//int port=request.getServerPort();
		//String sessionId=session.getId();
		//String unitCertifUrl="http://"+com.js.util.config.SystemCommon.getIpPortUnitCertify()+"/authLogoutNewAction.do?becom_authlogout_url=http://"+ip+":"+port+"/jsoa/login.jsp&becom_authlogout_key="+sessionId;
		////location.href="toUnitCertify.jsp?unitCertifUrl="+unitCertifUrl;
	
      out.write("\r\n\t\tlocation.href=\"toUnitCertify.jsp?flag=close\";\r\n\t");
}else{
      out.write("\r\n\t\tif(flag==1){\r\n\t\t\t");
if("hntdxy".equals(customName)){
      out.write("\r\n\t\t\t\tlocation.href=\"https://cas.hnrpc.com/lyuapServer/logout\";\r\n\t\t\t");
}else if("zcl".equals(customName)){
      out.write("\r\n\t\t\t\twindow.opener=null;\r\n\t\t\t\twindow.open('','_self');\r\n\t\t\t\twindow.close();\r\n\t\t\t");
}else{
      out.write("\r\n\t\t\t\tlocation.href=\"/jsoa/login.jsp?validate=no\";\r\n\t\t\t");
}
      out.write("\r\n\t\t}\r\n\t");
}
      out.write("\r\n}\r\n\r\nfunction openOnlineUser(){\r\n   JSMainWinOpenForOnlineUser('/jsoa/OnlinerAction.do?method=showOnliner&action=showTree','','',800,0);\r\n}\r\n///////////////////////////////////////////////////////////////\r\nfunction IM_Start(){   \r\n\t\r\n}\r\n\r\n\r\nvar xmlhttp;\r\n\r\nfunction msgShow(a)\r\n{\r\n\r\n var element=document.all.content1;\r\n        var offsetTop = element.offsetTop; \r\n       var offsetLeft = element.offsetLeft; \r\n        var offsetWidth = element.offsetWidth; \r\n        var offsetHeight = element.offsetHeight; \r\n        while( element = element.offsetParent ) \r\n        { \r\n          offsetTop += element.offsetTop; \r\n          offsetLeft += element.offsetLeft; \r\n           }\r\n    var winTop=window.screenTop;\r\n    var winLeft=window.screenLeft; \r\n    \r\n    var Top=offsetTop+winTop;\r\n   var Left=offsetLeft+winLeft;\r\n   var se;\r\n   se=a.value.replace(/~/g,'&');   \r\n  \r\n  \r\n   offsetHeight=offsetHeight-33;\r\n   offsetWidth=offsetWidth-10;\r\n    \r\n    var b=document.getElementById(\"showTypeForVB\").value;\r\n   if(\"1\"==b){\r\n\t if(se.indexOf(\"showChat.jsp\")>=0)\r\n");
      out.write("\t{\r\n    JSMainWinOpen2(se,'newpage','',620,465);\r\n\t}else{\r\n window.open(se,\"newpage\",'TOP='+Top+',LEFT='+Left+',scrollbars=yes,resizable=yes,width='+offsetWidth+',height='+offsetHeight);\r\n   }\r\n\t  }else if(\"0\"==b)\r\n\t  {\r\n\t  document.getElementById(\"MainDesktop\").src=se;\r\n\t  \r\n\t  }\r\n         \r\n   \r\n}\r\nfunction otherload()\r\n{\r\n  var rtxlogin=\"");
      out.print(rtxlogins);
      out.write("\";\r\n  var othersys=\"");
      out.print(usd);
      out.write("\";\r\n  if(\"iactive\"==othersys){\r\n\t  //alert(rtxlogin);\r\n\t  if(rtxlogin==\"1\")\r\n\t  {\r\n\t  //  alert(\"dsfsfdsdf\");\r\n\t    IM_Start();\r\n\t  }\r\n   \r\n  }\r\n \r\n  var openother=\"");
      out.print(other);
      out.write("\";\r\n  var openotan=\"");
      out.print(tan);
      out.write("\";\r\n  if(\"null\"!=openother)\r\n  {\r\n      if(\"null\"!=openotan&&\"N\"==openotan)\r\n      {\r\n     // openother=openother.replace(/~/g,'&');  \r\n      window.open(openother,\"MainDesktop\",\"\");\r\n      }\r\n      \r\n       if(\"null\"!=openotan&&\"Y\"==openotan)\r\n      {\r\n        var element=document.all.content1;\r\n        var offsetTop = element.offsetTop; \r\n       var offsetLeft = element.offsetLeft; \r\n        var offsetWidth = element.offsetWidth; \r\n        var offsetHeight = element.offsetHeight; \r\n        while( element = element.offsetParent ) \r\n        { \r\n          offsetTop += element.offsetTop; \r\n          offsetLeft += element.offsetLeft; \r\n           }\r\n       var winTop=window.screenTop;\r\n       var winLeft=window.screenLeft; \r\n       var Top=offsetTop+winTop;\r\n       var Left=offsetLeft+winLeft;\r\n   \r\n      offsetHeight=offsetHeight-33;\r\n      offsetWidth=offsetWidth-10;\r\n      \r\n      var b=\"");
      out.print(showTypeForVB);
      out.write("\";\r\n         if(\"1\"==b){\r\n\t if(openother.indexOf(\"showChat.jsp\")>=0)\r\n\t  {\r\n       JSMainWinOpen2(openother,'newpage','',620,465);\r\n\t   }else{\r\n          window.open(openother,\"newpage\",'TOP='+Top+',LEFT='+Left+',scrollbars=yes,resizable=yes,width='+offsetWidth+',height='+offsetHeight);\r\n         }\r\n\t  }else if(0==b||\"0\"==b)\r\n\t  {\r\n\t  document.getElementById(\"MainDesktop\").src=openother;\r\n\t  \r\n\t  }\r\n      }\r\n  }\r\n  \r\n}\r\nfunction showVersionInfo()//显示版本信息\r\n{\r\n\tvar element =document.getElementById(\"imginfo\");\r\n\tvar top=event.screenY+20;\r\n\tvar left=event.screenX-440;\r\n\twindow.open(\"help_information.jsp\",\"帮助信息\",'TOP='+top+',LEFT='+left+',scrollbars=no,status=no,resizable=no,width=372,height=322,location=no');\r\n}\r\nfunction showmessages(index,url,id,urltype,a)\r\n{\r\n\t titleScrollStope=1;//停止页面的标题滚动\r\n\t window.setTimeout(\"window.document.title='");
      out.print(session.getAttribute("userName"));
      out.write(",九思协同办公系统iThink欢迎您!'\",2000);\r\n     var element=document.all.content1;\r\n     var offsetTop = element.offsetTop; \r\n     var offsetLeft = element.offsetLeft; \r\n     var offsetWidth = element.offsetWidth; \r\n     var offsetHeight = element.offsetHeight; \r\n     while( element = element.offsetParent ) \r\n     { \r\n       offsetTop += element.offsetTop; \r\n       offsetLeft += element.offsetLeft; \r\n     }\r\n     var winTop=window.screenTop;\r\n     var winLeft=window.screenLeft; \r\n     var Top=offsetTop+winTop;\r\n     var Left=offsetLeft+winLeft;\r\n   \r\n     offsetHeight=offsetHeight-33;\r\n     offsetWidth=offsetWidth-10;\r\n\r\n     if(\"1\"==a){\r\n\t \t //弹开\r\n\t\t if(\"0\"==urltype){\r\n\t\t \t//弹开小页面\r\n\t\t  \tJSMainWinOpen2(url,'newpage'+id,'',620,465);\r\n\t\t  }else{\r\n\t\t  \t//弹开大页面\r\n\t\t  \tvar workIds= new Array(); \r\n\t\t\t\tworkIds=url.split(\"&\");\r\n\t\t\t\tvar work=\"\";\r\n\t\t\t\tif(workIds!=null){\r\n\t\t\t\t\tfor(var song=0;song<workIds.length;song++){\r\n\t\t\t\t\t\tif(workIds[song].indexOf(\"workId=\")>=0){\r\n\t\t\t\t\t\t\twork=workIds[song].substring(7,25);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n\t\t\t  if(work!=null){\r\n\t\t\t\t\r\n\t\t\t  }else{\r\n\t\t\t    work=\"newpage\"+id;\r\n\t\t\t  }\r\n\t\t  \t  window.open(url,work,'TOP='+Top+',LEFT='+Left+',scrollbars=yes,resizable=yes,width='+offsetWidth+',height='+offsetHeight);\r\n\t\t  }\r\n\t  }else if(\"0\"==a)\r\n\t  {\r\n\t\t  //嵌在页面中\r\n\t\t  document.getElementById(\"MainDesktop\").src=url;\r\n\t  \r\n\t  }else if(\"3\"==a){\r\n\t  \t\t//下载\r\n\t  \t\tdocument.all.deskIframe.src=url;\r\n\t  }\r\n\t  //未读数目-1\r\n\t  document.all.remindWinNum.innerHTML=parseInt(document.all.remindWinNum.innerHTML)-1;\r\n\t  \r\n\t  eval(\"document.all.messageWinDIV\"+index+\".style.display='none'\");\r\n\t  eval(\"document.all.messageWinDIVIMG_\"+index+\".style.display='none'\");\r\n\t  eval(\"document.all.messageWinDIV_\"+index+\".style.display='none'\");\r\n\t  \r\n\t  if(parseInt(document.all.remindWinNum.innerHTML)<1){\r\n\t\t  document.all.remindDIV.style.display='none';\r\n\t      document.all.remindWinNum.innerHTML='0'; \r\n\t      if(document.all.remindWinImg.src.indexOf(\"dahua.gif\")>0){\r\n\t         document.all.remindWinImg.click();\r\n\t      }\r\n      }        \r\n\t  \r\n\t//标记为已读 \r\n");
      out.write("    if (window.XMLHttpRequest) {\r\n        xmlhttp = new XMLHttpRequest();\r\n        if (xmlhttp.overrideMimeType) {\r\n            xmlhttp.overrideMimeType(\"text/xml\");\r\n        }\r\n    } else if (window.ActiveXObject) {\r\n        var activexName = [\"MSXML2.XMLHTTP\",\"Microsoft.XMLHTTP\"];\r\n        for (var i = 0; i < activexName.length; i++) {\r\n            try{\r\n                xmlhttp = new ActiveXObject(activexName[i]);\r\n                break;\r\n            } catch(e){\r\n            }\r\n        }\r\n    }      \r\n    xmlhttp.open(\"post\",\"/jsoa/public/jsp/changesysmessagestatus.jsp?messageid=\"+id,true);\r\n    xmlhttp.send();\r\n    var newData;    \r\n}\r\n\r\nfunction showmoremessages(url){\r\n\t  document.getElementById(\"MainDesktop\").src=url;\t\r\n}\r\nfunction deleteOnlineUser(userId,userAccount){\r\n\tvar xmlhttp = getXmlHttp();\t\t\r\n\txmlhttp.open(\"GET\",\"/jsoa/public/jsp/deleteOnlineUser.jsp?userId=\"+userId+\"&userAccount=\"+userAccount,false);\r\n\txmlhttp.send();\r\n}\r\nfunction out(){//当鼠标移出下拉层时\r\n  document.getElementById(\"menu1\").style.visibility=\"hidden\";\r\n");
      out.write("  document.getElementById(\"selectTD\").style.visibility=\"visible\";\r\n}\r\nvar timeactionxiala;\r\n\r\nfunction clickXiala(){//点击下拉时\r\ndocument.getElementById(\"menu1\").style.visibility=\"visible\";\r\ntimeactionxiala=setTimeout(timeaction,2000);// 设置一个超时对象\r\ndocument.getElementById(\"selectTD\").style.visibility=\"hidden\";\r\n}\r\n\r\nfunction over(){\r\nclearTimeout(timeactionxiala);//清除定时器对象\r\ndocument.getElementById(\"menu1\").style.visibility=\"visible\";\r\ndocument.getElementById(\"selectTD\").style.visibility=\"hidden\";\r\n}\r\n\r\nfunction timeaction(){//定时器\r\ndocument.getElementById(\"menu1\").style.visibility=\"hidden\";\r\ndocument.getElementById(\"selectTD\").style.visibility=\"visible\";\r\n}\r\nfunction getXmlHttp(){\r\n\tvar xmlhttp;\r\n\t//开始初始化XMLHttpRequest对象\r\n\tif(window.XMLHttpRequest) { //Mozilla 浏览器\r\n\t\txmlhttp = new XMLHttpRequest();\r\n\t\tif (xmlhttp.overrideMimeType) {//设置MiME类别\r\n\t\t\txmlhttp.overrideMimeType('text/xml');\r\n\t\t}\r\n\t}\r\n\telse if (window.ActiveXObject) { // IE浏览器\r\n\t\ttry {\r\n\t\t\txmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n\t\t} catch (e) {\r\n");
      out.write("\t\t\ttry {\r\n\t\t\t\txmlhttp = new ActiveXObject(\"MSXML2.XMLHTTP\");\r\n\t\t\t} catch (e) {\r\n\t\t\t\talert(\"您看到此信息，说明您的浏览器不支持XML解析。\\r\\n请在弹出页面中下载XML解析器并安装！\");\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn xmlhttp;\r\n}\r\n\r\nfunction sAlert(str){ \r\n\tvar msgw, msgh, bordercolor; \r\n\tmsgw = 400;\t//提示窗口的宽度 \r\n\tmsgh = 100;\t//提示窗口的高度 \r\n\ttitleheight = 25   //提示窗口标题高度 \r\n\tbordercolor = \"#336699\";\t//提示窗口的边框颜色 \r\n\ttitlecolor = \"#99CCFF\";\t//提示窗口的标题颜色 \r\n\tvar Width, sHeight; \r\n\tsWidth = parent.document.body.offsetWidth;\t//浏览器工作区域内页面宽度 \r\n\tsHeight = screen.height;\t//屏幕高度（垂直分辨率） \r\n\r\n\t// 背景层（大小与窗口有效区域相同，即当弹出对话框时，背景显示为放射状透明灰色） \r\n\tvar bgObj = parent.document.createElement(\"div\");\t//创建一个div对象（背景层） \r\n\t// 定义div属性，即相当于 \r\n\tbgObj.setAttribute(\"id\", \"bgDiv\");\r\n\tbgObj.style.position = \"absolute\"; \r\n\tbgObj.style.top = \"0\"; \r\n\tbgObj.style.background = \"#777\"; \r\n\tbgObj.style.filter = \"progid:DXImageTransform.Microsoft.Alpha(style=3,opacity=25,finishOpacity=75\"; \r\n\tbgObj.style.opacity = \"0.6\"; \r\n\tbgObj.style.left = \"0\"; \r\n\tbgObj.style.width = sWidth + \"px\"; \r\n\tbgObj.style.height = sHeight + \"px\"; \r\n");
      out.write("\tbgObj.style.zIndex = \"10000\"; \r\n\tparent.document.body.appendChild(bgObj);\t//在body内添加该div对象 \r\n\r\n\tvar msgObj = parent.document.createElement(\"div\");\t//创建一个div对象（提示框层） \r\n\t//定义div属性，即相当于 \r\n\tmsgObj.setAttribute(\"id\", \"msgDiv\"); \r\n\tmsgObj.setAttribute(\"align\", \"center\"); \r\n\tmsgObj.style.background = \"white\"; \r\n\tmsgObj.style.border = \"1px solid \" + bordercolor; \r\n\tmsgObj.style.position = \"absolute\"; \r\n\tmsgObj.style.left = \"50%\"; \r\n\tmsgObj.style.top = \"50%\"; \r\n\tmsgObj.style.font = \"12px/1.6em Verdana, Geneva, Arial, Helvetica, sans-serif\"; \r\n\tmsgObj.style.marginLeft = \"-225px\"   ; \r\n\tmsgObj.style.marginTop = -75 + parent.document.documentElement.scrollTop + \"px\"; \r\n\tmsgObj.style.width = msgw + \"px\"; \r\n\tmsgObj.style.height = msgh + \"px\"; \r\n\tmsgObj.style.textAlign = \"center\"; \r\n\tmsgObj.style.lineHeight = \"25px\"; \r\n\tmsgObj.style.zIndex = \"10001\"; \r\n\tparent.document.body.appendChild(msgObj);\r\n\t     \r\n\tvar txt = parent.document.createElement(\"p\");\t//创建一个p对象（提示框提示信息） \r\n\t//定义p的属性，即相当于 \r\n\ttxt.style.margin = \"1em 0\" \r\n\ttxt.setAttribute(\"id\", \"msgTxt\"); \r\n");
      out.write("\ttxt.innerHTML = str;\t//来源于函数调用时的参数值  \r\n\tmsgObj.appendChild(txt);\r\n\tvar msgIMG = parent.document.createElement(\"IMG\") \r\n\tmsgIMG.src = \"/jsoa/iSignatureHTML.jsp/load.gif\";\r\n\tmsgIMG.setAttribute(\"id\", \"msgIMG\"); \r\n\tmsgObj.appendChild(msgIMG);\r\n} \r\n\r\nfunction removeObj(){ //点击标题栏触发的事件 \r\n\tdocument.body.removeChild(parent.document.getElementById(\"bgDiv\"));\t//删除背景层Div \r\n\tdocument.body.removeChild(parent.document.getElementById(\"msgDiv\"));\t//删除提示框层 \r\n}\r\n\r\n// 设置一级下拉菜单\r\nfunction outEvel(){//当鼠标移出下拉层时\r\n  document.getElementById(\"menuEvel\").style.visibility=\"hidden\";\r\n}\r\nvar timeactionxialaEvel;\r\n\r\nfunction clickXialaEvel()\r\n{//点击下拉时\r\n\t\r\n\tdocument.getElementById(\"menuEvel\").style.display=\"\";\r\n\tdocument.getElementById(\"menuEvel\").style.visibility=\"visible\";\r\n\ttimeactionxialaEvel=setTimeout(timeactionEvel,2000);// 设置一个超时对象\r\n}\r\n\r\nfunction overEvel(){\r\nclearTimeout(timeactionxialaEvel);//清除定时器对象\r\ndocument.getElementById(\"menuEvel\").style.visibility=\"visible\";\r\n}\r\n\r\nfunction timeactionEvel(){//定时器\r\ndocument.getElementById(\"menuEvel\").style.visibility=\"hidden\";\r\n");
      out.write("}\r\nfunction changeCurrentOrg(obj){\r\n\tdocument.getElementById(\"changeOrgIframe\").src=\"/jsoa/public/jsp/changecurrentorg.jsp?orgId=\"+obj.value+\"&rnd=\"+new Date();\r\n}\r\n</script>\r\n<SCRIPT FOR=window EVENT=onbeforeunload>\r\n\tdeleteOnlineUser(\"");
      out.print(userId);
      out.write('"');
      out.write(',');
      out.write('"');
      out.print(userAccount);
      out.write("\");\r\n</SCRIPT>\r\n<script src=\"/jsoa/js/js.js\"></script>\r\n<script src=\"/jsoa/js/util.js\"></script>\r\n<script src=\"/jsoa/js/jsrequest.js\"></script>\r\n<script src=\"/jsoa/js/desktop.js\"></script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
