/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: JspC/ApacheTomcat8
 * Generated at: 2023-01-06 09:43:56 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.kq.weixinkq;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import com.js.oa.hr.kq.bean.KqCheckinInfoBean;
import com.js.oa.form.kq.PaiBanUtil;
import com.js.oa.form.kq.KqImportUtil;
import java.util.*;
import java.text.*;
import com.js.system.manager.service.ManagerService;
import com.js.util.util.BrowserJudge;

public final class weixin_005fkq_005fnq_005fshow_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(6);
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-nested.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-tiles.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-logic.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-html.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-template.tld", Long.valueOf(1499751390000L));
    _jspx_dependants.put("/WEB-INF/tag-lib/struts-bean.tld", Long.valueOf(1499751390000L));
  }

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("java.util");
    _jspx_imports_packages.add("java.text");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = new java.util.HashSet<>();
    _jspx_imports_classes.add("com.js.oa.form.kq.KqImportUtil");
    _jspx_imports_classes.add("com.js.oa.hr.kq.bean.KqCheckinInfoBean");
    _jspx_imports_classes.add("com.js.util.util.BrowserJudge");
    _jspx_imports_classes.add("com.js.oa.form.kq.PaiBanUtil");
    _jspx_imports_classes.add("com.js.system.manager.service.ManagerService");
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    final java.lang.String _jspx_method = request.getMethod();
    if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method) && !javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
      return;
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=GBK");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n");

String year,month,day;
year=request.getParameter("Year")==null?(request.getAttribute("Year")==null?"":request.getAttribute("Year").toString()):request.getParameter("Year");
month=request.getParameter("Month")==null?(request.getAttribute("Month")==null?"":request.getAttribute("Month").toString()):request.getParameter("Month");
day=request.getParameter("Day")==null?(request.getAttribute("Day")==null?"":request.getAttribute("Day").toString()):request.getParameter("Day");

String kuanggongTitle = "无考勤数据";
Date d = new Date();
if(year==null || "".equals(year)){
	year = String.valueOf(d.getYear()+1900);
}
if(month==null || "".equals(month)){
	month = String.valueOf(d.getMonth()+1);
}
if(day == null || "".equals(day)){
	day = String.valueOf(d.getDate());
}

boolean bflag=false;if(BrowserJudge.isMSIE(request))bflag=true;

int index = 0;
String range = "*0*";
if(session.getAttribute("rang")!=null && !"".equals(session.getAttribute("rang"))){
	range = (String)session.getAttribute("rang");
}
String dateString = request.getAttribute("dateString").toString();
String[] dateStr = dateString.split(",");
Map map=new HashMap();
map=(Map)request.getAttribute("map");
String empOrgName = request.getAttribute("orgName")+"";
String empName = request.getParameter("empName");
String empId = request.getParameter("empId");
Map dutyShow = (Map)request.getAttribute("dutyShow");

List list=(List)request.getAttribute("list");

      out.write("\r\n<head>\r\n<META HTTP-EQUIV=\"pragma\" CONTENT=\"no-cache\"> \r\n<META HTTP-EQUIV=\"Cache-Control\" CONTENT=\"no-cache, must-revalidate\"> \r\n<META HTTP-EQUIV=\"expires\" CONTENT=\"Wed, 26 Feb 1997 08:21:57 GMT\">\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\">\r\n<title>考勤统计</title>\r\n<link href=\"skin/");
      out.print(session.getAttribute("skin"));
      out.write("/style-");
      out.print(session.getAttribute("browserVersion"));
      out.write(".css\" rel=\"stylesheet\" type=\"text/css\" />\r\n<link rel=stylesheet type=\"text/css\" href=\"/jsoa/public/date_picker/DateObject2.css\">\r\n<SCRIPT language=javascript src=\"/jsoa/js/openEndow.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/DateObject.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/DatePicker.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/editlib.js\"></SCRIPT>\r\n<SCRIPT language=javascript src=\"/jsoa/public/date_picker/tree.js\"></SCRIPT>\r\n<script src=\"/jsoa/js/js.js\" language=\"javascript\"></script>\r\n<script src=\"/jsoa/js/util.js\"></script>\r\n<script src=\"/jsoa/kq/showDuty.js\"></script>\r\n<style type=\"text/css\">\r\n.listTableLine1{\r\n    /*background-color:#F5F6F6;*/\r\n    background-color:#f6f9fc;\r\n    height:80px;\r\n\tborder-TOP:1px solid #B6B6B6;\r\n\ttext-indent:6px;\t\r\n\toverflow:hidden;\r\n\ttext-overflow:ellipsis;\r\n\twhite-space:nowrap;\r\n\ttable-layout:fixed;\r\n}\r\n.listTableLine2{\r\n\toverflow:hidden;\r\n\ttext-overflow:ellipsis;\r\n\twhite-space:nowrap;\r\n");
      out.write("    background-color:#FFFFFF;\r\n    height:80px;\r\n\ttext-indent:6px;\t\r\n\tborder-TOP:1px solid #B6B6B6;\t\r\n}\r\n</style>\r\n\r\n</head>\r\n\r\n<body  class=\"MainFrameBox\" >\r\n<table width=\"100%\" border=0 cellpadding=\"0\" cellspacing=\"0\">\r\n<tr>\r\n<td>\r\n");

String local = session.getAttribute("org.apache.struts.action.LOCALE").toString();
SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
SimpleDateFormat dateTimeformat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
String searchDate=request.getAttribute("searchDate")==null?"":request.getAttribute("searchDate").toString();
	
String byear,bmonth,bday,eyear,emonth,eday;
String start_date=request.getAttribute("start_date")==null?"":request.getAttribute("start_date").toString();
String end_date=request.getAttribute("end_date")==null?"":request.getAttribute("end_date").toString();
//System.out.println("-------"+start_date+"   "+end_date);
Date b=null; 
Date e=null; 
if("".equals(start_date)){
	b = new Date();
}else{
	b= format.parse(start_date);
}
byear = String.valueOf(b.getYear()+1900);
bmonth = String.valueOf(b.getMonth()+1);
bday = String.valueOf(b.getDate());
if("".equals(end_date)){
	e = new Date();
}else{
	e= format.parse(end_date);
}
eyear = String.valueOf(e.getYear()+1900);
emonth = String.valueOf(e.getMonth()+1);
eday = String.valueOf(e.getDate());

      out.write("\r\n\r\n<table width=\"100%\" height=\"25\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"inlineBottomLine\">\r\n  <tr>\r\n  <td align=\"left\" width=\"130px\">\r\n       <span style=\"font-size:15px;\"><b>");
      out.print(request.getAttribute("orgName") );
      out.write("</b></span>&nbsp;\r\n       <span style=\"font-size:15px;\"><b>");
      out.print(request.getAttribute("empName"));
      out.write("</b></span>\r\n  </td>\r\n  <td align=\"left\" width=\"60px\">考勤月份：</td>\r\n  <td align=\"left\">\r\n       <div valign=\"bottom\">&nbsp;&nbsp;&nbsp;\r\n     \t<a href=\"javascript:void(0);getMonth(-1,");
      out.print(Integer.parseInt(month)==1?(Integer.parseInt(year)-1):Integer.parseInt(year));
      out.write(',');
      out.print(Integer.parseInt(month)==1?12:(Integer.parseInt(month)-1));
      out.write(");\" title=\"上月\">\r\n     \t  <img src=\"/jsoa/skin/");
      out.print(session.getAttribute("skin"));
      out.write("/images/prev.gif\" border=0 align=\"absmiddle\"/>\r\n     \t</a>&nbsp;\r\n\t\t  ");
if(local.indexOf("en")!=-1){
		  	out.print(new java.text.SimpleDateFormat("MMMM yyyy",java.util.Locale.US).format((new java.util.Date(Integer.parseInt(year)-1900, Integer.parseInt(month)-1, Integer.parseInt(day)))));
		  }else{
		  	out.print(new java.text.SimpleDateFormat("yyyy年M月",java.util.Locale.CHINA).format((new java.util.Date(Integer.parseInt(year)-1900, Integer.parseInt(month)-1, Integer.parseInt(day)))));
		  }
		  Date thisDate = new Date();
		  int nian = thisDate.getYear()+1900;
		  int yue = thisDate.getMonth()+1;
		  int nextNian = Integer.parseInt(month)==12?(Integer.parseInt(year)+1):Integer.parseInt(year);
		  int nextYue = Integer.parseInt(month)==12?1:(Integer.parseInt(month)+1);
		  //System.out.println("-------"+(nextNian*12+nextYue)+"   "+(nian*12+yue));
		  if((nextNian*12+nextYue)<=(nian*12+yue)){
      out.write("\r\n\t   <a href=\"javascript:void(0);getMonth(1,");
      out.print(nextNian );
      out.write(',');
      out.print(nextYue );
      out.write(");\" title=\"下月\"><img src=\"/jsoa/skin/");
      out.print(session.getAttribute("skin"));
      out.write("/images/next.gif\"  border=0 align=\"absmiddle\"/></a>&nbsp;\r\n\t  ");
} 
      out.write("\r\n     </div>\r\n  </td>\r\n  \r\n  <td><input type=\"button\" id=\"hiddenExport\" class=\"btnButton2Font\" onClick=\"toexcelWithSub()\" value=\"导出\" /></td>\r\n </tr>\r\n</table>\r\n<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"listTable\">\r\n     <tr align=\"center\">\r\n             <td class=\"listTableHead\" width=\"110px\" >日期</td>\r\n             <td class=\"listTableHead\" width=\"110px\" align=\"center\">时间</td>\r\n             <td class=\"listTableHead\" width=\"110px\" align=\"center\">地点</td>\r\n\t </tr>\r\n\t  ");

	   String listClass="listTableLine1";
	   String userId=(String)request.getAttribute("userId");
	   for(int j=0;j<dateStr.length;j++){
	      index ++;
		  listClass = index%2!=0?"listTableLine2":"listTableLine1";
		  List listData=new KqCheckinInfoBean().getWeixinKqByDate(dateStr[j], userId);
	  
      out.write("\r\n\t   <tr>\r\n\t\t   <td class=\"");
      out.print(listClass);
      out.write('"');
      out.write('>');
      out.print(dateStr[j]);
      out.write("</td>\r\n\t\t   ");

		   String date="";
		   String weizhi="";
		   if(listData!=null&&listData.size()>0){
		      for(int i=0;i<listData.size();i++){
		        Object[] objss=(Object[])listData.get(i);
		        if(i==0){
		          date+="上班："+objss[2].toString().substring(10, objss[2].toString().length()-2);
		          weizhi+="上班："+objss[3]+"</br></br>";
		        }else if(i==listData.size()-1){
		          date+="</br></br>&nbsp;&nbsp;下班："+objss[2].toString().substring(10, objss[2].toString().length()-2);
		          weizhi+="&nbsp;&nbsp;下班："+objss[3];
		        }
		      }
		    }else{
		         DateFormat format1 = new SimpleDateFormat("yyyy-MM-dd");        
                 String bDate = dateStr[j].toString().substring(0,10); 
                 Date bdate = format1.parse(bDate); 
			     Calendar cal = Calendar.getInstance();
			     cal.setTime(bdate);
			     if(cal.get(Calendar.DAY_OF_WEEK)==Calendar.SATURDAY)
				 {
				     //out.print("星期六");
				     date="星期六";
				     weizhi="";
				 }
				 if(cal.get(Calendar.DAY_OF_WEEK)==Calendar.SUNDAY)
				 {
				      //out.print("星期日");
				       date="星期日";
				       weizhi="";
				 }
		    
		    }
		    
      out.write("\r\n\t\t     <td class=\"");
      out.print(listClass);
      out.write("\">&nbsp;");
      out.print(date );
      out.write("</td>\r\n\t\t     <td class=\"");
      out.print(listClass);
      out.write("\">&nbsp;");
      out.print(weizhi );
      out.write("</td>\r\n       </tr>\r\n    ");
}
      out.write("\r\n</table>\r\n</body>\r\n<script language=\"javascript\">\r\n\r\n\r\n\r\n\r\nfunction hide(obj,flag){\r\n\tvar theDiv = document.getElementById(flag);\r\n\tif(!theDiv){\r\n\t\ttheDiv = document.getElementById(\"show\");\r\n\t}\r\n\ttheDiv.style.display=\"none\";\r\n\tobj.style.background=\"#f6f9fc\"; \r\n}\r\nfunction searcher(){\r\n\tKqLeaveActionForm.submit();\r\n}\r\nfunction hidserch(){\r\n     var stable=document.getElementById(\"searchtable\");\r\n     var sbutton=document.getElementById(\"hiddenSearch\");\r\n     if(stable.style.display==\"none\"){\r\n\t     stable.style.display=\"\";\r\n\t     hiddenSearch.innerHTML=\"关闭查询\";\r\n     }else{\r\n\t     stable.style.display=\"none\";\r\n\t     hiddenSearch.innerHTML=\"查询\";\r\n     }\r\n}\r\nfunction changePanle(cURL){\r\n\tlocation.href=cURL;\r\n}\r\nfunction getMonth(type, year, month){\r\n\tif(type=='0'){\r\n\t\tvar d=new Date();\r\n\t\t");
if(bflag){ 
      out.write("year=d.getYear();");
}else{
      out.write("year=d.getYear()+1900;");
}
      out.write("\r\n\t\tmonth=d.getMonth()+1;\r\n\t}\r\n\tif(month<10){\r\n\t\tmonth=\"0\"+month;\r\n\t}\r\n\tlocation.href='/jsoa/kqCheckinInfoAction.do?action=kqquerygr&userId=");
      out.print(request.getAttribute("userId"));
      out.write("&Year='+year+'&Month='+month+'&Day=");
      out.print(day);
      out.write("';\r\n}\r\n\r\nfunction toexcelWithSub(){\r\n  JSMainWinOpen(\"/jsoa/kqCheckinInfoAction.do?action=kqquerygrexport&userId=");
      out.print(request.getAttribute("userId"));
      out.write("&Year=");
      out.print(year);
      out.write("&Month=");
      out.print(month);
      out.write("&Day=");
      out.print(day);
      out.write("\");\r\n}\r\n\r\n\r\n</script>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
